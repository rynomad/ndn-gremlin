!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("ndn-js-contrib"),d=c.ndn,e=a("os"),f={},g=a("./Manager.js");f.debug=a("debug")("Forwarder");var h=function(a){a=a||{},this.ndn=c.ndn,this.contrib=c,this.nameTree=new c.NameTree,this.fib=new c.FIB(this.nameTree),this.listeners=new c.FIB(new c.NameTree),this.listenerCallbacks=[],this.pit=new c.PIT(this.nameTree),this.maxMemory=a.mem||.5*e.freemem(),this.cache=new c.ContentStore(this.nameTree,null,this.maxMemory),this.interfaces=new c.Interfaces(this);var b=Object.keys(c.Transports);a.TCPServerTransport=a.tcp,a.WebSocketServerTransport=a.ws,this.remoteInfo={ipv4:a.ipv4||"0.0.0.0",domain:a.domain||"localhost",iceServers:a.iceServers||[]};for(var d=0;d<b.length;d++)c.Transports[b[d]].defineListener&&("TCPServerTransport"===c.Transports[b[d]].prototype.name?this.remoteInfo.tcp={port:a.tcp||8484,name:"TCPServerTransport"}:"WebSocketServerTransport"===c.Transports[b[d]].prototype.name?this.remoteInfo.ws={port:a.ws||8585,name:"WebSocketServerTransport"}:"WebSocketTransport"===c.Transports[b[d]].prototype.name&&(this.remoteInfo.ws={name:"WebSocketTransport"}),c.Transports[b[d]].defineListener(this,a[c.Transports[b[d]].prototype.name])),this.interfaces.installTransport(c.Transports[b[d]]);return g(this),this};h.ndn=c.ndn,h.contrib=c,h.prototype.addConnectionListener=function(){},a("./node/ConnectionListeners.js")(h),a("./node/createSuffix.js")(h),h.prototype.handleInterest=function(a,b,c){function e(c,d,i){function j(){return function(a){e(a,!1,i)}}function k(){if(i.hasNext){for(var a,c,d=i.next(),e=[],f=0;f<d.nextHops.length;f++)g.listenerCallbacks[d.nextHops[f].faceID].blocking?(a=g.listenerCallbacks[d.nextHops[f].faceID].callback,block=!0):g.listenerCallbacks[d.nextHops[f].faceID].connection?c=g.listenerCallbacks[d.nextHops[f].faceID].callback:e.push(g.listenerCallbacks[d.nextHops[f].faceID]);if(c)return void c(h,b,function(c){if(!c&&e.length>0)for(var d=0;d<e.length;d++)e[d].callback(h,b);if(a)a(h,b,new j);else{var f=new j;f(c)}});if(e.length>0)for(var m=0;m<e.length;m++)e[m].callback(h,b);a?a(h,b,new j):i.hasNext?k():l()}else l()}function l(){var c=g.cache.check(h);if(c)g.interfaces.dispatch(c,0|1<<b);else if(!f.skipForward){var d=g.fib.findAllNextHops(h.name,b);d&&g.interfaces.dispatch(a,d)}}return i=i||g.listeners.findAllFibEntries(h.name),c?l():k(),g}var f={},g=this,h=new d.Interest;return h.wireDecode(a),this.pit.checkDuplicate(h)?this:(g.pit.insertPitEntry(a,h,b),e(c))},h.prototype.handleData=function(a){var b=new d.Data;b.wireDecode(a);var c=this.pit.lookup(b);if(c.faces&&this.interfaces.dispatch(a,c.faces),c.pitEntries.length>0){this.cache.insert(a,b);for(var e=0;e<c.pitEntries.length;e++)c.pitEntries[e].callback&&c.pitEntries[e].callback(b,c.pitEntries[e].interest),c.pitEntries[e].consume(!0)}return this},h.prototype.addListener=function(a,b){this.listenerCallbacks=this.listenerCallbacks||[];var c,e;"string"==typeof a?(c=a,e={}):(c=a.prefix,e=a),c=new d.Name(c),c=c.toUri();var f=this.listenerCallbacks.length,g=!0;if(e.connection){var h=!1;if(this.listenerCallbacks.length>0)for(var i=0;i<this.listenerCallbacks.length;i++)if(this.listenerCallbacks[i].prefix===c&&this.listenerCallbacks[i].connection){this.listenerCallbacks[i].callback=b,h=!0,g=!1;break}h||this.listenerCallbacks.push({connection:!0,callback:b,listenerID:f,prefix:c})}else if(e.blocking){var j=!1;if(this.listenerCallbacks.length>0)for(var k=0;k<this.listenerCallbacks.length;k++)if(this.listenerCallbacks[k].prefix===c&&this.listenerCallbacks[k].blocking){this.listenerCallbacks[k].callback=b,j=!0,g=!1;break}j||(this.listenerCallbacks.push({blocking:!0,callback:b,listenerID:f,prefix:c}),console.log("pushed"))}else this.listenerCallbacks.push({blocking:!1,callback:b,listenerID:f,prefix:c});return g&&this.listeners.addEntry(c,f),this},h.prototype.removeListeners=function(a){if(a=new d.Name(a),this.listenerCallbacks=this.listenerCallbacks||[],0===this.listenerCallbacks.length)return this;for(var b=this.listeners.lookup(a);b.nextHops.length;){var c=b.nextHops.pop();this.listenerCallbacks[c.faceID].callback=null}return this},h.prototype.setMaxConnections=function(a){return this.maxConnections=a,this},a("./node/addConnection.js")(h),h.prototype.removeConnection=function(a){if(this.interfaces.Faces[a]){for(;this.interfaces.Faces[a].prefixes.length>0;)this.fib.lookup(this.interfaces.Faces[a].prefixes.pop()).removeNextHop({faceID:a});return this.interfaces.Faces[a].close(),this.interfaces.Faces[a].closeByTransport(),this.interfaces.Faces[a].onclose(),this.connectionCount--,this}},h.prototype.requestConnection=function(a,b,c){var e=this;return e.createConnectionRequestSuffix(function(c,f){var g=new d.Name(a);g.append(c.value);var h=new d.Interest(g);h.setInterestLifetimeMilliseconds(16e3);var i=h.wireEncode().buffer,j=new d.Interest;try{j.wireDecode(i)}catch(k){}e.pit.insertPitEntry(i,j,function(c){if(c)try{if(f){var d=JSON.parse(c.content.toString());f(d)}e.addRegisteredPrefix(a,e.interfaces.Faces.length-1),b(null,e.interfaces.Faces.length-1)}catch(g){}else b(new Error("connection request timeout"))});var l=e.fib.findAllNextHops(a);try{e.interfaces.dispatch(i,l)}catch(k){}},function(d){e.addConnection(d,function(c){e.addRegisteredPrefix(a,c),b(null,c)},function(a){e.removeConnection(a),c(a)})}),this},h.prototype.addRegisteredPrefix=function(a,b){return this.fib.addEntry(a,b),this.interfaces.Faces[b].prefixes=this.interfaces.Faces[b].prefixes||[],this.interfaces.Faces[b].prefixes.push(a),this},h.prototype.registerPrefix=function(a,b){var c=new d.Name("marx/fib/add-nexthop");c.append(new d.Name(a));var e=new d.Interest(c);return this.interfaces.Faces[b].send(e.wireEncode().buffer),this},h.prototype.unregisterPrefix=function(a,b){var c=new d.Name("marx/fib/remove-nexthop");c.append(new d.Name(a));var e=new d.Interest(c);return this.interfaces.Faces[b].send(e.wireEncode().buffer),this},b.exports=h},{"./Manager.js":2,"./node/ConnectionListeners.js":3,"./node/addConnection.js":5,"./node/createSuffix.js":6,debug:7,"ndn-js-contrib":44,os:29}],2:[function(a,b){b.exports=function(a){a.addListener("marx/fib/add-nexthop",function(b,c){console.log("got add-nexthop");var d=b.name.getSubName(3).toUri();a.fib.lookup(d).addNextHop({faceID:c}),a.interfaces.Faces[c].prefixes=a.interfaces.Faces[c].prefixes||[],a.interfaces.Faces[c].prefixes.push(d)}).addListener("marx/fib/remove-nexthop",function(b,c){var d=b.name.getSubName(3).toUri();a.fib.lookup(d).removeNextHop({faceID:c})}).addListener("marx",function(a){console.log("logging blocked Interest on /marx namespace, ",a.toUri())})}},{}],3:[function(a,b){var c=a("./adapter/adapter.js"),d={};d.debug=a("debug")("ConnectionListeners"),b.exports=function(a){var b=a.ndn;a.prototype.addConnectionListener=function(a,d,e,f){var g=this,h=0;return g.connectionLabels=g.connectionLabels||[],g.addListener({connection:!0,prefix:a},function(i,j,k){if(d>h){h++;var l,m=new g.ndn.Data;try{if(m.wireDecode(i.name.get(-1).getValueAsBuffer()),"/connectionRequest"===m.name.toUri())if(l=JSON.parse(m.content.toString()),l.ws)g.addConnection("ws://"+l.domain+":"+l.ws.port,function(b){g.addRegisteredPrefix(a,b),e(null,b)},function(a){h--,f&&f(a)});else if(l.candidates&&l.config){for(var n=!1,o=0;o<l.labels.length;o++){for(var p=0;p<g.connectionLabels.length;p++)if(l.labels[o]===g.connectionLabels.length){n=!0;break}if(n)break}if(n)k();else{var q={};q.candidates=[];var r=!1,s=new c(l.config,{optional:[{RTPDataChannels:!0}]});s.ondatachannel=function(b){g.connectionLabels.push(b.channel.label),g.addConnection(b.channel,function(b){g.addRegisteredPrefix(a,b),e(null,b)},function(a){f&&f(a),h--})};var t=function(){var a=new b.Data(new b.Name(i.name),new b.SignedInfo,JSON.stringify(q));console.log("made data"),a.signedInfo.setFields(),a.sign(),console.log("signed data");var c=a.wireEncode().buffer;return c};s.onicecandidate=function(a){if(q.candidates.length>0&&r===!1){r=!0;var b=t();g.interfaces.dispatch(b,0|1<<j)}else a.candidate&&"data"===a.candidate.sdpMid&&q.candidates.push(a.candidate)},s.setRemoteDescription(new RTCSessionDescription(l.sdp));for(var u=0;u<l.candidates.length;u++)s.addIceCandidate(new RTCIceCandidate(l.candidates[u]));s.createAnswer(function(a){q.sdp=a,s.setLocalDescription(a)})}}else k();else k()}catch(v){k()}}else console.log("max connections for this listener"),k()})}}},{"./adapter/adapter.js":4,debug:7}],4:[function(a,b){"use strict";function c(a){if(a)for(var b=0;b<a.iceServers.length;b++)a.iceServers[b].hasOwnProperty("urls")&&(a.iceServers[b].url=a.iceServers[b].urls,delete a.iceServers[b].urls)}var d=null,e=null,f=null,g=null,h=null,i=null;if(navigator.mozGetUserMedia)console.log("This appears to be Firefox"),h="firefox",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10),d=function(a,b){return c(a),new mozRTCPeerConnection(a,b)},window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate,e=navigator.mozGetUserMedia.bind(navigator),navigator.getUserMedia=e,window.createIceServer=function(a,b,c){var d=null,e=a.split(":");if(0===e[0].indexOf("stun"))d={url:a};else if(0===e[0].indexOf("turn"))if(27>i){var f=a.split("?");(1===f.length||0===f[1].indexOf("transport=udp"))&&(d={url:f[0],credential:c,username:b})}else d={url:a,credential:c,username:b};return d},window.createIceServers=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=window.createIceServer(a[e],b,c);null!==f&&d.push(f)}return d},f=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b},g=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject};else if(navigator.webkitGetUserMedia){console.log("This appears to be Chrome"),h="chrome";var j=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);i=null!==j?parseInt(j[2],10):999,window.createIceServer=function(a,b,c){var d=null,e=a.split(":");return 0===e[0].indexOf("stun")?d={url:a}:0===e[0].indexOf("turn")&&(d={url:a,credential:c,username:b}),d},window.createIceServers=function(a,b,c){var d=[];if(i>=34)d={urls:a,credential:c,username:b};else for(var e=0;e<a.length;e++){var f=window.createIceServer(a[e],b,c);null!==f&&d.push(f)}return d},d=function(a,b){return 34>i&&c(a),new webkitRTCPeerConnection(a,b)},e=navigator.webkitGetUserMedia.bind(navigator),navigator.getUserMedia=e,f=function(a,b){"undefined"!=typeof a.srcObject?a.srcObject=b:"undefined"!=typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},g=function(a,b){a.src=b.src}}else console.log("Browser does not appear to be WebRTC-capable");b.exports=d},{}],5:[function(a,b){function c(a,b,c){var d;if(console.log("addConnection ",a),this.connectionCount=this.connectionCount||0,!this.maxConnections||this.interfaces.Faces.length<this.maxConnections)if("string"==typeof a){var e=a,f=e.split("://")[0];console.log(this),"ws"===f&&(this.connectionCount++,d=this.interfaces.newFace("WebSocketTransport",{host:e.split("://")[1].split(":")[0],port:e.split("://")[1].split(":")[1]||8585},b,c))}else a instanceof MessagePort?(this.connectionCount++,d=this.interfaces.newFace("MessageChannelTransport",a,b,c)):a.binaryType&&a.readyState&&a.label&&(this.connectionCount++,console.log("dataChanneltransport ducktype"),d=this.interfaces.newFace("DataChannelTransport",a,b,c));else console.log("maximum connections reached");return this}b.exports=function(a){a.prototype.addConnection=c}},{}],6:[function(a,b){function c(a,b){function c(){j.config=h;var a=JSON.stringify(j),b=new g.Data(new g.Name("connectionRequest"),new g.SignedInfo,a);b.signedInfo.setFields(),b.sign();var c=b.wireEncode(),d=new g.Name.Component(c.buffer);return d}var e=this,f=!1,g=e.ndn;e.connectionLabels=e.connectionLabels||[];var h={iceServers:this.remoteInfo.iceServers},i=new d(h,{optional:[{RTPDataChannels:!0}]}),j={};j.candidates=[],j.labels=e.connectionLabels;var k=i.createDataChannel(Math.random(),{reliable:!1});k.onopen=function(){e.connectionLabels.push(k.label),b(k)};var l=function(a){var b=new RTCSessionDescription(a.sdp);i.setRemoteDescription(b);for(var c=0;c<a.candidates.length;c++){var d=new RTCIceCandidate(a.candidates[c]);i.addIceCandidate(d)}};i.onicecandidate=function(b){if(console.log("ICECAndidate",b,j,f),j.candidates.length>1&&f===!1){f=!0;var d=c();console.log("executing suffix callback"),a(d,l)}else b.candidate&&"data"===b.candidate.sdpMid&&f===!1&&j.candidates.push(b.candidate)};var m={optional:[],mandatory:{OfferToReceiveVideo:!1}};i.createOffer(function(a){i.setLocalDescription(a,function(){console.log("description set")},function(a){console.log(a)}),j.sdp=a},null,m)}var d=a("./adapter/adapter.js"),e={};e.debug=a("debug")("RTCConnectionListener"),b.exports=function(a){a.prototype.createConnectionRequestSuffix=c}},{"./adapter/adapter.js":4,debug:7}],7:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(b){}}function h(){var a;try{a=localStorage.debug}catch(b){}return a}c=b.exports=a("./debug"),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{"./debug":8}],8:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:9}],9:[function(a,b){function c(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"h":return c*i;case"minutes":case"minute":case"m":return c*h;case"seconds":case"second":case"s":return c*g;case"ms":return c}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;b.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b.long?e(a):d(a)}},{}],10:[function(){},{}],11:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e,f=typeof a;if("number"===f)e=a>0?a>>>0:0;else if("string"===f)"base64"===b&&(a=x(a)),e=d.byteLength(a,b);else{if("object"!==f||null===a)throw new TypeError("must start with number, buffer, array or string");"Buffer"===a.type&&J(a.data)&&(a=a.data),e=+a.length>0?Math.floor(+a.length):0}if(this.length>K)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K.toString(16)+" bytes");var g;d.TYPED_ARRAY_SUPPORT?g=d._augment(new Uint8Array(e)):(g=this,g.length=e,g._isBuffer=!0);var h;if(d.TYPED_ARRAY_SUPPORT&&"number"==typeof a.byteLength)g._set(a);else if(z(a))if(d.isBuffer(a))for(h=0;e>h;h++)g[h]=a.readUInt8(h);else for(h=0;e>h;h++)g[h]=(a[h]%256+256)%256;else if("string"===f)g.write(a,0,b);else if("number"===f&&!d.TYPED_ARRAY_SUPPORT&&!c)for(h=0;e>h;h++)g[h]=0;return g}function e(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function f(a,b,c,d){var e=F(B(b),a,c,d);return e}function g(a,b,c,d){var e=F(C(b),a,c,d);return e}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,d){var e=F(E(b),a,c,d);return e}function j(a,b,c,d){var e=F(D(b),a,c,d);return e}function k(a,b,c){return H.fromByteArray(0===b&&c===a.length?a:a.slice(b,c))}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=G(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+G(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=A(a[f]);return e}function p(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function q(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function r(a,b,c,e,f,g){if(!d.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new TypeError("value is out of bounds");if(c+e>a.length)throw new TypeError("index out of range")}function s(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function t(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function u(a,b,c,d,e,f){if(b>e||f>b)throw new TypeError("value is out of bounds");if(c+d>a.length)throw new TypeError("index out of range")}function v(a,b,c,d,e){return e||u(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),I.write(a,b,c,d,23,4),c+4}function w(a,b,c,d,e){return e||u(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),I.write(a,b,c,d,52,8),c+8}function x(a){for(a=y(a).replace(M,"");a.length%4!==0;)a+="=";return a}function y(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function z(a){return J(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function A(a){return 16>a?"0"+a.toString(16):a.toString(16)}function B(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(d);else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function C(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function D(a){for(var b,c,d,e=[],f=0;f<a.length;f++)b=a.charCodeAt(f),c=b>>8,d=b%256,e.push(d),e.push(c);return e}function E(a){return H.toByteArray(a)}function F(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function G(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var H=a("base64-js"),I=a("ieee754"),J=a("is-array");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192;var K=1073741823;d.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(c){return!1}}(),d.isBuffer=function(a){return!(null==a||!a._isBuffer)},d.compare=function(a,b){if(!d.isBuffer(a)||!d.isBuffer(b))throw new TypeError("Arguments must be Buffers");for(var c=a.length,e=b.length,f=0,g=Math.min(c,e);g>f&&a[f]===b[f];f++);return f!==g&&(c=a[f],e=b[f]),e>c?-1:c>e?1:0},d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(a,b){if(!J(a))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===a.length)return new d(0);if(1===a.length)return a[0];var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.byteLength=function(a,b){var c;switch(a+="",b||"utf8"){case"ascii":case"binary":case"raw":c=a.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;case"hex":c=a.length>>>1;break;case"utf8":case"utf-8":c=B(a).length;break;case"base64":c=E(a).length;break;default:c=a.length}return c},d.prototype.length=void 0,d.prototype.parent=void 0,d.prototype.toString=function(a,b,c){var d=!1;if(b>>>=0,c=void 0===c||1/0===c?this.length:c>>>0,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return o(this,b,c);case"utf8":case"utf-8":return l(this,b,c);case"ascii":return m(this,b,c);case"binary":return n(this,b,c);case"base64":return k(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}},d.prototype.equals=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return 0===d.compare(this,a)},d.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},d.prototype.compare=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return d.compare(this,a)},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var k=d;d=b,b=c,c=k}b=Number(b)||0;var l=this.length-b;c?(c=Number(c),c>l&&(c=l)):c=l,d=String(d||"utf8").toLowerCase();var m;switch(d){case"hex":m=e(this,a,b,c);break;case"utf8":case"utf-8":m=f(this,a,b,c);break;case"ascii":m=g(this,a,b,c);break;case"binary":m=h(this,a,b,c);break;case"base64":m=i(this,a,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":m=j(this,a,b,c);break;default:throw new TypeError("Unknown encoding: "+d)}return m},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(a,b){var c=this.length;if(a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a),d.TYPED_ARRAY_SUPPORT)return d._augment(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.readUInt8=function(a,b){return b||q(a,1,this.length),this[a]},d.prototype.readUInt16LE=function(a,b){return b||q(a,2,this.length),this[a]|this[a+1]<<8},d.prototype.readUInt16BE=function(a,b){return b||q(a,2,this.length),this[a]<<8|this[a+1]},d.prototype.readUInt32LE=function(a,b){return b||q(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},d.prototype.readUInt32BE=function(a,b){return b||q(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},d.prototype.readInt8=function(a,b){return b||q(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},d.prototype.readInt16LE=function(a,b){b||q(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},d.prototype.readInt16BE=function(a,b){b||q(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},d.prototype.readInt32LE=function(a,b){return b||q(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},d.prototype.readInt32BE=function(a,b){return b||q(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},d.prototype.readFloatLE=function(a,b){return b||q(a,4,this.length),I.read(this,a,!0,23,4)},d.prototype.readFloatBE=function(a,b){return b||q(a,4,this.length),I.read(this,a,!1,23,4)},d.prototype.readDoubleLE=function(a,b){return b||q(a,8,this.length),I.read(this,a,!0,52,8)},d.prototype.readDoubleBE=function(a,b){return b||q(a,8,this.length),I.read(this,a,!1,52,8)},d.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,1,255,0),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},d.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):s(this,a,b,!0),b+2},d.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):s(this,a,b,!1),b+2},d.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):t(this,a,b,!0),b+4},d.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):t(this,a,b,!1),b+4},d.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,1,127,-128),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},d.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):s(this,a,b,!0),b+2},d.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):s(this,a,b,!1),b+2},d.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):t(this,a,b,!0),b+4},d.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||r(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):t(this,a,b,!1),b+4},d.prototype.writeFloatLE=function(a,b,c){return v(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){return v(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){return w(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){return w(this,a,b,!1,c)},d.prototype.copy=function(a,b,c,e){var f=this;if(c||(c=0),e||0===e||(e=this.length),b||(b=0),e!==c&&0!==a.length&&0!==f.length){if(c>e)throw new TypeError("sourceEnd < sourceStart");if(0>b||b>=a.length)throw new TypeError("targetStart out of bounds");if(0>c||c>=f.length)throw new TypeError("sourceStart out of bounds");if(0>e||e>f.length)throw new TypeError("sourceEnd out of bounds");e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);var g=e-c;if(1e3>g||!d.TYPED_ARRAY_SUPPORT)for(var h=0;g>h;h++)a[h+b]=this[h+c];else a._set(this.subarray(c,c+g),b)}},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new TypeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new TypeError("start out of bounds");if(0>c||c>this.length)throw new TypeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=B(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d.TYPED_ARRAY_SUPPORT)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var L=d.prototype;d._augment=function(a){return a.constructor=d,a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=L.get,a.set=L.set,a.write=L.write,a.toString=L.toString,a.toLocaleString=L.toString,a.toJSON=L.toJSON,a.equals=L.equals,a.compare=L.compare,a.copy=L.copy,a.slice=L.slice,a.readUInt8=L.readUInt8,a.readUInt16LE=L.readUInt16LE,a.readUInt16BE=L.readUInt16BE,a.readUInt32LE=L.readUInt32LE,a.readUInt32BE=L.readUInt32BE,a.readInt8=L.readInt8,a.readInt16LE=L.readInt16LE,a.readInt16BE=L.readInt16BE,a.readInt32LE=L.readInt32LE,a.readInt32BE=L.readInt32BE,a.readFloatLE=L.readFloatLE,a.readFloatBE=L.readFloatBE,a.readDoubleLE=L.readDoubleLE,a.readDoubleBE=L.readDoubleBE,a.writeUInt8=L.writeUInt8,a.writeUInt16LE=L.writeUInt16LE,a.writeUInt16BE=L.writeUInt16BE,a.writeUInt32LE=L.writeUInt32LE,a.writeUInt32BE=L.writeUInt32BE,a.writeInt8=L.writeInt8,a.writeInt16LE=L.writeInt16LE,a.writeInt16BE=L.writeInt16BE,a.writeInt32LE=L.writeInt32LE,a.writeInt32BE=L.writeInt32BE,a.writeFloatLE=L.writeFloatLE,a.writeFloatBE=L.writeFloatBE,a.writeDoubleLE=L.writeDoubleLE,a.writeDoubleBE=L.writeDoubleBE,a.fill=L.fill,a.inspect=L.inspect,a.toArrayBuffer=L.toArrayBuffer,a};var M=/[^+\/0-9A-z]/g},{"base64-js":12,ieee754:13,"is-array":14}],12:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],13:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;
for(b=Math.abs(b),isNaN(b)||1/0===b?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],14:[function(a,b){var c=Array.isArray,d=Object.prototype.toString;b.exports=c||function(a){return!!a&&"[object Array]"==d.call(a)}},{}],15:[function(a,b){(function(c){function d(a){return function(){var b=[],d={update:function(a,d){return c.isBuffer(a)||(a=new c(a,d)),b.push(a),this},digest:function(d){var e=c.concat(b),f=a(e);return b=null,d?f.toString(d):f}};return d}}var e=a("sha.js"),f=d(a("./md5")),g=d(a("ripemd160"));b.exports=function(a){return"md5"===a?new f:"rmd160"===a?new g:e(a)}}).call(this,a("buffer").Buffer)},{"./md5":19,buffer:11,ripemd160:20,"sha.js":22}],16:[function(a,b){(function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);this._opad=i,this._alg=a,b=this._key=c.isBuffer(b)?b:new c(b),b.length>f?b=e(a).update(b).digest():b.length<f&&(b=c.concat([b,g],f));for(var h=this._ipad=new c(f),i=this._opad=new c(f),j=0;f>j;j++)h[j]=54^b[j],i[j]=92^b[j];this._hash=e(a).update(h)}var e=a("./create-hash"),f=64,g=new c(f);g.fill(0),b.exports=d,d.prototype.update=function(a,b){return this._hash.update(a,b),this},d.prototype.digest=function(a){var b=this._hash.digest();return e(this._alg).update(this._opad).update(b).digest(a)}}).call(this,a("buffer").Buffer)},{"./create-hash":15,buffer:11}],17:[function(a,b){(function(a){function c(b,c){if(b.length%f!==0){var d=b.length+(f-b.length%f);b=a.concat([b,g],d)}for(var e=[],h=c?b.readInt32BE:b.readInt32LE,i=0;i<b.length;i+=f)e.push(h.call(b,i));return e}function d(b,c,d){for(var e=new a(c),f=d?e.writeInt32BE:e.writeInt32LE,g=0;g<b.length;g++)f.call(e,b[g],4*g,!0);return e}function e(b,e,f,g){a.isBuffer(b)||(b=new a(b));var i=e(c(b,g),b.length*h);return d(i,f,g)}var f=4,g=new a(f);g.fill(0);var h=8;b.exports={hash:e}}).call(this,a("buffer").Buffer)},{buffer:11}],18:[function(a,b,c){(function(b){function d(){var a=[].slice.call(arguments).join(" ");throw new Error([a,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function e(a,b){for(var c in a)b(a[c],c)}var f=a("./rng");c.createHash=a("./create-hash"),c.createHmac=a("./create-hmac"),c.randomBytes=function(a,c){if(!c||!c.call)return new b(f(a));try{c.call(this,void 0,new b(f(a)))}catch(d){c(d)}},c.getHashes=function(){return["sha1","sha256","md5","rmd160"]};var g=a("./pbkdf2")(c.createHmac);c.pbkdf2=g.pbkdf2,c.pbkdf2Sync=g.pbkdf2Sync,e(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman"],function(a){c[a]=function(){d("sorry,",a,"is not implemented yet")}})}).call(this,a("buffer").Buffer)},{"./create-hash":15,"./create-hmac":16,"./pbkdf2":26,"./rng":27,buffer:11}],19:[function(a,b){function c(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,j=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=j,p=k;c=e(c,d,j,k,a[l+0],7,-680876936),k=e(k,c,d,j,a[l+1],12,-389564586),j=e(j,k,c,d,a[l+2],17,606105819),d=e(d,j,k,c,a[l+3],22,-1044525330),c=e(c,d,j,k,a[l+4],7,-176418897),k=e(k,c,d,j,a[l+5],12,1200080426),j=e(j,k,c,d,a[l+6],17,-1473231341),d=e(d,j,k,c,a[l+7],22,-45705983),c=e(c,d,j,k,a[l+8],7,1770035416),k=e(k,c,d,j,a[l+9],12,-1958414417),j=e(j,k,c,d,a[l+10],17,-42063),d=e(d,j,k,c,a[l+11],22,-1990404162),c=e(c,d,j,k,a[l+12],7,1804603682),k=e(k,c,d,j,a[l+13],12,-40341101),j=e(j,k,c,d,a[l+14],17,-1502002290),d=e(d,j,k,c,a[l+15],22,1236535329),c=f(c,d,j,k,a[l+1],5,-165796510),k=f(k,c,d,j,a[l+6],9,-1069501632),j=f(j,k,c,d,a[l+11],14,643717713),d=f(d,j,k,c,a[l+0],20,-373897302),c=f(c,d,j,k,a[l+5],5,-701558691),k=f(k,c,d,j,a[l+10],9,38016083),j=f(j,k,c,d,a[l+15],14,-660478335),d=f(d,j,k,c,a[l+4],20,-405537848),c=f(c,d,j,k,a[l+9],5,568446438),k=f(k,c,d,j,a[l+14],9,-1019803690),j=f(j,k,c,d,a[l+3],14,-187363961),d=f(d,j,k,c,a[l+8],20,1163531501),c=f(c,d,j,k,a[l+13],5,-1444681467),k=f(k,c,d,j,a[l+2],9,-51403784),j=f(j,k,c,d,a[l+7],14,1735328473),d=f(d,j,k,c,a[l+12],20,-1926607734),c=g(c,d,j,k,a[l+5],4,-378558),k=g(k,c,d,j,a[l+8],11,-2022574463),j=g(j,k,c,d,a[l+11],16,1839030562),d=g(d,j,k,c,a[l+14],23,-35309556),c=g(c,d,j,k,a[l+1],4,-1530992060),k=g(k,c,d,j,a[l+4],11,1272893353),j=g(j,k,c,d,a[l+7],16,-155497632),d=g(d,j,k,c,a[l+10],23,-1094730640),c=g(c,d,j,k,a[l+13],4,681279174),k=g(k,c,d,j,a[l+0],11,-358537222),j=g(j,k,c,d,a[l+3],16,-722521979),d=g(d,j,k,c,a[l+6],23,76029189),c=g(c,d,j,k,a[l+9],4,-640364487),k=g(k,c,d,j,a[l+12],11,-421815835),j=g(j,k,c,d,a[l+15],16,530742520),d=g(d,j,k,c,a[l+2],23,-995338651),c=h(c,d,j,k,a[l+0],6,-198630844),k=h(k,c,d,j,a[l+7],10,1126891415),j=h(j,k,c,d,a[l+14],15,-1416354905),d=h(d,j,k,c,a[l+5],21,-57434055),c=h(c,d,j,k,a[l+12],6,1700485571),k=h(k,c,d,j,a[l+3],10,-1894986606),j=h(j,k,c,d,a[l+10],15,-1051523),d=h(d,j,k,c,a[l+1],21,-2054922799),c=h(c,d,j,k,a[l+8],6,1873313359),k=h(k,c,d,j,a[l+15],10,-30611744),j=h(j,k,c,d,a[l+6],15,-1560198380),d=h(d,j,k,c,a[l+13],21,1309151649),c=h(c,d,j,k,a[l+4],6,-145523070),k=h(k,c,d,j,a[l+11],10,-1120210379),j=h(j,k,c,d,a[l+2],15,718787259),d=h(d,j,k,c,a[l+9],21,-343485551),c=i(c,m),d=i(d,n),j=i(j,o),k=i(k,p)}return Array(c,d,j,k)}function d(a,b,c,d,e,f){return i(j(i(i(b,a),i(d,f)),e),c)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function j(a,b){return a<<b|a>>>32-b}var k=a("./helpers");b.exports=function(a){return k.hash(a,c,16)}},{"./helpers":17}],20:[function(a,b){(function(a){function c(a,b,c){return a^b^c}function d(a,b,c){return a&b|~a&c}function e(a,b,c){return(a|~b)^c}function f(a,b,c){return a&c|b&~c}function g(a,b,c){return a^(b|~c)}function h(a,b){return a<<b|a>>>32-b}function i(b){var c=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof b&&(b=new a(b,"utf8"));var d=p(b),e=8*b.length,f=8*b.length;d[e>>>5]|=128<<24-e%32,d[(e+64>>>9<<4)+14]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8);for(var g=0;g<d.length;g+=16)r(c,d,g);for(var g=0;5>g;g++){var h=c[g];c[g]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}var i=q(c);return new a(i)}b.exports=i;var j=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],k=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],l=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],n=[0,1518500249,1859775393,2400959708,2840853838],o=[1352829926,1548603684,1836072691,2053994217,0],p=function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-d%32;return b},q=function(a){for(var b=[],c=0;c<32*a.length;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},r=function(a,b,i){for(var p=0;16>p;p++){var q=i+p,r=b[q];b[q]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s,t,u,v,w,x,y,z,A,B;x=s=a[0],y=t=a[1],z=u=a[2],A=v=a[3],B=w=a[4];for(var C,p=0;80>p;p+=1)C=s+b[i+j[p]]|0,C+=16>p?c(t,u,v)+n[0]:32>p?d(t,u,v)+n[1]:48>p?e(t,u,v)+n[2]:64>p?f(t,u,v)+n[3]:g(t,u,v)+n[4],C=0|C,C=h(C,l[p]),C=C+w|0,s=w,w=v,v=h(u,10),u=t,t=C,C=x+b[i+k[p]]|0,C+=16>p?g(y,z,A)+o[0]:32>p?f(y,z,A)+o[1]:48>p?e(y,z,A)+o[2]:64>p?d(y,z,A)+o[3]:c(y,z,A)+o[4],C=0|C,C=h(C,m[p]),C=C+B|0,x=B,B=A,A=h(z,10),z=y,y=C;C=a[1]+u+A|0,a[1]=a[2]+v+B|0,a[2]=a[3]+w+x|0,a[3]=a[4]+s+y|0,a[4]=a[0]+t+z|0,a[0]=C}}).call(this,a("buffer").Buffer)},{buffer:11}],21:[function(a,b){var c=a("./util"),d=c.write,e=c.zeroFill;b.exports=function(a){function b(b,c){this._block=new a(b),this._finalSize=c,this._blockSize=b,this._len=0,this._s=0}function f(a,b){return null==b?a.byteLength||a.length:"ascii"==b||"binary"==b?a.length:"hex"==b?a.length/2:"base64"==b?a.length/3:void 0}return b.prototype.init=function(){this._s=0,this._len=0},b.prototype.update=function(b,c){var e,g=this._blockSize;c||"string"!=typeof b||(c="utf8"),c?("utf-8"===c&&(c="utf8"),("base64"===c||"utf8"===c)&&(b=new a(b,c),c=null),e=f(b,c)):e=b.byteLength||b.length;for(var h=this._len+=e,i=this._s=this._s||0,j=0,k=this._block;h>i;){var l=Math.min(e,j+g);d(k,b,c,i%g,j,l);var m=l-j;i+=m,j+=m,i%g||this._update(k)}return this._s=i,this},b.prototype.digest=function(a){var b=this._blockSize,d=this._finalSize,f=8*this._len,g=this._block,h=f%(8*b);g[this._len%b]=128,e(this._block,this._len%b+1),h>=8*d&&(this._update(this._block),c.zeroFill(this._block,0)),g.writeInt32BE(f,d+4);var i=this._update(this._block)||this._hash();return null==a?i:i.toString(a)},b.prototype._update=function(){throw new Error("_update must be implemented by subclass")},b}},{"./util":25}],22:[function(a,b,c){var c=b.exports=function(a){var b=c[a];if(!b)throw new Error(a+" is not supported (we accept pull requests)");return new b},d=a("buffer").Buffer,e=a("./hash")(d);c.sha=c.sha1=a("./sha1")(d,e),c.sha256=a("./sha256")(d,e)},{"./hash":21,"./sha1":23,"./sha256":24,buffer:11}],23:[function(a,b){b.exports=function(b,c){function d(){return p.length?p.pop().init():this instanceof d?(this._w=o,c.call(this,64,56),this._h=null,void this.init()):new d}function e(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function f(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function g(a,b){return a+b|0}function h(a,b){return a<<b|a>>>32-b}var i=a("util").inherits;i(d,c);var j=0,k=4,l=8,m=12,n=16,o=new Int32Array(80),p=[];d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,c.prototype.init.call(this),this},d.prototype._POOL=p;new b(1)instanceof DataView;return d.prototype._update=function(){{var a,b,c,d,i,j,k,l,m,n,o=this._block;this._h}a=j=this._a,b=k=this._b,c=l=this._c,d=m=this._d,i=n=this._e;for(var p=this._w,q=0;80>q;q++){var r=p[q]=16>q?o.readInt32BE(4*q):h(p[q-3]^p[q-8]^p[q-14]^p[q-16],1),s=g(g(h(a,5),e(q,b,c,d)),g(g(i,r),f(q)));i=d,d=c,c=h(b,30),b=a,a=s}this._a=g(a,j),this._b=g(b,k),this._c=g(c,l),this._d=g(d,m),this._e=g(i,n)},d.prototype._hash=function(){p.length<100&&p.push(this);var a=new b(20);return a.writeInt32BE(0|this._a,j),a.writeInt32BE(0|this._b,k),a.writeInt32BE(0|this._c,l),a.writeInt32BE(0|this._d,m),a.writeInt32BE(0|this._e,n),a},d}},{util:33}],24:[function(a,b){{var c=a("util").inherits;a("./util")}b.exports=function(a,b){function d(){o.length,this.init(),this._w=n,b.call(this,64,56)}function e(a,b){return a>>>b|a<<32-b}function f(a,b){return a>>>b}function g(a,b,c){return a&b^~a&c}function h(a,b,c){return a&b^a&c^b&c}function i(a){return e(a,2)^e(a,13)^e(a,22)}function j(a){return e(a,6)^e(a,11)^e(a,25)}function k(a){return e(a,7)^e(a,18)^f(a,3)}function l(a){return e(a,17)^e(a,19)^f(a,10)}var m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];c(d,b);var n=new Array(64),o=[];d.prototype.init=function(){return this._a=1779033703,this._b=-1150833019,this._c=1013904242,this._d=-1521486534,this._e=1359893119,this._f=-1694144372,this._g=528734635,this._h=1541459225,this._len=this._s=0,this};return d.prototype._update=function(){var a,b,c,d,e,f,n,o,p,q,r=this._block,s=this._w;a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,f=0|this._f,n=0|this._g,o=0|this._h;for(var t=0;64>t;t++){var u=s[t]=16>t?r.readInt32BE(4*t):l(s[t-2])+s[t-7]+k(s[t-15])+s[t-16];p=o+j(e)+g(e,f,n)+m[t]+u,q=i(a)+h(a,b,c),o=n,n=f,f=e,e=d+p,d=c,c=b,b=a,a=p+q}this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0,this._f=f+this._f|0,this._g=n+this._g|0,this._h=o+this._h|0},d.prototype._hash=function(){o.length<10&&o.push(this);var b=new a(32);return b.writeInt32BE(this._a,0),b.writeInt32BE(this._b,4),b.writeInt32BE(this._c,8),b.writeInt32BE(this._d,12),b.writeInt32BE(this._e,16),b.writeInt32BE(this._f,20),b.writeInt32BE(this._g,24),b.writeInt32BE(this._h,28),b},d}},{"./util":25,util:33}],25:[function(a,b,c){function d(a,b,c,d,e,f){var g=f-e;if("ascii"===c||"binary"===c)for(var h=0;g>h;h++)a[d+h]=b.charCodeAt(h+e);else if(null==c)for(var h=0;g>h;h++)a[d+h]=b[h+e];else{if("hex"!==c)throw new Error("base64"===c?"base64 encoding not yet supported":c+" encoding not yet supported");for(var h=0;g>h;h++){var i=e+h;a[d+h]=parseInt(b[2*i]+b[2*i+1],16)}}}function e(a,b){for(var c=b;c<a.length;c++)a[c]=0}c.write=d,c.zeroFill=e,c.toString=toString},{}],26:[function(a,b){(function(a){var c=64,d=new a(c);d.fill(0),b.exports=function(b,e){return e=e||{},e.pbkdf2=function(a,b,c,d,f){if("function"!=typeof f)throw new Error("No callback provided to pbkdf2");setTimeout(function(){f(null,e.pbkdf2Sync(a,b,c,d))})},e.pbkdf2Sync=function(e,f,g,h){if("number"!=typeof g)throw new TypeError("Iterations not a number");if(0>g)throw new TypeError("Bad iterations");if("number"!=typeof h)throw new TypeError("Key length not a number");if(0>h)throw new TypeError("Bad key length");var e=a.isBuffer(e)?e:new a(e);e.length>c?e=createHash(alg).update(e).digest():e.length<c&&(e=a.concat([e,d],c));var i,j,k,l=0,m=1,n=new a(4),o=new a(h);for(o.fill(0);h;){j=h>20?20:h,n[0]=m>>24&255,n[1]=m>>16&255,n[2]=m>>8&255,n[3]=255&m,i=b("sha1",e),i.update(f),i.update(n),k=i.digest(),k.copy(o,l,0,j);for(var p=1;g>p;p++){i=b("sha1",e),i.update(k),k=i.digest();for(var q=0;j>q;q++)o[q]^=k[q]}h-=j,m++,l+=j}return o},e}}).call(this,a("buffer").Buffer)},{buffer:11}],27:[function(a,b){(function(a){!function(){var c,d,e=this;c=function(b){for(var c,c,d=new a(b),e=0;b>e;e++)0==(3&e)&&(c=4294967296*Math.random()),d[e]=c>>>((3&e)<<3)&255;return d},e.crypto&&crypto.getRandomValues&&(d=function(b){var c=new a(b);return crypto.getRandomValues(c),c}),b.exports=d||c}()}).call(this,a("buffer").Buffer)},{buffer:11}],28:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],29:[function(a,b,c){c.endianness=function(){return"LE"},c.hostname=function(){return"undefined"!=typeof location?location.hostname:""},c.loadavg=function(){return[]},c.uptime=function(){return 0},c.freemem=function(){return Number.MAX_VALUE},c.totalmem=function(){return Number.MAX_VALUE},c.cpus=function(){return[]},c.type=function(){return"Browser"},c.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},c.networkInterfaces=c.getNetworkInterfaces=function(){return{}},c.arch=function(){return"javascript"},c.platform=function(){return"browser"},c.tmpdir=c.tmpDir=function(){return"/tmp"},c.EOL="\n"},{}],30:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("JkpR2F"))},{JkpR2F:31}],31:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],32:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],33:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("JkpR2F"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":32,JkpR2F:31,inherits:28}],34:[function(a,b){function c(a,b){if(!a)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function d(a,b){var c=b.getMetaInfo().getFreshnessPeriod();return this.name=b.name,this.freshnessPeriod=c,this.uri=b.name.toUri(),this.publisherPublicKeyDigest=b.signedInfo.publisher.publisherPublicKeyDigest,f.set(b.name.toUri(),{entry:this,element:a}),this}var e={};e.debug=a("debug")("ContentStore");var f,g=a("lru-cache"),h=a("debug")("lru");d.type="csEntry",d.prototype.getElement=function(a){return(a=a||function(a){return a})(f.get(this.uri).element)},d.prototype.stale=function(a){return delete a.csEntry,f.has(this.uri)&&f.del(this.uri),this};var i=function(a,b,c){return b=b||d,"csEntry"===b.type&&(f=g({max:c||1e7,length:function(a){return a.element.length},dispose:function(a,b){h("evicting"),delete b.entry.nameTreeNode.csEntry}})),this.nameTree=a,this.EntryClass=b,this};i.prototype.check=function(a,b,d,e,f,g){function h(a){var b=!!f.length&&!!a.parent&&a.parent.children.length>f[f.length-1]+1;return b}function i(c){return e++,f.push(0),n?l.check(a,b,c.children[c.children.length-1],e,f,g++):l.check(a,b,c.children[0],e,f,g++)}function j(c){return f[f.length-1]++,n?l.check(a,b,c.parent.children[c.parent.children.length+~f[f.length-1]],e,f,g++):l.check(a,b,c.parent.children[f[f.length-1]],e,f,g++)}function k(a,c){if(e--,f.pop(),c++>1e4)return b(null);var d=a.parent&&a.parent.parent&&a.parent.parent.children.length>f[f.length-1]+1;return d?j(a.parent):f.length>0?k(a.parent,c++):b(null)}if(b=b||function(a){return a},d=d||this.nameTree.lookup(a.name),g=g||1,g++,g++>2*Object.keys(this.nameTree).length)return b(null);var l=this;if(d[this.EntryClass.type]&&a.matchesName(d[this.EntryClass.type].name)&&c(a.publisherPublicKeyDigest,d[this.EntryClass.type].publisherPublicKeyDigest))return d[this.EntryClass.type].getElement(b);e=e||0,f=f||[];var m=a.getMaxSuffixComponents(),n=(a.getMinSuffixComponents(),a.getChildSelector()),o=m&&e===m,p=d.children.length>0;return 1===f.length&&a.exclude.matches(d.prefix.get(-1))?h(d)?j(d):b(null):!d.prefix.size()||!o&&p?i(d):h(d)?j(d):f.length>1?k(d):b(null)},i.prototype.insert=function(a,b){var c=this.EntryClass,d=b.getMetaInfo().getFreshnessPeriod(),e=this.nameTree.lookup(b.name),f=new c(a,b);return e[c.type]=f,e[c.type].nameTreeNode=e,setTimeout(function(){e[c.type]&&e[c.type].stale(e)},d||20),this},b.exports=i},{debug:7,"lru-cache":45}],35:[function(a,b){function c(a,b){return this.prefix="string"==typeof a?new e.Name(a):a,this.nextHops=function(){function a(){if(b&&b.length>0){var d;d="undefined"!=typeof b[0].faceID?b.shift():{faceID:b.shift()};var e=f(c,d,"faceID");return 0>e&&c.splice(~e,0,d),a()}return c}var c=[];return a()}(),this}function d(a){return this.nameTree=a,this}var e,f=a("./../Utility/binarySearch.js"),g={};g.debug=a("debug")("FIB"),c.type="FibEntry",c.prototype.getNextHops=function(a){var b;if(void 0!==a){var c={faceID:a},d=f(this.nextHops,c,"faceID");b=d>=0?this.nextHops.slice(0,d).concat(this.nextHops.slice(d+1)):this.nextHops}else b=this.nextHops;return b},c.prototype.removeNextHop=function(a){var b=f(this.nextHops,a,"faceID");return 0>b?this:(this.nextHops.splice(b,1),this)},c.prototype.addNextHop=function(a){var b=f(this.nextHops,a,"faceID");return 0>b?(this.nextHops.splice(~b,0,a),this):(this.nextHops.splice(b,1,a),this)},d.installNDN=function(a){return e=a,this},d.prototype.lookup=function(a){a="string"==typeof a?new e.Name(a):a;var b=this.nameTree.lookup(a),d=b.fibEntry;return d?d:b.fibEntry=new c({prefix:a,nextHops:[]})},d.prototype.findAllFibEntries=function(a){var b=this.nameTree.findAllMatches(a,function(a){return a.fibEntry&&a.fibEntry.nextHops.length>0?!0:!1}),c={hasNext:b.hasNext,next:function(){if(b.hasNext){var a=b.next();return this.hasNext=b.hasNext?!0:!1,a.fibEntry}return null}};return c},d.prototype.findAllNextHops=function(a,b){a="string"==typeof a?new e.Name(a):a;for(var c=0,d=this.findAllFibEntries(a);d.hasNext;)for(var f=d.next(),g=f.getNextHops(b),h=0;h<g.length;h++)c|=1<<g[h].faceID;return c},d.prototype.addEntry=function(a,b){var d;d="number"==typeof b||"object"==typeof b&&b.faceID?new c(a,[b]):new c(a,b);var e=this.nameTree.lookup(d.prefix);if(e.fibEntry){for(var g=0;g<d.nextHops.length;g++){var h=f(e.fibEntry.nextHops,d.nextHops[g],"faceID");0>h&&e.fibEntry.nextHops.splice(~h,0,d.nextHops[g])}return this}return e.fibEntry=d,this},d.Entry=c,b.exports=d},{"./../Utility/binarySearch.js":43,debug:7}],36:[function(a,b){var c,d,e={},c=a("ndn-js"),f=a("ndn-lib/js/encoding/tlv/tlv-decoder.js").TlvDecoder,g=a("ndn-js/js/encoding/tlv/tlv.js").Tlv;e.debug=a("debug")("Interfaces");var h=function(a){return this.subject=a,this.transports={},d=c.Face,this.Faces=[],this};h.installNDN=function(a){return c=a,this},h.prototype.transports={},h.prototype.installTransport=function(a){return this.transports[a.prototype.name]=a,a.Listener&&a.Listener(this),this},h.prototype.newFace=function(a,b,d,e){var h=this;if(this.transports[a]){var i=new this.transports[a](b),j=new c.Face(i,i.connectionInfo);this.Faces.push(j),j.faceID=this.Faces.length-1;var k;return k="WebSocketTransport"===a?new this.transports[a].ConnectionInfo(b.host,b.port):j.connectionInfo||i.connectionInfo||new this.transports[a].ConnectionInfo(i.socket),e&&(j.onclose=e),j.transport.connect(k,j,function(){j.onReceivedElement=function(a){var b=new f(a);b.peekType(g.Interest,a.length)?h.subject.handleInterest(a,this.faceID):b.peekType(g.Data,a.length)&&h.subject.handleData(a,this.faceID)},j.send=function(a){this.transport.send(a)},d&&d(j.faceID)},function(){e&&e(j.faceID)}),j.faceID}return-1},h.prototype.closeFace=function(){},h.prototype.dispatch=function(a,b,c){if(b)for(var d=0;d<b.toString(2).length;d++)b&1<<d&&(this.Faces[d]&&this.Faces[d].transport.send(a),c&&c(d));return this},b.exports=h},{debug:7,"ndn-js":55,"ndn-js/js/encoding/tlv/tlv.js":75,"ndn-lib/js/encoding/tlv/tlv-decoder.js":219}],37:[function(a,b){var c,d=a("./NameTreeNode.js"),e=(a("./../Utility/binarySearch.js"),function(){return this.addNode("/"),this});e.Node=d,e.installNDN=function(a){return e.Node.installNDN(a),c=a,this},e.prototype.addNode=function(a){"string"==typeof a&&(a=new c.Name(a));var b=this[a.toUri()];if(b)return b;for(b=this[a.toUri()]=new e.Node(a);a.size()>0;){var d=a.getPrefix(-1);this[d.toUri()]||(this[d.toUri()]=new e.Node(d)),this[a.toUri()].parent=this[d.toUri()],this[d.toUri()].addChild(this[a.toUri()]),a=d}return b},e.prototype.removeNode=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||a;var d=this[a.toUri()];if(d){var e=d.children.shift();return void 0!==e?this.removeNode(e.prefix,b):(delete this[d.prefix.toUri()],b.equals(a)?(d.parent.removeChild(d),this):this.removeNode(a.getPrefix(-1),b))
}return this},e.prototype.lookup=function(a){"string"==typeof a&&(a=new c.Name(a));var b=this[a.toUri()];return b?b:this.addNode(a)},e.prototype.findLongestPrefixMatch=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||function(){return!0};var d=this[a.toUri()];return d&&b(d)?d:a.size()>0?this.findLongestPrefixMatch(a.getPrefix(-1),b):null},e.prototype.findAllMatches=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||function(){return!0};var d,e=this,f=e[a.toUri()],g={next:function(){return this.hasNext?(a=f.prefix,d=f,f=d&&d.parent&&b(d.parent)?d.parent:a.size()>0?e.findLongestPrefixMatch(a.getPrefix(-1),b):null,this.hasNext=f?!0:!1,d):null}};return f&&b(f)?(g.hasNext=!0,g):a.size()>0?this.findAllMatches(a.getPrefix(-1),b):(g.hasNext=!1,g)},b.exports=e},{"./../Utility/binarySearch.js":43,"./NameTreeNode.js":38}],38:[function(a,b){var c,d=a("./../Utility/binarySearch.js"),e=function(a){return this.prefix="string"==typeof a?new c.Name(a):a||null,this.parent=null,this.children=[],this.fibEntry=null,this.pitEntries=[],this.measurements=null,this.strategy=null,this};e.installNDN=function(a){return c=a,this},e.prototype.addChild=function(a){var b=this,f=d(this.children,a.prefix.get(-1),"prefix");return a=a.prefix?a:new e(new c.Name(b.prefix).append(a)),0>f&&this.children.splice(~f,0,a),this},e.prototype.removeChild=function(a){a="string"==typeof a?{prefix:new c.Name(a)}:a;var b=d(this.children,a.prefix.get(-1),"prefix");return 0>b?this:(this.children.splice(b,1),this)},b.exports=e},{"./../Utility/binarySearch.js":43}],39:[function(a,b){function c(a,b){if(!a)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function d(a,b,c){return"object"!=typeof b&&(c=b,b=new e.Interest,b.wireDecode(a)),b.nonce||b.wireDecode(a),this.nonce=b.nonce,this.uri=b.name.toUri(),this.interest=b,this.element=a,"function"==typeof c?this.callback=c:this.faceID=c,this}var e,f=a("./../Utility/binarySearch.js"),g={};g.debug=a("debug")("PIT"),d.prototype.matches=function(a){return this.interest.matchesName(a.name)&&c(this.interest.publisherPublicKeyDigest,a.signedInfo.publisher.publisherPublicKeyDigest)?!0:!1},d.prototype.consume=function(a){if(this.nameTreeNode){var b=f(this.nameTreeNode.pitEntries,this,"nonce");if(b>=0){var c=this.nameTreeNode.pitEntries.splice(~b,1)[0];c.callback&&!a&&c.callback(null,c.interest)}}return this};var h=function(a){return this.nameTree=a,this};h.installNDN=function(a){return e=a,this},h.Entry=d,h.prototype.useNameTree=function(a){return this.nameTree=a,this},h.prototype.insertPitEntry=function(a,b,c){var d=new h.Entry(a,b,c);setTimeout(function(){d.consume()},d.interest.getInterestLifetimeMilliseconds()||10);var e=this.nameTree.lookup(d.interest.name),g=f(e.pitEntries,d,"nonce");return 0>g&&(d.nameTreeNode=e,e.pitEntries.splice(~g,0,d)),this},h.prototype.checkDuplicate=function(a){var b=this.nameTree.lookup(a.name),c=f(b.pitEntries,a,"nonce");return 0>c?!1:!0},h.prototype.lookup=function(a,b,c,d){b=b||a.name,c=c||[],d=d||0;for(var e=this.nameTree.lookup(b).pitEntries,f=0;f<e.length;f++)e[f].matches(a)&&(c.push(e[f]),e[f].faceID&&(d|=1<<e[f].faceID));return b.size()>0?this.lookup(a,b.getPrefix(-1),c,d):{pitEntries:c,faces:d}},b.exports=h},{"./../Utility/binarySearch.js":43,debug:7}],40:[function(a,b){(function(c){function d(a){return f.call(this),this.connectionInfo=new d.ConnectionInfo(a),this}var e=a("ndn-lib/js/encoding/element-reader.js").ElementReader,f=a("ndn-lib/js/transport/transport.js").Transport,g={};g.debug=a("debug")("MessageChannelTransport"),d.prototype=new f,d.prototype.name="MessageChannelTransport",d.ConnectionInfo=function(a){f.ConnectionInfo.call(this),this.port=a},d.ConnectionInfo.prototype=new f.ConnectionInfo,d.ConnectionInfo.prototype.name="MessageChannelTransport.ConnectionInfo",d.ConnectionInfo.prototype.getPort=function(){return this.port},d.ConnectionInfo.prototype.equals=function(a){return null===a||void 0===a.port?!1:this.port===a.port},d.prototype.connect=function(a,b,d){this.elementReader=new e(b);var f=this;a.getPort().onmessage=function(a){if(a.data.buffer instanceof ArrayBuffer)try{f.elementReader.onReceivedData(new c(a.data))}catch(b){return}},d()},d.prototype.send=function(a){this.connectionInfo.getPort().postMessage(a)},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:11,debug:7,"ndn-lib/js/encoding/element-reader.js":218,"ndn-lib/js/transport/transport.js":223}],41:[function(a,b){(function(c){function d(a){return f.call(this),this.connectionInfo=new d.ConnectionInfo(a),this}var e=a("ndn-lib/js/encoding/element-reader.js").ElementReader,f=a("ndn-lib/js/transport/transport.js").Transport,g={};g.debug=a("debug")("DataChannelTransport"),d.prototype=new f,d.prototype.name="DataChannelTransport",d.ConnectionInfo=function(a){f.ConnectionInfo.call(this),a.binaryType="arraybuffer",this.channel=a},d.ConnectionInfo.prototype=new f.ConnectionInfo,d.ConnectionInfo.prototype.name="DataChannelTransport.ConnectionInfo",d.ConnectionInfo.prototype.getChannel=function(){return this.channel},d.ConnectionInfo.prototype.equals=function(a){return null===a||void 0===a.port?!1:this.port===a.port},d.prototype.connect=function(a,b,d,f){this.elementReader=new e(b);var g=this;a.getChannel().onmessage=function(a){if(a.data instanceof ArrayBuffer){var b=a.data,d=new c(new Uint8Array(b));try{g.elementReader.onReceivedData(d)}catch(e){return void cdebug("onmessage exception: ",e)}}},a.getChannel().onopen=function(){d()},a.getChannel().onerror=function(){},a.getChannel().onclose=function(){g.dc=null,g.face.readyStatus=3,g.face.closeByTransport(),f()},"open"===a.getChannel().readyState&&d()},d.prototype.send=function(a){"open"===this.connectionInfo.getChannel().readyState&&this.connectionInfo.getChannel().send(a.toArrayBuffer())},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:11,debug:7,"ndn-lib/js/encoding/element-reader.js":218,"ndn-lib/js/transport/transport.js":223}],42:[function(a,b,c){c.MessageChannel=a("./MessageChannel.js"),c.WebRTCDataChannel=a("./WebRTCDataChannel.js"),c.WebSocketTransport=a("ndn-js").TcpTransport,b.exports=c},{"./MessageChannel.js":40,"./WebRTCDataChannel.js":41,"ndn-js":55}],43:[function(a,b){function c(a,b,d){if(d>=0||(d=-1),d>=0||a.length==b.length){if(d++,b[d]>a[d])return 1;if(b[d]<a[d])return-1;if(a[d]==b[d])return d<a.length-1?c(a,b,d):0}else{if(b.length>a.length)return 1;if(b.length<a.length)return-1}}var d=function(a,b,d){"use strict";if(0==a.length)return-1;var e,f,g,h,i=0,j=a.length-1;for(b="prefix"==d?b.getValue().buffer:"nonce"==d?b.nonce:"faceID"==d?b.faceID:b;j>=i;)if(g=e=(i+j)/2|0,f="prefix"==d?a[e].prefix.get(-1).getValue().buffer:"nonce"==d?a[e].nonce:"faceID"==d?a[e].faceID:a[e],h="number"!=typeof b?c(b,f):function(){return b>f?-1:f>b?1:0}(),1==h)j=e-1;else{if(-1!=h)return e;i=e+1}return~(j+1)};b.exports=d},{}],44:[function(a,b,c){c.ndn=a("ndn-js"),c.NameTree=a("./dist/src/DataStructures/NameTree.js").installNDN(c.ndn),c.PIT=a("./dist/src/DataStructures/PIT.js").installNDN(c.ndn),c.FIB=a("./dist/src/DataStructures/FIB.js").installNDN(c.ndn),c.ContentStore=a("./dist/src/DataStructures/ContentStore.js"),c.Interfaces=a("./dist/src/DataStructures/Interfaces.js").installNDN(c.ndn),c.Transports=a("./dist/src/Transports/node/export.js"),b.exports=c},{"./dist/src/DataStructures/ContentStore.js":34,"./dist/src/DataStructures/FIB.js":35,"./dist/src/DataStructures/Interfaces.js":36,"./dist/src/DataStructures/NameTree.js":37,"./dist/src/DataStructures/PIT.js":39,"./dist/src/Transports/node/export.js":42,"ndn-js":55}],45:[function(a,b){!function(){function a(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function c(){return 1}function d(a){return this instanceof d?("number"==typeof a&&(a={max:a}),a||(a={}),this._max=a.max,(!this._max||"number"!=typeof this._max||this._max<=0)&&(this._max=1/0),this._lengthCalculator=a.length||c,"function"!=typeof this._lengthCalculator&&(this._lengthCalculator=c),this._allowStale=a.stale||!1,this._maxAge=a.maxAge||null,this._dispose=a.dispose,void this.reset()):new d(a)}function e(a,b,c){var d=a._cache[b];return d&&(a._maxAge&&Date.now()-d.now>a._maxAge?(i(a,d),a._allowStale||(d=void 0)):c&&f(a,d),d&&(d=d.value)),d}function f(a,b){h(a,b),b.lu=a._mru++,a._lruList[b.lu]=b}function g(a){for(;a._lru<a._mru&&a._length>a._max;)i(a,a._lruList[a._lru])}function h(a,b){for(delete a._lruList[b.lu];a._lru<a._mru&&!a._lruList[a._lru];)a._lru++}function i(a,b){b&&(a._dispose&&a._dispose(b.key,b.value),a._length-=b.length,a._itemCount--,delete a._cache[b.key],h(a,b))}function j(a,b,c,d,e){this.key=a,this.value=b,this.lu=c,this.length=d,this.now=e}"object"==typeof b&&b.exports?b.exports=d:this.LRUCache=d,Object.defineProperty(d.prototype,"max",{set:function(a){(!a||"number"!=typeof a||0>=a)&&(a=1/0),this._max=a,this._length>this._max&&g(this)},get:function(){return this._max},enumerable:!0}),Object.defineProperty(d.prototype,"lengthCalculator",{set:function(a){if("function"!=typeof a){this._lengthCalculator=c,this._length=this._itemCount;for(var b in this._cache)this._cache[b].length=1}else{this._lengthCalculator=a,this._length=0;for(var b in this._cache)this._cache[b].length=this._lengthCalculator(this._cache[b].value),this._length+=this._cache[b].length}this._length>this._max&&g(this)},get:function(){return this._lengthCalculator},enumerable:!0}),Object.defineProperty(d.prototype,"length",{get:function(){return this._length},enumerable:!0}),Object.defineProperty(d.prototype,"itemCount",{get:function(){return this._itemCount},enumerable:!0}),d.prototype.forEach=function(a,b){b=b||this;for(var c=0,d=this._mru-1;d>=0&&c<this._itemCount;d--)if(this._lruList[d]){c++;var e=this._lruList[d];this._maxAge&&Date.now()-e.now>this._maxAge&&(i(this,e),this._allowStale||(e=void 0)),e&&a.call(b,e.value,e.key,this)}},d.prototype.keys=function(){for(var a=new Array(this._itemCount),b=0,c=this._mru-1;c>=0&&b<this._itemCount;c--)if(this._lruList[c]){var d=this._lruList[c];a[b++]=d.key}return a},d.prototype.values=function(){for(var a=new Array(this._itemCount),b=0,c=this._mru-1;c>=0&&b<this._itemCount;c--)if(this._lruList[c]){var d=this._lruList[c];a[b++]=d.value}return a},d.prototype.reset=function(){if(this._dispose&&this._cache)for(var a in this._cache)this._dispose(a,this._cache[a].value);this._cache=Object.create(null),this._lruList=Object.create(null),this._mru=0,this._lru=0,this._length=0,this._itemCount=0},d.prototype.dump=function(){return this._cache},d.prototype.dumpLru=function(){return this._lruList},d.prototype.set=function(b,c){if(a(this._cache,b))return this._dispose&&this._dispose(b,this._cache[b].value),this._maxAge&&(this._cache[b].now=Date.now()),this._cache[b].value=c,this.get(b),!0;var d=this._lengthCalculator(c),e=this._maxAge?Date.now():0,f=new j(b,c,this._mru++,d,e);return f.length>this._max?(this._dispose&&this._dispose(b,c),!1):(this._length+=f.length,this._lruList[f.lu]=this._cache[b]=f,this._itemCount++,this._length>this._max&&g(this),!0)},d.prototype.has=function(b){if(!a(this._cache,b))return!1;var c=this._cache[b];return this._maxAge&&Date.now()-c.now>this._maxAge?!1:!0},d.prototype.get=function(a){return e(this,a,!0)},d.prototype.peek=function(a){return e(this,a,!1)},d.prototype.pop=function(){var a=this._lruList[this._lru];return i(this,a),a||null},d.prototype.del=function(a){i(this,this._cache[a])}}()},{}],46:[function(a,b,c){function d(a,b){return new r(a,b)}function e(a,b){if("8"!=a.substring(b+2,b+3))return 1;var c=parseInt(a.substring(b+3,b+4));return 0==c?-1:c>0&&10>c?c+1:-2}function f(a,b){var c=e(a,b);return 1>c?"":a.substring(b+2,b+2+2*c)}function g(a,b){var c=f(a,b);if(""==c)return-1;var e;return e=parseInt(c.substring(0,1))<8?d(c,16):d(c.substring(2),16),e.intValue()}function h(a,b){var c=e(a,b);return 0>c?c:b+2*(c+1)}function i(a,b){var c=h(a,b),d=g(a,b);return a.substring(c,c+2*d)}function j(a,b){var c=a.substr(b,2),d=f(a,b),e=i(a,b);return c+d+e}function k(a,b){var c=h(a,b),d=g(a,b);return c+2*d}function l(a,b){var c=new Array,d=h(a,b);c.push(d);for(var e=g(a,b),f=d,i=0;;){var j=k(a,f);if(null==j||j-d>=2*e)break;if(i>=200)break;c.push(j),f=j,i++}return c}function m(a,b,c){var d=l(a,b);return d[c]}function n(a,b,c){if(0==c.length)return b;var d=c.shift(),e=l(a,b);return n(a,e[d],c)}function o(a,b,c){var d=n(a,b,c);return j(a,d)}function p(a,b,c){var d=n(a,b,c);return i(a,d)}var q=a("jsbn"),r=q.BigInteger?q.BigInteger:q,s=function t(){return t};s.getByteLengthOfL_AtObj=e,s.getHexOfL_AtObj=f,s.getIntOfL_AtObj=g,s.getStartPosOfV_AtObj=h,s.getHexOfV_AtObj=i,s.getHexOfTLV_AtObj=j,s.getPosOfNextSibling_AtObj=k,s.getPosArrayOfChildren_AtObj=l,s.getNthChildIndex_AtObj=m,s.getDecendantIndexByNthList=n,s.getDecendantHexVByNthList=p,s.getDecendantHexTLVByNthList=o,c.ASN1HEX=s,b.exports=c},{jsbn:120}],47:[function(a,b,c){function d(a){return j.charAt(a)}function e(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=h.charAt(c>>6)+h.charAt(63&c);if(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=h.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=h.charAt(c>>2)+h.charAt((3&c)<<4)),i)for(;(3&d.length)>0;)d+=i;return d}function f(a){var b,c,e="",f=0;for(b=0;b<a.length&&a.charAt(b)!=i;++b)v=h.indexOf(a.charAt(b)),0>v||(0==f?(e+=d(v>>2),c=3&v,f=1):1==f?(e+=d(c<<2|v>>4),c=15&v,f=2):2==f?(e+=d(c),e+=d(v>>2),c=3&v,f=3):(e+=d(c<<2|v>>4),e+=d(15&v),f=0));return 1==f&&(e+=d(c<<2)),e}function g(a){var b,c=f(a),d=new Array;for(b=0;2*b<c.length;++b)d[b]=parseInt(c.substring(2*b,2*b+2),16);return d}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="=",j="0123456789abcdefghijklmnopqrstuvwxyz";c.b64tohex=f,c.b64toBA=g,c.hex2b64=e,b.exports=c},{}],48:[function(a,b,c){var d=d||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;e>f;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else if(c.length>65535)for(var f=0;e>f;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;j>l;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);c.CryptoJS=d,b.exports=c},{}],49:[function(require,module,exports){function parseBigInt(a,b){return new BigInteger(a,b)}var CryptoJS=require("./sha256.js").CryptoJS,intShim=require("jsbn"),BigInteger=intShim.BigInteger?intShim.BigInteger:intShim;"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.getDigestInfoHex=function(a,b){if("undefined"==typeof this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a},this.getPaddedDigestInfoHex=function(a,b,c){var d=this.getDigestInfoHex(a,b),e=c/4;if(d.length+22>e)throw"key is too short for SigAlg: keylen="+c+","+b;for(var f="0001",g="00"+d,h="",i=e-f.length-g.length,j=0;i>j;j+=2)h+="ff";var k=f+h+g;return k},this.sha1=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return b.digestString(a)},this.sha256=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestString(a)},this.sha512=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestString(a)},this.md5=function(a){var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return b.digestString(a)},this.ripemd160=function(a){var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return b.digestString(a)}},KJUR.crypto.MessageDigest=function(params){var md=null,algName=null,provName=null,_CryptoJSMdName={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"};this.setAlgAndProvider=function(alg,prov){if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)&&"cryptojs"==prov){try{this.md=eval(_CryptoJSMdName[alg]).create()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=CryptoJS.enc.Hex.parse(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return a.toString(CryptoJS.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(-1!=":sha256:".indexOf(alg)&&"sjcl"==prov){try{this.md=new sjcl.hash.sha256}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=sjcl.codec.hex.toBits(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},"undefined"!=typeof params&&"undefined"!=typeof params.alg&&(this.algName=params.alg,this.provName=params.prov,this.setAlgAndProvider(params.alg,params.prov))},KJUR.crypto.Signature=function(a){var b=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(a,b){for(var c="",d=b/4-a.length,e=0;d>e;e++)c+="0";return c+a},this.setAlgAndProvider=function(a,b){if(this._setAlgNames(),"cryptojs/jsrsa"!=b)throw"provider not supported: "+b;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName,prov:"cryptojs"})}catch(c){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+c}this.initSign=function(a){this.prvKey=a,this.state="SIGN"},this.initVerifyByPublicKey=function(a){this.pubKey=a,this.state="VERIFY"},this.initVerifyByCertificatePEM=function(a){var b=new X509;b.readCertPEM(a),this.pubKey=b.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(a){this.md.updateString(a)},this.updateHex=function(a){this.md.updateHex(a)},this.sign=function(){var a=KJUR.crypto.Util,b=this.prvKey.n.bitLength();this.sHashHex=this.md.digest(),this.hDigestInfo=a.getDigestInfoHex(this.sHashHex,this.mdAlgName),this.hPaddedDigestInfo=a.getPaddedDigestInfoHex(this.sHashHex,this.mdAlgName,b);var c=parseBigInt(this.hPaddedDigestInfo,16);this.hoge=c.toString(16);var d=this.prvKey.doPrivate(c);return this.hSign=this._zeroPaddingOfSignature(d.toString(16),b),this.hSign},this.signString=function(a){this.updateString(a),this.sign()},this.signHex=function(a){this.updateHex(a),this.sign()},this.verify=function(a){KJUR.crypto.Util,this.pubKey.n.bitLength();this.sHashHex=this.md.digest();var b=parseBigInt(a,16),c=this.pubKey.doPublic(b);this.hPaddedDigestInfo=c.toString(16);var d=this.hPaddedDigestInfo;d=d.replace(/^1ff+00/,"");var e=KJUR.crypto.Util.DIGESTINFOHEAD[this.mdAlgName];if(0!=d.indexOf(e))return!1;var f=d.substr(e.length);return f==this.sHashHex}}},this.initVerifyByPublicKey=function(){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},"undefined"!=typeof a&&("undefined"!=typeof a.alg&&(this.algName=a.alg,this.provName=a.prov,this.algProvName=a.alg+":"+a.prov,this.setAlgAndProvider(a.alg,a.prov),this._setAlgNames()),"undefined"!=typeof a.prvkeypem)){if("undefined"!=typeof a.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{var b=new RSAKey;b.readPrivateKeyFromPEMString(a.prvkeypem),this.initSign(b)}catch(c){throw"fatal error to load pem private key: "+c}}},exports.KJUR=KJUR,module.exports=exports},{"./sha256.js":54,jsbn:120}],50:[function(a,b,c){function d(a,b){return new m(a,b)}function e(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var c=new Array,d=a.length-1;d>=0&&b>0;){var e=a.charCodeAt(d--);128>e?c[--b]=e:e>127&&2048>e?(c[--b]=63&e|128,c[--b]=e>>6|192):(c[--b]=63&e|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;for(var f=new SecureRandom,g=new Array;b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new m(c)}function f(a,b,c){for(var d="",e=0;d.length<b;)d+=c(String.fromCharCode.apply(String,a.concat([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))),e+=1;return d}function g(a,b,c){if(a.length+2*n+2>b)throw"Message too long for RSA";var d,e="";for(d=0;d<b-a.length-2*n-2;d+=1)e+="\x00";var g=rstr_sha1("")+e+""+a,h=new Array(n);(new SecureRandom).nextBytes(h);var i=f(h,g.length,c||rstr_sha1),j=[];for(d=0;d<g.length;d+=1)j[d]=g.charCodeAt(d)^i.charCodeAt(d);var k=f(j,h.length,rstr_sha1),l=[0];for(d=0;d<h.length;d+=1)l[d+1]=h[d]^k.charCodeAt(d);return new m(l.concat(j))}function h(a,b){"string"!=typeof a?(this.n=a,this.e=b):null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=d(a,16),this.e=parseInt(b,16)):alert("Invalid RSA public key")}function i(a){return a.modPowInt(this.e,this.n)}function j(a){var b=e(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPublic(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d}function k(a,b){var c=g(a,this.n.bitLength()+7>>3,b);if(null==c)return null;var d=this.doPublic(c);if(null==d)return null;var e=d.toString(16);return 0==(1&e.length)?e:"0"+e}var l=a("jsbn"),m=l.BigInteger?l.BigInteger:l,n=20,o=function(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null};o.prototype.doPublic=i,o.prototype.setPublic=h,o.prototype.encrypt=j,o.prototype.encryptOAEP=k,c.RSAKey=o,b.exports=c},{jsbn:120}],51:[function(a,b,c){function d(a,b){return new o(a,b)}function e(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=255&c[d];128>f?e+=String.fromCharCode(f):f>191&&224>f?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2)}return e}function f(a,b,c){for(var d="",e=0;d.length<b;)d+=c(a+String.fromCharCode.apply(String,[(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])),e+=1;return d}function g(a,b,c){a=a.toByteArray();var d;for(d=0;d<a.length;d+=1)a[d]&=255;for(;a.length<b;)a.unshift(0);if(a=String.fromCharCode.apply(String,a),a.length<2*q+2)throw"Cipher too short";var d,e=a.substr(1,q),g=a.substr(q+1),h=f(g,q,c||rstr_sha1),i=[];for(d=0;d<e.length;d+=1)i[d]=e.charCodeAt(d)^h.charCodeAt(d);var j=f(String.fromCharCode.apply(String,i),a.length-q,rstr_sha1),k=[];for(d=0;d<g.length;d+=1)k[d]=g.charCodeAt(d)^j.charCodeAt(d);if(k=String.fromCharCode.apply(String,k),k.substr(0,q)!==rstr_sha1(""))throw"Hash mismatch";k=k.substr(q);var l=k.indexOf(""),m=-1!=l?k.substr(0,l).lastIndexOf("\x00"):-1;if(m+1!=l)throw"Malformed data";return k.substr(l+1)}function h(a,b,c){"string"!=typeof a?(this.n=a,this.e=b,this.d=c):null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=d(a,16),this.e=parseInt(b,16),this.d=d(c,16)):alert("Invalid RSA private key")}function i(a,b,c,e,f,g,h,i){if(null==a)throw"RSASetPrivateEx N == null";if(null==b)throw"RSASetPrivateEx E == null";if(0==a.length)throw"RSASetPrivateEx N.length == 0";if(0==b.length)throw"RSASetPrivateEx E.length == 0";null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=d(a,16),this.e=parseInt(b,16),this.d=d(c,16),this.p=d(e,16),this.q=d(f,16),this.dmp1=d(g,16),this.dmq1=d(h,16),this.coeff=d(i,16)):alert("Invalid RSA private key in RSASetPrivateEx")}function j(a,b){var c=new SecureRandom,d=a>>1;this.e=parseInt(b,16);for(var e=new o(b,16);;){for(;this.p=new o(a-d,1,c),0!=this.p.subtract(o.ONE).gcd(e).compareTo(o.ONE)||!this.p.isProbablePrime(10););for(;this.q=new o(d,1,c),0!=this.q.subtract(o.ONE).gcd(e).compareTo(o.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var f=this.p;this.p=this.q,this.q=f}var g=this.p.subtract(o.ONE),h=this.q.subtract(o.ONE),i=g.multiply(h);if(0==i.gcd(e).compareTo(o.ONE)){this.n=this.p.multiply(this.q),this.d=e.modInverse(i),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}function k(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)}function l(a){var b=d(a,16),c=this.doPrivate(b);return null==c?null:e(c,this.n.bitLength()+7>>3)}function m(a,b){var c=d(a,16),e=this.doPrivate(c);return null==e?null:g(e,this.n.bitLength()+7>>3,b)}var n=a("jsbn"),o=n.BigInteger?n.BigInteger:n,p=a("./rsa.js").RSAKey,q=20;p.prototype.doPrivate=k,p.prototype.setPrivate=h,p.prototype.setPrivateEx=i,p.prototype.generate=j,p.prototype.decrypt=l,p.prototype.decryptOAEP=m,c.RSAKey=p,b.exports=c},{"./rsa.js":50,jsbn:120}],52:[function(a,b,c){function d(a){var b=a;return b=b.replace("-----BEGIN RSA PRIVATE KEY-----",""),b=b.replace("-----END RSA PRIVATE KEY-----",""),b=b.replace(/[ \n]+/g,"")}function e(a){var b=new Array,c=i.getStartPosOfV_AtObj(a,0),d=i.getPosOfNextSibling_AtObj(a,c),e=i.getPosOfNextSibling_AtObj(a,d),f=i.getPosOfNextSibling_AtObj(a,e),g=i.getPosOfNextSibling_AtObj(a,f),h=i.getPosOfNextSibling_AtObj(a,g),j=i.getPosOfNextSibling_AtObj(a,h),k=i.getPosOfNextSibling_AtObj(a,j),l=i.getPosOfNextSibling_AtObj(a,k);return b.push(c,d,e,f,g,h,j,k,l),b}function f(a){var b=e(a),c=i.getHexOfV_AtObj(a,b[0]),d=i.getHexOfV_AtObj(a,b[1]),f=i.getHexOfV_AtObj(a,b[2]),g=i.getHexOfV_AtObj(a,b[3]),h=i.getHexOfV_AtObj(a,b[4]),j=i.getHexOfV_AtObj(a,b[5]),k=i.getHexOfV_AtObj(a,b[6]),l=i.getHexOfV_AtObj(a,b[7]),m=i.getHexOfV_AtObj(a,b[8]),n=new Array;return n.push(c,d,f,g,h,j,k,l,m),n}function g(a){var b=f(a);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}function h(a){var b=d(a),c=j(b),e=f(c);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}var i=a("./asn1hex-1.1.js").ASN1HEX,j=a("./base64.js").b64tohex,k=a("./rsa2.js").RSAKey;k.prototype.readPrivateKeyFromPEMString=h,k.prototype.readPrivateKeyFromASN1HexString=g,c.RSAKey=k,b.exports=c},{"./asn1hex-1.1.js":46,"./base64.js":47,"./rsa2.js":51}],53:[function(a,b,c){function d(a,b){return new t(a,b)}function e(a,b,c){for(var d=b/4,e=w[c],f=e(a),g="0001",h="00"+v[c]+f,i="",j=d-g.length-h.length,k=0;j>k;k+=2)i+="ff";return sPaddedMessageHex=g+i+h}function f(a,b){for(var c="",d=b/4-a.length,e=0;d>e;e++)c+="0";return c+a}function g(a,b){var c=e(a,this.n.bitLength(),b),g=d(c,16),h=this.doPrivate(g),i=h.toString(16);return f(i,this.n.bitLength())}function h(a){return g.call(this,a,"sha1")}function i(a){return g.call(this,a,"sha256")}function j(a,b,c){for(var d="",e=0;d.length<b;)d+=c(a+String.fromCharCode.apply(String,[(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])),e+=1;return d}function k(a,b,c){var d,e=_RSASIGN_HASHRAWFUNC[b],g=e(a),h=g.length,i=this.n.bitLength()-1,k=Math.ceil(i/8);if(-1===c)c=h;else if(-2===c||void 0===c)c=k-h-2;else if(-2>c)throw"invalid salt length";if(h+c+2>k)throw"data too long";var l="";c>0&&(l=new Array(c),(new SecureRandom).nextBytes(l),l=String.fromCharCode.apply(String,l));var m=e("\x00\x00\x00\x00\x00\x00\x00\x00"+g+l),n=[];for(d=0;k-c-h-2>d;d+=1)n[d]=0;var o=String.fromCharCode.apply(String,n)+""+l,p=j(m,o.length,e),q=[];for(d=0;d<o.length;d+=1)q[d]=o.charCodeAt(d)^p.charCodeAt(d);var r=65280>>8*k-i&255;for(q[0]&=~r,d=0;h>d;d++)q.push(m.charCodeAt(d));return q.push(188),f(this.doPrivate(new t(q)).toString(16),this.n.bitLength())
}function l(a,b,c){var d=new u;d.setPublic(b,c);var e=d.doPublic(a);return e}function m(a,b,c){var d=l(a,b,c),e=d.toString(16).replace(/^1f+00/,"");return e}function n(a){for(var b in v){var c=v[b],d=c.length;if(a.substring(0,d)==c){var e=[b,a.substring(d)];return e}}return[]}function o(a,b,c,d){var e=m(b,c,d),f=n(e);if(0==f.length)return!1;var g=f[0],h=f[1],i=w[g],j=i(a);return h==j}function p(a,b){var c=d(a,16),e=o(b,c,this.n.toString(16),this.e.toString(16));return e}function q(a,b){if(b=b.replace(x,""),b.length!=this.n.bitLength()/4)return 0;b=b.replace(/[ \n]+/g,"");var c=d(b,16),e=this.doPublic(c),f=e.toString(16).replace(/^1f+00/,""),g=n(f);if(0==g.length)return!1;var h=g[0],i=g[1],j=w[h],k=j(a);return i==k}function r(a,b,c,e){if(b.length!==this.n.bitLength()/4)return!1;var f,g=_RSASIGN_HASHRAWFUNC[c],h=g(a),i=h.length,k=this.n.bitLength()-1,l=Math.ceil(k/8);if(-1===e)e=i;else if(-2===e||void 0===e)e=l-i-2;else if(-2>e)throw"invalid salt length";if(i+e+2>l)throw"data too long";var m=this.doPublic(d(b,16)).toByteArray();for(f=0;f<m.length;f+=1)m[f]&=255;for(;m.length<l;)m.unshift(0);if(188!==m[l-1])throw"encoded message does not end in 0xbc";m=String.fromCharCode.apply(String,m);var n=m.substr(0,l-i-1),o=m.substr(n.length,i),p=65280>>8*l-k&255;if(0!==(n.charCodeAt(0)&p))throw"bits beyond keysize not zero";var q=j(o,n.length,g),r=[];for(f=0;f<n.length;f+=1)r[f]=n.charCodeAt(f)^q.charCodeAt(f);r[0]&=~p;var s=l-i-e-2;for(f=0;s>f;f+=1)if(0!==r[f])throw"leftmost octets not zero";if(1!==r[s])throw"0x01 marker not found";return o===g("\x00\x00\x00\x00\x00\x00\x00\x00"+h+String.fromCharCode.apply(String,r.slice(-e)))}var s=a("jsbn"),t=s.BigInteger?s.BigInteger:s,u=a("./rsapem-1.1.js").RSAKey,v=[];v.sha1="3021300906052b0e03021a05000414",v.sha256="3031300d060960864801650304020105000420",v.sha384="3041300d060960864801650304020205000430",v.sha512="3051300d060960864801650304020305000440",v.md2="3020300c06082a864886f70d020205000410",v.md5="3020300c06082a864886f70d020505000410",v.ripemd160="3021300906052b2403020105000414";var w=[];w.sha1=function(a){return KJUR.crypto.Util.sha1(a)},w.sha256=function(a){return KJUR.crypto.Util.sha256(a)},w.sha512=function(a){return KJUR.crypto.Util.sha512(a)},w.md5=function(a){return KJUR.crypto.Util.md5(a)},w.ripemd160=function(a){return KJUR.crypto.Util.ripemd160(a)};var x=new RegExp("");x.compile("[^0-9a-f]","gi"),u.prototype.signString=g,u.prototype.signStringWithSHA1=h,u.prototype.signStringWithSHA256=i,u.prototype.sign=g,u.prototype.signWithSHA1=h,u.prototype.signWithSHA256=i,u.prototype.signStringPSS=k,u.prototype.signPSS=k,u.SALT_LEN_HLEN=-1,u.SALT_LEN_MAX=-2,u.prototype.verifyString=q,u.prototype.verifyHexSignatureForMessage=p,u.prototype.verify=q,u.prototype.verifyHexSignatureForByteArrayMessage=p,u.prototype.verifyStringPSS=r,u.prototype.verifyPSS=r,u.SALT_LEN_RECOVER=-2,c.RSAKey=u,b.exports=c},{"./rsapem-1.1.js":52,jsbn:120}],54:[function(a,b,c){var d=a("./core.js").CryptoJS;!function(a){var b=d.lib,c=b.WordArray,e=b.Hasher,f=d.algo,g=[],h=[];!function(){function b(b){for(var c=a.sqrt(b),d=2;c>=d;d++)if(!(b%d))return!1;return!0}function c(a){return 4294967296*(a-(0|a))|0}for(var d=2,e=0;64>e;)b(d)&&(8>e&&(g[e]=c(a.pow(d,.5))),h[e]=c(a.pow(d,1/3)),e++),d++}();var i=[],j=f.SHA256=e.extend({_doReset:function(){this._hash=new c.init(g.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],j=c[4],k=c[5],l=c[6],m=c[7],n=0;64>n;n++){if(16>n)i[n]=0|a[b+n];else{var o=i[n-15],p=(o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3,q=i[n-2],r=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;i[n]=p+i[n-7]+r+i[n-16]}var s=j&k^~j&l,t=d&e^d&f^e&f,u=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),v=(j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25),w=m+v+s+h[n]+i[n],x=u+t;m=l,l=k,k=j,j=g+w|0,g=f,f=e,e=d,d=w+x|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+g|0,c[4]=c[4]+j|0,c[5]=c[5]+k|0,c[6]=c[6]+l|0,c[7]=c[7]+m|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});d.SHA256=e._createHelper(j),d.HmacSHA256=e._createHmacHelper(j)}(Math),c.CryptoJS=d,b.exports=c},{"./core.js":48}],55:[function(a,b,c){c.Face=a("./js/face.js").Face,c.NDN=a("./js/face.js").NDN,c.Closure=a("./js/closure.js").Closure,c.Name=a("./js/name.js").Name,c.ForwardingFlags=a("./js/forwarding-flags.js").ForwardingFlags,c.Interest=a("./js/interest.js").Interest,c.Exclude=a("./js/exclude.js").Exclude,c.Data=a("./js/data.js").Data,c.ContentObject=a("./js/data.js").ContentObject,c.ContentType=a("./js/meta-info.js").ContentType,c.MetaInfo=a("./js/meta-info.js").MetaInfo,c.SignedInfo=a("./js/meta-info.js").SignedInfo,c.Sha256WithRsaSignature=a("./js/sha256-with-rsa-signature.js").Sha256WithRsaSignature,c.Signature=a("./js/sha256-with-rsa-signature.js").Signature,c.Key=a("./js/key.js").Key,c.KeyLocator=a("./js/key-locator.js").KeyLocator,c.KeyName=a("./js/key-locator.js").KeyName,c.KeyLocatorType=a("./js/key-locator.js").KeyLocatorType,c.PublisherPublicKeyDigest=a("./js/publisher-public-key-digest.js").PublisherPublicKeyDigest,c.WireFormat=a("./js/encoding/wire-format.js").WireFormat,c.BinaryXmlWireFormat=a("./js/encoding/binary-xml-wire-format.js").BinaryXmlWireFormat,c.TlvWireFormat=a("./js/encoding/tlv-wire-format.js").TlvWireFormat,c.TcpTransport=a("./js/transport/tcp-transport.js").TcpTransport,c.UnixTransport=a("./js/transport/unix-transport.js").UnixTransport,c.DataUtils=a("./js/encoding/data-utils.js").DataUtils,c.EncodingUtils=a("./js/encoding/encoding-utils.js").EncodingUtils,c.ProtobufTlv=a("./js/encoding/protobuf-tlv.js").ProtobufTlv,c.Blob=a("./js/util/blob.js").Blob,c.NameEnumeration=a("./js/util/name-enumeration.js").NameEnumeration,c.MemoryContentCache=a("./js/util/memory-content-cache.js").MemoryContentCache,c.NDNTime=a("./js/util/ndn-time.js").NDNTime,c.globalKeyManager=a("./js/security/key-manager.js").globalKeyManager,c.SecurityException=a("./js/security/security-exception.js").SecurityException,c.KeyType=a("./js/security/security-types.js").KeyType,c.KeyClass=a("./js/security/security-types.js").KeyClass,c.DigestAlgorithm=a("./js/security/security-types.js").DigestAlgorithm,c.EncryptMode=a("./js/security/security-types.js").EncryptMode,c.IdentityStorage=a("./js/security/identity/identity-storage.js").IdentityStorage,c.MemoryIdentityStorage=a("./js/security/identity/memory-identity-storage.js").MemoryIdentityStorage,c.MemoryPrivateKeyStorage=a("./js/security/identity/memory-private-key-storage.js").MemoryPrivateKeyStorage,c.IdentityManager=a("./js/security/identity/identity-manager.js").IdentityManager,c.ValidationRequest=a("./js/security/policy/validation-request.js").ValidationRequest,c.PolicyManager=a("./js/security/policy/policy-manager.js").PolicyManager,c.NoVerifyPolicyManager=a("./js/security/policy/no-verify-policy-manager.js").NoVerifyPolicyManager,c.SelfVerifyPolicyManager=a("./js/security/policy/self-verify-policy-manager.js").SelfVerifyPolicyManager,c.KeyChain=a("./js/security/key-chain.js").KeyChain,c.ChronoSync2013=a("./js/sync/chrono-sync2013.js").ChronoSync2013},{"./js/closure.js":58,"./js/data.js":60,"./js/encoding/binary-xml-wire-format.js":64,"./js/encoding/data-utils.js":65,"./js/encoding/encoding-utils.js":68,"./js/encoding/protobuf-tlv.js":69,"./js/encoding/tlv-wire-format.js":71,"./js/encoding/wire-format.js":76,"./js/exclude.js":77,"./js/face.js":79,"./js/forwarding-flags.js":81,"./js/interest.js":82,"./js/key-locator.js":83,"./js/key.js":84,"./js/meta-info.js":86,"./js/name.js":87,"./js/publisher-public-key-digest.js":89,"./js/security/identity/identity-manager.js":92,"./js/security/identity/identity-storage.js":93,"./js/security/identity/memory-identity-storage.js":94,"./js/security/identity/memory-private-key-storage.js":95,"./js/security/key-chain.js":97,"./js/security/key-manager.js":98,"./js/security/policy/no-verify-policy-manager.js":99,"./js/security/policy/policy-manager.js":100,"./js/security/policy/self-verify-policy-manager.js":101,"./js/security/policy/validation-request.js":102,"./js/security/security-exception.js":103,"./js/security/security-types.js":104,"./js/sha256-with-rsa-signature.js":105,"./js/sync/chrono-sync2013.js":106,"./js/transport/tcp-transport.js":56,"./js/transport/unix-transport.js":110,"./js/util/blob.js":112,"./js/util/memory-content-cache.js":115,"./js/util/name-enumeration.js":116,"./js/util/ndn-time.js":118}],56:[function(a,b,c){c.TcpTransport=a("./transport/web-socket-transport").WebSocketTransport},{"./transport/web-socket-transport":111}],57:[function(a,b){(function(c){var d=a("../contrib/securityLib/asn1hex-1.1.js").ASN1HEX,e=a("../contrib/securityLib/crypto-1.0.js").KJUR,f=a("../contrib/securityLib/rsasign-1.2.js").RSAKey,g=a("../contrib/securityLib/base64.js").b64tohex,h=h||{};h.Key=a("./key.js").Key;var i=h;i.createHash=function(a){if("sha256"!=a)throw new Error("createHash: unsupported algorithm.");var b={};return b.md=new e.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}),b.update=function(a){this.md.updateHex(a.toString("hex"))},b.digest=function(){return new c(this.md.digest(),"hex")},b},i.createSign=function(a){if("RSA-SHA256"!=a)throw new Error("createSign: unsupported algorithm.");var b={};return b.arr=[],b.update=function(a){this.arr.push(a)},b.sign=function(a){var b=new f;b.readPrivateKeyFromPEMString(a);var d=new e.crypto.Signature({alg:"SHA256withRSA",prov:"cryptojs/jsrsa"});d.initSign(b);for(var g=0;g<this.arr.length;++g)d.updateHex(this.arr[g].toString("hex"));return new c(d.sign(),"hex")},b},i.createVerify=function(a){if("RSA-SHA256"!=a)throw new Error("createSign: unsupported algorithm.");var b={};b.arr=[],b.update=function(a){this.arr.push(a)};var c=function(a){var b=d.getPosArrayOfChildren_AtObj(a,0);if(2!=b.length)return-1;var c=b[1];if("03"!=a.substring(c,c+2))return-1;var e=d.getStartPosOfV_AtObj(a,c);return"00"!=a.substring(e,e+2)?-1:e+2},g=function(a){var b=a.toString("hex"),e=c(b),g=d.getPosArrayOfChildren_AtObj(b,e);if(2!=g.length)return null;var h=d.getHexOfV_AtObj(b,g[0]),i=d.getHexOfV_AtObj(b,g[1]),j=new f;return j.setPublic(h,i),j};return b.verify=function(a,b){var c=new h.Key;c.fromPemString(a);var d=g(c.publicToDER()),f=new e.crypto.Signature({alg:"SHA256withRSA",prov:"cryptojs/jsrsa"});f.initVerifyByPublicKey(d);for(var i=0;i<this.arr.length;i++)f.updateHex(this.arr[i].toString("hex"));var j=b.toString("hex");return f.verify(j)},b},i.randomBytes=function(a){for(var b=new c(a),d=0;a>d;++d)b[d]=Math.floor(256*Math.random());return b},i.toByteArray=function(a){var b=g(a),c=[];return b.replace(/(..)/g,function(a){c.push(parseInt(a,16))}),c},b.exports=i}).call(this,a("buffer").Buffer)},{"../contrib/securityLib/asn1hex-1.1.js":46,"../contrib/securityLib/base64.js":47,"../contrib/securityLib/crypto-1.0.js":49,"../contrib/securityLib/rsasign-1.2.js":53,"./key.js":84,buffer:11}],58:[function(a,b,c){var d=function(){this.ndn_data=null,this.ndn_data_dirty=!1};c.Closure=d,d.RESULT_ERR=-1,d.RESULT_OK=0,d.RESULT_REEXPRESS=1,d.RESULT_INTEREST_CONSUMED=2,d.RESULT_VERIFY=3,d.RESULT_FETCHKEY=4,d.UPCALL_FINAL=0,d.UPCALL_INTEREST=1,d.UPCALL_CONSUMED_INTEREST=2,d.UPCALL_CONTENT=3,d.UPCALL_INTEREST_TIMED_OUT=4,d.UPCALL_CONTENT_UNVERIFIED=5,d.UPCALL_CONTENT_BAD=6,d.prototype.upcall=function(){return d.RESULT_OK};var e=function(a,b,c,d){this.face=a,this.ndn=a,this.interest=b,this.matchedComps=c,this.data=d,this.contentObject=d};e.prototype.toString=function(){var a="face = "+this.face;return a+="\nInterest = "+this.interest,a+="\nmatchedComps = "+this.matchedComps,a+="\nData: "+this.data},c.UpcallInfo=e},{}],59:[function(a,b,c){var d=a("./forwarding-flags.js").ForwardingFlags,e=a("./name.js").Name,f=a("./encoding/wire-format.js").WireFormat,g=function(){this.name=new e,this.faceId=null,this.localControlFeature=null,this.origin=null,this.cost=null,this.forwardingFlags=new d,this.expirationPeriod=null};c.ControlParameters=g,g.prototype.wireEncode=function(a){return a=a||f.getDefaultWireFormat(),a.encodeControlParameters(this)},g.prototype.wireDecode=function(a,b){b=b||f.getDefaultWireFormat();var c="object"==typeof a&&a instanceof Blob?a.buf():a;b.decodeControlParameters(this,c)},g.prototype.getName=function(){return this.name},g.prototype.getFaceId=function(){return this.faceId},g.prototype.getLocalControlFeature=function(){return this.localControlFeature},g.prototype.getOrigin=function(){return this.origin},g.prototype.getCost=function(){return this.cost},g.prototype.getForwardingFlags=function(){return this.forwardingFlags},g.prototype.getExpirationPeriod=function(){return this.expirationPeriod},g.prototype.setName=function(a){this.name="object"==typeof a&&a instanceof e?new e(a):new e},g.prototype.setFaceId=function(a){this.faceId=a},g.prototype.setLocalControlFeature=function(a){this.localControlFeature=a},g.prototype.setOrigin=function(a){this.origin=a},g.prototype.setCost=function(a){this.cost=a},g.prototype.setForwardingFlags=function(a){this.forwardingFlags="object"==typeof a&&a instanceof d?new d(a):new d},g.prototype.setExpirationPeriod=function(a){this.expirationPeriod=a}},{"./encoding/wire-format.js":76,"./forwarding-flags.js":81,"./name.js":87}],60:[function(a,b,c){(function(b){var d=a("./crypto.js"),e=a("./util/blob.js").Blob,f=a("./util/signed-blob.js").SignedBlob,g=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),h=a("./encoding/data-utils.js").DataUtils,i=a("./name.js").Name,j=a("./sha256-with-rsa-signature.js").Sha256WithRsaSignature,k=a("./meta-info.js").MetaInfo,l=a("./key-locator.js").KeyLocator,m=a("./security/key-manager.js").globalKeyManager,n=a("./encoding/wire-format.js").WireFormat,o=function(a,b,c){this.name="string"==typeof a?new i(a):"object"==typeof a&&a instanceof i?new i(a):new i;var d,g;"object"==typeof b&&b instanceof k?(d=b,g=c):(d=null,g=b),this.signedInfo="object"==typeof d&&d instanceof k?new k(d):new k,this.content="string"==typeof g?h.toNumbersFromString(g):"object"==typeof g&&g instanceof e?g.buf():g,this.signature=new j,this.wireEncoding=new f};c.Data=o,o.prototype.getName=function(){return this.name},o.prototype.getMetaInfo=function(){return this.signedInfo},o.prototype.getSignature=function(){return this.signature},o.prototype.getContent=function(){return new e(this.content,!1)},o.prototype.getContentAsBuffer=function(){return this.content},o.prototype.setName=function(a){return this.name="object"==typeof a&&a instanceof i?new i(a):new i,this.wireEncoding=new f,this},o.prototype.setMetaInfo=function(a){return this.signedInfo="object"==typeof a&&a instanceof k?new k(a):new k,this.wireEncoding=new f,this},o.prototype.setSignature=function(a){return this.signature="object"==typeof a&&a instanceof j?a.clone():new j,this.wireEncoding=new f,this},o.prototype.setContent=function(a){return this.content="string"==typeof a?h.toNumbersFromString(a):"object"==typeof a&&a instanceof e?a.buf():new b(a),this.wireEncoding=new f,this},o.prototype.sign=function(a){a=a||n.getDefaultWireFormat(),(null==this.getSignatureOrMetaInfoKeyLocator()||null==this.getSignatureOrMetaInfoKeyLocator().getType())&&this.getMetaInfo().setFields(),(null==this.wireEncoding||this.wireEncoding.isNull())&&(this.getSignature().setSignature(new b(128)),this.wireEncode(a));var c=d.createSign("RSA-SHA256");c.update(this.wireEncoding.signedBuf());var e=new b(h.toNumbersIfString(c.sign(m.privateKey)));this.signature.setSignature(e)},o.verifyUsesString=null,o.prototype.verify=function(a){if(null==a||null==a.publicKeyPem)throw new Error("Cannot verify Data without a public key.");if(null==o.verifyUsesString){var b=d.createHash("sha256").digest();o.verifyUsesString="string"==typeof b}(null==this.wireEncoding||this.wireEncoding.isNull())&&this.wireEncode();var c=d.createVerify("RSA-SHA256");c.update(this.wireEncoding.signedBuf());var e=o.verifyUsesString?h.toString(this.signature.getSignature().buf()):this.signature.getSignature().buf();return c.verify(a.publicKeyPem,e)},o.prototype.getElementLabel=function(){return g.Data},o.prototype.wireEncode=function(a){a=a||n.getDefaultWireFormat();var b=a.encodeData(this);return this.wireEncoding=new f(b.encoding,b.signedPortionBeginOffset,b.signedPortionEndOffset),this.wireEncoding},o.prototype.wireDecode=function(a,b){b=b||n.getDefaultWireFormat();var c="object"==typeof a&&a instanceof e?a.buf():a,d=b.decodeData(this,c);this.wireEncoding=new f(new e(a,!0),d.signedPortionBeginOffset,d.signedPortionEndOffset)},o.prototype.getSignatureOrMetaInfoKeyLocator=function(){return null!=this.signature&&null!=this.signature.getKeyLocator()&&null!=this.signature.getKeyLocator().getType()&&this.signature.getKeyLocator().getType()>=0?this.signature.getKeyLocator():null!=this.signedInfo&&null!=this.signedInfo.locator&&null!=this.signedInfo.locator.getType()&&this.signedInfo.locator.getType()>=0?(console.log("WARNING: Temporarily using the key locator found in the MetaInfo - expected it in the Signature object."),console.log("WARNING: In the future, the key locator in the Signature object will not be supported."),this.signedInfo.locator):null!=this.signature&&null!=this.signature.getKeyLocator()?this.signature.getKeyLocator():new l};var p=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat;o.prototype.from_ndnb=function(a){p.decodeData(this,a)},o.prototype.to_ndnb=function(a){p.encodeData(this,a)},o.prototype.encode=function(a){return a=a||p.get(),a.encodeData(this).buf()},o.prototype.decode=function(a,b){b=b||p.get(),b.decodeData(this,a)};var q=function(a,b,c){o.call(this,a,b,c)};q.prototype=new o,c.ContentObject=q}).call(this,a("buffer").Buffer)},{"./crypto.js":57,"./encoding/binary-xml-encoder.js":62,"./encoding/binary-xml-wire-format.js":64,"./encoding/data-utils.js":65,"./encoding/wire-format.js":76,"./key-locator.js":83,"./meta-info.js":86,"./name.js":87,"./security/key-manager.js":98,"./sha256-with-rsa-signature.js":105,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117,"./util/signed-blob.js":119,buffer:11}],61:[function(a,b,c){(function(b){var d=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("../util/ndn-time.js").NDNTime,f=a("./data-utils.js").DataUtils,g=a("./decoding-exception.js").DecodingException,h=a("../log.js").Log.LOG,i=1,j=2,k=3,l=4,m=6,n=0,o=3,p=(1<<o)-1,q=o+1,r=(1<<q)-1,s=7,t=(1<<s)-1,u=1<<s;tagToString=function(a){return a>=0&&a<NDNProtocolDTagsStrings.length?NDNProtocolDTagsStrings[a]:a==d.NDNProtocolDataUnit?d.NDNPROTOCOL_DATA_UNIT:null},stringToTag=function(a){for(var b=0;b<NDNProtocolDTagsStrings.length;++b)if(null!=NDNProtocolDTagsStrings[b]&&NDNProtocolDTagsStrings[b]==a)return b;return d.NDNPROTOCOL_DATA_UNIT==a?d.NDNProtocolDataUnit:null};var v=function(a){this.input=a,this.offset=0,this.previouslyPeekedDTagStartOffset=-1};c.BinaryXMLDecoder=v,v.prototype.readElementStartDTag=function(a){if(this.offset==this.previouslyPeekedDTagStartOffset){if(this.previouslyPeekedDTag!=a)throw new g(new Error("Did not get the expected DTAG "+a+", got "+this.previouslyPeekedDTag));this.offset=this.previouslyPeekedDTagEndOffset}else{var b=this.decodeTypeAndVal();if(null==b||b.type()!=j)throw new g(new Error("Header type is not a DTAG"));if(b.val()!=a)throw new g(new Error("Expected start element: "+a+" got: "+b.val()))}},v.prototype.readStartElement=function(a,b){var c=this.decodeTypeAndVal();if(null==c)throw new g(new Error("Expected start element: "+a+" got something not a tag."));var d=null;if(c.type()==i){var e;e="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,d=this.decodeUString(e)}else c.type()==j&&(d=c.val());if(null==d||d!=a)throw console.log("expecting "+a+" but got "+d),new g(new Error("Expected start element: "+a+" got: "+d+"("+c.val()+")"));null!=b&&readAttributes(b)},v.prototype.readAttributes=function(a){if(null!=a)try{for(var b=this.peekTypeAndVal();null!=b&&(k==b.type()||l==b.type());){var c=this.decodeTypeAndVal(),d=null;if(k==c.type()){var e;e="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,d=this.decodeUString(e)}else if(l==c.type()&&(d=tagToString(c.val()),null==d))throw new g(new Error("Unknown DATTR value"+c.val()));var f=this.decodeUString();a.push([d,f]),b=this.peekTypeAndVal()}}catch(h){throw new g(new Error("readStartElement",h))}},v.prototype.peekStartElementAsString=function(){var a=null,b=this.offset;try{var c=this.decodeTypeAndVal();if(null!=c)if(c.type()==i){var d;d="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,a=this.decodeUString(d)}else c.type()==j&&(a=tagToString(c.val()))}catch(e){}finally{try{this.offset=b}catch(e){throw Log.logStackTrace(Log.FAC_ENCODING,Level.WARNING,e),new g(new Error("Cannot reset stream! "+e.getMessage(),e))}}return a},v.prototype.peekDTag=function(a){if(this.offset==this.previouslyPeekedDTagStartOffset)return this.previouslyPeekedDTag==a;if(this.input[this.offset]==n)return!1;var b=this.offset,c=this.decodeTypeAndVal();return this.previouslyPeekedDTagEndOffset=this.offset,this.offset=b,null!=c&&c.type()==j?(this.previouslyPeekedDTagStartOffset=b,this.previouslyPeekedDTag=c.val(),c.val()==a):!1},v.prototype.peekStartElement=function(a){if("string"==typeof a){var b=this.peekStartElementAsString();return null!=b&&b==a?!0:!1}if("number"==typeof a){var b=this.peekStartElementAsLong();return null!=b&&b==a?!0:!1}throw new g(new Error("SHOULD BE STRING OR NUMBER"))},v.prototype.peekStartElementAsLong=function(){var a=null,b=this.offset;try{var c=this.decodeTypeAndVal();if(null!=c)if(c.type()==i){if(c.val()+1>DEBUG_MAX_LEN)throw new g(new Error("Decoding error: length "+c.val()+"1 longer than expected maximum length!"));var d;d="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1;var e=this.decodeUString(d);a=stringToTag(e)}else c.type()==j&&(a=c.val())}catch(f){}finally{try{this.offset=b}catch(f){throw Log.logStackTrace(Log.FAC_ENCODING,Level.WARNING,f),new Error("Cannot reset stream! "+f.getMessage(),f)}}return a},v.prototype.readBinaryDTagElement=function(a,b){return this.readElementStartDTag(a),this.readBlob(b)},v.prototype.readBinaryElement=function(a,b,c){return this.readStartElement(a,b),this.readBlob(c)},v.prototype.readElementClose=function(){var a=this.input[this.offset++];if(a!=n)throw new g(new Error("Expected end element, got: "+a))},v.prototype.readEndElement=function(){h>4&&console.log("this.offset is "+this.offset);var a=this.input[this.offset];if(this.offset++,h>4&&console.log("XML_CLOSE IS "+n),h>4&&console.log("next is "+a),a!=n)throw console.log("Expected end element, got: "+a),new g(new Error("Expected end element, got: "+a))},v.prototype.readUString=function(){var a=this.decodeUString();return this.readElementClose(),a},v.prototype.readBlob=function(a){if(this.input[this.offset]==n&&a)return this.readElementClose(),null;var b=this.decodeBlob();return this.readElementClose(),b},v.prototype.readDateTimeDTagElement=function(a){var b=this.readBinaryDTagElement(a);b=f.toHex(b),b=parseInt(b,16);var c=b/4096*1e3,d=new e(c);if(null==d)throw new g(new Error("Cannot parse timestamp: "+f.printHexBytes(b)));return d},v.prototype.readDateTime=function(a){var b=this.readBinaryElement(a);b=f.toHex(b),b=parseInt(b,16);var c=b/4096*1e3;h>4&&console.log("DECODED DATE WITH VALUE"),h>4&&console.log(c);var d=new e(c);if(null==d)throw new g(new Error("Cannot parse timestamp: "+f.printHexBytes(b)));return d},v.prototype.decodeTypeAndVal=function(){var a=-1,b=0,c=!0;do{var d=this.input[this.offset];if(null==d)return null;if(0>d)return null;if(0==d&&0==b)return null;c=0==(d&u),c?(b<<=s,b|=d&t):(a=d&p,b<<=q,b|=d>>>o&r),this.offset++}while(c);return h>4&&console.log("TYPE is "+a+" VAL is "+b),new w(a,b)},v.prototype.peekTypeAndVal=function(){var a=null,b=this.offset;try{a=this.decodeTypeAndVal()}finally{this.offset=b}return a},v.prototype.decodeBlob=function(a){if(null==a){var c,d=this.decodeTypeAndVal();return c="string"==typeof d.val()?parseInt(d.val()):d.val(),this.decodeBlob(c)}var e=new b(this.input.slice(this.offset,this.offset+a));return this.offset+=a,e},v.prototype.decodeUString=function(a){if(null==a){var b=this.offset,c=this.decodeTypeAndVal();return h>4&&console.log("TV is "+c),h>4&&console.log(c),h>4&&console.log("Type of TV is "+typeof c),null==c||m!=c.type()?(this.offset=b,""):this.decodeUString(c.val())}var d=this.decodeBlob(a);return f.toString(d)};var w=function(a,b){this.t=a,this.v=b};w.prototype.type=function(){return this.t},w.prototype.val=function(){return this.v},v.prototype.readIntegerDTagElement=function(a){return parseInt(this.readUTF8DTagElement(a))},v.prototype.readIntegerElement=function(a){h>4&&console.log("READING INTEGER "+a),h>4&&console.log("TYPE OF "+typeof a);var b=this.readUTF8Element(a);return parseInt(b)},v.prototype.readUTF8DTagElement=function(a){return this.readElementStartDTag(a),this.readUString()},v.prototype.readUTF8Element=function(a,b){this.readStartElement(a,b);var c=this.readUString();return c},v.prototype.seek=function(a){this.offset=a}}).call(this,a("buffer").Buffer)},{"../log.js":85,"../util/ndn-protoco-id-tags.js":117,"../util/ndn-time.js":118,"./data-utils.js":65,"./decoding-exception.js":66,buffer:11}],62:[function(a,b,c){var d=a("../log.js").Log.LOG,e=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("../util/dynamic-buffer.js").DynamicBuffer,g=a("./data-utils.js").DataUtils,d=a("../log.js").Log.LOG,h=1,i=2,j=3,k=4,l=5,m=6,n=0,o=3,p=(1<<o)-1,q=o+1,r=(1<<q)-1,s=7,t=(1<<s)-1,u=1<<s,v=255,w=function(a){a||(a=16),this.ostream=new f(a),this.offset=0,this.CODEC_NAME="Binary"};c.BinaryXMLEncoder=w,w.prototype.writeUString=function(a){this.encodeUString(a,m)},w.prototype.writeBlob=function(a){d>3&&console.log(a),this.encodeBlob(a,a.length)},w.prototype.writeElementStartDTag=function(a){this.encodeTypeAndVal(i,a)},w.prototype.writeStartElement=function(a,b){var c=a;null==c?this.encodeUString(a,h):this.encodeTypeAndVal(i,c),null!=b&&this.writeAttributes(b)},w.prototype.writeElementClose=function(){this.ostream.ensureLength(this.offset+1),this.ostream.array[this.offset]=n,this.offset+=1},w.prototype.writeEndElement=function(){this.writeElementClose()},w.prototype.writeAttributes=function(a){if(null!=a)for(var b=0;b<a.length;b++){var c=a[b].k,d=a[b].v,e=stringToTag(c);null==e?this.encodeUString(c,j):this.encodeTypeAndVal(k,e),this.encodeUString(d)}},stringToTag=function(a){return a>=0&&a<NDNProtocolDTagsStrings.length?NDNProtocolDTagsStrings[a]:a==e.NDNProtocolDataUnit?e.NDNPROTOCOL_DATA_UNIT:null},tagToString=function(a){for(var b=0;b<NDNProtocolDTagsStrings.length;++b)if(null!=NDNProtocolDTagsStrings[b]&&NDNProtocolDTagsStrings[b]==a)return b;return e.NDNPROTOCOL_DATA_UNIT==a?e.NDNProtocolDataUnit:null},w.prototype.writeDTagElement=function(a,b){this.writeElementStartDTag(a),"number"==typeof b?this.writeUString(b.toString()):"string"==typeof b?this.writeUString(b):this.writeBlob(b),this.writeElementClose()},w.prototype.writeElement=function(a,b,c){this.writeStartElement(a,c),"number"==typeof b?(d>4&&console.log("GOING TO WRITE THE NUMBER .charCodeAt(0) "+b.toString().charCodeAt(0)),d>4&&console.log("GOING TO WRITE THE NUMBER "+b.toString()),d>4&&console.log("type of number is "+typeof b.toString()),this.writeUString(b.toString())):"string"==typeof b?(d>4&&console.log("GOING TO WRITE THE STRING  "+b),d>4&&console.log("type of STRING is "+typeof b),this.writeUString(b)):(d>4&&console.log("GOING TO WRITE A BLOB  "+b),this.writeBlob(b)),this.writeElementClose()};w.prototype.encodeTypeAndVal=function(a,b){if(d>4&&console.log("Encoding type "+a+" and value "+b),d>4&&console.log("OFFSET IS "+this.offset),a>m||0>a||0>b)throw new Error("Tag and value must be positive, and tag valid.");var c=this.numEncodingBytes(b);this.ostream.ensureLength(this.offset+c),this.ostream.array[this.offset+c-1]=v&(p&a|(r&b)<<o)|u,b>>>=q;for(var e=this.offset+c-2;0!=b&&e>=this.offset;)this.ostream.array[e]=v&(b&t),b>>>=s,--e;if(0!=b)throw new Error("This should not happen: miscalculated encoding");return this.offset+=c,c},w.prototype.encodeUString=function(a,b){if(null!=a&&b!=h&&(b!=j||0!=a.length)){d>3&&console.log("The string to write is "),d>3&&console.log(a);var c=g.stringToUtf8Array(a);this.encodeTypeAndVal(b,b==h||b==j?c.length-1:c.length),d>3&&console.log("THE string to write is "),d>3&&console.log(c),this.writeString(c),this.offset+=c.length}},w.prototype.encodeBlob=function(a,b){null!=a&&(d>4&&console.log("LENGTH OF XML_BLOB IS "+b),this.encodeTypeAndVal(l,b),this.writeBlobArray(a),this.offset+=b)};var x=(1<<q)-1,y=(1<<q+s)-1,z=(1<<q+2*s)-1;w.prototype.numEncodingBytes=function(a){if(x>=a)return 1;if(y>=a)return 2;if(z>=a)return 3;var b=1;for(a>>>=q;0!=a;)b++,a>>>=s;return b},w.prototype.writeDateTimeDTagElement=function(a,b){var c=Math.round(b.msec/1e3*4096).toString(16);c.length%2==1&&(c="0"+c),this.writeDTagElement(a,g.toNumbers(c))},w.prototype.writeDateTime=function(a,b){var c=Math.round(b.msec/1e3*4096).toString(16);c.length%2==1&&(c="0"+c),this.writeElement(a,g.toNumbers(c))},w.prototype.writeString=function(a){if("string"==typeof a){d>4&&console.log("GOING TO WRITE A STRING"),d>4&&console.log(a),this.ostream.ensureLength(this.offset+a.length);for(var b=0;b<a.length;b++)d>4&&console.log("input.charCodeAt(i)="+a.charCodeAt(b)),this.ostream.array[this.offset+b]=a.charCodeAt(b)}else d>4&&console.log("GOING TO WRITE A STRING IN BINARY FORM"),d>4&&console.log(a),this.writeBlobArray(a)},w.prototype.writeBlobArray=function(a){d>4&&console.log("GOING TO WRITE A BLOB"),this.ostream.copy(a,this.offset)},w.prototype.getReducedOstream=function(){return this.ostream.slice(0,this.offset)}},{"../log.js":85,"../util/dynamic-buffer.js":114,"../util/ndn-protoco-id-tags.js":117,"./data-utils.js":65}],63:[function(a,b,c){var d=a("./binary-xml-decoder.js").BinaryXMLDecoder,e=a("../util/dynamic-buffer.js").DynamicBuffer,f=0,g=1,h=2,i=3,j=4,k=5,l=6,m=0,n=7,o=1<<n,p=function(){this.gotElementEnd=!1,this.offset=0,this.level=0,this.state=p.READ_HEADER_OR_CLOSE,this.headerLength=0,this.useHeaderBuffer=!1,this.headerBuffer=new e(5),this.nBytesToRead=0};c.BinaryXMLStructureDecoder=p,p.READ_HEADER_OR_CLOSE=0,p.READ_BYTES=1,p.prototype.findElementEnd=function(a){if(this.gotElementEnd)return!0;for(var b=new d(a);;){if(this.offset>=a.length)return!1;switch(this.state){case p.READ_HEADER_OR_CLOSE:if(0==this.headerLength&&a[this.offset]==m){if(++this.offset,--this.level,0==this.level)return this.gotElementEnd=!0,!0;if(this.level<0)throw new Error("BinaryXMLStructureDecoder: Unexpected close tag at offset "+(this.offset-1));this.startHeader();break}for(var c=this.headerLength;;){if(this.offset>=a.length){this.useHeaderBuffer=!0;var e=this.headerLength-c;return this.headerBuffer.copy(a.slice(this.offset-e,e),c),!1}var n=a[this.offset++];if(++this.headerLength,n&o)break}var q;if(this.useHeaderBuffer?(e=this.headerLength-c,this.headerBuffer.copy(a.slice(this.offset-e,e),c),q=new d(this.headerBuffer.array).decodeTypeAndVal()):(b.seek(this.offset-this.headerLength),q=b.decodeTypeAndVal()),null==q)throw new Error("BinaryXMLStructureDecoder: Can't read header starting at offset "+(this.offset-this.headerLength));var r=q.t;if(r==j)this.startHeader();else if(r==h||r==f)++this.level,this.startHeader();else if(r==g||r==i)r==g&&++this.level,this.nBytesToRead=q.v+1,this.state=p.READ_BYTES;else{if(r!=k&&r!=l)throw new Error("BinaryXMLStructureDecoder: Unrecognized header type "+r);this.nBytesToRead=q.v,this.state=p.READ_BYTES}break;case p.READ_BYTES:var s=a.length-this.offset;if(s<this.nBytesToRead)return this.offset+=s,this.nBytesToRead-=s,!1;this.offset+=this.nBytesToRead,this.startHeader();break;default:throw new Error("BinaryXMLStructureDecoder: Unrecognized state "+this.state)}}},p.prototype.startHeader=function(){this.headerLength=0,this.useHeaderBuffer=!1,this.state=p.READ_HEADER_OR_CLOSE},p.prototype.seek=function(a){this.offset=a}},{"../util/dynamic-buffer.js":114,"./binary-xml-decoder.js":61}],64:[function(a,b,c){var d=a("../util/blob.js").Blob,e=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("./binary-xml-encoder.js").BinaryXMLEncoder,g=a("./binary-xml-decoder.js").BinaryXMLDecoder,h=a("./wire-format.js").WireFormat,i=a("../name.js").Name,j=a("../exclude.js").Exclude,k=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,l=a("../meta-info.js").MetaInfo,m=a("../publisher-public-key-digest.js").PublisherPublicKeyDigest,n=a("./data-utils.js").DataUtils,o=a("../key-locator.js").KeyLocatorType,p=function(){h.call(this)
};c.BinaryXmlWireFormat=p,p.instance=null,p.prototype.encodeName=function(a){var b=new f;return a.to_ndnb(b),new d(b.getReducedOstream(),!1)},p.prototype.decodeName=function(a,b){var c=new g(b);a.from_ndnb(c)},p.prototype.encodeInterest=function(a){var b=new f,c=p.encodeInterest(a,b);return{encoding:new d(b.getReducedOstream(),!1),signedPortionBeginOffset:c.signedPortionBeginOffset,signedPortionEndOffset:c.signedPortionEndOffset}},p.prototype.decodeInterest=function(a,b){var c=new g(b);return p.decodeInterest(a,c)},p.prototype.encodeData=function(a){var b=new f(1500),c=p.encodeData(a,b);return c.encoding=new d(b.getReducedOstream(),!1),c},p.prototype.encodeContentObject=function(a){return this.encodeData(a)},p.prototype.decodeData=function(a,b){var c=new g(b);return p.decodeData(a,c)},p.prototype.decodeContentObject=function(a,b){this.decodeData(a,b)},p.get=function(){return null===p.instance&&(p.instance=new p),p.instance},p.encodeInterest=function(a,b){b.writeElementStartDTag(e.Interest);var c=a.getName().to_ndnb(b);return null!=a.getMinSuffixComponents()&&b.writeDTagElement(e.MinSuffixComponents,a.getMinSuffixComponents()),null!=a.getMaxSuffixComponents()&&b.writeDTagElement(e.MaxSuffixComponents,a.getMaxSuffixComponents()),a.getKeyLocator().getType()==o.KEY_LOCATOR_DIGEST&&!a.getKeyLocator().getKeyData().isNull()&&a.getKeyLocator().getKeyData().size()>0?b.writeDTagElement(e.PublisherPublicKeyDigest,a.getKeyLocator().getKeyData()):null!=a.publisherPublicKeyDigest&&a.publisherPublicKeyDigest.to_ndnb(b),null!=a.getExclude()&&a.getExclude().to_ndnb(b),null!=a.getChildSelector()&&b.writeDTagElement(e.ChildSelector,a.getChildSelector()),a.DEFAULT_ANSWER_ORIGIN_KIND!=a.setAnswerOriginKind()&&null!=a.setAnswerOriginKind()&&b.writeDTagElement(e.AnswerOriginKind,a.setAnswerOriginKind()),null!=a.setScope()&&b.writeDTagElement(e.Scope,a.setScope()),null!=a.getInterestLifetimeMilliseconds()&&b.writeDTagElement(e.InterestLifetime,n.nonNegativeIntToBigEndian(a.getInterestLifetimeMilliseconds()/1e3*4096)),a.getNonce().size()>0&&b.writeDTagElement(e.Nonce,a.getNonce()),b.writeElementClose(),c},p.decodeInterest=function(a,b){b.readElementStartDTag(e.Interest),a.setName(new i);var c=a.getName().from_ndnb(b);return a.setMinSuffixComponents(b.peekDTag(e.MinSuffixComponents)?b.readIntegerDTagElement(e.MinSuffixComponents):null),a.setMaxSuffixComponents(b.peekDTag(e.MaxSuffixComponents)?b.readIntegerDTagElement(e.MaxSuffixComponents):null),a.getKeyLocator().clear(),b.peekDTag(e.PublisherPublicKeyDigest)?(a.publisherPublicKeyDigest=new m,a.publisherPublicKeyDigest.from_ndnb(b)):a.publisherPublicKeyDigest=null,null!=a.publisherPublicKeyDigest&&null!=a.publisherPublicKeyDigest.publisherPublicKeyDigest&&a.publisherPublicKeyDigest.publisherPublicKeyDigest.length>0&&(a.getKeyLocator().setType(o.KEY_LOCATOR_DIGEST),a.getKeyLocator().setKeyData(a.publisherPublicKeyDigest.publisherPublicKeyDigest)),b.peekDTag(e.Exclude)?(a.setExclude(new j),a.getExclude().from_ndnb(b)):a.setExclude(new j),a.setChildSelector(b.peekDTag(e.ChildSelector)?b.readIntegerDTagElement(e.ChildSelector):null),a.setAnswerOriginKind(b.peekDTag(e.AnswerOriginKind)?b.readIntegerDTagElement(e.AnswerOriginKind):null),a.setScope(b.peekDTag(e.Scope)?b.readIntegerDTagElement(e.Scope):null),a.setInterestLifetimeMilliseconds(b.peekDTag(e.InterestLifetime)?1e3*n.bigEndianToUnsignedInt(b.readBinaryDTagElement(e.InterestLifetime))/4096:null),a.setNonce(b.peekDTag(e.Nonce)?b.readBinaryDTagElement(e.Nonce):null),b.readElementClose(),c},p.encodeData=function(a,b){b.writeElementStartDTag(a.getElementLabel()),null!=a.getSignature()&&a.getSignature().to_ndnb(b);var c=b.offset;null!=a.getName()&&a.getName().to_ndnb(b),null!=a.getMetaInfo()&&a.getMetaInfo().to_ndnb(b,a.getSignatureOrMetaInfoKeyLocator()),b.writeDTagElement(e.Content,a.getContent().buf());var d=b.offset;return b.writeElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:d}},p.decodeData=function(a,b){b.readElementStartDTag(a.getElementLabel()),b.peekDTag(e.Signature)?(a.setSignature(new k),a.getSignature().from_ndnb(b)):a.setSignature(new k);var c=b.offset;a.setName(new i),a.getName().from_ndnb(b),b.peekDTag(e.SignedInfo)?(a.setMetaInfo(new l),a.getMetaInfo().from_ndnb(b),null!=a.getMetaInfo().locator&&null!=a.getSignature()&&a.getSignature().setKeyLocator(a.getMetaInfo().locator)):a.setMetaInfo(new l),a.setContent(b.readBinaryDTagElement(e.Content,!0));var d=b.offset;return b.readElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:d}}},{"../exclude.js":77,"../key-locator.js":83,"../meta-info.js":86,"../name.js":87,"../publisher-public-key-digest.js":89,"../sha256-with-rsa-signature.js":105,"../util/blob.js":112,"../util/ndn-protoco-id-tags.js":117,"./binary-xml-decoder.js":61,"./binary-xml-encoder.js":62,"./data-utils.js":65,"./wire-format.js":76}],65:[function(a,b,c){(function(a){var b={};c.DataUtils=b,b.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b.stringtoBase64=function(a){var c,d,e,f,g,h="",i="",j="",k=0;do c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=a.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+b.keyStr.charAt(e)+b.keyStr.charAt(f)+b.keyStr.charAt(g)+b.keyStr.charAt(j),c=d=i="",e=f=g=j="";while(k<a.length);return h},b.base64toString=function(a){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(a)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=b.keyStr.indexOf(a.charAt(k++)),f=b.keyStr.indexOf(a.charAt(k++)),g=b.keyStr.indexOf(a.charAt(k++)),j=b.keyStr.indexOf(a.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!=g&&(h+=String.fromCharCode(d)),64!=j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<a.length);return h},b.toHex=function(a){return a.toString("hex")},b.stringToHex=function(a){for(var b="",c=0;c<a.length;++c){var d=a.charCodeAt(c);b+=(16>d?"0":"")+d.toString(16)}return b},b.toString=function(a){return a.toString("binary")},b.toNumbers=function(b){return new a(b,"hex")},b.hexToRawString=function(a){if("string"==typeof a){var b="";return a.replace(/(..)/g,function(a){b+=String.fromCharCode(parseInt(a,16))}),b}},b.toNumbersFromString=function(b){return new a(b,"binary")},b.toNumbersIfString=function(b){return"string"==typeof b?new a(b,"binary"):b},b.stringToUtf8Array=function(b){return new a(b,"utf8")},b.concatArrays=function(b){return a.concat(b)},b.decodeUtf8=function(a){for(var b="",c=0,d=0,e=0;c<a.length;)if(d=a.charCodeAt(c),128>d)b+=String.fromCharCode(d),c++;else if(d>191&&224>d)e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2;else{e=a.charCodeAt(c+1);var f=a.charCodeAt(c+2);b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3}return b},b.arraysEqual=function(a,b){if(!a.slice)throw new Error("DataUtils.arraysEqual: a1 is not an array");if(!b.slice)throw new Error("DataUtils.arraysEqual: a2 is not an array");if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0},b.bigEndianToUnsignedInt=function(a){for(var b=0,c=0;c<a.length;++c)b*=256,b+=a[c];return b},b.nonNegativeIntToBigEndian=function(b){if(b=Math.round(b),0>=b)return new a(0);for(var c=8,d=new a(c),e=0;0!=b;)++e,d[c-e]=255&b,b=Math.floor(b/256);return d.slice(c-e,c)},b.shuffle=function(a){for(var b=a.length-1;b>=1;--b){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}}}).call(this,a("buffer").Buffer)},{buffer:11}],66:[function(a,b,c){function d(a){this.message=a.message;for(var b in a)this[b]=a[b]}d.prototype=new Error,d.prototype.name="DecodingException",c.DecodingException=d},{}],67:[function(a,b,c){var d=a("./data-utils.js").DataUtils,e=a("./binary-xml-structure-decoder.js").BinaryXMLStructureDecoder,f=a("./tlv/tlv.js").Tlv,g=a("./tlv/tlv-structure-decoder.js").TlvStructureDecoder,h=a("../log.js").Log.LOG,i=function(a){this.elementListener=a,this.dataParts=[],this.binaryXmlStructureDecoder=new e,this.tlvStructureDecoder=new g,this.useTlv=null};c.ElementReader=i,i.prototype.onReceivedData=function(a){for(;;){if(0==this.dataParts.length){if(a.length<=0)return;this.useTlv=a[0]==f.Interest||a[0]==f.Data||128==a[0]?!0:!1}var b,c;if(this.useTlv?(this.tlvStructureDecoder.seek(0),b=this.tlvStructureDecoder.findElementEnd(a),c=this.tlvStructureDecoder.getOffset()):(this.binaryXmlStructureDecoder.seek(0),b=this.binaryXmlStructureDecoder.findElementEnd(a),c=this.binaryXmlStructureDecoder.offset),!b)return this.dataParts.push(a),void(h>3&&console.log("Incomplete packet received. Length "+a.length+". Wait for more input."));this.dataParts.push(a.slice(0,c));var i=d.concatArrays(this.dataParts);this.dataParts=[];try{this.elementListener.onReceivedElement(i)}catch(j){console.log("ElementReader: ignoring exception from onReceivedElement: "+j)}if(a=a.slice(c,a.length),this.binaryXmlStructureDecoder=new e,this.tlvStructureDecoder=new g,0==a.length)return}}},{"../log.js":85,"./binary-xml-structure-decoder.js":63,"./data-utils.js":65,"./tlv/tlv-structure-decoder.js":74,"./tlv/tlv.js":75}],68:[function(a,b,c){var d=a("./data-utils.js").DataUtils,e=a("./binary-xml-encoder.js").BinaryXMLEncoder,f=a("./binary-xml-decoder.js").BinaryXMLDecoder,g=(a("../key.js").Key,a("../key-locator.js").KeyLocatorType),h=a("../interest.js").Interest,i=a("../data.js").Data,j=a("../face-instance.js").FaceInstance,k=a("../forwarding-entry.js").ForwardingEntry,l=a("./wire-format.js").WireFormat,m=a("../log.js").Log.LOG,n=function(){};c.EncodingUtils=n,n.encodeToHexInterest=function(a,b){return b=b||l.getDefaultWireFormat(),d.toHex(a.wireEncode(b).buf())},n.encodeToHexData=function(a,b){return b=b||l.getDefaultWireFormat(),d.toHex(a.wireEncode(b).buf())},n.encodeToHexContentObject=function(a,b){return n.encodeToHexData(a,b)},n.encodeForwardingEntry=function(a){var b=new e;a.to_ndnb(b);var c=b.getReducedOstream();return c},n.decodeHexFaceInstance=function(a){var b=d.toNumbers(a),c=new f(b);m>3&&console.log("DECODING HEX FACE INSTANCE  \n"+b);var e=new j;return e.from_ndnb(c),e},n.decodeHexInterest=function(a,b){b=b||l.getDefaultWireFormat();var c=new h;return c.wireDecode(d.toNumbers(a),b),c},n.decodeHexData=function(a,b){b=b||l.getDefaultWireFormat();var c=new i;return c.wireDecode(d.toNumbers(a),b),c},n.decodeHexContentObject=function(a,b){return n.decodeHexData(a,b)},n.decodeHexForwardingEntry=function(a){var b=d.toNumbers(a),c=new f(b);m>3&&console.log("DECODED HEX FORWARDING ENTRY \n"+b);var e=new k;return e.from_ndnb(c),e},n.decodeSubjectPublicKeyInfo=function(a){var b=d.toHex(a).toLowerCase(),c=_x509_getPublicKeyHexArrayFromCertHex(b,_x509_getSubjectPublicKeyPosFromCertHex(b,0)),e=new RSAKey;return e.setPublic(c[0],c[1]),e},n.dataToHtml=function(a){var b="";if(-1==a)b+="NO CONTENT FOUND";else if(-2==a)b+="CONTENT NAME IS EMPTY";else{if(null!=a.getName()&&(b+="NAME: "+a.getName().toUri(),b+="<br />",b+="<br />"),a.getContent().isNull()||(b+="CONTENT(ASCII): "+d.toString(a.getContent().buf()),b+="<br />",b+="<br />"),a.getContent().isNull()||(b+="CONTENT(hex): "+a.getContent().toHex(),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().digestAlgorithm&&(b+="DigestAlgorithm (hex): "+d.toHex(a.getSignature().digestAlgorithm),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().witness&&(b+="Witness (hex): "+d.toHex(a.getSignature().witness),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().getSignature()&&(b+="Signature(hex): "+a.getSignature().getSignature().toHex(),b+="<br />",b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().publisher&&null!=a.getMetaInfo().publisher.publisherPublicKeyDigest&&(b+="Publisher Public Key Digest(hex): "+d.toHex(a.getMetaInfo().publisher.publisherPublicKeyDigest),b+="<br />",b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().timestamp){var c=new Date;c.setTime(a.getMetaInfo().timestamp.msec);b+="TimeStamp: "+c,b+="<br />",b+="TimeStamp(number): "+a.getMetaInfo().timestamp.msec,b+="<br />"}null!=a.getMetaInfo()&&a.getMetaInfo().getFinalBlockId().getValue().size()>0&&(b+="FinalBlockId: "+a.getMetaInfo().getFinalBlockId().getValue().toHex(),b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().locator&&a.getMetaInfo().locator.getType()&&(b+="keyLocator: ",b+=a.getMetaInfo().locator.getType()==g.KEY?"Key: "+d.toHex(a.getMetaInfo().locator.publicKey).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.KEY_LOCATOR_DIGEST?"KeyLocatorDigest: "+d.toHex(a.getMetaInfo().locator.getKeyData().buf()).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.CERTIFICATE?"Certificate: "+d.toHex(a.getMetaInfo().locator.certificate).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.KEYNAME?"KeyName: "+a.getMetaInfo().locator.keyName.contentName.to_uri()+"<br />":"[unrecognized ndn_KeyLocatorType "+a.getMetaInfo().locator.getType()+"]<br />")}return b},n.contentObjectToHtml=function(a){return n.dataToHtml(a)}},{"../data.js":60,"../face-instance.js":78,"../forwarding-entry.js":80,"../interest.js":82,"../key-locator.js":83,"../key.js":84,"../log.js":85,"./binary-xml-decoder.js":61,"./binary-xml-encoder.js":62,"./data-utils.js":65,"./wire-format.js":76}],69:[function(a,b,c){var d=a("./tlv/tlv-encoder.js").TlvEncoder,e=a("./tlv/tlv-decoder.js").TlvDecoder,f=a("../util/blob.js").Blob,g=function(){};c.ProtobufTlv=g,g._Field=null,g.establishField=function(){if(null===g._Field)try{g._Field=dcodeIO.ProtoBuf.Reflect.Message.Field}catch(b){g._Field=a("protobufjs/dist/ProtoBuf.js").Reflect.Message.Field}},g.encode=function(a,b){g.establishField(),a.encodeAB();var c=new d;return g._encodeMessageValue(a,b,c),new f(c.getOutput(),!1)},g.decode=function(b,c,d){g.establishField(),null===g._Field&&(g._Field=dcodeIO?dcodeIO.ProtoBuf.Reflect.Message.Field:a("protobufjs/dist/ProtoBuf.js").Reflect.Message.Field);var h="object"==typeof d&&d instanceof f?d.buf():d,i=new e(h);g._decodeMessageValue(b,c,i,h.length)},g._encodeMessageValue=function(a,b,c){for(var d=b.getChildren(g._Field),e=d.length-1;e>=0;--e){var h,i=d[e],j=i.id;if(i.repeated)h=a[i.name];else{if(null==a[i.name])continue;h=[a[i.name]]}for(var k=h.length-1;k>=0;--k){var l=h[k];if("message"==i.type.name){var m=c.getLength();g._encodeMessageValue(l,i.resolvedType,c),c.writeTypeAndLength(j,c.getLength()-m)}else if("uint32"==i.type.name||"uint64"==i.type.name)c.writeNonNegativeIntegerTlv(j,l);else if("enum"==i.type.name){if(0>l)throw new Error("ProtobufTlv::encode: ENUM value may not be negative");c.writeNonNegativeIntegerTlv(j,l)}else if("bytes"==i.type.name)c.writeBlobTlv(j,l.toBinary());else if("string"==i.type.name)c.writeBlobTlv(j,new f(l,!1).buf());else{if("bool"!=i.type.name)throw new Error("ProtobufTlv::encode: Unknown field type");l&&c.writeTypeAndLength(j,0)}}}},g._decodeMessageValue=function(a,b,c,d){for(var e=b.getChildren(g._Field),f=0;f<e.length;++f){var h=e[f],i=h.id;if(h.required||c.peekType(i,d))if(h.repeated)for(;c.peekType(i,d);)if("message"==h.type.name){var j=c.readNestedTlvsStart(i),k=new(h.resolvedType.build());a.add(h.name,k),g._decodeMessageValue(k,h.resolvedType,c,j),c.finishNestedTlvs(j)}else a.add(h.name,g._decodeFieldValue(h,i,c,d));else if("message"==h.type.name){var j=c.readNestedTlvsStart(i),k=new(h.resolvedType.build());a.set(h.name,k),g._decodeMessageValue(k,h.resolvedType,c,j),c.finishNestedTlvs(j)}else a.set(h.name,g._decodeFieldValue(h,i,c,d))}},g._decodeFieldValue=function(a,b,c,d){if("uint32"==a.type.name||"uint64"==a.type.name||"enum"==a.type.name)return c.readNonNegativeIntegerTlv(b);if("bytes"==a.type.name)return c.readBlobTlv(b);if("string"==a.type.name)return c.readBlobTlv(b).toString();if("bool"==a.type.name)return c.readBooleanTlv(b,d);throw new Error("ProtobufTlv.decode: Unknown field type")}},{"../util/blob.js":112,"./tlv/tlv-decoder.js":72,"./tlv/tlv-encoder.js":73,"protobufjs/dist/ProtoBuf.js":121}],70:[function(a,b,c){(function(b){var d=a("../crypto.js"),e=a("../util/blob.js").Blob,f=a("./tlv/tlv.js").Tlv,g=a("./tlv/tlv-encoder.js").TlvEncoder,h=a("./tlv/tlv-decoder.js").TlvDecoder,i=a("./wire-format.js").WireFormat,j=a("../exclude.js").Exclude,k=a("../meta-info.js").ContentType,l=a("../key-locator.js").KeyLocatorType,m=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,n=a("../forwarding-flags.js").ForwardingFlags,o=a("../publisher-public-key-digest.js").PublisherPublicKeyDigest,p=a("./decoding-exception.js").DecodingException,q=function(){i.call(this)};q.prototype=new i,q.prototype.name="Tlv0_1WireFormat",c.Tlv0_1WireFormat=q,q.instance=null,q.prototype.encodeName=function(a){var b=new g;return q.encodeName(a,b),new e(b.getOutput(),!1)},q.prototype.decodeName=function(a,b){var c=new h(b);q.decodeName(a,c)},q.prototype.encodeInterest=function(a){var c=new g(256),h=c.getLength();if(c.writeOptionalNonNegativeIntegerTlv(f.InterestLifetime,a.getInterestLifetimeMilliseconds()),c.writeOptionalNonNegativeIntegerTlv(f.Scope,a.getScope()),a.getNonce().isNull()||0==a.getNonce().size())c.writeBlobTlv(f.Nonce,d.randomBytes(4));else if(a.getNonce().size()<4){var i=b(4);a.getNonce().buf().copy(i);for(var j=a.getNonce().size();4>j;++j)i[j]=d.randomBytes(1)[0];c.writeBlobTlv(f.Nonce,i)}else 4==a.getNonce().size()?c.writeBlobTlv(f.Nonce,a.getNonce().buf()):c.writeBlobTlv(f.Nonce,a.getNonce().buf().slice(0,4));q.encodeSelectors(a,c);var k=q.encodeName(a.getName(),c),l=c.getLength()-k.signedPortionBeginOffset,m=c.getLength()-k.signedPortionEndOffset;c.writeTypeAndLength(f.Interest,c.getLength()-h);var n=c.getLength()-l,o=c.getLength()-m;return{encoding:new e(c.getOutput(),!1),signedPortionBeginOffset:n,signedPortionEndOffset:o}},q.prototype.decodeInterest=function(a,b){var c=new h(b),d=c.readNestedTlvsStart(f.Interest),e=q.decodeName(a.getName(),c);c.peekType(f.Selectors,d)&&q.decodeSelectors(a,c);var g=c.readBlobTlv(f.Nonce);return a.setScope(c.readOptionalNonNegativeIntegerTlv(f.Scope,d)),a.setInterestLifetimeMilliseconds(c.readOptionalNonNegativeIntegerTlv(f.InterestLifetime,d)),a.setNonce(g),c.finishNestedTlvs(d),e},q.prototype.encodeData=function(a){var b=new g(1500),c=b.getLength();b.writeBlobTlv(f.SignatureValue,a.getSignature().getSignature().buf());var d=b.getLength();q.encodeSignatureSha256WithRsaValue(a.getSignature(),b,a.getSignatureOrMetaInfoKeyLocator()),b.writeBlobTlv(f.Content,a.getContent().buf()),q.encodeMetaInfo(a.getMetaInfo(),b),q.encodeName(a.getName(),b);var h=b.getLength();b.writeTypeAndLength(f.Data,b.getLength()-c);var i=b.getLength()-h,j=b.getLength()-d;return{encoding:new e(b.getOutput(),!1),signedPortionBeginOffset:i,signedPortionEndOffset:j}},q.prototype.decodeData=function(a,b){var c=new h(b),d=c.readNestedTlvsStart(f.Data),g=c.getOffset();q.decodeName(a.getName(),c),q.decodeMetaInfo(a.getMetaInfo(),c),a.setContent(c.readBlobTlv(f.Content)),q.decodeSignatureInfo(a,c),null!=a.getSignature()&&null!=a.getSignature().getKeyLocator()&&null!=a.getMetaInfo()&&(a.getMetaInfo().locator=a.getSignature().getKeyLocator());var i=c.getOffset();return a.getSignature().setSignature(new e(c.readBlobTlv(f.SignatureValue),!0)),c.finishNestedTlvs(d),{signedPortionBeginOffset:g,signedPortionEndOffset:i}},q.prototype.encodeControlParameters=function(a){var b=new g(256),c=b.getLength();b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_ExpirationPeriod,a.getExpirationPeriod());var d=a.getForwardingFlags().getNfdForwardingFlags();return d!=(new n).getNfdForwardingFlags()&&b.writeNonNegativeIntegerTlv(f.ControlParameters_Flags,d),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_Cost,a.getCost()),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_Origin,a.getOrigin()),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_LocalControlFeature,a.getLocalControlFeature()),b.writeOptionalNonNegativeIntegerTlv(f.FaceID,a.getFaceId()),q.encodeName(a.getName(),b),b.writeTypeAndLength(f.ControlParameters_ControlParameters,b.getLength()-c),new e(b.getOutput(),!1)},q.prototype.encodeSignatureInfo=function(a){var b=new g(256);return q.encodeSignatureSha256WithRsaValue(a,b,a.getKeyLocator()),new e(b.getOutput(),!1)},q.SignatureHolder=function(){},q.SignatureHolder.prototype.setSignature=function(a){this.signature=a},q.SignatureHolder.prototype.getSignature=function(){return this.signature},q.prototype.decodeSignatureInfoAndValue=function(a,b){var c=new q.SignatureHolder,d=new h(a);return q.decodeSignatureInfo(c,d),d=new h(b),c.getSignature().setSignature(new e(d.readBlobTlv(f.SignatureValue),!0)),c.getSignature()},q.prototype.encodeSignatureValue=function(a){var b=new g(256);return b.writeBlobTlv(f.SignatureValue,a.getSignature().buf()),new e(b.getOutput(),!1)},q.get=function(){return null===q.instance&&(q.instance=new q),q.instance},q.encodeName=function(a,b){for(var c,d=b.getLength(),e=a.size()-1;e>=0;--e)b.writeBlobTlv(f.NameComponent,a.get(e).getValue().buf()),e==a.size()-1&&(c=b.getLength());var g=b.getLength();b.writeTypeAndLength(f.Name,b.getLength()-d);var h,i=b.getLength()-g;return h=0==a.size()?i:b.getLength()-c,{signedPortionBeginOffset:i,signedPortionEndOffset:h}},q.decodeName=function(a,b){a.clear();for(var c=b.readNestedTlvsStart(f.Name),d=b.getOffset(),e=d;b.getOffset()<c;)e=b.getOffset(),a.append(b.readBlobTlv(f.NameComponent));return b.finishNestedTlvs(c),{signedPortionBeginOffset:d,signedPortionEndOffset:e}},q.encodeSelectors=function(a,b){var c=b.getLength();if(a.getMustBeFresh()&&b.writeTypeAndLength(f.MustBeFresh,0),b.writeOptionalNonNegativeIntegerTlv(f.ChildSelector,a.getChildSelector()),a.getExclude().size()>0&&q.encodeExclude(a.getExclude(),b),null!=a.getKeyLocator().getType())q.encodeKeyLocator(f.PublisherPublicKeyLocator,a.getKeyLocator(),b);else if(null!=a.publisherPublicKeyDigest){var d=b.getLength();b.writeBlobTlv(f.KeyLocatorDigest,a.publisherPublicKeyDigest.publisherPublicKeyDigest),b.writeTypeAndLength(f.PublisherPublicKeyLocator,b.getLength()-d)}b.writeOptionalNonNegativeIntegerTlv(f.MaxSuffixComponents,a.getMaxSuffixComponents()),b.writeOptionalNonNegativeIntegerTlv(f.MinSuffixComponents,a.getMinSuffixComponents()),b.getLength()!=c&&b.writeTypeAndLength(f.Selectors,b.getLength()-c)},q.decodeSelectors=function(a,b){var c=b.readNestedTlvsStart(f.Selectors);a.setMinSuffixComponents(b.readOptionalNonNegativeIntegerTlv(f.MinSuffixComponents,c)),a.setMaxSuffixComponents(b.readOptionalNonNegativeIntegerTlv(f.MaxSuffixComponents,c)),a.publisherPublicKeyDigest=null,b.peekType(f.PublisherPublicKeyLocator,c)?(q.decodeKeyLocator(f.PublisherPublicKeyLocator,a.getKeyLocator(),b),a.getKeyLocator().getType()==l.KEY_LOCATOR_DIGEST&&(a.publisherPublicKeyDigest=new o,a.publisherPublicKeyDigest.publisherPublicKeyDigest=a.getKeyLocator().getKeyData().buf())):a.getKeyLocator().clear(),b.peekType(f.Exclude,c)?q.decodeExclude(a.getExclude(),b):a.getExclude().clear(),a.setChildSelector(b.readOptionalNonNegativeIntegerTlv(f.ChildSelector,c)),a.setMustBeFresh(b.readBooleanTlv(f.MustBeFresh,c)),b.finishNestedTlvs(c)},q.encodeExclude=function(a,b){for(var c=b.getLength(),d=a.size()-1;d>=0;--d){var e=a.get(d);e==j.ANY?b.writeTypeAndLength(f.Any,0):b.writeBlobTlv(f.NameComponent,e.getValue().buf())}b.writeTypeAndLength(f.Exclude,b.getLength()-c)},q.decodeExclude=function(a,b){var c=b.readNestedTlvsStart(f.Exclude);for(a.clear();;)if(b.peekType(f.NameComponent,c))a.appendComponent(b.readBlobTlv(f.NameComponent));else{if(!b.readBooleanTlv(f.Any,c))break;a.appendAny()}b.finishNestedTlvs(c)},q.encodeKeyLocator=function(a,b,c){var d=c.getLength();if(null!=b.getType())if(b.getType()==l.KEYNAME)q.encodeName(b.getKeyName(),c);else{if(!(b.getType()==l.KEY_LOCATOR_DIGEST&&b.getKeyData().size()>0))throw new Error("Unrecognized KeyLocatorType "+b.getType());c.writeBlobTlv(f.KeyLocatorDigest,b.getKeyData().buf())}c.writeTypeAndLength(a,c.getLength()-d)},q.decodeKeyLocator=function(a,b,c){var d=c.readNestedTlvsStart(a);if(b.clear(),c.getOffset()!=d){if(c.peekType(f.Name,d))b.setType(l.KEYNAME),q.decodeName(b.getKeyName(),c);else{if(!c.peekType(f.KeyLocatorDigest,d))throw new p("decodeKeyLocator: Unrecognized key locator type");b.setType(l.KEY_LOCATOR_DIGEST),b.setKeyData(c.readBlobTlv(f.KeyLocatorDigest))}c.finishNestedTlvs(d)}},q.encodeSignatureSha256WithRsaValue=function(a,b,c){var d=b.getLength();q.encodeKeyLocator(f.KeyLocator,c,b),b.writeNonNegativeIntegerTlv(f.SignatureType,f.SignatureType_SignatureSha256WithRsa),b.writeTypeAndLength(f.SignatureInfo,b.getLength()-d)},q.decodeSignatureInfo=function(a,b){var c=b.readNestedTlvsStart(f.SignatureInfo),d=b.readNonNegativeIntegerTlv(f.SignatureType);if(d!=f.SignatureType_SignatureSha256WithRsa)throw new p("decodeSignatureInfo: unrecognized SignatureInfo type"+d);a.setSignature(new m);var e=a.getSignature();q.decodeKeyLocator(f.KeyLocator,e.getKeyLocator(),b),b.finishNestedTlvs(c)},q.encodeMetaInfo=function(a,b){var c=b.getLength(),d=a.getFinalBlockId().getValue().buf();if(null!=d&&d.length>0){var e=b.getLength();b.writeBlobTlv(f.NameComponent,d),b.writeTypeAndLength(f.FinalBlockId,b.getLength()-e)}if(b.writeOptionalNonNegativeIntegerTlv(f.FreshnessPeriod,a.getFreshnessPeriod()),a.getType()!=k.BLOB){if(a.getType()!=k.LINK&&a.getType()!=k.KEY)throw new Error("unrecognized TLV ContentType");b.writeNonNegativeIntegerTlv(f.ContentType,a.getType())}b.writeTypeAndLength(f.MetaInfo,b.getLength()-c)},q.decodeMetaInfo=function(a,b){var c=b.readNestedTlvsStart(f.MetaInfo);if(a.setType(b.readOptionalNonNegativeIntegerTlv(f.ContentType,c)),a.setFreshnessPeriod(b.readOptionalNonNegativeIntegerTlv(f.FreshnessPeriod,c)),b.peekType(f.FinalBlockId,c)){var d=b.readNestedTlvsStart(f.FinalBlockId);a.setFinalBlockId(b.readBlobTlv(f.NameComponent)),b.finishNestedTlvs(d)}else a.setFinalBlockId(null);b.finishNestedTlvs(c)}}).call(this,a("buffer").Buffer)},{"../crypto.js":57,"../exclude.js":77,"../forwarding-flags.js":81,"../key-locator.js":83,"../meta-info.js":86,"../publisher-public-key-digest.js":89,"../sha256-with-rsa-signature.js":105,"../util/blob.js":112,"./decoding-exception.js":66,"./tlv/tlv-decoder.js":72,"./tlv/tlv-encoder.js":73,"./tlv/tlv.js":75,"./wire-format.js":76,buffer:11}],71:[function(a,b,c){var d=a("./wire-format.js").WireFormat,e=a("./tlv-0_1-wire-format.js").Tlv0_1WireFormat,f=function(){e.call(this)};f.prototype=new e,f.prototype.name="TlvWireFormat",c.TlvWireFormat=f,f.instance=null,f.get=function(){return null===f.instance&&(f.instance=new f),f.instance},d.setDefaultWireFormat(f.get())},{"./tlv-0_1-wire-format.js":70,"./wire-format.js":76}],72:[function(a,b,c){var d=a("../decoding-exception.js").DecodingException,e=function(a){this.input=a,this.offset=0};c.TlvDecoder=e,e.prototype.readVarNumber=function(){var a=this.input[this.offset];return this.offset+=1,253>a?a:this.readExtendedVarNumber(a)},e.prototype.readExtendedVarNumber=function(a){var b;if(253==a)b=(this.input[this.offset]<<8)+this.input[this.offset+1],this.offset+=2;else if(254==a)b=Math.abs(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3],this.offset+=4;else{var c=Math.abs(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3];b=4294967296*c+(this.input[this.offset+4]<<24)+(this.input[this.offset+5]<<16)+(this.input[this.offset+6]<<8)+this.input[this.offset+7],this.offset+=8}return b},e.prototype.readTypeAndLength=function(a){var b=this.readVarNumber();if(b!=a)throw new d("Did not get the expected TLV type");var c=this.readVarNumber();if(this.offset+c>this.input.length)throw new d("TLV length exceeds the buffer length");return c},e.prototype.readNestedTlvsStart=function(a){return this.readTypeAndLength(a)+this.offset},e.prototype.finishNestedTlvs=function(a){if(this.offset!=a){for(;this.offset<a;){this.readVarNumber();var b=this.readVarNumber();if(this.offset+=b,this.offset>this.input.length)throw new d("TLV length exceeds the buffer length")}if(this.offset!=a)throw new d("TLV length does not equal the total length of the nested TLVs")}},e.prototype.peekType=function(a,b){if(this.offset>=b)return!1;var c=this.offset,d=this.readVarNumber();return this.offset=c,d==a},e.prototype.readNonNegativeInteger=function(a){var b;if(1==a)b=this.input[this.offset];else if(2==a)b=(this.input[this.offset]<<8)+this.input[this.offset+1];else if(4==a)b=Math.abs(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3];else{if(8!=a)throw new d("Invalid length for a TLV nonNegativeInteger");var c=Math.abs(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3];b=4294967296*c+Math.abs(this.input[this.offset+4]<<24)+(this.input[this.offset+5]<<16)+(this.input[this.offset+6]<<8)+this.input[this.offset+7]}return this.offset+=a,b},e.prototype.readNonNegativeIntegerTlv=function(a){var b=this.readTypeAndLength(a);return this.readNonNegativeInteger(b)},e.prototype.readOptionalNonNegativeIntegerTlv=function(a,b){return this.peekType(a,b)?this.readNonNegativeIntegerTlv(a):null},e.prototype.readBlobTlv=function(a){var b=this.readTypeAndLength(a),c=this.input.slice(this.offset,this.offset+b);return this.offset+=b,c},e.prototype.readOptionalBlobTlv=function(a,b){return this.peekType(a,b)?this.readBlobTlv(a):null},e.prototype.readBooleanTlv=function(a,b){if(this.peekType(a,b)){var c=this.readTypeAndLength(a);return this.offset+=c,!0}return!1},e.prototype.getOffset=function(){return this.offset},e.prototype.seek=function(a){this.offset=a}},{"../decoding-exception.js":66}],73:[function(a,b,c){var d=a("../../util/dynamic-buffer.js").DynamicBuffer,e=a("./tlv.js").Tlv,f=function(a){a=a||16,this.output=new d(a),this.length=0};c.TlvEncoder=f,f.prototype.getLength=function(){return this.length},f.prototype.writeVarNumber=function(a){if(253>a)this.length+=1,this.output.ensureLengthFromBack(this.length),this.output.array[this.output.array.length-this.length]=255&a;else if(65535>=a){this.length+=3,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=253,this.output.array[b+1]=a>>8&255,this.output.array[b+2]=255&a}else if(4294967295>=a){this.length+=5,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=254,this.output.array[b+1]=a>>24&255,this.output.array[b+2]=a>>16&255,this.output.array[b+3]=a>>8&255,this.output.array[b+4]=255&a}else{this.length+=9,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=255;var c=e.getHighBytes(a);this.output.array[b+1]=c>>24&255,this.output.array[b+2]=c>>16&255,this.output.array[b+3]=c>>8&255,this.output.array[b+4]=255&c,this.output.array[b+5]=a>>24&255,this.output.array[b+6]=a>>16&255,this.output.array[b+7]=a>>8&255,this.output.array[b+8]=255&a}},f.prototype.writeTypeAndLength=function(a,b){this.writeVarNumber(b),this.writeVarNumber(a)},f.prototype.writeNonNegativeInteger=function(a){if(0>a)throw new Error("TLV integer value may not be negative");if(a=Math.round(a),255>=a)this.length+=1,this.output.ensureLengthFromBack(this.length),this.output.array[this.output.array.length-this.length]=255&a;else if(65535>=a){this.length+=2,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=a>>8&255,this.output.array[b+1]=255&a}else if(4294967295>=a){this.length+=4,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=a>>24&255,this.output.array[b+1]=a>>16&255,this.output.array[b+2]=a>>8&255,this.output.array[b+3]=255&a}else{this.length+=8,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length,c=e.getHighBytes(a);this.output.array[b]=c>>24&255,this.output.array[b+1]=c>>16&255,this.output.array[b+2]=c>>8&255,this.output.array[b+3]=255&c,this.output.array[b+4]=a>>24&255,this.output.array[b+5]=a>>16&255,this.output.array[b+6]=a>>8&255,this.output.array[b+7]=255&a
}},f.prototype.writeNonNegativeIntegerTlv=function(a,b){var c=this.length;this.writeNonNegativeInteger(b),this.writeTypeAndLength(a,this.length-c)},f.prototype.writeOptionalNonNegativeIntegerTlv=function(a,b){null!=b&&b>=0&&this.writeNonNegativeIntegerTlv(a,b)},f.prototype.writeBlobTlv=function(a,b){return null==b?void this.writeTypeAndLength(a,0):(this.length+=b.length,this.output.copyFromBack(b,this.length),void this.writeTypeAndLength(a,b.length))},f.prototype.writeOptionalBlobTlv=function(a,b){null!=b&&b.length>0&&this.writeBlobTlv(a,b)},f.prototype.getOutput=function(){return this.output.array.slice(this.output.array.length-this.length)}},{"../../util/dynamic-buffer.js":114,"./tlv.js":75}],74:[function(a,b,c){(function(b){var d=a("./tlv-decoder.js").TlvDecoder,e=function f(){this.gotElementEnd=!1,this.offset=0,this.state=f.READ_TYPE,this.headerLength=0,this.useHeaderBuffer=!1,this.headerBuffer=new b(8),this.nBytesToRead=0};c.TlvStructureDecoder=e,e.READ_TYPE=0,e.READ_TYPE_BYTES=1,e.READ_LENGTH=2,e.READ_LENGTH_BYTES=3,e.READ_VALUE_BYTES=4,e.prototype.findElementEnd=function(a){if(this.gotElementEnd)return!0;for(var b=new d(a);;){if(this.offset>=a.length)return!1;if(this.state==e.READ_TYPE){var c=a[this.offset];this.offset+=1,253>c?this.state=e.READ_LENGTH:(this.nBytesToRead=253==c?2:254==c?4:8,this.state=e.READ_TYPE_BYTES)}else if(this.state==e.READ_TYPE_BYTES){var f=a.length-this.offset;if(f<this.nBytesToRead)return this.offset+=f,this.nBytesToRead-=f,!1;this.offset+=this.nBytesToRead,this.state=e.READ_LENGTH}else if(this.state==e.READ_LENGTH){var c=a[this.offset];if(this.offset+=1,253>c){if(this.nBytesToRead=c,0==this.nBytesToRead)return this.gotElementEnd=!0,!0;this.state=e.READ_VALUE_BYTES}else this.nBytesToRead=253==c?2:254==c?4:8,this.firstOctet=c,this.state=e.READ_LENGTH_BYTES}else{if(this.state!=e.READ_LENGTH_BYTES){if(this.state==e.READ_VALUE_BYTES)return f=a.length-this.offset,f<this.nBytesToRead?(this.offset+=f,this.nBytesToRead-=f,!1):(this.offset+=this.nBytesToRead,this.gotElementEnd=!0,!0);throw new Error("findElementEnd: unrecognized state")}var f=a.length-this.offset;if(!this.useHeaderBuffer&&f>=this.nBytesToRead)b.seek(this.offset),this.nBytesToRead=b.readExtendedVarNumber(this.firstOctet),this.offset=b.getOffset();else{this.useHeaderBuffer=!0;var g=this.nBytesToRead-this.headerLength;if(g>f){if(this.headerLength+f>this.headerBuffer.length)throw new Error("Cannot store more header bytes than the size of headerBuffer");return a.slice(this.offset,this.offset+f).copy(this.headerBuffer,this.headerLength),this.offset+=f,this.headerLength+=f,!1}if(this.headerLength+g>this.headerBuffer.length)throw new Error("Cannot store more header bytes than the size of headerBuffer");a.slice(this.offset,this.offset+g).copy(this.headerBuffer,this.headerLength),this.offset+=g;var h=new d(this.headerBuffer);this.nBytesToRead=h.readExtendedVarNumber(this.firstOctet)}if(0==this.nBytesToRead)return this.gotElementEnd=!0,!0;this.state=e.READ_VALUE_BYTES}}},e.prototype.getOffset=function(){return this.offset},e.prototype.seek=function(a){this.offset=a}}).call(this,a("buffer").Buffer)},{"./tlv-decoder.js":72,buffer:11}],75:[function(a,b,c){var d=function(){};c.Tlv=d,d.Interest=5,d.Data=6,d.Name=7,d.NameComponent=8,d.Selectors=9,d.Nonce=10,d.Scope=11,d.InterestLifetime=12,d.MinSuffixComponents=13,d.MaxSuffixComponents=14,d.PublisherPublicKeyLocator=15,d.Exclude=16,d.ChildSelector=17,d.MustBeFresh=18,d.Any=19,d.MetaInfo=20,d.Content=21,d.SignatureInfo=22,d.SignatureValue=23,d.ContentType=24,d.FreshnessPeriod=25,d.FinalBlockId=26,d.SignatureType=27,d.KeyLocator=28,d.KeyLocatorDigest=29,d.FaceInstance=128,d.ForwardingEntry=129,d.StatusResponse=130,d.Action=131,d.FaceID=132,d.IPProto=133,d.Host=134,d.Port=135,d.MulticastInterface=136,d.MulticastTTL=137,d.ForwardingFlags=138,d.StatusCode=139,d.StatusText=140,d.SignatureType_DigestSha256=0,d.SignatureType_SignatureSha256WithRsa=1,d.ContentType_Default=0,d.ContentType_Link=1,d.ContentType_Key=2,d.NfdCommand_ControlResponse=101,d.NfdCommand_StatusCode=102,d.NfdCommand_StatusText=103,d.ControlParameters_ControlParameters=104,d.ControlParameters_FaceId=105,d.ControlParameters_Uri=114,d.ControlParameters_LocalControlFeature=110,d.ControlParameters_Origin=111,d.ControlParameters_Cost=106,d.ControlParameters_Flags=108,d.ControlParameters_Strategy=107,d.ControlParameters_ExpirationPeriod=109,d.getHighBytes=function(a){return(a-a%4294967296)/4294967296}},{}],76:[function(a,b,c){var d=function(){};c.WireFormat=d,d.prototype.encodeName=function(){throw new Error("encodeName is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeName=function(){throw new Error("decodeName is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeInterest=function(){throw new Error("encodeInterest is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeInterest=function(){throw new Error("decodeInterest is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeData=function(){throw new Error("encodeData is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeData=function(){throw new Error("decodeData is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeControlParameters=function(){throw new Error("encodeControlParameters is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeControlParameters=function(){throw new Error("decodeControlParameters is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeSignatureInfo=function(){throw new Error("encodeSignatureInfo is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeSignatureInfoAndValue=function(){throw new Error("decodeSignatureInfoAndValue is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeSignatureValue=function(){throw new Error("encodeSignatureValue is unimplemented in the base WireFormat class.  You should use a derived class.")},d.setDefaultWireFormat=function(a){d.defaultWireFormat=a},d.getDefaultWireFormat=function(){return d.defaultWireFormat};a("./tlv-wire-format.js").TlvWireFormat},{"./tlv-wire-format.js":71}],77:[function(a,b,c){var d=a("./name.js").Name,e=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./encoding/data-utils.js").DataUtils),g=a("./util/blob.js").Blob,h=function i(a){if(this.values=[],"object"==typeof a&&a instanceof i)this.values=a.values.slice(0);else if(a){this.changeCount=0;for(var b=0;b<a.length;++b)a[b]==i.ANY?this.appendAny():this.appendComponent(a[b])}this.changeCount=0};c.Exclude=h,h.ANY="*",h.prototype.size=function(){return this.values.length},h.prototype.get=function(a){return this.values[a]},h.prototype.appendAny=function(){return this.values.push(h.ANY),++this.changeCount,this},h.prototype.appendComponent=function(a){return this.values.push(new d.Component(a)),++this.changeCount,this},h.prototype.clear=function(){++this.changeCount,this.values=[]},h.prototype.from_ndnb=function(a){for(a.readElementStartDTag(e.Exclude);;)if(a.peekDTag(e.Component))this.appendComponent(a.readBinaryDTagElement(e.Component));else if(a.peekDTag(e.Any))a.readElementStartDTag(e.Any),a.readElementClose(),this.appendAny();else{if(!a.peekDTag(e.Bloom))break;a.readBinaryDTagElement(e.Bloom),this.appendAny()}a.readElementClose()},h.prototype.to_ndnb=function(a){if(null!=this.values&&0!=this.values.length){a.writeElementStartDTag(e.Exclude);for(var b=0;b<this.values.length;++b)this.values[b]==h.ANY?(a.writeElementStartDTag(e.Any),a.writeElementClose()):a.writeDTagElement(e.Component,this.values[b].getValue().buf());a.writeElementClose()}},h.prototype.toUri=function(){if(null==this.values||0==this.values.length)return"";for(var a="",b=0;b<this.values.length;++b)b>0&&(a+=","),a+=this.values[b]==h.ANY?"*":d.toEscapedString(this.values[b].getValue().buf());return a},h.prototype.matches=function(a){"object"==typeof a&&a instanceof d.Component?a=a.getValue().buf():"object"==typeof a&&a instanceof g&&(a=a.buf());for(var b=0;b<this.values.length;++b)if(this.values[b]==h.ANY){var c=null;b>0&&(c=this.values[b-1]);var e,i=null;for(e=b+1;e<this.values.length;++e)if(this.values[e]!=h.ANY){i=this.values[e];break}if(null!=i){if(null!=c){if(h.compareComponents(a,c)>0&&h.compareComponents(a,i)<0)return!0}else if(h.compareComponents(a,i)<0)return!0;b=e-1}else{if(null==c)return!0;if(h.compareComponents(a,c)>0)return!0}}else if(f.arraysEqual(a,this.values[b].getValue().buf()))return!0;return!1},h.compareComponents=function(a,b){return"object"==typeof a&&a instanceof d.Component&&(a=a.getValue().buf()),"object"==typeof b&&b instanceof d.Component&&(b=b.getValue().buf()),d.Component.compareBuffers(a,b)},h.prototype.getChangeCount=function(){return this.changeCount}},{"./encoding/binary-xml-decoder.js":61,"./encoding/binary-xml-encoder.js":62,"./encoding/data-utils.js":65,"./name.js":87,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117}],78:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,f=function(a,b,c,d,e,f,g,h,i){this.action=a,this.publisherPublicKeyDigest=b,this.faceID=c,this.ipProto=d,this.host=e,this.Port=f,this.multicastInterface=g,this.multicastTTL=h,this.freshnessSeconds=i};c.FaceInstance=f,f.NetworkProtocol={TCP:6,UDP:17},f.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(d.Action)&&(this.action=a.readUTF8DTagElement(d.Action)),a.peekDTag(d.PublisherPublicKeyDigest)&&(this.publisherPublicKeyDigest=new e,this.publisherPublicKeyDigest.from_ndnb(a)),a.peekDTag(d.FaceID)&&(this.faceID=a.readIntegerDTagElement(d.FaceID)),a.peekDTag(d.IPProto)){var b=a.readIntegerDTagElement(d.IPProto);if(this.ipProto=null,f.NetworkProtocol.TCP==b)this.ipProto=f.NetworkProtocol.TCP;else{if(f.NetworkProtocol.UDP!=b)throw new Error("FaceInstance.decoder.  Invalid NDNProtocolDTags.IPProto field: "+b);this.ipProto=f.NetworkProtocol.UDP}}a.peekDTag(d.Host)&&(this.host=a.readUTF8DTagElement(d.Host)),a.peekDTag(d.Port)&&(this.Port=a.readIntegerDTagElement(d.Port)),a.peekDTag(d.MulticastInterface)&&(this.multicastInterface=a.readUTF8DTagElement(d.MulticastInterface)),a.peekDTag(d.MulticastTTL)&&(this.multicastTTL=a.readIntegerDTagElement(d.MulticastTTL)),a.peekDTag(d.FreshnessSeconds)&&(this.freshnessSeconds=a.readIntegerDTagElement(d.FreshnessSeconds)),a.readElementClose()},f.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),null!=this.action&&0!=this.action.length&&a.writeDTagElement(d.Action,this.action),null!=this.publisherPublicKeyDigest&&this.publisherPublicKeyDigest.to_ndnb(a),null!=this.faceID&&a.writeDTagElement(d.FaceID,this.faceID),null!=this.ipProto&&a.writeDTagElement(d.IPProto,this.ipProto),null!=this.host&&0!=this.host.length&&a.writeDTagElement(d.Host,this.host),null!=this.Port&&a.writeDTagElement(d.Port,this.Port),null!=this.multicastInterface&&0!=this.multicastInterface.length&&a.writeDTagElement(d.MulticastInterface,this.multicastInterface),null!=this.multicastTTL&&a.writeDTagElement(d.MulticastTTL,this.multicastTTL),null!=this.freshnessSeconds&&a.writeDTagElement(d.FreshnessSeconds,this.freshnessSeconds),a.writeElementClose()},f.prototype.getElementLabel=function(){return d.FaceInstance}},{"./publisher-public-key-digest.js":89,"./util/ndn-protoco-id-tags.js":117}],79:[function(a,b,c){(function(b){function d(a){for(var b=-1,c=0;c<F.registeredPrefixTable.length;c++)E>3&&console.log("Registered prefix "+c+": checking if "+F.registeredPrefixTable[c].prefix+" matches "+a),F.registeredPrefixTable[c].prefix.match(a)&&(0>b||F.registeredPrefixTable[c].prefix.size()>F.registeredPrefixTable[b].prefix.size())&&(b=c);return b>=0?F.registeredPrefixTable[b]:null}var e=(a("crypto"),a("./encoding/data-utils.js").DataUtils),f=a("./name.js").Name,g=a("./interest.js").Interest,h=a("./data.js").Data,i=a("./meta-info.js").MetaInfo,j=a("./forwarding-entry.js").ForwardingEntry,k=a("./control-parameters.js").ControlParameters,l=a("./encoding/wire-format.js").WireFormat,m=a("./encoding/tlv-wire-format.js").TlvWireFormat,n=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat,o=a("./encoding/tlv/tlv.js").Tlv,p=a("./encoding/tlv/tlv-decoder.js").TlvDecoder,q=a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,r=a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,s=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,t=a("./key.js").Key,u=a("./key-locator.js").KeyLocatorType,v=a("./security/key-manager.js").globalKeyManager,w=a("./forwarding-flags.js").ForwardingFlags,x=a("./closure.js").Closure,y=a("./closure.js").UpcallInfo,z=a("./transport/transport.js").Transport,A=a("./transport/tcp-transport.js").TcpTransport,B=a("./transport/unix-transport.js").UnixTransport,C=a("./util/command-interest-generator.js").CommandInterestGenerator,D=a("fs"),E=a("./log.js").Log.LOG,F=function K(a,b){if(!K.supported)throw new Error("The necessary JavaScript support is not available on this platform.");var c;if("object"==typeof a&&a instanceof z){if(this.getConnectionInfo=null,this.transport=a,this.connectionInfo=b||null,c={},null==this.connectionInfo&&this.transport&&this.transport.__proto__&&"UnixTransport"==this.transport.__proto__.name){var d=K.getUnixSocketFilePathForLocalhost();null!=d?this.connectionInfo=new B.ConnectionInfo(d):console.log("Face constructor: Cannot determine the default Unix socket file path for UnixTransport"),console.log("Using "+this.connectionInfo.toString())}}else{c=a||{};var e=c.getTransport||function(){return new A};if(this.transport=e(),this.getConnectionInfo=c.getConnectionInfo||this.transport.defaultGetConnectionInfo,this.connectionInfo=c.connectionInfo||null,null==this.connectionInfo){var g=void 0!==c.host?c.host:null;if(this.transport&&this.transport.__proto__&&"UnixTransport"==this.transport.__proto__.name){if(null!=g)this.connectionInfo=new B.ConnectionInfo(g);else if(null==this.getConnectionInfo){var d=K.getUnixSocketFilePathForLocalhost();null!=d?this.connectionInfo=new B.ConnectionInfo(d):console.log("Face constructor: Cannot determine the default Unix socket file path for UnixTransport")}}else null!=g&&(this.connectionInfo="undefined"!=typeof WebSocketTransport?new WebSocketTransport.ConnectionInfo(g,c.port||9696):new A.ConnectionInfo(g,c.port||6363))}}null==this.connectionInfo?(this.host=null,this.host=null):(this.host=this.connectionInfo.host,this.host=this.connectionInfo.port),this.readyStatus=K.UNOPEN,this.verify=void 0!==c.verify?c.verify:!1,this.onopen=c.onopen||function(){E>3&&console.log("Face connection established.")},this.onclose=c.onclose||function(){E>3&&console.log("Face connection closed.")},this.ndndid=null,this.onConnectedCallbacks=[],this.commandKeyChain=null,this.commandCertificateName=new f,this.commandInterestGenerator=new C,this.timeoutPrefix=new f("/local/timeout")};c.Face=F,F.UNOPEN=0,F.OPEN_REQUESTED=1,F.OPENED=2,F.CLOSED=3,A.importFace(F),F.getUnixSocketFilePathForLocalhost=function(){var a="/var/run/nfd.sock";return D.existsSync(a)?a:(a="/tmp/.ndnd.sock",D.existsSync(a)?a:"")},F.getSupported=function(){try{{new b(1).slice(0,1)}}catch(a){return console.log("NDN not available: Buffer not supported. "+a),!1}return!0},F.supported=F.getSupported(),F.ndndIdFetcher=new f("/%C1.M.S.localhost/%C1.M.SRV/ndnd/KEY"),F.prototype.createRoute=function(a,b){this.connectionInfo=a instanceof z.ConnectionInfo?a:new A.ConnectionInfo(a,b),this.host=this.connectionInfo.host,this.host=this.connectionInfo.port},F.KeyStore=new Array;var G=function(a,b,c){this.keyName=a,this.rsaKey=b,this.timeStamp=c};F.addKeyEntry=function(a){var b=F.getKeyByName(a.keyName);null==b?F.KeyStore.push(a):b=a},F.getKeyByName=function(a){for(var b=null,c=0;c<F.KeyStore.length;c++)F.KeyStore[c].keyName.contentName.match(a.contentName)&&(null==b||F.KeyStore[c].keyName.contentName.size()>b.keyName.contentName.size())&&(b=F.KeyStore[c]);return b},F.prototype.close=function(){this.readyStatus==F.OPENED&&(this.readyStatus=F.CLOSED,this.transport.close())},F.PITTable=new Array,F.PITTableRemoveRequests=new Array;var H=function(a,b,c){this.pendingInterestId=a,this.interest=b,this.closure=c,this.timerID=-1};H.lastPendingInterestId=0,H.getNextPendingInterestId=function(){return++H.lastPendingInterestId,H.lastPendingInterestId},F.extractEntriesForExpressedInterest=function(a){for(var b=[],c=F.PITTable.length-1;c>=0;--c){var d=F.PITTable[c];d.interest.matchesName(a)&&(clearTimeout(d.timerID),b.push(d),F.PITTable.splice(c,1))}return b},F.registeredPrefixTable=new Array,F.registeredPrefixRemoveRequests=new Array;var I=function(a,b,c){this.registeredPrefixId=a,this.prefix=b,this.closure=c};I.lastRegisteredPrefixId=0,I.getNextRegisteredPrefixId=function(){return++I.lastRegisteredPrefixId,I.lastRegisteredPrefixId},F.makeShuffledHostGetConnectionInfo=function(a,b,c){return a=a.slice(0,a.length),e.shuffle(a),function(){return 0==a.length?null:c(a.splice(0,1)[0],b)}},F.prototype.expressInterest=function(a,b,c,d){var e;if(b&&b.upcall&&"function"==typeof b.upcall){if(e=new g(a),c){var f=c;e.setMinSuffixComponents(f.getMinSuffixComponents()),e.setMaxSuffixComponents(f.getMaxSuffixComponents()),e.publisherPublicKeyDigest=f.publisherPublicKeyDigest,e.setExclude(f.getExclude()),e.setChildSelector(f.getChildSelector()),e.getAnswerOriginKind(f.getAnswerOriginKind()),e.setScope(f.getScope()),e.setInterestLifetimeMilliseconds(f.getInterestLifetimeMilliseconds())}else e.setInterestLifetimeMilliseconds(4e3);return this.expressInterestWithClosure(e,b)}var h,i;if("object"==typeof a&&a instanceof g)e=new g(a),h=b,i=c?c:function(){};else if(e=new g(a),b&&"object"==typeof b&&b instanceof g){var f=b;e.setMinSuffixComponents(f.getMinSuffixComponents()),e.setMaxSuffixComponents(f.getMaxSuffixComponents()),e.publisherPublicKeyDigest=f.publisherPublicKeyDigest,e.setExclude(f.getExclude()),e.setChildSelector(f.getChildSelector()),e.getAnswerOriginKind(f.getAnswerOriginKind()),e.setScope(f.getScope()),e.setInterestLifetimeMilliseconds(f.getInterestLifetimeMilliseconds()),h=c,i=d?d:function(){}}else e.setInterestLifetimeMilliseconds(4e3),h=b,i=c?c:function(){};return this.expressInterestWithClosure(e,new F.CallbackClosure(h,i))},F.CallbackClosure=function(a,b,c,d,e){x.call(this),this.onData=a,this.onTimeout=b,this.onInterest=c,this.prefix=d,this.transport=e},F.CallbackClosure.prototype.upcall=function(a,b){return a==x.UPCALL_CONTENT||a==x.UPCALL_CONTENT_UNVERIFIED?this.onData(b.interest,b.data):a==x.UPCALL_INTEREST_TIMED_OUT?this.onTimeout(b.interest):a==x.UPCALL_INTEREST&&this.onInterest(this.prefix,b.interest,this.transport),x.RESULT_OK},F.prototype.expressInterestWithClosure=function(a,b){var c=H.getNextPendingInterestId();if(null==this.connectionInfo)if(null==this.getConnectionInfo)console.log("ERROR: connectionInfo is NOT SET");else{var d=this;this.connectAndExecute(function(){d.reconnectAndExpressInterest(c,a,b)})}else this.reconnectAndExpressInterest(c,a,b);return c},F.prototype.reconnectAndExpressInterest=function(a,b,c){var d=this;if(this.connectionInfo.equals(this.transport.connectionInfo)&&this.readyStatus!==F.UNOPEN)if(this.readyStatus===F.OPEN_REQUESTED)this.onConnectedCallbacks.push(function(){d.expressInterestHelper(a,b,c)});else{if(this.readyStatus!==F.OPENED)throw new Error("reconnectAndExpressInterest: unexpected connection is not opened");this.expressInterestHelper(a,b,c)}else this.readyStatus=F.OPEN_REQUESTED,this.onConnectedCallbacks.push(function(){d.expressInterestHelper(a,b,c)}),this.transport.connect(this.connectionInfo,this,function(){for(d.readyStatus=F.OPENED;d.onConnectedCallbacks.length>0;)try{d.onConnectedCallbacks.shift()()}catch(a){console.log("Face.reconnectAndExpressInterest: ignoring exception from onConnectedCallbacks: "+a)}d.onopen&&d.onopen()},function(){d.closeByTransport()})},F.prototype.expressInterestHelper=function(a,b,c){var d=b.wireEncode(),e=this;if(null!=c){var f=-1;if(null!=f&&(f=F.PITTableRemoveRequests.indexOf(a)),f>=0)F.PITTableRemoveRequests.splice(f,1);else{var g=new H(a,b,c);F.PITTable.push(g),c.pitEntry=g;var h=b.getInterestLifetimeMilliseconds()||4e3,i=function(){E>1&&console.log("Interest time out: "+b.getName().toUri());var a=F.PITTable.indexOf(g);a>=0&&F.PITTable.splice(a,1),c.upcall(x.UPCALL_INTEREST_TIMED_OUT,new y(e,b,0,null))==x.RESULT_REEXPRESS&&(E>1&&console.log("Re-express interest: "+b.getName().toUri()),g.timerID=setTimeout(i,h),F.PITTable.push(g),e.transport.send(d.buf()))};g.timerID=setTimeout(i,h)}}this.timeoutPrefix.match(b.getName())||this.transport.send(d.buf())},F.prototype.removePendingInterest=function(a){if(null!=a){for(var b=0,c=F.PITTable.length-1;c>=0;--c){var d=F.PITTable[c];d.pendingInterestId==a&&(clearTimeout(d.timerID),F.PITTable.splice(c,1),++b)}0==b&&F.PITTableRemoveRequests.indexOf(a)<0&&F.PITTableRemoveRequests.push(a)}},F.prototype.setCommandSigningInfo=function(a,b){this.commandKeyChain=a,this.commandCertificateName=new f(b)},F.prototype.setCommandCertificateName=function(a){this.commandCertificateName=new f(a)},F.prototype.makeCommandInterest=function(a,b){b=b||l.getDefaultWireFormat(),this.nodeMakeCommandInterest(a,this.commandKeyChain,this.commandCertificateName,b)},F.prototype.nodeMakeCommandInterest=function(a,b,c,d){this.commandInterestGenerator.generate(a,b,c,d)},F.prototype.registerPrefix=function(a,b,c,d){if(b&&b.upcall&&"function"==typeof b.upcall){if(c){var e;return"number"==typeof e?(e=new w,e.setForwardingEntryFlags(c)):e=c,this.registerPrefixWithClosure(a,b,e)}return this.registerPrefixWithClosure(a,b,new w)}var f=b,g=c?c:function(){},e=d?d:new w;return this.registerPrefixWithClosure(a,new F.CallbackClosure(null,null,f,a,this.transport),e,g)},F.prototype.registerPrefixWithClosure=function(a,b,c,d){var e=I.getNextRegisteredPrefixId(),f=this,h=function(){if(null!=f.ndndid||null==f.commandKeyChain)if(null==f.ndndid){var h=new g(F.ndndIdFetcher);h.setInterestLifetimeMilliseconds(4e3),E>3&&console.log("Expressing interest for ndndid from ndnd."),f.reconnectAndExpressInterest(null,h,new F.FetchNdndidClosure(f,e,a,b,c,d))}else f.registerPrefixHelper(e,a,b,c,d);else f.nfdRegisterPrefix(e,a,b,c,d,f.commandKeyChain,f.commandCertificateName)};return null==this.connectionInfo?null==this.getConnectionInfo?console.log("ERROR: connectionInfo is NOT SET"):this.connectAndExecute(h):h(),e},F.FetchNdndidClosure=function(a,b,c,d,e,f){x.call(this),this.face=a,this.registeredPrefixId=b,this.prefix=c,this.callerClosure=d,this.flags=e,this.onRegisterFailed=f},F.FetchNdndidClosure.prototype.upcall=function(c,d){if(c==x.UPCALL_INTEREST_TIMED_OUT)return console.log("Timeout while requesting the ndndid.  Cannot registerPrefix for "+this.prefix.toUri()+" ."),this.onRegisterFailed&&this.onRegisterFailed(this.prefix),x.RESULT_OK;if(c!=x.UPCALL_CONTENT&&c!=x.UPCALL_CONTENT_UNVERIFIED)return x.RESULT_ERR;E>3&&console.log("Got ndndid from ndnd.");var f=a("crypto").createHash("sha256");return f.update(d.data.getContent().buf()),this.face.ndndid=new b(e.toNumbersIfString(f.digest())),E>3&&console.log(this.face.ndndid),this.face.registerPrefixHelper(this.registeredPrefixId,this.prefix,this.callerClosure,this.flags,this.onRegisterFailed),x.RESULT_OK},F.RegisterResponseClosure=function(a,b,c,d,e,f,g){x.call(this),this.face=a,this.prefix=b,this.callerClosure=c,this.onRegisterFailed=d,this.flags=e,this.wireFormat=f,this.isNfdCommand=g},F.RegisterResponseClosure.prototype.upcall=function(a,b){if(a==x.UPCALL_INTEREST_TIMED_OUT){if(this.isNfdCommand)if(null==this.face.ndndid){var c=new g(F.ndndIdFetcher);c.setInterestLifetimeMilliseconds(4e3),this.face.reconnectAndExpressInterest(null,c,new F.FetchNdndidClosure(this.face,0,this.prefix,this.closure,this.flags,this.onRegisterFailed))}else this.face.registerPrefixHelper(0,this.prefix,this.closure,this.flags,this.onRegisterFailed);else this.onRegisterFailed&&this.onRegisterFailed(this.prefix);return x.RESULT_OK}if(a!=x.UPCALL_CONTENT&&a!=x.UPCALL_CONTENT_UNVERIFIED)return x.RESULT_ERR;if(this.isNfdCommand){var d;try{var e=new p(b.data.getContent().buf());e.readNestedTlvsStart(o.NfdCommand_ControlResponse),d=e.readNonNegativeIntegerTlv(o.NfdCommand_StatusCode)}catch(h){return this.onRegisterFailed&&this.onRegisterFailed(this.prefix),x.RESULT_OK}200!=d&&this.onRegisterFailed&&this.onRegisterFailed(this.prefix)}else{var i=new f("/ndnx/.../selfreg");if(b.data.getName().size()<4||!b.data.getName().get(0).equals(i.get(0))||!b.data.getName().get(2).equals(i.get(2)))return this.onRegisterFailed(this.prefix),x.RESULT_OK}return x.RESULT_OK},F.prototype.registerPrefixHelper=function(a,b,c,d,e){var k=-1;if(null!=k&&(k=F.registeredPrefixRemoveRequests.indexOf(a)),k>=0)return void F.registeredPrefixRemoveRequests.splice(k,1);var l=new j("selfreg",b,null,null,d.getForwardingEntryFlags(),null),m=new r;l.to_ndnb(m);var o=m.getReducedOstream(),p=new i;p.setFields(),p.locator.setType(u.KEY),p.locator.setKeyData(v.getKey().publicToDER());var q=new h(new f,p,o);q.sign(n.get());var s=q.wireEncode(n.get()),t=this.ndndid,w=new f(["ndnx",t,"selfreg",s]),x=new g(w);x.setInterestLifetimeMilliseconds(4e3),x.setScope(1),E>3&&console.log("Send Interest registration packet."),0!=a&&F.registeredPrefixTable.push(new I(a,b,c)),this.reconnectAndExpressInterest(null,x,new F.RegisterResponseClosure(this,b,c,e,d,n.get(),!1))},F.prototype.nfdRegisterPrefix=function(a,b,c,d,e,h,i){var j=-1;if(null!=j&&(j=F.registeredPrefixRemoveRequests.indexOf(a)),j>=0)return void F.registeredPrefixRemoveRequests.splice(j,1);if(null==h)throw new Error("registerPrefix: The command KeyChain has not been set. You must call setCommandSigningInfo.");if(0==i.size())throw new Error("registerPrefix: The command certificate name has not been set. You must call setCommandSigningInfo.");var l=new k;l.setName(b);var n=new g(new f("/localhost/nfd/rib/register"));n.getName().append(l.wireEncode(m.get())),this.nodeMakeCommandInterest(n,h,i,m.get()),n.setInterestLifetimeMilliseconds(2e3),0!=a&&F.registeredPrefixTable.push(new I(a,b,c)),this.reconnectAndExpressInterest(null,n,new F.RegisterResponseClosure(this,b,c,e,d,m.get(),!0))},F.prototype.removeRegisteredPrefix=function(a){for(var b=0,c=F.registeredPrefixTable.length-1;c>=0;--c){var d=F.registeredPrefixTable[c];d.registeredPrefixId==a&&(F.registeredPrefixTable.splice(c,1),++b)}0==b&&F.registeredPrefixRemoveRequests.indexOf(a)<0&&F.registeredPrefixRemoveRequests.push(a)},F.prototype.onReceivedElement=function(a){E>3&&console.log("Complete element received. Length "+a.length+". Start decoding.");var b=null,c=null;if(a[0]==o.Interest||a[0]==o.Data){var e=new p(a);e.peekType(o.Interest,a.length)?(b=new g,b.wireDecode(a,m.get())):e.peekType(o.Data,a.length)&&(c=new h,c.wireDecode(a,m.get()))}else{var e=new q(a);e.peekDTag(s.Interest)?(b=new g,b.wireDecode(a,n.get())):e.peekDTag(s.Data)&&(c=new h,c.wireDecode(a,n.get()))}if(null!==b){E>3&&console.log("Interest packet received.");var f=d(b.getName());if(null!=f){E>3&&console.log("Found registered prefix for "+b.getName().toUri());var i=new y(this,b,0,null),j=f.closure.upcall(x.UPCALL_INTEREST,i);j==x.RESULT_INTEREST_CONSUMED&&null!=i.data&&this.transport.send(i.data.wireEncode().buf())}}else if(null!==c){E>3&&console.log("Data packet received.");for(var k=F.extractEntriesForExpressedInterest(c.getName()),l=0;l<k.length;++l){var r=k[l],v=r.closure;if(0!=this.verify){var w=function(a,b,c){this.data=a,this.closure=b,this.keyName=c,x.call(this)},z=this;if(w.prototype.upcall=function(a,b){if(a==x.UPCALL_INTEREST_TIMED_OUT)console.log("In KeyFetchClosure.upcall: interest time out."),console.log(this.keyName.contentName.toUri());else if(a==x.UPCALL_CONTENT){var d=new t;d.readDerPublicKey(b.data.getContent().buf());var e=c.verify(d),f=1==e?x.UPCALL_CONTENT:x.UPCALL_CONTENT_BAD;this.closure.upcall(f,new y(z,null,0,this.data));var g=new G(C.keyName,d,(new Date).getTime());F.addKeyEntry(g)}else a==x.UPCALL_CONTENT_BAD&&console.log("In KeyFetchClosure.upcall: signature verification failed")},c.getMetaInfo()&&c.getMetaInfo().locator&&c.getSignature()){E>3&&console.log("Key verification...");var A=c.getSignature().getSignature().toHex(),B=null;null!=c.getSignature().witness&&v.upcall(x.UPCALL_CONTENT_BAD,new y(this,r.interest,0,c));var C=c.getMetaInfo().locator;if(C.getType()==u.KEYNAME)if(E>3&&console.log("KeyLocator contains KEYNAME"),C.keyName.contentName.match(c.getName())){E>3&&console.log("Content is key itself");var D=new t;D.readDerPublicKey(c.getContent().buf());var H=c.verify(D),I=1==H?x.UPCALL_CONTENT:x.UPCALL_CONTENT_BAD;v.upcall(I,new y(this,r.interest,0,c))}else{var J=F.getKeyByName(C.keyName);if(J){E>3&&console.log("Local key cache hit");var D=J.rsaKey,H=c.verify(D),I=1==H?x.UPCALL_CONTENT:x.UPCALL_CONTENT_BAD;v.upcall(I,new y(this,r.interest,0,c))}else{E>3&&console.log("Fetch key according to keylocator");var K=new w(c,v,C.keyName,A,B);this.expressInterest(C.keyName.contentName.getPrefix(4),K)}}else if(C.getType()==u.KEY){E>3&&console.log("Keylocator contains KEY");var D=new t;D.readDerPublicKey(C.publicKey);var H=c.verify(D),I=1==H?x.UPCALL_CONTENT:x.UPCALL_CONTENT_BAD;v.upcall(x.UPCALL_CONTENT,new y(this,r.interest,0,c))}else{var L=C.certificate;console.log("KeyLocator contains CERT"),console.log(L)}}}else v.upcall(x.UPCALL_CONTENT_UNVERIFIED,new y(this,r.interest,0,c))}}},F.prototype.connectAndExecute=function(a){var b=this.getConnectionInfo();if(null==b)return console.log("ERROR: No more connectionInfo from getConnectionInfo"),this.connectionInfo=null,this.host=null,void(this.host=null);if(b.equals(this.connectionInfo))return void console.log("ERROR: The host returned by getConnectionInfo is not alive: "+this.connectionInfo.toString());this.connectionInfo=b,E>0&&console.log("connectAndExecute: trying host from getConnectionInfo: "+this.connectionInfo.toString()),this.host=this.connectionInfo.host,this.host=this.connectionInfo.port;var c=new g(new f("/"));c.setInterestLifetimeMilliseconds(4e3);var d=this,e=setTimeout(function(){E>0&&console.log("connectAndExecute: timeout waiting for host "+d.host),d.connectAndExecute(a)},3e3);this.reconnectAndExpressInterest(null,c,new F.ConnectClosure(this,a,e))},F.prototype.closeByTransport=function(){this.readyStatus=F.CLOSED,this.onclose()},F.ConnectClosure=function(a,b,c){x.call(this),this.face=a,this.onConnected=b,this.timerID=c},F.ConnectClosure.prototype.upcall=function(a){return a!=x.UPCALL_CONTENT&&a!=x.UPCALL_CONTENT_UNVERIFIED?x.RESULT_ERR:(clearTimeout(this.timerID),E>0&&console.log("connectAndExecute: connected to host "+this.face.host),this.onConnected(),x.RESULT_OK)};var J=function(a){F.call(this,a)};J.prototype=new F({getTransport:function(){},getConnectionInfo:function(){}}),c.NDN=J,J.supported=F.supported,J.UNOPEN=F.UNOPEN,J.OPEN_REQUESTED=F.OPEN_REQUESTED,J.OPENED=F.OPENED,J.CLOSED=F.CLOSED}).call(this,a("buffer").Buffer)},{"./closure.js":58,"./control-parameters.js":59,"./data.js":60,"./encoding/binary-xml-decoder.js":61,"./encoding/binary-xml-encoder.js":62,"./encoding/binary-xml-wire-format.js":64,"./encoding/data-utils.js":65,"./encoding/tlv-wire-format.js":71,"./encoding/tlv/tlv-decoder.js":72,"./encoding/tlv/tlv.js":75,"./encoding/wire-format.js":76,"./forwarding-entry.js":80,"./forwarding-flags.js":81,"./interest.js":82,"./key-locator.js":83,"./key.js":84,"./log.js":85,"./meta-info.js":86,"./name.js":87,"./security/key-manager.js":98,"./transport/tcp-transport.js":56,"./transport/transport.js":109,"./transport/unix-transport.js":110,"./util/command-interest-generator.js":113,"./util/ndn-protoco-id-tags.js":117,buffer:11,crypto:18,fs:10}],80:[function(a,b,c){var d=(a("./forwarding-flags.js").ForwardingFlags,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),e=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,f=a("./name.js").Name,g=function(a,b,c,d,e,f){this.action=a,this.prefixName=b,this.ndndID=c,this.faceID=d,this.flags=e,this.lifetime=f
};c.ForwardingEntry=g,g.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),a.peekDTag(d.Action)&&(this.action=a.readUTF8DTagElement(d.Action)),a.peekDTag(d.Name)&&(this.prefixName=new f,this.prefixName.from_ndnb(a)),a.peekDTag(d.PublisherPublicKeyDigest)&&(this.NdndId=new e,this.NdndId.from_ndnb(a)),a.peekDTag(d.FaceID)&&(this.faceID=a.readIntegerDTagElement(d.FaceID)),a.peekDTag(d.ForwardingFlags)&&(this.flags=a.readIntegerDTagElement(d.ForwardingFlags)),a.peekDTag(d.FreshnessSeconds)&&(this.lifetime=a.readIntegerDTagElement(d.FreshnessSeconds)),a.readElementClose()},g.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),null!=this.action&&0!=this.action.length&&a.writeDTagElement(d.Action,this.action),null!=this.prefixName&&this.prefixName.to_ndnb(a),null!=this.NdndId&&this.NdndId.to_ndnb(a),null!=this.faceID&&a.writeDTagElement(d.FaceID,this.faceID),null!=this.flags&&a.writeDTagElement(d.ForwardingFlags,this.flags),null!=this.lifetime&&a.writeDTagElement(d.FreshnessSeconds,this.lifetime),a.writeElementClose()},g.prototype.getElementLabel=function(){return d.ForwardingEntry}},{"./forwarding-flags.js":81,"./name.js":87,"./publisher-public-key-digest.js":89,"./util/ndn-protoco-id-tags.js":117}],81:[function(a,b,c){var d=function(){this.active=!0,this.childInherit=!0,this.advertise=!1,this.last=!1,this.capture=!1,this.local=!1,this.tap=!1,this.captureOk=!1};c.ForwardingFlags=d,d.ForwardingEntryFlags_ACTIVE=1,d.ForwardingEntryFlags_CHILD_INHERIT=2,d.ForwardingEntryFlags_ADVERTISE=4,d.ForwardingEntryFlags_LAST=8,d.ForwardingEntryFlags_CAPTURE=16,d.ForwardingEntryFlags_LOCAL=32,d.ForwardingEntryFlags_TAP=64,d.ForwardingEntryFlags_CAPTURE_OK=128,d.NfdForwardingFlags_CHILD_INHERIT=1,d.NfdForwardingFlags_CAPTURE=2,d.prototype.getForwardingEntryFlags=function(){var a=0;return this.active&&(a|=d.ForwardingEntryFlags_ACTIVE),this.childInherit&&(a|=d.ForwardingEntryFlags_CHILD_INHERIT),this.advertise&&(a|=d.ForwardingEntryFlags_ADVERTISE),this.last&&(a|=d.ForwardingEntryFlags_LAST),this.capture&&(a|=d.ForwardingEntryFlags_CAPTURE),this.local&&(a|=d.ForwardingEntryFlags_LOCAL),this.tap&&(a|=d.ForwardingEntryFlags_TAP),this.captureOk&&(a|=d.ForwardingEntryFlags_CAPTURE_OK),a},d.prototype.setForwardingEntryFlags=function(a){this.active=0!=(a&d.ForwardingEntryFlags_ACTIVE),this.childInherit=0!=(a&d.ForwardingEntryFlags_CHILD_INHERIT),this.advertise=0!=(a&d.ForwardingEntryFlags_ADVERTISE),this.last=0!=(a&d.ForwardingEntryFlags_LAST),this.capture=0!=(a&d.ForwardingEntryFlags_CAPTURE),this.local=0!=(a&d.ForwardingEntryFlags_LOCAL),this.tap=0!=(a&d.ForwardingEntryFlags_TAP),this.captureOk=0!=(a&d.ForwardingEntryFlags_CAPTURE_OK)},d.prototype.getNfdForwardingFlags=function(){var a=0;return this.childInherit&&(a|=d.NfdForwardingFlags_CHILD_INHERIT),this.capture&&(a|=d.NfdForwardingFlags_CAPTURE),a},d.prototype.setNfdForwardingFlags=function(a){this.childInherit=0!=(a&d.NfdForwardingFlags_CHILD_INHERIT),this.capture=0!=(a&d.NfdForwardingFlags_CAPTURE)},d.prototype.getActive=function(){return this.active},d.prototype.getChildInherit=function(){return this.childInherit},d.prototype.getAdvertise=function(){return this.advertise},d.prototype.getLast=function(){return this.last},d.prototype.getCapture=function(){return this.capture},d.prototype.getLocal=function(){return this.local},d.prototype.getTap=function(){return this.tap},d.prototype.getCaptureOk=function(){return this.captureOk},d.prototype.setActive=function(a){this.active=a},d.prototype.setChildInherit=function(a){this.childInherit=a},d.prototype.setAdvertise=function(a){this.advertise=a},d.prototype.setLast=function(a){this.last=a},d.prototype.setCapture=function(a){this.capture=a},d.prototype.setLocal=function(a){this.local=a},d.prototype.setTap=function(a){this.tap=a},d.prototype.setCaptureOk=function(a){this.captureOk=a}},{}],82:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./util/signed-blob.js").SignedBlob,f=a("./name.js").Name,g=a("./exclude.js").Exclude,h=(a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,a("./key-locator.js").KeyLocator),i=a("./encoding/wire-format.js").WireFormat,j=function l(a,c,d,i,j,k,m,n,o,p){if("object"==typeof a&&a instanceof l){var q=a;q.name&&(this.name=new f(q.name)),this.maxSuffixComponents=q.maxSuffixComponents,this.minSuffixComponents=q.minSuffixComponents,this.publisherPublicKeyDigest=q.publisherPublicKeyDigest,this.keyLocator=new h(q.keyLocator),this.exclude=new g(q.exclude),this.childSelector=q.childSelector,this.answerOriginKind=q.answerOriginKind,this.scope=q.scope,this.interestLifetime=q.interestLifetime,q.nonce&&(this.nonce=new b(q.nonce))}else this.name="object"==typeof a&&a instanceof f?new f(a):new f,this.maxSuffixComponents=d,this.minSuffixComponents=c,this.publisherPublicKeyDigest=i,this.keyLocator=new h,this.exclude="object"==typeof j&&j instanceof g?new g(j):new g,this.childSelector=k,this.answerOriginKind=m,this.scope=n,this.interestLifetime=o,p&&(this.nonce=new b(p));this.wireEncoding=new e};c.Interest=j,j.RECURSIVE_POSTFIX="*",j.CHILD_SELECTOR_LEFT=0,j.CHILD_SELECTOR_RIGHT=1,j.ANSWER_NO_CONTENT_STORE=0,j.ANSWER_CONTENT_STORE=1,j.ANSWER_GENERATED=2,j.ANSWER_STALE=4,j.MARK_STALE=16,j.DEFAULT_ANSWER_ORIGIN_KIND=j.ANSWER_CONTENT_STORE|j.ANSWER_GENERATED,j.prototype.matchesName=function(a){return this.name.match(a)&&(null==this.minSuffixComponents||a.size()+1-this.name.size()>=this.minSuffixComponents)&&(null==this.maxSuffixComponents||a.size()+1-this.name.size()<=this.maxSuffixComponents)?null!=this.exclude&&a.size()>this.name.size()&&this.exclude.matches(a.get(this.name.size()))?!1:!0:!1},j.prototype.matches_name=function(a){return this.matchesName(a)},j.prototype.clone=function(){return new j(this.name,this.minSuffixComponents,this.maxSuffixComponents,this.publisherPublicKeyDigest,this.exclude,this.childSelector,this.answerOriginKind,this.scope,this.interestLifetime,this.nonce)},j.prototype.getName=function(){return this.name},j.prototype.getMinSuffixComponents=function(){return this.minSuffixComponents},j.prototype.getMaxSuffixComponents=function(){return this.maxSuffixComponents},j.prototype.getKeyLocator=function(){return this.keyLocator},j.prototype.getExclude=function(){return this.exclude},j.prototype.getChildSelector=function(){return this.childSelector},j.prototype.getAnswerOriginKind=function(){return this.answerOriginKind},j.prototype.getMustBeFresh=function(){return null==this.answerOriginKind||this.answerOriginKind<0?!0:0==(this.answerOriginKind&j.ANSWER_STALE)},j.prototype.getNonce=function(){return new d(this.nonce,!1)},j.prototype.getNonceAsBuffer=function(){return this.nonce},j.prototype.getScope=function(){return this.scope},j.prototype.getInterestLifetimeMilliseconds=function(){return this.interestLifetime},j.prototype.setName=function(a){this.nonce=null,this.wireEncoding=new e,this.name="object"==typeof a&&a instanceof f?new f(a):new f},j.prototype.setMinSuffixComponents=function(a){this.nonce=null,this.wireEncoding=new e,this.minSuffixComponents=a},j.prototype.setMaxSuffixComponents=function(a){this.nonce=null,this.wireEncoding=new e,this.maxSuffixComponents=a},j.prototype.setExclude=function(a){this.nonce=null,this.wireEncoding=new e,this.exclude="object"==typeof a&&a instanceof g?new g(a):new g},j.prototype.setChildSelector=function(a){this.nonce=null,this.wireEncoding=new e,this.childSelector=a},j.prototype.setAnswerOriginKind=function(a){this.nonce=null,this.wireEncoding=new e,this.answerOriginKind=a},j.prototype.setMustBeFresh=function(a){this.nonce=null,this.wireEncoding=new e,null==this.answerOriginKind||this.answerOriginKind<0?a||(this.answerOriginKind=j.ANSWER_STALE):a?this.answerOriginKind&=~j.ANSWER_STALE:this.answerOriginKind|=j.ANSWER_STALE},j.prototype.setScope=function(a){this.nonce=null,this.wireEncoding=new e,this.scope=a},j.prototype.setInterestLifetimeMilliseconds=function(a){this.nonce=null,this.wireEncoding=new e,this.interestLifetime=a},j.prototype.setNonce=function(a){this.wireEncoding=new e,this.nonce=a?"object"==typeof a&&a instanceof d?a.buf():new b(a):null},j.prototype.toUri=function(){var a="";null!=this.minSuffixComponents&&(a+="&ndn.MinSuffixComponents="+this.minSuffixComponents),null!=this.maxSuffixComponents&&(a+="&ndn.MaxSuffixComponents="+this.maxSuffixComponents),null!=this.childSelector&&(a+="&ndn.ChildSelector="+this.childSelector),null!=this.answerOriginKind&&(a+="&ndn.AnswerOriginKind="+this.answerOriginKind),null!=this.scope&&(a+="&ndn.Scope="+this.scope),null!=this.interestLifetime&&(a+="&ndn.InterestLifetime="+this.interestLifetime),null!=this.publisherPublicKeyDigest&&(a+="&ndn.PublisherPublicKeyDigest="+f.toEscapedString(this.publisherPublicKeyDigest.publisherPublicKeyDigest)),null!=this.nonce&&(a+="&ndn.Nonce="+f.toEscapedString(this.nonce)),null!=this.exclude&&this.exclude.size()>0&&(a+="&ndn.Exclude="+this.exclude.toUri());var b=this.name.toUri();return""!=a&&(b+="?"+a.substr(1)),b},j.prototype.wireEncode=function(a){a=a||i.getDefaultWireFormat();var b=a.encodeInterest(this);return this.wireEncoding=new e(b.encoding,b.signedPortionBeginOffset,b.signedPortionEndOffset),this.wireEncoding},j.prototype.wireDecode=function(a,b){b=b||i.getDefaultWireFormat();var c="object"==typeof a&&a instanceof d?a.buf():a,f=b.decodeInterest(this,c);this.wireEncoding=new e(new d(a,!0),f.signedPortionBeginOffset,f.signedPortionEndOffset)};var k=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat;j.prototype.from_ndnb=function(a){k.decodeInterest(this,a)},j.prototype.to_ndnb=function(a){k.encodeInterest(this,a)},j.prototype.encode=function(){return this.wireEncode(k.get()).buf()},j.prototype.decode=function(a){this.wireDecode(a,k.get())}}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-wire-format.js":64,"./encoding/wire-format.js":76,"./exclude.js":77,"./key-locator.js":83,"./name.js":87,"./publisher-public-key-digest.js":89,"./util/blob.js":112,"./util/signed-blob.js":119,buffer:11}],83:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./name.js").Name,f=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,g=a("./publisher-id.js").PublisherID,h=a("./log.js").Log.LOG,i={KEYNAME:1,KEY_LOCATOR_DIGEST:2,KEY:3,CERTIFICATE:4};c.KeyLocatorType=i;var j=function l(a,c){"object"==typeof a&&a instanceof l?(this.type=a.type,this.keyName=new k,null!=a.keyName&&(this.keyName.contentName=null==a.keyName.contentName?null:new e(a.keyName.contentName),this.keyName.publisherID=a.keyName.publisherID),this.keyData=null==a.keyData?null:new b(a.keyData),this.publicKey=null==a.publicKey?null:new b(a.publicKey),this.certificate=null==a.certificate?null:new b(a.certificate)):(this.type=c,this.keyName=new k,c==i.KEYNAME?this.keyName=a:c==i.KEY_LOCATOR_DIGEST?this.keyData=new b(a):c==i.KEY?(this.keyData=new b(a),this.publicKey=this.keyData):c==i.CERTIFICATE&&(this.keyData=new b(a),this.certificate=this.keyData))};c.KeyLocator=j,j.prototype.getType=function(){return this.type},j.prototype.getKeyName=function(){return null==this.keyName&&(this.keyName=new k),null==this.keyName.contentName&&(this.keyName.contentName=new e),this.keyName.contentName},j.prototype.getKeyData=function(){return new d(this.getKeyDataAsBuffer(),!1)},j.prototype.getKeyDataAsBuffer=function(){return this.type==i.KEY?this.publicKey:this.type==i.CERTIFICATE?this.certificate:this.keyData},j.prototype.setType=function(a){this.type=a},j.prototype.setKeyName=function(a){null==this.keyName&&(this.keyName=new k),this.keyName.contentName="object"==typeof a&&a instanceof e?new e(a):new e},j.prototype.setKeyData=function(a){var c=a;null!=c&&(c=new b("object"==typeof c&&c instanceof d?c.buf():c)),this.keyData=c,this.publicKey=c,this.certificate=c},j.prototype.clear=function(){this.type=null,this.keyName=null,this.keyData=null,this.publicKey=null,this.certificate=null},j.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(f.Key)){try{var b=a.readBinaryDTagElement(f.Key);this.publicKey=b,this.type=i.KEY,h>4&&console.log("PUBLIC KEY FOUND: "+this.publicKey)}catch(c){throw new Error("Cannot parse key: ",c)}if(null==this.publicKey)throw new Error("Cannot parse key: ")}else if(a.peekDTag(f.Certificate)){try{var d=a.readBinaryDTagElement(f.Certificate);this.certificate=d,this.type=i.CERTIFICATE,h>4&&console.log("CERTIFICATE FOUND: "+this.certificate)}catch(c){throw new Error("Cannot decode certificate: "+c)}if(null==this.certificate)throw new Error("Cannot parse certificate! ")}else this.type=i.KEYNAME,this.keyName=new k,this.keyName.from_ndnb(a);a.readElementClose()},j.prototype.to_ndnb=function(a){if(h>4&&console.log("type is is "+this.type),this.type!=i.KEY_LOCATOR_DIGEST){if(a.writeElementStartDTag(this.getElementLabel()),this.type==i.KEY)h>5&&console.log("About to encode a public key"+this.publicKey),a.writeDTagElement(f.Key,this.publicKey);else if(this.type==i.CERTIFICATE)try{a.writeDTagElement(f.Certificate,this.certificate)}catch(b){throw new Error("CertificateEncodingException attempting to write key locator: "+b)}else this.type==i.KEYNAME&&this.keyName.to_ndnb(a);a.writeElementClose()}},j.prototype.getElementLabel=function(){return f.KeyLocator};var k=function(){this.contentName=new e,this.publisherID=this.publisherID};c.KeyName=k,k.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),this.contentName=new e,this.contentName.from_ndnb(a),h>4&&console.log("KEY NAME FOUND: "),g.peek(a)&&(this.publisherID=new g,this.publisherID.from_ndnb(a)),a.readElementClose()},k.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),this.contentName.to_ndnb(a),null!=this.publisherID&&this.publisherID.to_ndnb(a),a.writeElementClose()},k.prototype.getElementLabel=function(){return f.KeyName}}).call(this,a("buffer").Buffer)},{"./log.js":85,"./name.js":87,"./publisher-id.js":88,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117,buffer:11}],84:[function(a,b,c){(function(b){var d=a("./encoding/data-utils.js").DataUtils,e=a("./log.js").Log.LOG,f=function(){this.publicKeyDer=null,this.publicKeyDigest=null,this.publicKeyPem=null,this.privateKeyPem=null};c.Key=f,f.prototype.publicToDER=function(){return this.publicKeyDer},f.prototype.privateToDER=function(){var a=this.privateKeyPem.split("\n");priKey="";for(var c=1;c<a.length-1;c++)priKey+=a[c];return new b(priKey,"base64")},f.prototype.publicToPEM=function(){return this.publicKeyPem},f.prototype.privateToPEM=function(){return this.privateKeyPem},f.prototype.getKeyID=function(){return this.publicKeyDigest},c.Key=f,f.prototype.readDerPublicKey=function(c){e>4&&console.log("Encode DER public key:\n"+c.toString("hex")),this.publicKeyDer=c;var f=a("crypto").createHash("sha256");f.update(this.publicKeyDer),this.publicKeyDigest=new b(d.toNumbersIfString(f.digest()));for(var g=c.toString("base64"),h="-----BEGIN PUBLIC KEY-----\n",i=0;i<g.length;i+=64)h+=g.substr(i,64)+"\n";h+="-----END PUBLIC KEY-----",this.publicKeyPem=h,e>4&&console.log("Convert public key to PEM format:\n"+this.publicKeyPem)},f.prototype.fromPemString=function(c,f){if(null==c&&null==f)throw new Error("Cannot create Key object if both public and private PEM string is empty.");if(null!=c){this.publicKeyPem=c,e>4&&console.log("Key.publicKeyPem: \n"+this.publicKeyPem);var g=c.split("\n");c="";for(var h=1;h<g.length-1;h++)c+=g[h];this.publicKeyDer=new b(c,"base64"),e>4&&console.log("Key.publicKeyDer: \n"+this.publicKeyDer.toString("hex"));var i=a("crypto").createHash("sha256");i.update(this.publicKeyDer),this.publicKeyDigest=new b(d.toNumbersIfString(i.digest())),e>4&&console.log("Key.publicKeyDigest: \n"+this.publicKeyDigest.toString("hex"))}null!=f&&(this.privateKeyPem=f,e>4&&console.log("Key.privateKeyPem: \n"+this.privateKeyPem))},f.prototype.fromPem=f.prototype.fromPemString,f.createFromPEM=function(a){var b=new f;return b.fromPemString(a.pub,a.pri),b}}).call(this,a("buffer").Buffer)},{"./encoding/data-utils.js":65,"./log.js":85,buffer:11,crypto:18}],85:[function(a,b,c){var d=function(){};c.Log=d,d.LOG=0},{}],86:[function(a,b,c){(function(b){var d=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/blob.js").Blob),e=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("./key-locator.js").KeyLocator,g=a("./key-locator.js").KeyLocatorType,h=a("./name.js").Name,i=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,j=a("./util/ndn-time.js").NDNTime,k=a("./security/key-manager.js").globalKeyManager,l=a("./log.js").Log.LOG,m={BLOB:0,DATA:0,LINK:1,KEY:2,ENCR:3,GONE:4,NACK:5};c.ContentType=m;var n=function p(a,b,c,d,e,g,h){if("object"==typeof a&&a instanceof p){var i=a;this.publisher=i.publisher,this.timestamp=i.timestamp,this.type=i.type,this.locator=null==i.locator?new f:new f(i.locator),this.freshnessSeconds=i.freshnessSeconds,this.finalBlockID=i.finalBlockID}else this.publisher=a,this.timestamp=b,this.type=null==c||0>c?m.BLOB:c,this.locator=null==d?new f:new f(d),this.freshnessSeconds=e,this.finalBlockID=g,h||this.setFields();this.changeCount=0};c.MetaInfo=n,n.prototype.getType=function(){return this.type},n.prototype.getFreshnessPeriod=function(){return null==this.freshnessSeconds||this.freshnessSeconds<0?null:1e3*this.freshnessSeconds},n.prototype.getFinalBlockId=function(){return new h.Component(new d(this.finalBlockID,!0))},n.prototype.getFinalBlockID=function(){return this.getFinalBlockId()},n.prototype.getFinalBlockIDAsBuffer=function(){return this.finalBlockID},n.prototype.setType=function(a){this.type=null==a||0>a?m.BLOB:a,++this.changeCount},n.prototype.setFreshnessPeriod=function(a){this.freshnessSeconds=null==a||0>a?null:a/1e3,++this.changeCount},n.prototype.setFinalBlockId=function(a){this.finalBlockID=null==a?null:"object"==typeof a&&a instanceof d?a.buf():"object"==typeof a&&a instanceof h.Component?a.getValue().buf():new b(a),++this.changeCount},n.prototype.setFinalBlockID=function(a){this.setFinalBlockId(a)},n.prototype.setFields=function(){var a=k.getKey();this.publisher=new i(a.getKeyID());var b=new Date,c=b.getTime();this.timestamp=new j(c),l>4&&console.log("TIME msec is"),l>4&&console.log(this.timestamp.msec),this.type=m.BLOB,l>4&&console.log("PUBLIC KEY TO WRITE TO DATA PACKET IS "),l>4&&console.log(a.publicToDER().toString("hex")),this.locator=new f(a.getKeyID(),g.KEY_LOCATOR_DIGEST),++this.changeCount},n.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(e.PublisherPublicKeyDigest)&&(l>4&&console.log("DECODING PUBLISHER KEY"),this.publisher=new i,this.publisher.from_ndnb(a)),a.peekDTag(e.Timestamp)&&(l>4&&console.log("DECODING TIMESTAMP"),this.timestamp=a.readDateTimeDTagElement(e.Timestamp)),a.peekDTag(e.Type)){var b=a.readBinaryDTagElement(e.Type);if(l>4&&console.log("Binary Type of of Signed Info is "+b),this.type=b,null==this.type)throw new Error("Cannot parse signedInfo type: bytes.")}else this.type=m.DATA;a.peekDTag(e.FreshnessSeconds)&&(this.freshnessSeconds=a.readIntegerDTagElement(e.FreshnessSeconds),l>4&&console.log("FRESHNESS IN SECONDS IS "+this.freshnessSeconds)),a.peekDTag(e.FinalBlockID)&&(l>4&&console.log("DECODING FINAL BLOCKID"),this.finalBlockID=a.readBinaryDTagElement(e.FinalBlockID)),a.peekDTag(e.KeyLocator)&&(l>4&&console.log("DECODING KEY LOCATOR"),this.locator=new f,this.locator.from_ndnb(a)),a.readElementClose(),++this.changeCount},n.prototype.to_ndnb=function(a,b){if(!this.validate())throw new Error("Cannot encode : field values missing.");a.writeElementStartDTag(this.getElementLabel()),null!=this.publisher?(l>3&&console.log("ENCODING PUBLISHER KEY"+this.publisher.publisherPublicKeyDigest),this.publisher.to_ndnb(a)):null!=b&&b.getType()==g.KEY_LOCATOR_DIGEST&&!b.getKeyData().isNull()&&b.getKeyData().size()>0&&a.writeDTagElement(e.PublisherPublicKeyDigest,b.getKeyData().buf()),null!=this.timestamp&&a.writeDateTimeDTagElement(e.Timestamp,this.timestamp),null!=this.type&&0!=this.type&&a.writeDTagElement(e.type,this.type),null!=this.freshnessSeconds&&a.writeDTagElement(e.FreshnessSeconds,this.freshnessSeconds),null!=this.finalBlockID&&a.writeDTagElement(e.FinalBlockID,this.finalBlockID),null!=b&&b.to_ndnb(a),a.writeElementClose()},n.prototype.valueToType=function(){return null},n.prototype.getElementLabel=function(){return e.SignedInfo},n.prototype.validate=function(){return null==this.timestamp?!1:!0},n.prototype.getChangeCount=function(){return this.changeCount};var o=function(a,b,c,d,e,f){n.call(this,a,b,c,d,e,f)};o.prototype=new n(null,null,null,null,null,null,!0),c.SignedInfo=o}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":61,"./encoding/binary-xml-encoder.js":62,"./key-locator.js":83,"./log.js":85,"./name.js":87,"./publisher-public-key-digest.js":89,"./security/key-manager.js":98,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117,"./util/ndn-time.js":118,buffer:11}],87:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./encoding/data-utils.js").DataUtils,f=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),g=a("./log.js").Log.LOG,h=function k(a){if("string"==typeof a)g>3&&console.log("Content Name String "+a),this.components=k.createNameArray(a);else if("object"==typeof a)if(this.components=[],a instanceof k)this.append(a);else for(var b=0;b<a.length;++b)this.append(a[b]);else null==a?this.components=[]:g>1&&console.log("NO CONTENT NAME GIVEN");this.changeCount=0};c.Name=h,h.Component=function(a){if("string"==typeof a)this.value=e.stringToUtf8Array(a);else if("object"==typeof a&&a instanceof h.Component)this.value=new b(a.value);else if("object"==typeof a&&a instanceof d)this.value=new b(a.isNull()?0:a.buf());else if(b.isBuffer(a))this.value=new b(a);else if("object"==typeof a&&"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)this.value=new b(new Uint8Array(a));else if("object"==typeof a)this.value=new b(a);else{if(a)throw new Error("Name.Component constructor: Invalid type");this.value=new b(0)}},h.Component.prototype.getValue=function(){return new d(this.value,!1)},h.Component.prototype.getValueAsBuffer=function(){return this.value},h.Component.prototype.toEscapedString=function(){return h.toEscapedString(this.value)},h.Component.prototype.toNumber=function(){return e.bigEndianToUnsignedInt(this.value)},h.Component.prototype.toNumberWithMarker=function(a){if(0==this.value.length||this.value[0]!=a)throw new Error("Name component does not begin with the expected marker");return e.bigEndianToUnsignedInt(this.value.slice(1))},h.Component.prototype.toSegment=function(){return this.toNumberWithMarker(0)},h.Component.prototype.toSegmentOffset=function(){return this.toNumberWithMarker(251)},h.Component.prototype.toVersion=function(){return this.toNumberWithMarker(253)},h.Component.prototype.toTimestamp=function(){return this.toNumberWithMarker(252)},h.Component.prototype.toSequenceNumber=function(){return this.toNumberWithMarker(254)},h.Component.fromNumber=function(a){var b=new i(8);return b.writeNonNegativeInteger(a),new h.Component(new d(b.getOutput(),!1))},h.Component.fromNumberWithMarker=function(a,b){var c=new i(9);return c.writeNonNegativeInteger(a),c.writeNonNegativeInteger(b),new h.Component(new d(c.getOutput(),!1))},h.Component.prototype.equals=function(a){return e.arraysEqual(this.value,a.value)},h.Component.prototype.compare=function(a){return h.Component.compareBuffers(this.value,a.value)},h.Component.compareBuffers=function(a,b){if(a.length<b.length)return-1;if(a.length>b.length)return 1;for(var c=0;c<a.length;++c){if(a[c]<b[c])return-1;if(a[c]>b[c])return 1}return 0},h.prototype.getName=function(){return this.toUri()},h.createNameArray=function(a){if(a=a.trim(),a.length<=0)return[];var b=a.indexOf(":");if(b>=0){var c=a.indexOf("/");(0>c||c>b)&&(a=a.substr(b+1,a.length-b-1).trim())}if("/"==a[0])if(a.length>=2&&"/"==a[1]){var d=a.indexOf("/",2);if(0>d)return[];a=a.substr(d+1,a.length-d-1).trim()}else a=a.substr(1,a.length-1).trim();for(var e=a.split("/"),f=0;f<e.length;++f){var g=h.fromEscapedString(e[f]);g.isNull()?(e.splice(f,1),--f):e[f]=new h.Component(g)}return e},h.prototype.set=function(a){this.components=h.createNameArray(a),++this.changeCount},h.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel());var b=a.offset,c=b;for(this.components=[];a.peekDTag(f.Component);)c=a.offset,this.append(a.readBinaryDTagElement(f.Component));return a.readElementClose(),++this.changeCount,{signedPortionBeginOffset:b,signedPortionEndOffset:c}},h.prototype.to_ndnb=function(a){if(null==this.components)throw new Error("CANNOT ENCODE EMPTY CONTENT NAME");a.writeElementStartDTag(this.getElementLabel());var b,c=a.offset,d=this.size();if(0==d)b=c;else for(var e=0;d>e;e++)e==d-1&&(b=a.offset),a.writeDTagElement(f.Component,this.components[e].getValue().buf());return a.writeElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:b}},h.prototype.getElementLabel=function(){return f.Name},h.prototype.append=function(a){if("object"==typeof a&&a instanceof h){var b;b=a==this?this.components.slice(0,this.components.length):a.components;for(var c=0;c<b.length;++c)this.components.push(new h.Component(b[c]))}else this.components.push(new h.Component(a));return++this.changeCount,this},h.prototype.add=function(a){return this.append(a)},h.prototype.clear=function(){this.components=[],++this.changeCount},h.prototype.toUri=function(){if(0==this.size())return"/";for(var a="",b=0;b<this.size();++b)a+="/"+h.toEscapedString(this.components[b].getValue().buf());return a},h.prototype.to_uri=function(){return this.toUri()},h.prototype.appendSegment=function(a){return this.append(h.Component.fromNumberWithMarker(a,0))},h.prototype.appendSegmentOffset=function(a){return this.append(h.Component.fromNumberWithMarker(a,251))},h.prototype.appendVersion=function(a){return this.append(h.Component.fromNumberWithMarker(a,253))},h.prototype.appendTimestamp=function(a){return this.append(h.Component.fromNumberWithMarker(a,252))},h.prototype.appendSequenceNumber=function(a){return this.append(h.Component.fromNumberWithMarker(a,254))},h.prototype.addSegment=function(a){return this.appendSegment(a)},h.prototype.getSubName=function(a,b){0>a&&(a=this.components.length- -a),void 0==b&&(b=this.components.length-a);for(var c=new h,d=a+b,e=a;d>e&&e<this.components.length;++e)c.components.push(this.components[e]);return c},h.prototype.getPrefix=function(a){return 0>a?this.getSubName(0,this.components.length+a):this.getSubName(0,a)},h.prototype.cut=function(a){return new h(this.components.slice(0,this.components.length-a))},h.prototype.size=function(){return this.components.length},h.prototype.get=function(a){if(a>=0){if(a>=this.components.length)throw new Error("Name.get: Index is out of bounds");return new h.Component(this.components[a])}if(a<-this.components.length)throw new Error("Name.get: Index is out of bounds");return new h.Component(this.components[this.components.length- -a])},h.prototype.getComponentCount=function(){return this.components.length},h.prototype.getComponent=function(a){return new b(this.components[a].getValue().buf())},h.prototype.indexOfFileName=function(){for(var a=this.size()-1;a>=0;--a){var b=this.components[a].getValue().buf();if(!(b.length<=0||0==b[0]||192==b[0]||193==b[0]||b[0]>=245&&b[0]<=255))return a}return-1},h.prototype.wireEncode=function(a){return a=a||j.getDefaultWireFormat(),a.encodeName(this)},h.prototype.wireDecode=function(a,b){b=b||j.getDefaultWireFormat();var c="object"==typeof a&&a instanceof d?a.buf():a;b.decodeName(this,c)},h.prototype.compare=function(a){for(var b=0;b<this.size()&&b<a.size();++b){var c=this.components[b].compare(a.components[b]);if(0!=c)return c}return this.size()<a.size()?-1:this.size()>a.size()?1:0},h.prototype.equals=function(a){if(this.components.length!=a.components.length)return!1;for(var b=this.components.length-1;b>=0;--b)if(!this.components[b].equals(a.components[b]))return!1;return!0},h.prototype.equalsName=function(a){return this.equals(a)},h.prototype.getContentDigestValue=function(){for(var a=this.size()-1;a>=0;--a){var b=h.getComponentContentDigestValue(this.components[a]);if(null!=b)return b}return null},h.getComponentContentDigestValue=function(a){"object"==typeof a&&a instanceof h.Component&&(a=a.getValue().buf());var b=h.ContentDigestPrefix.length+32+h.ContentDigestSuffix.length;return a.length==b&&e.arraysEqual(a.slice(0,h.ContentDigestPrefix.length),h.ContentDigestPrefix)&&e.arraysEqual(a.slice(a.length-h.ContentDigestSuffix.length,a.length),h.ContentDigestSuffix)?a.slice(h.ContentDigestPrefix.length,h.ContentDigestPrefix.length+32):null},h.ContentDigestPrefix=new b([193,46,77,46,71,193,1,170,2,133]),h.ContentDigestSuffix=new b([0]),h.toEscapedString=function(a){"object"==typeof a&&a instanceof h.Component?a=a.getValue().buf():"object"==typeof a&&a instanceof d&&(a=a.buf());for(var b="",c=!1,e=0;e<a.length;++e)if(46!=a[e]){c=!0;break}if(c)for(var e=0;e<a.length;++e){var f=a[e];b+=f>=48&&57>=f||f>=65&&90>=f||f>=97&&122>=f||43==f||45==f||46==f||95==f?String.fromCharCode(f):"%"+(16>f?"0":"")+f.toString(16).toUpperCase()}else{b="...";for(var e=0;e<a.length;++e)b+="."}return b},h.fromEscapedString=function(a){var b=unescape(a.trim());return null==b.match(/[^.]/)?b.length<=2?new d:new d(e.toNumbersFromString(b.substr(3,b.length-3)),!1):new d(e.toNumbersFromString(b),!1)},h.fromEscapedStringAsBuffer=function(a){return h.fromEscapedString(a).buf()},h.prototype.match=function(a){var b=this.components,c=a.components;if(b.length>c.length)return!1;for(var d=0;d<b.length;++d)if(!b[d].equals(c[d]))return!1;return!0},h.prototype.getChangeCount=function(){return this.changeCount};var i=a("./encoding/tlv/tlv-encoder.js").TlvEncoder,j=a("./encoding/wire-format.js").WireFormat}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":61,"./encoding/binary-xml-encoder.js":62,"./encoding/data-utils.js":65,"./encoding/tlv/tlv-encoder.js":73,"./encoding/wire-format.js":76,"./log.js":85,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117,buffer:11}],88:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=(a("./util/ndn-protoco-id-tags.js").NDNProtocolDTagsStrings,a("./encoding/decoding-exception.js").DecodingException),f=function(a){this.KEY=d.PublisherPublicKeyDigest,this.CERTIFICATE=d.PublisherCertificateDigest,this.ISSUER_KEY=d.PublisherIssuerKeyDigest,this.ISSUER_CERTIFICATE=d.PublisherIssuerCertificateDigest,this.Tag=a},g=function(){this.PUBLISHER_ID_DIGEST_ALGORITHM="SHA-256",this.PUBLISHER_ID_LEN=32,this.publisherID=null,this.publisherType=null,this.changeCount=0};c.PublisherID=g,g.prototype.from_ndnb=function(a){var b=g.peekAndGetNextDTag(a);if(this.publisherType=new f(b),0>b)throw new Error("Invalid publisher ID, got unexpected type");if(this.publisherID=a.readBinaryDTagElement(b),null==this.publisherID)throw new e(new Error("Cannot parse publisher ID of type : "+b+"."));++this.changeCount},g.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode "+this.getClass().getName()+": field values missing.");a.writeDTagElement(this.getElementLabel(),this.publisherID)},g.peekAndGetNextDTag=function(a){return a.peekDTag(d.PublisherPublicKeyDigest)?d.PublisherPublicKeyDigest:a.peekDTag(d.PublisherCertificateDigest)?d.PublisherCertificateDigest:a.peekDTag(d.PublisherIssuerKeyDigest)?d.PublisherIssuerKeyDigest:a.peekDTag(d.PublisherIssuerCertificateDigest)?d.PublisherIssuerCertificateDigest:-1},g.peek=function(a){return g.peekAndGetNextDTag(a)>=0},g.prototype.getElementLabel=function(){return this.publisherType.Tag},g.prototype.validate=function(){return null!=id()&&null!=type()},g.prototype.getChangeCount=function(){return this.changeCount}},{"./encoding/decoding-exception.js":66,"./util/ndn-protoco-id-tags.js":117}],89:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("./log.js").Log.LOG,f=function(a){this.PUBLISHER_ID_LEN=64,this.publisherPublicKeyDigest=a,this.changeCount=0
};c.PublisherPublicKeyDigest=f,f.prototype.from_ndnb=function(a){if(this.publisherPublicKeyDigest=a.readBinaryDTagElement(this.getElementLabel()),e>4&&console.log("Publisher public key digest is "+this.publisherPublicKeyDigest),null==this.publisherPublicKeyDigest)throw new Error("Cannot parse publisher key digest.");this.publisherPublicKeyDigest.length!=this.PUBLISHER_ID_LEN&&e>0&&console.log("LENGTH OF PUBLISHER ID IS WRONG! Expected "+this.PUBLISHER_ID_LEN+", got "+this.publisherPublicKeyDigest.length),++this.changeCount},f.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode : field values missing.");e>3&&console.log("PUBLISHER KEY DIGEST IS"+this.publisherPublicKeyDigest),a.writeDTagElement(this.getElementLabel(),this.publisherPublicKeyDigest)},f.prototype.getElementLabel=function(){return d.PublisherPublicKeyDigest},f.prototype.validate=function(){return null!=this.publisherPublicKeyDigest},f.prototype.getChangeCount=function(){return this.changeCount}},{"./log.js":85,"./util/ndn-protoco-id-tags.js":117}],90:[function(a,b,c){var d=function(){};c.IdentityCertificate=d,d.certificateNameToPublicKeyName=function(a){for(var b=a.size()-1,c="ID-CERT";b>=0&&a.get(b).toEscapedString()!=c;)b-=1;for(var d=a.getSubName(0,b),e="KEY",b=0;b<d.size()&&d.get(b).toEscapedString()!=e;++b);return d.getSubName(0,b).append(d.getSubName(b+1,d.size()-b-1))}},{}],91:[function(a,b,c){var d=a("../security-exception.js").SecurityException,e=a("../security-types.js").KeyType,f=function(a,b){this.keyType=a,this.keyDer=b};c.PublicKey=f,f.prototype.toDer=function(){throw new Error("PublicKey.toDer is not implemented")},f.fromDer=function(a,b){if(a!=e.RSA)throw new d(new Error("PublicKey::fromDer: Unrecognized keyType"));return new f(a,b)},f.prototype.getDigest=function(){throw new Error("PublicKey.getDigest is not implemented")},f.prototype.getKeyType=function(){return this.keyType},f.prototype.getKeyDer=function(){return this.keyDer}},{"../security-exception.js":103,"../security-types.js":104}],92:[function(a,b,c){(function(b){var d=a("../../name.js").Name,e=a("../../data.js").Data,f=a("../../sha256-with-rsa-signature.js").Sha256WithRsaSignature,g=a("../../key-locator.js").KeyLocatorType,h=a("../../encoding/wire-format.js").WireFormat,i=a("../security-exception.js").SecurityException,j=function(a,b){this.identityStorage=a,this.privateKeyStorage=b};c.IdentityManager=j,j.prototype.createIdentity=function(){throw new Error("IdentityManager.createIdentity is not implemented")},j.prototype.getDefaultIdentity=function(){return this.identityStorage.getDefaultIdentity()},j.prototype.generateRSAKeyPair=function(){throw new Error("IdentityManager.generateRSAKeyPair is not implemented")},j.prototype.setDefaultKeyForIdentity=function(a,b){null==b&&(b=new d),this.identityStorage.setDefaultKeyNameForIdentity(a,b)},j.prototype.getDefaultKeyNameForIdentity=function(a){return this.identityStorage.getDefaultKeyNameForIdentity(a)},j.prototype.generateRSAKeyPairAsDefault=function(){throw new Error("IdentityManager.generateRSAKeyPairAsDefault is not implemented")},j.prototype.getPublicKey=function(a){return PublicKey.fromDer(this.identityStorage.getKeyType(a),this.identityStorage.getKey(a))},j.prototype.addCertificate=function(a){this.identityStorage.addCertificate(a)},j.prototype.setDefaultCertificateForKey=function(a){var b=a.getPublicKeyName();if(!this.identityStorage.doesKeyExist(b))throw new i(new Error("No corresponding Key record for certificate!"));this.identityStorage.setDefaultCertificateNameForKey(b,a.getName())},j.prototype.addCertificateAsIdentityDefault=function(a){this.identityStorage.addCertificate(a);var b=a.getPublicKeyName();this.setDefaultKeyForIdentity(b),this.setDefaultCertificateForKey(a)},j.prototype.addCertificateAsDefault=function(a){this.identityStorage.addCertificate(a),this.setDefaultCertificateForKey(a)},j.prototype.getCertificate=function(a){return new IdentityCertificate(this.identityStorage.getCertificate(a,!1))},j.prototype.getAnyCertificate=function(a){return new IdentityCertificate(this.identityStorage.getCertificate(a,!0))},j.prototype.getDefaultCertificateNameForIdentity=function(a){return this.identityStorage.getDefaultCertificateNameForIdentity(a)},j.prototype.getDefaultCertificateName=function(){return this.identityStorage.getDefaultCertificateNameForIdentity(this.getDefaultIdentity())},j.prototype.signByCertificate=function(a,c,d){if(d=d||h.getDefaultWireFormat(),!(a instanceof e)){var i=j.certificateNameToPublicKeyName(c),k=new f;return k.getKeyLocator().setType(g.KEYNAME),k.getKeyLocator().setKeyName(c.getPrefix(-1)),k.setSignature(this.privateKeyStorage.sign(a,i)),k}var l=a,i=j.certificateNameToPublicKeyName(c);l.setSignature(new f);var k=l.getSignature();k.getKeyLocator().setType(g.KEYNAME),k.getKeyLocator().setKeyName(c.getPrefix(-1)),k.setSignature(new b(1));var m=l.wireEncode(d);k.setSignature(this.privateKeyStorage.sign(m.signedBuf(),i)),l.wireEncode(d)},j.prototype.selfSign=function(){throw new Error("IdentityManager.selfSign is not implemented")},j.certificateNameToPublicKeyName=function(a){for(var b=a.size()-1,c="ID-CERT";b>=0&&a.get(b).toEscapedString()!=c;)--b;var d=a.getSubName(0,b),e="KEY";for(b=0;b<d.size()&&d.get(b).toEscapedString()!=e;)++b;return d.getSubName(0,b).append(d.getSubName(b+1,d.size()-b-1))}}).call(this,a("buffer").Buffer)},{"../../data.js":60,"../../encoding/wire-format.js":76,"../../key-locator.js":83,"../../name.js":87,"../../sha256-with-rsa-signature.js":105,"../security-exception.js":103,buffer:11}],93:[function(a,b,c){var d=a("../../name.js").Name,e=a("../security-exception.js").SecurityException,f=function(){};c.IdentityStorage=f,f.prototype.doesIdentityExist=function(){throw new Error("IdentityStorage.doesIdentityExist is not implemented")},f.prototype.addIdentity=function(){throw new Error("IdentityStorage.addIdentity is not implemented")},f.prototype.revokeIdentity=function(){throw new Error("IdentityStorage.revokeIdentity is not implemented")},f.prototype.getNewKeyName=function(a,b){var c,f=(new Date).getTime(),g=""+Math.floor(f/1e3);c=b?"KSK-"+g:"DSK-"+g;var h=new d(a).append(c);if(this.doesKeyExist(h))throw new e(new Error("Key name already exists"));return h},f.prototype.doesKeyExist=function(){throw new Error("IdentityStorage.doesKeyExist is not implemented")},f.prototype.addKey=function(){throw new Error("IdentityStorage.addKey is not implemented")},f.prototype.getKey=function(){throw new Error("IdentityStorage.getKey is not implemented")},f.prototype.getKeyType=function(){throw new Error("IdentityStorage.getKeyType is not implemented")},f.prototype.activateKey=function(){throw new Error("IdentityStorage.activateKey is not implemented")},f.prototype.deactivateKey=function(){throw new Error("IdentityStorage.deactivateKey is not implemented")},f.prototype.doesCertificateExist=function(){throw new Error("IdentityStorage.doesCertificateExist is not implemented")},f.prototype.addCertificate=function(){throw new Error("IdentityStorage.addCertificate is not implemented")},f.prototype.getCertificate=function(){throw new Error("IdentityStorage.getCertificate is not implemented")},f.prototype.getDefaultIdentity=function(){throw new Error("IdentityStorage.getDefaultIdentity is not implemented")},f.prototype.getDefaultKeyNameForIdentity=function(){throw new Error("IdentityStorage.getDefaultKeyNameForIdentity is not implemented")},f.prototype.getDefaultCertificateNameForIdentity=function(a){var b=this.getDefaultKeyNameForIdentity(a);return this.getDefaultCertificateNameForKey(b)},f.prototype.getDefaultCertificateNameForKey=function(){throw new Error("IdentityStorage.getDefaultCertificateNameForKey is not implemented")},f.prototype.setDefaultIdentity=function(){throw new Error("IdentityStorage.setDefaultIdentity is not implemented")},f.prototype.setDefaultKeyNameForIdentity=function(){throw new Error("IdentityStorage.setDefaultKeyNameForIdentity is not implemented")},f.prototype.setDefaultCertificateNameForKey=function(){throw new Error("IdentityStorage.setDefaultCertificateNameForKey is not implemented")}},{"../../name.js":87,"../security-exception.js":103}],94:[function(a,b,c){var d=a("../../data.js").Data,e=a("../../name.js").Name,f=a("../../util/blob.js").Blob,g=(a("../security-types.js").KeyType,a("../../encoding/data-utils.js").DataUtils),h=a("../security-exception.js").SecurityException,i=a("./identity-storage.js").IdentityStorage,j=function(){i.call(this),this.identityStore=[],this.defaultIdentity="",this.keyStore={},this.certificateStore={}};j.prototype=new i,j.prototype.name="MemoryIdentityStorage",c.MemoryIdentityStorage=j,j.prototype.doesIdentityExist=function(a){return void 0!==this.identityStore[a.toUri()]},j.prototype.addIdentity=function(a){var b=a.toUri();if(this.identityStore.indexOf(b)>=0)throw new h(new Error("Identity already exists: "+b));this.identityStore.push(b)},j.prototype.revokeIdentity=function(){throw new Error("MemoryIdentityStorage.revokeIdentity is not implemented")},j.prototype.doesKeyExist=function(a){return void 0!==this.keyStore[a.toUri()]},j.prototype.addKey=function(a,b,c){var d=a.getSubName(0,a.size()-1);if(this.doesIdentityExist(d)||this.addIdentity(d),this.doesKeyExist(a))throw new h(new Error("A key with the same name already exists!"));this.keyStore[a.toUri()]={keyType:b,keyDer:new f(c)}},j.prototype.getKey=function(a){var b=a.toUri(),c=this.keyStore[b];return void 0===c?new f:c.keyDer},j.prototype.getKeyType=function(a){var b=a.toUri(),c=this.keyStore[b];if(void 0===c)throw new h(new Error("Cannot get public key type because the keyName doesn't exist"));return c.keyType},j.prototype.activateKey=function(){throw new Error("MemoryIdentityStorage.activateKey is not implemented")},j.prototype.deactivateKey=function(){throw new Error("MemoryIdentityStorage.deactivateKey is not implemented")},j.prototype.doesCertificateExist=function(a){return void 0!==this.certificateStore[a.toUri()]},j.prototype.addCertificate=function(a){var b=a.getName(),c=a.getPublicKeyName();if(!this.doesKeyExist(c))throw new h(new Error("No corresponding Key record for certificate! "+c.toUri()+" "+b.toUri()));if(this.doesCertificateExist(b))throw new h(new Error("Certificate has already been installed!"));var d=getKey(c);if(d.isNull()||!g.arraysEqual(d.buf(),a.getPublicKeyInfo().getKeyDer().buf()))throw new h(new Error("The certificate does not match the public key!"));this.certificateStore[b.toUri()]=a.wireEncode()},j.prototype.getCertificate=function(a){var b=a.toUri();if(void 0===this.certificateStore[b])return null;var c=new d;return c.wireDecode(this.certificateStore[b]),c},j.prototype.getDefaultIdentity=function(){if(0===this.defaultIdentity.length)throw new h(new Error("MemoryIdentityStorage.getDefaultIdentity: The default identity is not defined"));return new e(this.defaultIdentity)},j.prototype.getDefaultKeyNameForIdentity=function(){throw new Error("MemoryIdentityStorage.getDefaultKeyNameForIdentity is not implemented")},j.prototype.getDefaultCertificateNameForKey=function(){throw new Error("MemoryIdentityStorage.getDefaultCertificateNameForKey is not implemented")},j.prototype.setDefaultIdentity=function(a){var b=a.toUri();this.defaultIdentity=void 0!==this.identityStore[b]?b:""},j.prototype.setDefaultKeyNameForIdentity=function(){throw new Error("MemoryIdentityStorage.setDefaultKeyNameForIdentity is not implemented")},j.prototype.setDefaultCertificateNameForKey=function(){throw new Error("MemoryIdentityStorage.setDefaultCertificateNameForKey is not implemented")}},{"../../data.js":60,"../../encoding/data-utils.js":65,"../../name.js":87,"../../util/blob.js":112,"../security-exception.js":103,"../security-types.js":104,"./identity-storage.js":93}],95:[function(a,b,c){(function(b){var d=a("../../util/blob.js").Blob,e=a("../security-exception.js").SecurityException,f=a("../certificate/public-key.js").PublicKey,g=a("../security-types.js").KeyClass,h=a("../security-types.js").DigestAlgorithm,i=a("../../encoding/data-utils.js").DataUtils,j=a("./private-key-storage.js").PrivateKeyStorage,k=function(){j.call(this),this.publicKeyStore={},this.privateKeyStore={}};k.prototype=new j,k.prototype.name="MemoryPrivateKeyStorage",c.MemoryPrivateKeyStorage=k,k.prototype.setPublicKeyForKeyName=function(a,b,c){this.publicKeyStore[a.toUri()]=f.fromDer(b,new d(c,!0))},k.prototype.setPrivateKeyForKeyName=function(a,b,c){for(var d=c.toString("base64"),e="-----BEGIN RSA PRIVATE KEY-----\n",f=0;f<d.length;f+=64)e+=d.substr(f,64)+"\n";e+="-----END RSA PRIVATE KEY-----",this.privateKeyStore[a.toUri()]={keyType:b,privateKey:e}},k.prototype.setKeyPairForKeyName=function(a,b,c,d){this.setPublicKeyForKeyName(a,b,c),this.setPrivateKeyForKeyName(a,b,d)},k.prototype.getPublicKey=function(a){var b=a.toUri(),c=this.publicKeyStore[b];if(void 0===c)throw new e(new Error("MemoryPrivateKeyStorage: Cannot find public key "+a.toUri()));return c},k.prototype.sign=function(c,f,g){if(null==g&&(g=h.SHA256),g!=h.SHA256)return new d;var j=f.toUri(),k=this.privateKeyStore[j];if(void 0===k)throw new e(new Error("MemoryPrivateKeyStorage: Cannot find private key "+j));var l=a("crypto").createSign("RSA-SHA256");l.update(c);var m=new b(i.toNumbersIfString(l.sign(k.privateKey)));return new d(m,!1)},k.prototype.doesKeyExist=function(a,b){var c=a.toUri();return b==g.PUBLIC?void 0!==this.publicKeyStore[c]:b==g.PRIVATE?void 0!==this.privateKeyStore[c]:!1}}).call(this,a("buffer").Buffer)},{"../../encoding/data-utils.js":65,"../../util/blob.js":112,"../certificate/public-key.js":91,"../security-exception.js":103,"../security-types.js":104,"./private-key-storage.js":96,buffer:11,crypto:18}],96:[function(a,b,c){var d=function(){};c.PrivateKeyStorage=d,d.prototype.generateKeyPair=function(){throw new Error("PrivateKeyStorage.generateKeyPair is not implemented")},d.prototype.getPublicKey=function(){throw new Error("PrivateKeyStorage.getPublicKey is not implemented")},d.prototype.sign=function(){throw new Error("PrivateKeyStorage.sign is not implemented")},d.prototype.decrypt=function(){throw new Error("PrivateKeyStorage.decrypt is not implemented")},d.prototype.encrypt=function(){throw new Error("PrivateKeyStorage.encrypt is not implemented")},d.prototype.generateKey=function(){throw new Error("PrivateKeyStorage.generateKey is not implemented")},d.prototype.doesKeyExist=function(){throw new Error("PrivateKeyStorage.doesKeyExist is not implemented")}},{}],97:[function(a,b,c){var d=a("../name.js").Name,e=a("../interest.js").Interest,f=a("../data.js").Data,g=a("../key-locator.js").KeyLocatorType,h=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,i=a("../encoding/wire-format.js").WireFormat,j=a("../encoding/tlv/tlv.js").Tlv,k=a("../encoding/tlv/tlv-encoder.js").TlvEncoder,l=a("./security-exception.js").SecurityException,m=function(a,b){this.identityManager=a,this.policyManager=b,this.encryptionManager=null,this.face=null,this.maxSteps=100};c.KeyChain=m,m.prototype.createIdentity=function(a){return this.identityManager.createIdentity(a)},m.prototype.getDefaultIdentity=function(){return this.identityManager.getDefaultIdentity()},m.prototype.getDefaultCertificateName=function(){return this.identityManager.getDefaultCertificateName()},m.prototype.generateRSAKeyPair=function(a,b,c){return this.identityManager.generateRSAKeyPair(a,b,c)},m.prototype.setDefaultKeyForIdentity=function(a,b){return null==b&&(b=new d),this.identityManager.setDefaultKeyForIdentity(a,b)},m.prototype.generateRSAKeyPairAsDefault=function(a,b,c){return this.identityManager.generateRSAKeyPairAsDefault(a,b,c)},m.prototype.createSigningRequest=function(a){return this.identityManager.getPublicKey(a).getKeyDer()},m.prototype.installIdentityCertificate=function(a){this.identityManager.addCertificate(a)},m.prototype.setDefaultCertificateForKey=function(a){this.identityManager.setDefaultCertificateForKey(a)},m.prototype.getCertificate=function(a){return this.identityManager.getCertificate(a)},m.prototype.getAnyCertificate=function(a){return this.identityManager.getAnyCertificate(a)},m.prototype.getIdentityCertificate=function(a){return this.identityManager.getCertificate(a)},m.prototype.getAnyIdentityCertificate=function(a){return this.identityManager.getAnyCertificate(a)},m.prototype.revokeKey=function(){},m.prototype.revokeCertificate=function(){},m.prototype.getIdentityManager=function(){return this.identityManager},m.prototype.getPolicyManager=function(){return this.policyManager},m.prototype.sign=function(a,b,c){if(a instanceof e)this.signInterest(a,b,c);else{if(!(a instanceof f))return this.identityManager.signByCertificate(a,b);this.identityManager.signByCertificate(a,b,c)}},m.prototype.signInterest=function(a,b,c){c=c||i.getDefaultWireFormat();var e=new h;e.getKeyLocator().setType(g.KEYNAME),e.getKeyLocator().setKeyName(b.getPrefix(-1)),a.getName().append(c.encodeSignatureInfo(e)),a.getName().append(new d.Component);var f=a.wireEncode(c),l=this.sign(f.signedBuf(),b),m=new k(256);m.writeBlobTlv(j.SignatureValue,l.getSignature().buf()),a.setName(a.getName().getPrefix(-1).append(c.encodeSignatureValue(l)))},m.prototype.signByIdentity=function(a,b,c){if(null==b&&(b=new d),!(a instanceof f)){var e=this.identityManager.getDefaultCertificateNameForIdentity(b);if(0==e.size())throw new l(new Error("No qualified certificate name found!"));return this.identityManager.signByCertificate(array,e)}var e;if(0==b.size()){var g=this.policyManager.inferSigningIdentity(data.getName());e=0==g.size()?this.identityManager.getDefaultCertificateName():this.identityManager.getDefaultCertificateNameForIdentity(g)}else e=this.identityManager.getDefaultCertificateNameForIdentity(b);if(0==e.size())throw new l(new Error("No qualified certificate name found!"));if(!this.policyManager.checkSigningPolicy(data.getName(),e))throw new l(new Error("Signing Cert name does not comply with signing policy"));this.identityManager.signByCertificate(data,e,c)},m.prototype.verifyData=function(a,b,c,d){if(this.policyManager.requireVerify(a)){var e=this.policyManager.checkVerificationPolicy(a,d,b,c);if(null!=e){var f=this;this.face.expressInterest(e.interest,function(a,b){f.onCertificateData(a,b,e)},function(b){f.onCertificateInterestTimeout(b,e.retry,c,a,e)})}}else this.policyManager.skipVerifyAndTrust(a)?b(a):c(a)},m.prototype.verifyInterest=function(a,b,c,d,e){if(e=e||i.getDefaultWireFormat(),this.policyManager.requireVerify(a)){var f=this.policyManager.checkVerificationPolicy(a,d,b,c,e);if(null!=f)throw new l(new Error("verifyInterest: ValidationRequest not implemented yet"))}else this.policyManager.skipVerifyAndTrust(a)?b(a):c(a)},m.prototype.generateSymmetricKey=function(a,b){this.encryptionManager.createSymmetricKey(a,b)},m.prototype.encrypt=function(a,b,c,d){return this.encryptionManager.encrypt(a,b,c,d)},m.prototype.decrypt=function(a,b,c,d){return this.encryptionManager.decrypt(a,b,c,d)},m.prototype.setFace=function(a){this.face=a},m.prototype.onCertificateData=function(a,b,c){this.verifyData(b,c.onVerified,c.onVerifyFailed,c.stepCount)},m.prototype.onCertificateInterestTimeout=function(a,b,c,d,e){if(b>0){var f=this;this.face.expressInterest(a,function(a,b){f.onCertificateData(a,b,e)},function(a){f.onCertificateInterestTimeout(a,b-1,c,d,e)})}else c(d)}},{"../data.js":60,"../encoding/tlv/tlv-encoder.js":73,"../encoding/tlv/tlv.js":75,"../encoding/wire-format.js":76,"../interest.js":82,"../key-locator.js":83,"../name.js":87,"../sha256-with-rsa-signature.js":105,"./security-exception.js":103}],98:[function(a,b,c){var d=a("../key.js").Key,e=function(){this.publicKey="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuAmnWYKE7E8G+hyy4TiT\nU7t91KyIGvglEeT6HWEkW4LKzXLO22a1jVS9+yP96I6vp7N5vpS1t7oXtgWuzkO+\nO85u6gfbvwp+67zJe2I89eHO4dmNnP4fx/j7WcCUCyzZfbyW67h5IoouoBIdQge2\nXdvh9rFdex9UUhyjEZv5676zlcqlhz8xGBrJmQHsqpD9ijY1XhKBvoSIoQ0ZKkpm\nwVk8QYM9PbjUqzSQBj4aYXS+BPV6aRudVvyDt2DBXp2FNP0CGrosCXKnSl4Yv8BY\np0k0RmFZDuJuntLb/XIvPEfMX5li7g3zHzAlIJIVSwT+FRkd3H5cECFSIZFUYIuS\nQQIDAQAB\n-----END PUBLIC KEY-----",this.privateKey="-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAuAmnWYKE7E8G+hyy4TiTU7t91KyIGvglEeT6HWEkW4LKzXLO\n22a1jVS9+yP96I6vp7N5vpS1t7oXtgWuzkO+O85u6gfbvwp+67zJe2I89eHO4dmN\nnP4fx/j7WcCUCyzZfbyW67h5IoouoBIdQge2Xdvh9rFdex9UUhyjEZv5676zlcql\nhz8xGBrJmQHsqpD9ijY1XhKBvoSIoQ0ZKkpmwVk8QYM9PbjUqzSQBj4aYXS+BPV6\naRudVvyDt2DBXp2FNP0CGrosCXKnSl4Yv8BYp0k0RmFZDuJuntLb/XIvPEfMX5li\n7g3zHzAlIJIVSwT+FRkd3H5cECFSIZFUYIuSQQIDAQABAoIBAQCKBftzfxavn6lM\n5T8m+GZN0vzRBsBg8Z/jpsYKSLOayiHNKYCIPaSFpXuCIYEo6/JDJLB2xVLvwupL\ngkGSwm2mrvCyJkihI38Cz6iQF6I+iia9bYrupgwxzsK7klm1c+J9kXXivYxj4hyL\nwmoc/mnARMtYV7cTQvDbUEzgRQmPykWKBv6Y0SL1WprfiRfKIMwSqQk91ffj6whK\nxBLAuUdseVBmo/ivLPq0a+wDrcvaJAxSB4eIwCHzAugkRA/NoK0vG3mra0lK5jvQ\nrcNIuffxNAnresDVDTnYRc42etjePLAhlpeK/4sjYE/wPdeP8yzLHUg/hsSpAPIj\nLXJNZqUBAoGBANxPmUQNf1lGHo/nLY3dVMD3+kYNnTUD8XwS81qdg8/dNyF8t+7D\nOdJ1j7Itb+zGA1XXAGfTm6JoUG+eKKR2OSuyZcxygpOgzxAFanXKhTWZsKbG70xN\nmX0sOAEhtTGsgFTEGEv977MwIlFa6n2bsp3Luj/AGmvNsOYvBDPXOklxAoGBANXZ\nyXAaE7M5JALusLuEFxLGvWVz6TRdQ//c+FWvKrnh+nFlTlAPpDvlaPJJca8ViNev\nxJ2UhGtbENXAqgwTYpnAi/yQD4dATViIveK6Pn4t12mpPAlkMbbMTR8jtp5l1oHc\nhcwe8QuEOKuTX5+STpNGlWs+tsMb12mhCpc3eO3RAoGAMxjDE2WOA8afkACuMBkF\nbzwUb+r4azNe7sf2aS3fRHaqMroabuYYoxdhHJItQ10pqN8U2P/bOO+4uCqWgo5o\n9BmMQr7MSjEh1TVsW6V8/9GFhyjcl3XoA4Ad/SU0QTEhEofomrdqwMSJMRVFDZzu\n8Gov6FlFx3sNbFW7Q8rHWgECgYEAq/TVz3iIgsLdvCXmosHSM9zvCpcr3FlqhmFO\npseVmaamVWxajnIlY6xSuRBpg5nTUWwas4Nq/1BYtyiXE+K6lFuJtOq6Mc145EoA\nNkIAYkHGR0Y36m1QtGaPVQzImZHV7NJAHCR9Ov90+jIk4BErca1+FKB3IWhPzLYb\n6ABJEyECgYEAthhzWSxPkqyiLl+2vnhdR3EEkvDX6MV6hGu4tDAf2A1Y0GSApyEa\nSAA31hlxu5EgneLD7Ns2HMpIfQMydB5lcwKQc9g/tVI1eRzuk6Myi+2JmPEM2BLy\niX8yI+xnZlKDiZleQitCS4RQGz5HbXT70aYQIGxuvkQ/uf68jdrL6o8=\n-----END RSA PRIVATE KEY-----",this.key=null};e.prototype.getKey=function(){return null===this.key&&(this.key=new d,this.key.fromPemString(this.publicKey,this.privateKey)),this.key};var f=f||new e;c.globalKeyManager=f},{"../key.js":84}],99:[function(a,b,c){var d=a("../../name.js").Name,e=a("./policy-manager.js").PolicyManager,f=function(){e.call(this)};f.prototype=new e,f.prototype.name="NoVerifyPolicyManager",c.NoVerifyPolicyManager=f,f.prototype.skipVerifyAndTrust=function(){return!0},f.prototype.requireVerify=function(){return!1},f.prototype.checkVerificationPolicy=function(a,b,c){return c(a),null},f.prototype.checkSigningPolicy=function(){return!0},f.prototype.inferSigningIdentity=function(){return new d}},{"../../name.js":87,"./policy-manager.js":100}],100:[function(a,b,c){var d=function(){};c.PolicyManager=d,d.prototype.skipVerifyAndTrust=function(){throw new Error("PolicyManager.skipVerifyAndTrust is not implemented")},d.prototype.requireVerify=function(){throw new Error("PolicyManager.requireVerify is not implemented")},d.prototype.checkVerificationPolicy=function(){throw new Error("PolicyManager.checkVerificationPolicy is not implemented")},d.prototype.checkSigningPolicy=function(){throw new Error("PolicyManager.checkSigningPolicy is not implemented")},d.prototype.inferSigningIdentity=function(){throw new Error("PolicyManager.inferSigningIdentity is not implemented")}},{}],101:[function(a,b,c){var d=a("../../name.js").Name,e=a("../../interest.js").Interest,f=a("../../data.js").Data,g=a("../../encoding/data-utils.js").DataUtils,h=a("../certificate/identity-certificate.js").IdentityCertificate,i=a("../../key-locator.js").KeyLocatorType,j=a("../security-exception.js").SecurityException,k=a("../../encoding/wire-format.js").WireFormat,l=a("./policy-manager.js").PolicyManager,m=function(a){l.call(this),this.identityStorage=a};m.prototype=new l,m.prototype.name="SelfVerifyPolicyManager",c.SelfVerifyPolicyManager=m,m.prototype.skipVerifyAndTrust=function(){return!1},m.prototype.requireVerify=function(){return!0},m.prototype.checkVerificationPolicy=function(a,b,c,d,g){if(g=g||k.getDefaultWireFormat(),a instanceof f){var h=a;this.verify(h.getSignature(),h.wireEncode())?c(h):d(h)}else{if(!(a instanceof e))throw new j(new Error("checkVerificationPolicy: unrecognized type for dataOrInterest"));var i=a,l=g.decodeSignatureInfoAndValue(i.getName().get(-2).getValue().buf(),i.getName().get(-1).getValue().buf());this.verify(l,i.wireEncode())?c(i):d(i)}return null},m.prototype.checkSigningPolicy=function(){return!0},m.prototype.inferSigningIdentity=function(){return new d},m.prototype.verify=function(a,b){var c=a;if(c.getKeyLocator().getType()==i.KEY)return m.verifySha256WithRsaSignature(c,b,c.getKeyLocator().getKeyData());if(c.getKeyLocator().getType()==i.KEYNAME&&null!=this.identityStorage){var d=this.identityStorage.getKey(h.certificateNameToPublicKeyName(c.getKeyLocator().getKeyName()));return d.isNull()?!1:m.verifySha256WithRsaSignature(c,b,d)}return!1},m.verifyUsesString=null,m.verifySha256WithRsaSignature=function(b,c,d){if(null===m.verifyUsesString){var e=a("crypto").createHash("sha256").digest();m.verifyUsesString="string"==typeof e}for(var h=d.buf().toString("base64"),i="-----BEGIN PUBLIC KEY-----\n",j=0;j<h.length;j+=64)i+=h.substr(j,64)+"\n";i+="-----END PUBLIC KEY-----";var k=a("crypto").createVerify("RSA-SHA256");k.update(c.signedBuf());var l=f.verifyUsesString?g.toString(b.getSignature().buf()):b.getSignature().buf();return k.verify(i,l)}},{"../../data.js":60,"../../encoding/data-utils.js":65,"../../encoding/wire-format.js":76,"../../interest.js":82,"../../key-locator.js":83,"../../name.js":87,"../certificate/identity-certificate.js":90,"../security-exception.js":103,"./policy-manager.js":100,crypto:18}],102:[function(a,b,c){var d=function(a,b,c,d,e){this.interest=a,this.onVerified=b,this.onVerifyFailed=c,this.retry=d,this.stepCount=e};c.ValidationRequest=d},{}],103:[function(a,b,c){function d(a){this.message=a.message;for(var b in a)this[b]=a[b]}d.prototype=new Error,d.prototype.name="SecurityException",c.SecurityException=d},{}],104:[function(a,b,c){var d=function(){};c.KeyType=d,d.RSA=0,d.AES=1,d.EC=2;var e=function(){};c.KeyClass=e,e.PUBLIC=1,e.PRIVATE=2,e.SYMMETRIC=3;var f=function(){};c.DigestAlgorithm=f,f.SHA256=1;var g=function(){};c.EncryptMode=g,g.DEFAULT=1,g.CFB_AES=2},{}],105:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),f=a("./key-locator.js").KeyLocator,g=a("./log.js").Log.LOG,h=function j(a){"object"==typeof a&&a instanceof j?(this.keyLocator=new f(a.keyLocator),this.signature=a.signature,this.witness=a.witness,this.digestAlgorithm=a.digestAlgorithm):(this.keyLocator=new f,this.signature=null,this.witness=null,this.digestAlgorithm=null)};c.Sha256WithRsaSignature=h,h.prototype.clone=function(){return new h(this)},h.prototype.getKeyLocator=function(){return this.keyLocator},h.prototype.getSignature=function(){return new d(this.signature,!1)},h.prototype.getSignatureAsBuffer=function(){return this.signature},h.prototype.setKeyLocator=function(a){this.keyLocator="object"==typeof a&&a instanceof f?new f(a):new f},h.prototype.setSignature=function(a){this.signature=null==a?null:new b("object"==typeof a&&a instanceof d?a.buf():a)},h.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),g>4&&console.log("STARTED DECODING SIGNATURE"),a.peekDTag(e.DigestAlgorithm)&&(g>4&&console.log("DIGIEST ALGORITHM FOUND"),this.digestAlgorithm=a.readUTF8DTagElement(e.DigestAlgorithm)),a.peekDTag(e.Witness)&&(g>4&&console.log("WITNESS FOUND"),this.witness=a.readBinaryDTagElement(e.Witness)),g>4&&console.log("SIGNATURE FOUND"),this.signature=a.readBinaryDTagElement(e.SignatureBits),a.readElementClose()},h.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode: field values missing.");a.writeElementStartDTag(this.getElementLabel()),null==this.digestAlgorithm||this.digestAlgorithm.equals(NDNDigestHelper.DEFAULT_DIGEST_ALGORITHM)||a.writeDTagElement(e.DigestAlgorithm,OIDLookup.getDigestOID(this.DigestAlgorithm)),null!=this.witness&&a.writeDTagElement(e.Witness,this.witness),a.writeDTagElement(e.SignatureBits,this.signature),a.writeElementClose()},h.prototype.getElementLabel=function(){return e.Signature},h.prototype.validate=function(){return this.getSignature().size()>0};var i=function(a,b,c){"object"==typeof a&&a instanceof h?h.call(this,a):(h.call(this),null!=a&&(this.witness=a),null!=b&&(this.signature=b),null!=c&&(this.digestAlgorithm=c))};i.prototype=new h,c.Signature=i}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":61,"./encoding/binary-xml-encoder.js":62,"./key-locator.js":83,"./log.js":85,"./util/blob.js":112,"./util/ndn-protoco-id-tags.js":117,buffer:11}],106:[function(a,b,c){var d=a("./digest-tree.js").DigestTree,e=a("../interest.js").Interest,f=a("../data.js").Data,g=a("../name.js").Name,h=a("../util/blob.js").Blob,i=a("../util/memory-content-cache.js").MemoryContentCache,j=function k(b,c,f,g,h,j,l,m,n,o){this.onReceivedSyncState=b,this.onInitialized=c,this.applicationDataPrefixUri=f.toUri(),this.applicationBroadcastPrefix=g,this.session=h,this.face=j,this.keyChain=l,this.certificateName=m,this.sync_lifetime=n,this.usrseq=-1,this.digest_tree=new d,this.contentCache=new i(j),this.pendingInterestTable=[],this.digest_log=new Array,this.digest_log.push(new k.DigestLogEntry("00",[])),this.contentCache.registerPrefix(this.applicationBroadcastPrefix,o.bind(this),this.onInterest.bind(this));var p=new e(this.applicationBroadcastPrefix);p.getName().append("00"),p.setInterestLifetimeMilliseconds(1e3),p.setAnswerOriginKind(e.ANSWER_NO_CONTENT_STORE),this.SyncStateMsg=a("./sync-state.js").SyncStateMsg,this.SyncState=a("./sync-state.js").SyncState,this.face.expressInterest(p,this.onData.bind(this),this.initialTimeOut.bind(this))};c.ChronoSync2013=j,j.prototype.getProducerSequenceNo=function(a,b){var c=this.digest_tree.find(a,b);return 0>c?-1:this.digest_tree.get(c).getSequenceNo()},j.prototype.publishNextSequenceNo=function(){this.usrseq++;var a=[new this.SyncState({name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:this.usrseq,session:this.session}})],b=new this.SyncStateMsg({ss:a});this.broadcastSyncState(this.digest_tree.getRoot(),b),this.update(a)||console.log("Warning: ChronoSync: update did not create a new digest log entry");var c=new e(this.applicationBroadcastPrefix);c.getName().append(this.digest_tree.getRoot()),c.setInterestLifetimeMilliseconds(this.sync_lifetime),this.face.expressInterest(c,this.onData.bind(this),this.syncTimeout.bind(this))},j.prototype.getSequenceNo=function(){return this.usrseq},j.DigestLogEntry=function(a,b){this.digest=a,this.data=b},j.DigestLogEntry.prototype.getDigest=function(){return this.digest},j.DigestLogEntry.prototype.getData=function(){return this.data},j.PendingInterest=function(a,b){this.interest=a,this.transport=b,this.timeoutMilliseconds=this.interest.getInterestLifetimeMilliseconds()>=0?(new Date).getTime()+this.interest.getInterestLifetimeMilliseconds():-1},j.PendingInterest.prototype.getInterest=function(){return this.interest},j.PendingInterest.prototype.getTransport=function(){return this.transport},j.PendingInterest.prototype.isTimedOut=function(a){return this.timeoutTimeMilliseconds>=0&&a>=this.timeoutTimeMilliseconds},j.SyncState=function(a,b,c){this.dataPrefixUri_=a,this.sessionNo_=b,this.sequenceNo_=c},j.SyncState.prototype.getDataPrefix=function(){return this.dataPrefixUri_},j.SyncState.prototype.getSessionNo=function(){return this.sessionNo_},j.SyncState.prototype.getSequenceNo=function(){return this.sequenceNo_},j.prototype.broadcastSyncState=function(a,b){var c=new Uint8Array(b.toArrayBuffer()),d=new f(this.applicationBroadcastPrefix);d.getName().append(a),d.setContent(new h(c,!1)),this.keyChain.sign(d,this.certificateName),this.contentCacheAdd(d)},j.prototype.update=function(a){for(var b=0;b<a.length;b++)0==a[b].type&&this.digest_tree.update(a[b].name,a[b].seqno.seq,a[b].seqno.session)&&this.applicationDataPrefixUri==a[b].name&&(this.usrseq=a[b].seqno.seq);
if(-1==this.logfind(this.digest_tree.getRoot())){var c=new j.DigestLogEntry(this.digest_tree.getRoot(),a);return this.digest_log.push(c),!0}return!1},j.prototype.logfind=function(a){for(var b=0;b<this.digest_log.length;b++)if(a==this.digest_log[b].digest)return b;return-1},j.prototype.onInterest=function(a,b,c){var d=b.getName().get(this.applicationBroadcastPrefix.size()).toEscapedString();if(b.getName().size()==this.applicationBroadcastPrefix.size()+2&&(d=b.getName().get(this.applicationBroadcastPrefix.size()+1).toEscapedString()),b.getName().size()==this.applicationBroadcastPrefix.size()+2||"00"==d)this.processRecoveryInst(b,d,c);else if(this.pendingInterestTable.push(new j.PendingInterest(b,c)),d!=this.digest_tree.getRoot()){var f=this.logfind(d);if(-1==f){var h=new e(new g("/timeout"));h.setInterestLifetimeMilliseconds(2e3),this.face.expressInterest(h,this.dummyOnData,this.judgeRecovery.bind(this,h,d,c))}else this.processSyncInst(f,d,c)}},j.prototype.onData=function(a,b){var c=new Uint8Array(b.getContent().size());c.set(b.getContent().buf());var d=this.SyncStateMsg.decode(c.buffer),f=d.ss,h=!1;"00"==this.digest_tree.getRoot()?(h=!0,this.initialOndata(f)):h=a.getName().size()==this.applicationBroadcastPrefix.size()+2?!1:!0;for(var i=[],k=0;k<f.length;k++)0==f[k].type&&i.push(new j.SyncState(f[k].name,f[k].seqno.session,f[k].seqno.seq));this.onReceivedSyncState(i,h);var l=this.update(f);if(l){var m=new g(this.applicationBroadcastPrefix);m.append(this.digest_tree.getRoot());var a=new e(m);a.setInterestLifetimeMilliseconds(this.sync_lifetime),this.face.expressInterest(a,this.onData.bind(this),this.syncTimeout.bind(this))}},j.prototype.initialTimeOut=function(){console.log("no other people"),this.usrseq++,this.onInitialized();var a=[new this.SyncState({name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:this.usrseq,session:this.session}})];this.update(a);var b=new g(this.applicationBroadcastPrefix);b.append(this.digest_tree.getRoot());var c=new e(b);c.setInterestLifetimeMilliseconds(this.sync_lifetime),this.face.expressInterest(c,this.onData.bind(this),this.syncTimeout.bind(this))},j.prototype.processRecoveryInst=function(a,b,c){if(-1!=this.logfind(b)){for(var d=[],e=0;e<this.digest_tree.digestnode.length;e++)d[e]=new this.SyncState({name:this.digest_tree.digestnode[e].getDataPrefix(),type:"UPDATE",seqno:{seq:this.digest_tree.digestnode[e].getSequenceNo(),session:this.digest_tree.digestnode[e].getSessionNo()}});if(0!=d.length){var g=new this.SyncStateMsg({ss:d}),i=new Uint8Array(g.toArrayBuffer()),j=new f(a.getName());j.setContent(new h(i,!1)),this.keyChain.sign(j,this.certificateName);try{c.send(j.wireEncode().buf())}catch(k){console.log(k.toString())}}}},j.prototype.processSyncInst=function(a,b,c){for(var d=[],e=[],i=[],j=[],k=a+1;k<this.digest_log.length;k++)for(var l=this.digest_log[k].getData(),m=0;m<l.length;m++)if(0==l[m].type&&-1!=this.digest_tree.find(l[m].name,l[m].seqno.session)){var n=e.indexOf(l[m].name);(n=-1)?(e.push(l[m].name),i.push(l[m].seqno.seq),j.push(l[m].seqno.session)):(i[n]=l[m].seqno.seq,j[n]=l[m].seqno.session)}for(var m=0;m<e.length;m++)d[m]=new this.SyncState({name:e[m],type:"UPDATE",seqno:{seq:i[m],session:j[m]}});if(0!=d.length){var o=new this.SyncStateMsg({ss:d}),p=new Uint8Array(o.toArrayBuffer()),n=new g(this.prefix);n.append(this.chatroom).append(b);var q=new f(n);q.setContent(new h(p,!1)),this.keyChain.sign(q,this.certificateName);try{c.send(q.wireEncode().buf())}catch(r){console.log(r.toString())}}},j.prototype.sendRecovery=function(a){var b=new g(this.applicationBroadcastPrefix);b.append("recovery").append(a);var c=new e(b);c.setInterestLifetimeMilliseconds(this.sync_lifetime),this.face.expressInterest(c,this.onData.bind(this),this.syncTimeout.bind(this))},j.prototype.judgeRecovery=function(a,b,c){var d=this.logfind(b);-1!=d?b!=this.digest_tree.root&&this.processSyncInst(d,b,c):this.sendRecovery(b)},j.prototype.syncTimeout=function(a){var b=a.getName().get(4).toEscapedString();if(b==this.digest_tree.root){var c=new g(a.getName()),d=new e(c);a.setInterestLifetimeMilliseconds(this.sync_lifetime),this.face.expressInterest(d,this.onData.bind(this),this.syncTimeout.bind(this))}},j.prototype.initialOndata=function(a){this.update(a);for(var b=this.digest_tree.getRoot(),c=0;c<a.length;c++)if(a[c].name==this.applicationDataPrefixUri&&a[c].seqno.session==this.session){var d=[new this.SyncState({name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:a[c].seqno.seq+1,session:this.session}})];if(this.update(d)){var e=new j.DigestLogEntry(this.digest_tree.getRoot(),d);this.digest_log.push(e),this.onInitialized()}}var d;d=new this.SyncState(this.usrseq>=0?{name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:this.usrseq,session:this.session}}:{name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:0,session:this.session}});var f=new this.SyncStateMsg({ss:d});if(this.broadcastSyncState(b,f),-1==this.digest_tree.find(this.applicationDataPrefixUri,this.session)){this.usrseq++;var a=[new this.SyncState({name:this.applicationDataPrefixUri,type:"UPDATE",seqno:{seq:this.usrseq,session:this.session}})];this.update(a)&&this.onInitialized()}},j.prototype.contentCacheAdd=function(a){this.contentCache.add(a);for(var b=(new Date).getTime(),c=this.pendingInterestTable.length-1;c>=0;c--)if(this.pendingInterestTable[c].isTimedOut(b))this.pendingInterestTable.splice(c,1);else if(this.pendingInterestTable[c].getInterest().matchesName(a.getName())){try{this.pendingInterestTable[c].getTransport().send(a.wireEncode().buf())}catch(d){}this.pendingInterestTable.splice(c,1)}},j.prototype.dummyOnData=function(){console.log("*** dummyOnData called. ***")}},{"../data.js":60,"../interest.js":82,"../name.js":87,"../util/blob.js":112,"../util/memory-content-cache.js":115,"./digest-tree.js":107,"./sync-state.js":108}],107:[function(a,b,c){(function(b){function d(){return str1==str2?0:str1>str2?1:-1}var e=a("crypto"),f=(a("../encoding/data-utils.js").DataUtils,function(){this.root="00",this.digestnode=[]});c.DigestTree=f,f.Node=function(a,b,c){this.dataPrefix=a,this.seqno_seq=b,this.seqno_session=c,this.recomputeDigest()},f.Node.prototype.getDataPrefix=function(){return this.dataPrefix},f.Node.prototype.getSequenceNo=function(){return this.seqno_seq},f.Node.prototype.getSessionNo=function(){return this.seqno_session},f.Node.prototype.getDigest=function(){return this.digest},f.Node.prototype.setSequenceNo=function(a){this.seqno_seq=a,this.recomputeDigest()},f.Node.prototype.Int32ToBuffer=function(a){for(var c=new b(4),d=0;4>d;d++)c[d]=a%256,a=Math.floor(a/256);return c},f.Node.prototype.recomputeDigest=function(){var a=new e.createHash("sha256");a.update(this.Int32ToBuffer(this.seqno_session)),a.update(this.Int32ToBuffer(this.seqno_seq));var b=a.digest(),c=new e.createHash("sha256");c.update(this.dataPrefix);var d=c.digest(),f=new e.createHash("sha256");f.update(d),f.update(b),this.digest=f.digest("hex")},f.Node.Compare=function(a,b){var c=d(a.dataPrefix,b.dataPrefix);return 0!=c?0>c:a.seqno_session<b.seqno_session},f.prototype.update=function(a,b,c){var d=this.find(a,c);if(d>=0){if(!(this.digestnode[d].getSequenceNo()<b))return!1;this.digestnode[d].setSequenceNo(b)}else{var e=new f.Node(a,b,c);this.digestnode.push(e),this.digestnode.sort(this.sortNodes)}return this.recomputeRoot(),!0},f.prototype.sortNodes=function(){for(var a,b=this.digestnode.length;b>0;b--)for(var c=0;b-1>c;c++)this.digestnode[c].getDataPrefix()>this.digestnode[c+1].getDataPrefix()&&(a=this.digestnode[c],this.digestnode[c]=this.digestnode[c+1],this.digestnode[c+1]=a)},f.prototype.sortNodes=function(a,b){return a.getDataPrefix()==b.getDataPrefix()&&a.getSessionNo()==b.getSessionNo()?0:a.getDataPrefix()>b.getDataPrefix()||a.getDataPrefix()==b.getDataPrefix()&&a.getSessionNo()>b.getSessionNo()?1:-1},f.prototype.find=function(a,b){for(var c=0;c<this.digestnode.length;++c)if(this.digestnode[c].getDataPrefix()==a&&this.digestnode[c].getSessionNo()==b)return c;return-1},f.prototype.size=function(){return this.digestnode.size()},f.prototype.get=function(a){return this.digestnode[a]},f.prototype.getRoot=function(){return this.root},f.prototype.recomputeRoot=function(){for(var a=new e.createHash("sha256"),c=0;c<this.digestnode.length;c++)a.update(new b(this.digestnode[c].digest,"hex"));this.root=a.digest("hex")}}).call(this,a("buffer").Buffer)},{"../encoding/data-utils.js":65,buffer:11,crypto:18}],108:[function(a,b,c){var d=a("protobufjs"),e=d.newBuilder().import({"package":"Sync",messages:[{name:"SyncState",fields:[{rule:"required",type:"string",name:"name",id:1,options:{}},{rule:"required",type:"ActionType",name:"type",id:2,options:{}},{rule:"optional",type:"SeqNo",name:"seqno",id:3,options:{}}],enums:[{name:"ActionType",values:[{name:"UPDATE",id:0},{name:"DELETE",id:1},{name:"OTHER",id:2}],options:{}}],messages:[{name:"SeqNo",fields:[{rule:"required",type:"uint32",name:"seq",id:1,options:{}},{rule:"required",type:"uint32",name:"session",id:2,options:{}}],enums:[],messages:[],options:{}}],options:{}},{name:"SyncStateMsg",fields:[{rule:"repeated",type:"SyncState",name:"ss",id:1,options:{}}],enums:[],messages:[],options:{}}],enums:[],imports:[],options:{}}).build("Sync");c.SyncStateMsg=e.SyncStateMsg,c.SyncState=e.SyncState},{protobufjs:122}],109:[function(a,b,c){var d=function(){};c.Transport=d,d.ConnectionInfo=function(){}},{}],110:[function(a,b,c){(function(b){var d=a("../encoding/element-reader.js").ElementReader,e=a("../log.js").Log.LOG,f=a("./transport.js").Transport,g=function(){f.call(this),this.socket=null,this.sock_ready=!1,this.elementReader=null,this.connectionInfo=null,this.defaultGetConnectionInfo=null};g.prototype=new f,g.prototype.name="UnixTransport",c.UnixTransport=g,g.ConnectionInfo=function(a){f.ConnectionInfo.call(this),this.filePath=a},g.ConnectionInfo.prototype=new f.ConnectionInfo,g.ConnectionInfo.prototype.name="UnixTransport.ConnectionInfo",g.ConnectionInfo.prototype.equals=function(a){return null==a||void 0==a.filePath?!1:this.filePath==a.filePath},g.ConnectionInfo.prototype.toString=function(){return"{ filePath: "+this.filePath+" }"},g.prototype.connect=function(c,f,g,h){null!=this.socket&&delete this.socket,this.elementReader=new d(f);var i=a("net");this.socket=new i.createConnection(c.filePath);var j=this;this.socket.on("data",function(a){if("object"==typeof a){var c=new b(a);try{j.elementReader.onReceivedData(c)}catch(d){return void console.log("NDN.UnixTransport.ondata exception: "+d)}}}),this.socket.on("connect",function(){e>3&&console.log("socket.onopen: Unix socket connection opened."),j.sock_ready=!0,g()}),this.socket.on("error",function(){e>3&&console.log("socket.onerror: Unix socket error")}),this.socket.on("close",function(){e>3&&console.log("socket.onclose: Unix socket connection closed."),j.socket=null,h()}),this.connectionInfo=c},g.prototype.send=function(a){this.sock_ready?this.socket.write(a):console.log("Unix socket connection is not established.")},g.prototype.close=function(){this.socket.end(),e>3&&console.log("Unix socket connection closed.")}}).call(this,a("buffer").Buffer)},{"../encoding/element-reader.js":67,"../log.js":85,"./transport.js":109,buffer:11,net:10}],111:[function(a,b,c){(function(b){var d,e=a("../encoding/element-reader.js").ElementReader,f=a("../log.js").Log.LOG,g=a("./transport.js").Transport,h=function i(){if(g.call(this),!WebSocket)throw new Error("WebSocket support is not available on this platform.");this.ws=null,this.connectionInfo=null,this.elementReader=null,this.defaultGetConnectionInfo=d.makeShuffledHostGetConnectionInfo(["A.ws.ndn.ucla.edu","B.ws.ndn.ucla.edu","C.ws.ndn.ucla.edu","D.ws.ndn.ucla.edu","E.ws.ndn.ucla.edu","F.ws.ndn.ucla.edu","G.ws.ndn.ucla.edu","H.ws.ndn.ucla.edu","I.ws.ndn.ucla.edu","J.ws.ndn.ucla.edu","K.ws.ndn.ucla.edu","L.ws.ndn.ucla.edu","M.ws.ndn.ucla.edu","N.ws.ndn.ucla.edu"],9696,function(a,b){return new i.ConnectionInfo(a,b)})};h.prototype=new g,h.prototype.name="WebSocketTransport",h.importFace=function(a){d=a},c.WebSocketTransport=h,h.ConnectionInfo=function(a,b){g.ConnectionInfo.call(this),b=void 0!==b?b:9696,this.host=a,this.port=b},h.ConnectionInfo.prototype=new g.ConnectionInfo,h.ConnectionInfo.prototype.name="WebSocketTransport.ConnectionInfo",h.ConnectionInfo.prototype.equals=function(a){return null==a||void 0==a.host||void 0==a.port?!1:this.host==a.host&&this.port==a.port},h.ConnectionInfo.prototype.toString=function(){return"{ host: "+this.host+", port: "+this.port+" }"},h.prototype.connect=function(a,c,d,g){this.close(),this.ws=new WebSocket("ws://"+a.host+":"+a.port),f>0&&console.log("ws connection created."),this.connectionInfo=a,this.ws.binaryType="arraybuffer",this.elementReader=new e(c);var h=this;this.ws.onmessage=function(a){var c=a.data;if(null==c||void 0==c||""==c)console.log("INVALID ANSWER");else if(c instanceof ArrayBuffer){var d=new b(new Uint8Array(c));f>3&&console.log("BINARY RESPONSE IS "+d.toString("hex"));try{h.elementReader.onReceivedData(d)}catch(e){return void console.log("NDN.ws.onmessage exception: "+e)}}},this.ws.onopen=function(a){f>3&&console.log(a),f>3&&console.log("ws.onopen: WebSocket connection opened."),f>3&&console.log("ws.onopen: ReadyState: "+this.readyState),d()},this.ws.onerror=function(a){console.log("ws.onerror: ReadyState: "+this.readyState),console.log(a),console.log("ws.onerror: WebSocket error: "+a.data)},this.ws.onclose=function(){console.log("ws.onclose: WebSocket connection closed."),h.ws=null,g()}},h.prototype.connectByFace=function(a,b){this.connect(a.connectionInfo,a,b,function(){a.closeByTransport()})},h.prototype.send=function(a){if(null!=this.ws){var b=new Uint8Array(a.length);b.set(a),this.ws.send(b.buffer),f>3&&console.log("ws.send() returned.")}else console.log("WebSocket connection is not established.")},h.prototype.close=function(){null!=this.ws&&delete this.ws}}).call(this,a("buffer").Buffer)},{"../encoding/element-reader.js":67,"../log.js":85,"./transport.js":109,buffer:11}],112:[function(a,b,c){(function(a){var b=function d(b,c){null==c&&(c=!0),this.buffer=null==b?null:"object"==typeof b&&b instanceof d?b.buffer:"string"==typeof b?new a(b,"utf8"):c?new a(b):a.isBuffer(b)?b:new a(b),this.length=null!=this.buffer?this.buffer.length:0};c.Blob=b,b.prototype.size=function(){return null!=this.buffer?this.buffer.length:0},b.prototype.buf=function(){return this.buffer},b.prototype.isNull=function(){return null==this.buffer},b.prototype.toHex=function(){return null==this.buffer?"":this.buffer.toString("hex")},b.prototype.equals=function(a){if(this.isNull())return a.isNull();if(a.isNull())return!1;if(this.buffer.length!=a.buffer.length)return!1;for(var b=0;b<this.buffer.length;++b)if(this.buffer[b]!=a.buffer[b])return!1;return!0}}).call(this,a("buffer").Buffer)},{buffer:11}],113:[function(a,b,c){var d=a("../encoding/wire-format.js").WireFormat,e=a("../encoding/tlv/tlv-encoder.js").TlvEncoder,f=a("./blob.js").Blob,g=function(){this.lastTimestamp=Math.round((new Date).getTime())};c.CommandInterestGenerator=g,g.prototype.generate=function(b,c,g,h){h=h||d.getDefaultWireFormat();for(var i=Math.round((new Date).getTime());i<=this.lastTimestamp;)i+=1;var j=new e(8);j.writeNonNegativeInteger(i),b.getName().append(new f(j.getOutput(),!1)),b.getName().append(new f(a("crypto").randomBytes(8),!1)),c.sign(b,g,h),(null==b.getInterestLifetimeMilliseconds()||b.getInterestLifetimeMilliseconds()<0)&&b.setInterestLifetimeMilliseconds(1e3),this.lastTimestamp=i}},{"../encoding/tlv/tlv-encoder.js":73,"../encoding/wire-format.js":76,"./blob.js":112,crypto:18}],114:[function(a,b,c){(function(a){var b=function(b){b||(b=16),this.array=new a(b)};c.DynamicBuffer=b,b.prototype.ensureLength=function(b){if(!(this.array.length>=b)){var c=2*this.array.length;b>c&&(c=b);var d=new a(c);this.array.copy(d),this.array=d}},b.prototype.copy=function(b,c){this.ensureLength(b.length+c),a.isBuffer(b)?b.copy(this.array,c):new a(b).copy(this.array,c)},b.prototype.ensureLengthFromBack=function(b){if(!(this.array.length>=b)){var c=2*this.array.length;b>c&&(c=b);var d=new a(c);this.array.copy(d,d.length-this.array.length),this.array=d}},b.prototype.copyFromBack=function(b,c){this.ensureLengthFromBack(c),a.isBuffer(b)?b.copy(this.array,this.array.length-c):new a(b).copy(this.array,this.array.length-c)},b.prototype.slice=function(a,b){return this.array.slice(a,b)}}).call(this,a("buffer").Buffer)},{buffer:11}],115:[function(a,b,c){var d=a("../name.js").Name,e=function(a,b){b=b||1e3,this.face=a,this.cleanupIntervalMilliseconds=b,this.nextCleanupTime=(new Date).getTime()+b,this.onDataNotFoundForPrefix={},this.registeredPrefixIdList=[],this.noStaleTimeCache=[],this.staleTimeCache=[],this.emptyComponent=new d.Component};c.MemoryContentCache=e,e.prototype.registerPrefix=function(a,b,c,d,e){c&&(this.onDataNotFoundForPrefix[a.toUri()]=c);var f=this,g=this.face.registerPrefix(a,function(a,b,c){f.onInterest(a,b,c)},b,d,e);this.registeredPrefixIdList.push(g)},e.prototype.unregisterAll=function(){for(var a=0;a<this.registeredPrefixIdList.length;++a)this.face.removeRegisteredPrefix(this.registeredPrefixIdList[a]);this.registeredPrefixIdList=[],this.onDataNotFoundForPrefix={}},e.prototype.add=function(a){if(this.doCleanup(),null!=a.getMetaInfo().getFreshnessPeriod()&&a.getMetaInfo().getFreshnessPeriod()>=0){for(var b=new e.StaleTimeContent(a),c=this.staleTimeCache.length-1;c>=0&&!(this.staleTimeCache[c].staleTimeMilliseconds<=b.staleTimeMilliseconds);)--c;this.staleTimeCache.splice(c+1,0,b)}else this.noStaleTimeCache.push(new e.Content(a))},e.prototype.onInterest=function(a,b,c){this.doCleanup();for(var d=0,e=null,f=this.staleTimeCache.length+this.noStaleTimeCache.length,g=0;f>g;++g){var h;if(h=g<this.staleTimeCache.length?this.staleTimeCache[g]:this.noStaleTimeCache[g-this.staleTimeCache.length],b.matchesName(h.getName())){if(b.getChildSelector()<0)return void c.send(h.getDataEncoding());var i;i=h.getName().size()>b.getName().size()?h.getName().get(b.getName().size()):this.emptyComponent;var j=!1;null===e?j=!0:0==b.getChildSelector()?i.compare(d)<0&&(j=!0):i.compare(d)>0&&(j=!0),j&&(d=i,e=h.getDataEncoding())}}if(null!==e)c.send(e);else{var k=this.onDataNotFoundForPrefix[a.toUri()];k&&k(a,b,c)}},e.prototype.doCleanup=function(){var a=(new Date).getTime();if(a>=this.nextCleanupTime){for(;this.staleTimeCache.length>0&&this.staleTimeCache[0].isStale(a);)this.staleTimeCache.shift();this.nextCleanupTime=a+this.cleanupIntervalMilliseconds}},e.Content=function(a){a&&(this.name=new d(a.getName()),this.dataEncoding=a.wireEncode().buf())},e.Content.prototype.getName=function(){return this.name},e.Content.prototype.getDataEncoding=function(){return this.dataEncoding},e.StaleTimeContent=function(a){e.Content.call(this,a),this.staleTimeMilliseconds=(new Date).getTime()+a.getMetaInfo().getFreshnessPeriod()},e.StaleTimeContent.prototype=new e.Content,e.StaleTimeContent.prototype.name="StaleTimeContent",e.StaleTimeContent.prototype.isStale=function(a){return this.staleTimeMilliseconds<=a}},{"../name.js":87}],116:[function(a,b,c){(function(b){var d=(a("../encoding/data-utils.js").DataUtils,a("../encoding/binary-xml-decoder.js").BinaryXMLDecoder),e=a("./ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("../name.js").Name,g=function(a,b){this.face=a,this.onComponents=b,this.contentParts=[];var c=this;this.onData=function(a,b){c.processData(b)},this.onTimeout=function(){c.processTimeout()}};c.NameEnumeration=g,g.getComponents=function(a,b,c){var d=new f(b);d.add([193,46,69,46,98,101]);var e=new g(a,c);a.expressInterest(d,e.onData,e.onTimeout)},g.prototype.processData=function(a){try{if(g.endsWithSegmentNumber(a.getName())){var c=a.getName().get(-1).toSegment(),d=this.contentParts.length;if(c!=d)this.face.expressInterest(a.getName().getPrefix(-1).addSegment(d),this.onData,this.onTimeout);else{if(this.contentParts.push(a.getContent().buf()),null!=a.getMetaInfo()&&a.getMetaInfo().getFinalBlockId().getValue().size()>0){var e=a.getMetaInfo().getFinalBlockId().toSegment();if(c==e)return void this.onComponents(g.parseComponents(b.concat(this.contentParts)))}this.face.expressInterest(a.getName().getPrefix(-1).addSegment(d+1),this.onData,this.onTimeout)}}else this.onComponents(null)}catch(f){console.log("NameEnumeration: ignoring exception: "+f)}},g.prototype.processTimeout=function(){try{this.onComponents(null)}catch(a){console.log("NameEnumeration: ignoring exception: "+a)}},g.parseComponents=function(a){var c=[],f=new d(a);for(f.readElementStartDTag(e.Collection);f.peekDTag(e.Link);)f.readElementStartDTag(e.Link),f.readElementStartDTag(e.Name),c.push(new b(f.readBinaryDTagElement(e.Component))),f.readElementClose(),f.readElementClose();return f.readElementClose(),c},g.endsWithSegmentNumber=function(a){return a.size()>=1&&a.get(-1).getValue().size()>=1&&0==a.get(-1).getValue().buf()[0]}}).call(this,a("buffer").Buffer)},{"../encoding/binary-xml-decoder.js":61,"../encoding/data-utils.js":65,"../name.js":87,"./ndn-protoco-id-tags.js":117,buffer:11}],117:[function(a,b,c){var d={Any:13,Name:14,Component:15,Certificate:16,Collection:17,CompleteName:18,Content:19,SignedInfo:20,ContentDigest:21,ContentHash:22,Count:24,Header:25,Interest:26,Key:27,KeyLocator:28,KeyName:29,Length:30,Link:31,LinkAuthenticator:32,NameComponentCount:33,RootDigest:36,Signature:37,Start:38,Timestamp:39,Type:40,Nonce:41,Scope:42,Exclude:43,Bloom:44,BloomSeed:45,AnswerOriginKind:47,InterestLifetime:48,Witness:53,SignatureBits:54,DigestAlgorithm:55,BlockSize:56,FreshnessSeconds:58,FinalBlockID:59,PublisherPublicKeyDigest:60,PublisherCertificateDigest:61,PublisherIssuerKeyDigest:62,PublisherIssuerCertificateDigest:63,Data:64,WrappedKey:65,WrappingKeyIdentifier:66,WrapAlgorithm:67,KeyAlgorithm:68,Label:69,EncryptedKey:70,EncryptedNonceKey:71,WrappingKeyName:72,Action:73,FaceID:74,IPProto:75,Host:76,Port:77,MulticastInterface:78,ForwardingFlags:79,FaceInstance:80,ForwardingEntry:81,MulticastTTL:82,MinSuffixComponents:83,MaxSuffixComponents:84,ChildSelector:85,RepositoryInfo:86,Version:87,RepositoryVersion:88,GlobalPrefix:89,LocalName:90,Policy:91,Namespace:92,GlobalPrefixName:93,PolicyVersion:94,KeyValueSet:95,KeyValuePair:96,IntegerValue:97,DecimalValue:98,StringValue:99,BinaryValue:100,NameValue:101,Entry:102,ACL:103,ParameterizedName:104,Prefix:105,Suffix:106,Root:107,ProfileName:108,Parameters:109,InfoString:110,StatusResponse:112,StatusCode:113,StatusText:114,SyncNode:115,SyncNodeKind:116,SyncNodeElement:117,SyncVersion:118,SyncNodeElements:119,SyncContentHash:120,SyncLeafCount:121,SyncTreeDepth:122,SyncByteCount:123,ConfigSlice:124,ConfigSliceList:125,ConfigSliceOp:126,NDNProtocolDataUnit:17702112,NDNPROTOCOL_DATA_UNIT:"NDNProtocolDataUnit"};c.NDNProtocolDTags=d;var e=[null,null,null,null,null,null,null,null,null,null,null,null,null,"Any","Name","Component","Certificate","Collection","CompleteName","Content","SignedInfo","ContentDigest","ContentHash",null,"Count","Header","Interest","Key","KeyLocator","KeyName","Length","Link","LinkAuthenticator","NameComponentCount",null,null,"RootDigest","Signature","Start","Timestamp","Type","Nonce","Scope","Exclude","Bloom","BloomSeed",null,"AnswerOriginKind","InterestLifetime",null,null,null,null,"Witness","SignatureBits","DigestAlgorithm","BlockSize",null,"FreshnessSeconds","FinalBlockID","PublisherPublicKeyDigest","PublisherCertificateDigest","PublisherIssuerKeyDigest","PublisherIssuerCertificateDigest","Data","WrappedKey","WrappingKeyIdentifier","WrapAlgorithm","KeyAlgorithm","Label","EncryptedKey","EncryptedNonceKey","WrappingKeyName","Action","FaceID","IPProto","Host","Port","MulticastInterface","ForwardingFlags","FaceInstance","ForwardingEntry","MulticastTTL","MinSuffixComponents","MaxSuffixComponents","ChildSelector","RepositoryInfo","Version","RepositoryVersion","GlobalPrefix","LocalName","Policy","Namespace","GlobalPrefixName","PolicyVersion","KeyValueSet","KeyValuePair","IntegerValue","DecimalValue","StringValue","BinaryValue","NameValue","Entry","ACL","ParameterizedName","Prefix","Suffix","Root","ProfileName","Parameters","InfoString",null,"StatusResponse","StatusCode","StatusText","SyncNode","SyncNodeKind","SyncNodeElement","SyncVersion","SyncNodeElements","SyncContentHash","SyncLeafCount","SyncTreeDepth","SyncByteCount","ConfigSlice","ConfigSliceList","ConfigSliceOp"];c.NDNProtocolDTagsStrings=e},{}],118:[function(a,b,c){var d=a("../log.js").Log.LOG,e=function(a){this.NANOS_MAX=999877929,"number"==typeof a?this.msec=a:d>1&&console.log("UNRECOGNIZED TYPE FOR TIME")};c.NDNTime=e,e.prototype.getJavascriptDate=function(){var a=new Date;return a.setTime(this.msec),a}},{"../log.js":85}],119:[function(a,b,c){var d=a("./blob.js").Blob,e=function f(a,b,c){d.call(this,a),null==this.buffer?(this.signedPortionBeginOffset=0,this.signedPortionEndOffset=0):"object"==typeof a&&a instanceof f?(this.signedPortionBeginOffset=null==b?a.signedPortionBeginOffset:b,this.signedPortionEndOffset=null==c?a.signedPortionEndOffset:c):(this.signedPortionBeginOffset=b||0,this.signedPortionEndOffset=c||0),this.signedBuffer=null==this.buffer?null:this.buffer.slice(this.signedPortionBeginOffset,this.signedPortionEndOffset)};e.prototype=new d,e.prototype.name="SignedBlob",c.SignedBlob=e,e.prototype.signedSize=function(){return null!=this.signedBuffer?this.signedBuffer.length:0},e.prototype.signedBuf=function(){return null!=this.signedBuffer?this.signedBuffer:null},e.prototype.getSignedPortionBeginOffset=function(){return this.signedPortionBeginOffset},e.prototype.getSignedPortionEndOffset=function(){return this.signedPortionEndOffset}},{"./blob.js":112}],120:[function(a,b,c){(function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function d(){return new a(null)}function e(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function f(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function g(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function h(a){return hc.charAt(a)}function i(a,b){var c=ic[a.charCodeAt(b)];return null==c?-1:c}function j(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function k(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function l(a){var b=d();return b.fromInt(a),b}function m(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.t=0,this.s=0;for(var e=b.length,f=!1,g=0;--e>=0;){var h=8==d?255&b[e]:i(b,e);0>h?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)}function n(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function o(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,i=this.DB-g*this.DB%b;if(g-->0)for(i<this.DB&&(c=this[g]>>i)>0&&(e=!0,f=h(c));g>=0;)b>i?(c=(this[g]&(1<<i)-1)<<b-i,c|=this[--g]>>(i+=this.DB-b)):(c=this[g]>>(i-=b)&d,0>=i&&(i+=this.DB,--g)),c>0&&(e=!0),e&&(f+=h(c));return e?f:"0"}function p(){var b=d();return a.ZERO.subTo(this,b),b}function q(){return this.s<0?this.negate():this}function r(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function s(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function t(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)}function u(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function v(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function w(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function x(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function y(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function z(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)}function A(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function B(b,c,e){var f=b.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=c&&c.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=d());var h=d(),i=this.s,j=b.s,k=this.DB-s(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=e.t,t=r-l,u=null==c?d():c;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),a.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--t>=0;){var v=e[--r]==m?this.DM:Math.floor(e[r]*o+(e[r-1]+q)*p);if((e[r]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e[r]<--v;)e.subTo(u,e)}null!=c&&(e.drShiftTo(l,c),i!=j&&a.ZERO.subTo(c,c)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&a.ZERO.subTo(e,e)}}}function C(b){var c=d();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(a.ZERO)>0&&b.subTo(c,c),c}function D(a){this.m=a}function E(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function F(a){return a}function G(a){a.divRemTo(this.m,null,a)}function H(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function I(a,b){a.squareTo(b),this.reduce(b)}function J(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function K(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function L(b){var c=d();return b.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),b.s<0&&c.compareTo(a.ZERO)>0&&this.m.subTo(c,c),c}function M(a){var b=d();return a.copyTo(b),this.reduce(b),b}function N(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function O(a,b){a.squareTo(b),this.reduce(b)}function P(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Q(){return 0==(this.t>0?1&this[0]:this.s)}function R(b,c){if(b>4294967295||1>b)return a.ONE;var e=d(),f=d(),g=c.convert(this),h=s(b)-1;for(g.copyTo(e);--h>=0;)if(c.sqrTo(e,f),(b&1<<h)>0)c.mulTo(f,g,e);else{var i=e;e=f,f=i}return c.revert(e)}function S(a,b){var c;return c=256>a||b.isEven()?new D(b):new K(b),this.exp(a,c)
}function T(){var a=d();return this.copyTo(a),a}function U(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function V(){return 0==this.t?this.s:this[0]<<24>>24}function W(){return 0==this.t?this.s:this[0]<<16>>16}function X(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Y(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Z(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),e=l(c),f=d(),g=d(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function $(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,h=0,j=0;j<b.length;++j){var k=i(b,j);0>k?"-"==b.charAt(j)&&0==this.signum()&&(f=!0):(h=c*h+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(h,0)),f&&a.ZERO.subTo(this,this)}function _(b,c,d){if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),hb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{var e=new Array,f=7&b;e.length=(b>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ab(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function bb(a){return 0==this.compareTo(a)}function cb(a){return this.compareTo(a)<0?this:a}function db(a){return this.compareTo(a)>0?this:a}function eb(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function fb(a,b){return a&b}function gb(a){var b=d();return this.bitwiseTo(a,fb,b),b}function hb(a,b){return a|b}function ib(a){var b=d();return this.bitwiseTo(a,hb,b),b}function jb(a,b){return a^b}function kb(a){var b=d();return this.bitwiseTo(a,jb,b),b}function lb(a,b){return a&~b}function mb(a){var b=d();return this.bitwiseTo(a,lb,b),b}function nb(){for(var a=d(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function ob(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function pb(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function qb(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function rb(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+qb(this[a]);return this.s<0?this.t*this.DB:-1}function sb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function tb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=sb(this[c]^b);return a}function ub(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function vb(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d}function wb(a){return this.changeBit(a,hb)}function xb(a){return this.changeBit(a,lb)}function yb(a){return this.changeBit(a,jb)}function zb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ab(a){var b=d();return this.addTo(a,b),b}function Bb(a){var b=d();return this.subTo(a,b),b}function Cb(a){var b=d();return this.multiplyTo(a,b),b}function Db(){var a=d();return this.squareTo(a),a}function Eb(a){var b=d();return this.divRemTo(a,b,null),b}function Fb(a){var b=d();return this.divRemTo(a,null,b),b}function Gb(a){var b=d(),c=d();return this.divRemTo(a,b,c),new Array(b,c)}function Hb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ib(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Jb(){}function Kb(a){return a}function Lb(a,b,c){a.multiplyTo(b,c)}function Mb(a,b){a.squareTo(b)}function Nb(a){return this.exp(a,new Jb)}function Ob(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Pb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Qb(b){this.r2=d(),this.q3=d(),a.ONE.dlShiftTo(2*b.t,this.r2),this.mu=this.r2.divide(b),this.m=b}function Rb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=d();return a.copyTo(b),this.reduce(b),b}function Sb(a){return a}function Tb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Ub(a,b){a.squareTo(b),this.reduce(b)}function Vb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Wb(a,b){var c,e,f=a.bitLength(),g=l(1);if(0>=f)return g;c=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new D(b):b.isEven()?new Qb(b):new K(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=e.convert(this),c>1){var m=d();for(e.sqrTo(h[1],m);k>=i;)h[i]=d(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=d();for(f=s(a[p])-1;p>=0;){for(f>=j?n=a[p]>>f-j&k:(n=(a[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,r),e.sqrTo(r,g),i-=2;i>0?e.sqrTo(g,r):(o=g,g=r,r=o),e.mulTo(r,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Xb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Yb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function Zb(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=l(1),g=l(0),h=l(0),i=l(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i}function $b(a){var b,c=this.abs();if(1==c.t&&c[0]<=jc[jc.length-1]){for(b=0;b<jc.length;++b)if(c[0]==jc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<jc.length;){for(var d=jc[b],e=b+1;e<jc.length&&kc>d;)d*=jc[e++];for(d=c.modInt(d);e>b;)if(d%jc[b++]==0)return!1}return c.millerRabin(a)}function _b(b){var c=this.subtract(a.ONE),e=c.getLowestSetBit();if(0>=e)return!1;var f=c.shiftRight(e);b=b+1>>1,b>jc.length&&(b=jc.length);for(var g=d(),h=0;b>h;++h){g.fromInt(jc[Math.floor(Math.random()*jc.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(a.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<e&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(a.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}var ac,bc=0xdeadbeefcafe,cc=15715070==(16777215&bc),dc="undefined"!=typeof navigator;dc&&cc&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=f,ac=30):dc&&cc&&"Netscape"!=navigator.appName?(a.prototype.am=e,ac=26):(a.prototype.am=g,ac=28),a.prototype.DB=ac,a.prototype.DM=(1<<ac)-1,a.prototype.DV=1<<ac;var ec=52;a.prototype.FV=Math.pow(2,ec),a.prototype.F1=ec-ac,a.prototype.F2=2*ac-ec;var fc,gc,hc="0123456789abcdefghijklmnopqrstuvwxyz",ic=new Array;for(fc="0".charCodeAt(0),gc=0;9>=gc;++gc)ic[fc++]=gc;for(fc="a".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;for(fc="A".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;D.prototype.convert=E,D.prototype.revert=F,D.prototype.reduce=G,D.prototype.mulTo=H,D.prototype.sqrTo=I,K.prototype.convert=L,K.prototype.revert=M,K.prototype.reduce=N,K.prototype.mulTo=P,K.prototype.sqrTo=O,a.prototype.copyTo=j,a.prototype.fromInt=k,a.prototype.fromString=m,a.prototype.clamp=n,a.prototype.dlShiftTo=u,a.prototype.drShiftTo=v,a.prototype.lShiftTo=w,a.prototype.rShiftTo=x,a.prototype.subTo=y,a.prototype.multiplyTo=z,a.prototype.squareTo=A,a.prototype.divRemTo=B,a.prototype.invDigit=J,a.prototype.isEven=Q,a.prototype.exp=R,a.prototype.toString=o,a.prototype.negate=p,a.prototype.abs=q,a.prototype.compareTo=r,a.prototype.bitLength=t,a.prototype.mod=C,a.prototype.modPowInt=S,a.ZERO=l(0),a.ONE=l(1),Jb.prototype.convert=Kb,Jb.prototype.revert=Kb,Jb.prototype.mulTo=Lb,Jb.prototype.sqrTo=Mb,Qb.prototype.convert=Rb,Qb.prototype.revert=Sb,Qb.prototype.reduce=Tb,Qb.prototype.mulTo=Vb,Qb.prototype.sqrTo=Ub;var jc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],kc=(1<<26)/jc[jc.length-1];a.prototype.chunkSize=X,a.prototype.toRadix=Z,a.prototype.fromRadix=$,a.prototype.fromNumber=_,a.prototype.bitwiseTo=eb,a.prototype.changeBit=vb,a.prototype.addTo=zb,a.prototype.dMultiply=Hb,a.prototype.dAddOffset=Ib,a.prototype.multiplyLowerTo=Ob,a.prototype.multiplyUpperTo=Pb,a.prototype.modInt=Yb,a.prototype.millerRabin=_b,a.prototype.clone=T,a.prototype.intValue=U,a.prototype.byteValue=V,a.prototype.shortValue=W,a.prototype.signum=Y,a.prototype.toByteArray=ab,a.prototype.equals=bb,a.prototype.min=cb,a.prototype.max=db,a.prototype.and=gb,a.prototype.or=ib,a.prototype.xor=kb,a.prototype.andNot=mb,a.prototype.not=nb,a.prototype.shiftLeft=ob,a.prototype.shiftRight=pb,a.prototype.getLowestSetBit=rb,a.prototype.bitCount=tb,a.prototype.testBit=ub,a.prototype.setBit=wb,a.prototype.clearBit=xb,a.prototype.flipBit=yb,a.prototype.add=Ab,a.prototype.subtract=Bb,a.prototype.multiply=Cb,a.prototype.divide=Eb,a.prototype.remainder=Fb,a.prototype.divideAndRemainder=Gb,a.prototype.modPow=Wb,a.prototype.modInverse=Zb,a.prototype.pow=Nb,a.prototype.gcd=Xb,a.prototype.isProbablePrime=$b,a.prototype.square=Db,a.prototype.Barrett=Qb,"undefined"!=typeof c?c=b.exports=a:this.BigInteger=a}).call(this)},{}],121:[function(a,b,c){!function(d){"use strict";function e(b){var c={};return c.VERSION="3.8.1",c.WIRE_TYPES={},c.WIRE_TYPES.VARINT=0,c.WIRE_TYPES.BITS64=1,c.WIRE_TYPES.LDELIM=2,c.WIRE_TYPES.STARTGROUP=3,c.WIRE_TYPES.ENDGROUP=4,c.WIRE_TYPES.BITS32=5,c.PACKABLE_WIRE_TYPES=[c.WIRE_TYPES.VARINT,c.WIRE_TYPES.BITS64,c.WIRE_TYPES.BITS32],c.TYPES={int32:{name:"int32",wireType:c.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:c.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:c.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:c.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:c.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:c.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:c.WIRE_TYPES.VARINT},"double":{name:"double",wireType:c.WIRE_TYPES.BITS64},string:{name:"string",wireType:c.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:c.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:c.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:c.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:c.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:c.WIRE_TYPES.BITS64},"float":{name:"float",wireType:c.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:c.WIRE_TYPES.VARINT},message:{name:"message",wireType:c.WIRE_TYPES.LDELIM},group:{name:"group",wireType:c.WIRE_TYPES.STARTGROUP}},c.ID_MIN=1,c.ID_MAX=536870911,c.ByteBuffer=b,c.Long=b.Long||null,c.convertFieldsToCamelCase=!1,c.populateAccessors=!0,c.Util=function(){Object.create||(Object.create=function(a){function b(){}if(arguments.length>1)throw Error("Object.create polyfill only accepts the first parameter.");return b.prototype=a,new b});var b={};b.IS_NODE=!1;try{b.IS_NODE="function"==typeof a&&"function"==typeof a("fs").readFileSync&&"function"==typeof a("path").resolve}catch(c){}return b.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=null,c=0;c<a.length;c++){try{b=a[c]()}catch(d){continue}break}if(!b)throw Error("XMLHttpRequest is not supported");return b},b.fetch=function(c,d){if(d&&"function"!=typeof d&&(d=null),b.IS_NODE)if(d)a("fs").readFile(c,function(a,b){d(a?null:""+b)});else try{return a("fs").readFileSync(c)}catch(e){return null}else{var f=b.XHR();if(f.open("GET",c,d?!0:!1),f.setRequestHeader("Accept","text/plain"),"function"==typeof f.overrideMimeType&&f.overrideMimeType("text/plain"),!d)return f.send(null),200==f.status||0==f.status&&"string"==typeof f.responseText?f.responseText:null;if(f.onreadystatechange=function(){4==f.readyState&&d(200==f.status||0==f.status&&"string"==typeof f.responseText?f.responseText:null)},4==f.readyState)return;f.send(null)}},b.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},b}(),c.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i},c.DotProto=function(a,b){var c={},d=function(a){this.source=""+a,this.index=0,this.line=1,this.stack=[],this.readingString=!1,this.stringEndsWith=b.STRINGCLOSE},e=d.prototype;e._readString=function(){b.STRING.lastIndex=this.index-1;var a;if(null!==(a=b.STRING.exec(this.source))){var c=a[1];return this.index=b.STRING.lastIndex,this.stack.push(this.stringEndsWith),c}throw Error("Unterminated string at line "+this.line+", index "+this.index)},e.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var a,c;do{for(a=!1;b.WHITESPACE.test(c=this.source.charAt(this.index));)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,this.line++,a=!0}else{if("*"!==this.source.charAt(this.index))throw Error("Unterminated comment at line "+this.line+": /"+this.source.charAt(this.index));for(c="";c+(c=this.source.charAt(this.index))!=="*/";)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;this.index++,a=!0}}while(a);if(this.index===this.source.length)return null;var d=this.index;b.DELIM.lastIndex=0;var e=b.DELIM.test(this.source.charAt(d));if(e)++d;else for(++d;d<this.source.length&&!b.DELIM.test(this.source.charAt(d));)d++;var f=this.source.substring(this.index,this.index=d);return f===b.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE):f===b.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE_SQ),f},e.peek=function(){if(0===this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]},e.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"},c.Tokenizer=d;var f=function(a){this.tn=new d(a)},g=f.prototype;return g.parse=function(){for(var a,b={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},c=!0;a=this.tn.next();)switch(a){case"package":if(!c||null!==b["package"])throw Error("Unexpected package at line "+this.tn.line);b["package"]=this._parsePackage(a);break;case"import":if(!c)throw Error("Unexpected import at line "+this.tn.line);b.imports.push(this._parseImport(a));break;case"message":this._parseMessage(b,null,a),c=!1;break;case"enum":this._parseEnum(b,a),c=!1;break;case"option":if(!c)throw Error("Unexpected option at line "+this.tn.line);this._parseOption(b,a);break;case"service":this._parseService(b,a);break;case"extend":this._parseExtend(b,a);break;case"syntax":this._parseIgnoredStatement(b,a);break;default:throw Error("Unexpected token at line "+this.tn.line+": "+a)}return delete b.name,b},g._parseNumber=function(a){var c=1;if("-"==a.charAt(0)&&(c=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))return c*parseInt(a,10);if(b.NUMBER_HEX.test(a))return c*parseInt(a.substring(2),16);if(b.NUMBER_OCT.test(a))return c*parseInt(a.substring(1),8);if(b.NUMBER_FLT.test(a))return c*parseFloat(a);throw Error("Illegal number at line "+this.tn.line+": "+(0>c?"-":"")+a)},g._parseString=function(){var a,c="";do{if(a=this.tn.next(),c+=this.tn.next(),a=this.tn.next(),a!==this.tn.stringEndsWith)throw Error("Illegal end of string at line "+this.tn.line+": "+a);a=this.tn.peek()}while(a===b.STRINGOPEN||a===b.STRINGOPEN_SQ);return c},g._parseId=function(a,c){var d=-1,e=1;if("-"==a.charAt(0)&&(e=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))d=parseInt(a);else if(b.NUMBER_HEX.test(a))d=parseInt(a.substring(2),16);else{if(!b.NUMBER_OCT.test(a))throw Error("Illegal id at line "+this.tn.line+": "+(0>e?"-":"")+a);d=parseInt(a.substring(1),8)}if(d=e*d|0,!c&&0>d)throw Error("Illegal id at line "+this.tn.line+": "+(0>e?"-":"")+a);return d},g._parsePackage=function(a){if(a=this.tn.next(),!b.TYPEREF.test(a))throw Error("Illegal package name at line "+this.tn.line+": "+a);var c=a;if(a=this.tn.next(),a!=b.END)throw Error("Illegal end of package at line "+this.tn.line+": "+a);return c},g._parseImport=function(a){if(a=this.tn.peek(),"public"===a&&(this.tn.next(),a=this.tn.peek()),a!==b.STRINGOPEN&&a!==b.STRINGOPEN_SQ)throw Error("Illegal start of import at line "+this.tn.line+": "+a);var c=this._parseString();if(a=this.tn.next(),a!==b.END)throw Error("Illegal end of import at line "+this.tn.line+": "+a);return c},g._parseOption=function(a,c){c=this.tn.next();var d=!1;if(c==b.COPTOPEN&&(d=!0,c=this.tn.next()),!b.TYPEREF.test(c)&&!/google\.protobuf\./.test(c))throw Error("Illegal option name in message "+a.name+" at line "+this.tn.line+": "+c);var e=c;if(c=this.tn.next(),d){if(c!==b.COPTCLOSE)throw Error("Illegal end in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);e="("+e+")",c=this.tn.next(),b.FQTYPEREF.test(c)&&(e+=c,c=this.tn.next())}if(c!==b.EQUAL)throw Error("Illegal operator in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);var f;if(c=this.tn.peek(),c===b.STRINGOPEN||c===b.STRINGOPEN_SQ)f=this._parseString();else if(this.tn.next(),b.NUMBER.test(c))f=this._parseNumber(c,!0);else if(b.BOOL.test(c))f="true"===c;else{if(!b.TYPEREF.test(c))throw Error("Illegal option value in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);f=c}if(c=this.tn.next(),c!==b.END)throw Error("Illegal end of option in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);a.options[e]=f},g._parseIgnoredStatement=function(a,c){for(var d;;){if(d=this.tn.next(),null===d)throw Error("Unexpected EOF in "+a.name+", "+c+" at line "+this.tn.line);if(d===b.END)break}},g._parseService=function(a,c){if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal service name at line "+this.tn.line+": "+c);var d=c,e={name:d,rpc:{},options:{}};if(c=this.tn.next(),c!==b.OPEN)throw Error("Illegal start of service "+d+" at line "+this.tn.line+": "+c);do if(c=this.tn.next(),"option"===c)this._parseOption(e,c);else if("rpc"===c)this._parseServiceRPC(e,c);else if(c!==b.CLOSE)throw Error("Illegal type of service "+d+" at line "+this.tn.line+": "+c);while(c!==b.CLOSE);a.services.push(e)},g._parseServiceRPC=function(a,c){var d=c;if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal method name in service "+a.name+" at line "+this.tn.line+": "+c);var e=c,f={request:null,response:null,options:{}};if(c=this.tn.next(),c!==b.COPTOPEN)throw Error("Illegal start of request type in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal request type in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(f.request=c,c=this.tn.next(),c!=b.COPTCLOSE)throw Error("Illegal end of request type in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(c=this.tn.next(),"returns"!==c.toLowerCase())throw Error("Illegal delimiter in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(c=this.tn.next(),c!=b.COPTOPEN)throw Error("Illegal start of response type in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(c=this.tn.next(),f.response=c,c=this.tn.next(),c!==b.COPTCLOSE)throw Error("Illegal end of response type in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(c=this.tn.next(),c===b.OPEN){do if(c=this.tn.next(),"option"===c)this._parseOption(f,c);else if(c!==b.CLOSE)throw Error("Illegal start of option inservice "+a.name+"#"+e+" at line "+this.tn.line+": "+c);while(c!==b.CLOSE);this.tn.peek()===b.END&&this.tn.next()}else if(c!==b.END)throw Error("Illegal delimiter in service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);"undefined"==typeof a[d]&&(a[d]={}),a[d][e]=f},g._parseMessage=function(a,c,d){var e={},f="group"===d;if(d=this.tn.next(),!b.NAME.test(d))throw Error("Illegal "+(f?"group":"message")+" name"+(a?" in message "+a.name:"")+" at line "+this.tn.line+": "+d);if(e.name=d,f){if(d=this.tn.next(),d!==b.EQUAL)throw Error("Illegal id assignment after group "+e.name+" at line "+this.tn.line+": "+d);d=this.tn.next();try{c.id=this._parseId(d)}catch(g){throw Error("Illegal field id value for group "+e.name+"#"+c.name+" at line "+this.tn.line+": "+d)}e.isGroup=!0}if(e.fields=[],e.enums=[],e.messages=[],e.options={},e.oneofs={},d=this.tn.next(),d===b.OPTOPEN&&c&&(this._parseFieldOptions(e,c,d),d=this.tn.next()),d!==b.OPEN)throw Error("Illegal start of "+(f?"group":"message")+" "+e.name+" at line "+this.tn.line+": "+d);for(;;){if(d=this.tn.next(),d===b.CLOSE){d=this.tn.peek(),d===b.END&&this.tn.next();break}if(b.RULE.test(d))this._parseMessageField(e,d);else if("oneof"===d)this._parseMessageOneOf(e,d);else if("enum"===d)this._parseEnum(e,d);else if("message"===d)this._parseMessage(e,null,d);else if("option"===d)this._parseOption(e,d);else if("extensions"===d)e.extensions=this._parseExtensions(e,d);else{if("extend"!==d)throw Error("Illegal token in message "+e.name+" at line "+this.tn.line+": "+d);this._parseExtend(e,d)}}return a.messages.push(e),e},g._parseMessageField=function(a,c){var d={},e=null;if(d.rule=c,d.options={},c=this.tn.next(),"group"===c){if(e=this._parseMessage(a,d,c),!/^[A-Z]/.test(e.name))throw Error("Group names must start with a capital letter");d.type=e.name,d.name=e.name.toLowerCase(),c=this.tn.peek(),c===b.END&&this.tn.next()}else{if(!b.TYPE.test(c)&&!b.TYPEREF.test(c))throw Error("Illegal field type in message "+a.name+" at line "+this.tn.line+": "+c);if(d.type=c,c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal field name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal token in field "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c);c=this.tn.next();try{d.id=this._parseId(c)}catch(f){throw Error("Illegal field id in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c)}if(c=this.tn.next(),c===b.OPTOPEN&&(this._parseFieldOptions(a,d,c),c=this.tn.next()),c!==b.END)throw Error("Illegal delimiter in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c)}return a.fields.push(d),d},g._parseMessageOneOf=function(a,c){if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal oneof name in message "+a.name+" at line "+this.tn.line+": "+c);var d,e=c,f=[];if(c=this.tn.next(),c!==b.OPEN)throw Error("Illegal start of oneof "+e+" at line "+this.tn.line+": "+c);for(;this.tn.peek()!==b.CLOSE;)d=this._parseMessageField(a,"optional"),d.oneof=e,f.push(d.id);this.tn.next(),a.oneofs[e]=f},g._parseFieldOptions=function(a,c,d){for(var e=!0;;){if(d=this.tn.next(),d===b.OPTCLOSE)break;if(d===b.OPTEND){if(e)throw Error("Illegal start of options in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);d=this.tn.next()}this._parseFieldOption(a,c,d),e=!1}},g._parseFieldOption=function(a,c,d){var e=!1;if(d===b.COPTOPEN&&(d=this.tn.next(),e=!0),!b.TYPEREF.test(d))throw Error("Illegal field option in "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);var f=d;if(d=this.tn.next(),e){if(d!==b.COPTCLOSE)throw Error("Illegal delimiter in "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);f="("+f+")",d=this.tn.next(),b.FQTYPEREF.test(d)&&(f+=d,d=this.tn.next())}if(d!==b.EQUAL)throw Error("Illegal token in "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);var g;if(d=this.tn.peek(),d===b.STRINGOPEN||d===b.STRINGOPEN_SQ)g=this._parseString();else if(b.NUMBER.test(d,!0))g=this._parseNumber(this.tn.next(),!0);else if(b.BOOL.test(d))g="true"===this.tn.next().toLowerCase();else{if(!b.TYPEREF.test(d))throw Error("Illegal value in message "+a.name+"#"+c.name+", option "+f+" at line "+this.tn.line+": "+d);g=this.tn.next()}c.options[f]=g},g._parseEnum=function(a,c){var d={};if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal enum name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.OPEN)throw Error("Illegal start of enum "+d.name+" at line "+this.tn.line+": "+c);for(d.values=[],d.options={};;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c===b.END&&this.tn.next();break}if("option"==c)this._parseOption(d,c);else{if(!b.NAME.test(c))throw Error("Illegal name in enum "+d.name+" at line "+this.tn.line+": "+c);this._parseEnumValue(d,c)}}a.enums.push(d)},g._parseEnumValue=function(a,c){var d={};if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal token in enum "+a.name+" at line "+this.tn.line+": "+c);c=this.tn.next();try{d.id=this._parseId(c,!0)}catch(e){throw Error("Illegal id in enum "+a.name+" at line "+this.tn.line+": "+c)}if(a.values.push(d),c=this.tn.next(),c===b.OPTOPEN){var f={options:{}};this._parseFieldOptions(a,f,c),c=this.tn.next()}if(c!==b.END)throw Error("Illegal delimiter in enum "+a.name+" at line "+this.tn.line+": "+c)},g._parseExtensions=function(c,d){var e=[];if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),"to"!==d)throw Error("Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+": "+d);if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),d!==b.END)throw Error("Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+": "+d);return e},g._parseExtend=function(a,c){if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal message name at line "+this.tn.line+": "+c);var d={};if(d.ref=c,d.fields=[],c=this.tn.next(),c!==b.OPEN)throw Error("Illegal start of extend "+d.name+" at line "+this.tn.line+": "+c);for(;;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c==b.END&&this.tn.next();break}if(!b.RULE.test(c))throw Error("Illegal token in extend "+d.name+" at line "+this.tn.line+": "+c);this._parseMessageField(d,c)}return a.messages.push(d),d},g.toString=function(){return"Parser"},c.Parser=f,c}(c,c.Lang),c.Reflect=function(a){function c(b,d){var e=d.readVarint32(),f=7&e,g=e>>3;switch(f){case a.WIRE_TYPES.VARINT:do e=d.readUint8();while(128===(128&e));break;case a.WIRE_TYPES.BITS64:d.offset+=8;break;case a.WIRE_TYPES.LDELIM:e=d.readVarint32(),d.offset+=e;break;case a.WIRE_TYPES.STARTGROUP:c(g,d);break;case a.WIRE_TYPES.ENDGROUP:if(g===b)return!1;throw Error("Illegal GROUPEND after unknown group: "+g+" ("+b+" expected)");case a.WIRE_TYPES.BITS32:d.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+b+": "+f)}return!0}function d(b,c){if(b&&"number"==typeof b.low&&"number"==typeof b.high&&"boolean"==typeof b.unsigned&&b.low===b.low&&b.high===b.high)return new a.Long(b.low,b.high,"undefined"==typeof c?b.unsigned:c);if("string"==typeof b)return a.Long.fromString(b,c||!1,10);if("number"==typeof b)return a.Long.fromNumber(b,c||!1);throw Error("not convertible to Long")}var e={},f=function(a,b,c){this.builder=a,this.parent=b,this.name=c,this.className},g=f.prototype;g.fqn=function(){for(var a=this.name,b=this;;){if(b=b.parent,null==b)break;a=b.name+"."+a}return a},g.toString=function(a){return(a?this.className+" ":"")+this.fqn()},g.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},e.T=f;var h=function(a,b,c,d){f.call(this,a,b,c),this.className="Namespace",this.children=[],this.options=d||{}},i=h.prototype=Object.create(f.prototype);i.getChildren=function(a){if(a=a||null,null==a)return this.children.slice();for(var b=[],c=0,d=this.children.length;d>c;++c)this.children[c]instanceof a&&b.push(this.children[c]);return b},i.addChild=function(a){var b;if(b=this.getChild(a.name))if(b instanceof j.Field&&b.name!==b.originalName&&null===this.getChild(b.originalName))b.name=b.originalName;else{if(!(a instanceof j.Field&&a.name!==a.originalName&&null===this.getChild(a.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+a.name);a.name=a.originalName}this.children.push(a)},i.getChild=function(a){for(var b="number"==typeof a?"id":"name",c=0,d=this.children.length;d>c;++c)if(this.children[c][b]===a)return this.children[c];return null},i.resolve=function(a,b){var c=a.split("."),d=this,f=0;if(""===c[f]){for(;null!==d.parent;)d=d.parent;f++}var g;do{do{if(g=d.getChild(c[f]),!g||!(g instanceof e.T)||b&&g instanceof e.Message.Field){d=null;break}d=g,f++}while(f<c.length);if(null!=d)break;if(null!==this.parent)return this.parent.resolve(a,b)}while(null!=d);return d},i.build=function(){for(var a,b={},c=this.children,d=0,e=c.length;e>d;++d)a=c[d],a instanceof h&&(b[a.name]=a.build());return Object.defineProperty&&Object.defineProperty(b,"$options",{value:this.buildOpt()}),b
},i.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0,d=b.length;d>c;++c){var e=b[c],f=this.options[b[c]];a[e]=f}return a},i.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?this.options[a]:null},e.Namespace=h;var j=function(b,c,d,e,f){h.call(this,b,c,d,e),this.className="Message",this.extensions=[a.ID_MIN,a.ID_MAX],this.clazz=null,this.isGroup=!!f,this._fields=null,this._fieldsById=null,this._fieldsByName=null},k=j.prototype=Object.create(h.prototype);k.build=function(c){if(this.clazz&&!c)return this.clazz;var d=function(a,c){function d(a,c){var e={};for(var f in a)a.hasOwnProperty(f)&&(null===a[f]||"object"!=typeof a[f]?e[f]=a[f]:a[f]instanceof b?c&&(e[f]=a[f].toBase64()):e[f]=d(a[f],c));return e}var e=c.getChildren(a.Reflect.Message.Field),f=c.getChildren(a.Reflect.Message.OneOf),g=function(c){a.Builder.Message.call(this);for(var d=0,g=f.length;g>d;++d)this[f[d].name]=null;for(d=0,g=e.length;g>d;++d){var h=e[d];this[h.name]=h.repeated?[]:null,h.required&&null!==h.defaultValue&&(this[h.name]=h.defaultValue)}if(arguments.length>0)if(1!==arguments.length||"object"!=typeof c||"function"==typeof c.encode||a.Util.isArray(c)||c instanceof b||c instanceof ArrayBuffer||a.Long&&c instanceof a.Long)for(d=0,g=arguments.length;g>d;++d)this.$set(e[d].name,arguments[d]);else{var i=Object.keys(c);for(d=0,g=i.length;g>d;++d)this.$set(i[d],c[i[d]])}},h=g.prototype=Object.create(a.Builder.Message.prototype);h.add=function(b,d,e){var f=c._fieldsByName[b];if(!e){if(!f)throw Error(this+"#"+b+" is undefined");if(!(f instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+b+" is not a repeated field")}null===this[f.name]&&(this[f.name]=[]),this[f.name].push(e?d:f.verifyValue(d,!0))},h.$add=h.add,h.set=function(b,d,e){if(b&&"object"==typeof b){for(var f in b)b.hasOwnProperty(f)&&this.$set(f,b[f],e);return this}var g=c._fieldsByName[b];if(e)this[g.name]=d;else{if(!g)throw Error(this+"#"+b+" is not a field: undefined");if(!(g instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+g.toString(!0));this[g.name]=d=g.verifyValue(d)}return g.oneof&&(null!==d?(null!==this[g.oneof.name]&&(this[this[g.oneof.name]]=null),this[g.oneof.name]=g.name):g.oneof.name===b&&(this[g.oneof.name]=null)),this},h.$set=h.set,h.get=function(b,d){if(d)return this[b];var e=c._fieldsByName[b];if(!(e&&e instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: undefined");if(!(e instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+e.toString(!0));return this[e.name]},h.$get=h.get;for(var i=0;i<e.length;i++){var j=e[i];j instanceof a.Reflect.Message.ExtensionField||c.builder.options.populateAccessors&&function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")});b=b.substring(0,1).toUpperCase()+b.substring(1);var d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a}),e=function(b,c){return this[a.name]=c?b:a.verifyValue(b),this},f=function(){return this[a.name]};null===c.getChild("set"+b)&&(h["set"+b]=e),null===c.getChild("set_"+d)&&(h["set_"+d]=e),null===c.getChild("get"+b)&&(h["get"+b]=f),null===c.getChild("get_"+d)&&(h["get_"+d]=f)}(j)}h.encode=function(a,d){"boolean"==typeof a&&(d=a,a=void 0);var e=!1;a||(a=new b,e=!0);var f=a.littleEndian;try{return c.encode(this,a.LE(),d),(e?a.flip():a).LE(f)}catch(g){throw a.LE(f),g}},h.calculate=function(){return c.calculate(this)},h.encodeDelimited=function(a){var d=!1;a||(a=new b,d=!0);var e=(new b).LE();return c.encode(this,e).flip(),a.writeVarint32(e.remaining()),a.append(e),d?a.flip():a},h.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toArrayBuffer()),a}},h.toArrayBuffer=h.encodeAB,h.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a}},h.toBuffer=h.encodeNB,h.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a}},h.toBase64=h.encode64,h.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toHex()),a}},h.toHex=h.encodeHex,h.toRaw=function(a){return d(this,!!a)},g.decode=function(a,d){"string"==typeof a&&(a=b.wrap(a,d?d:"base64")),a=a instanceof b?a:b.wrap(a);var e=a.littleEndian;try{var f=c.decode(a.LE());return a.LE(e),f}catch(g){throw a.LE(e),g}},g.decodeDelimited=function(a,d){if("string"==typeof a&&(a=b.wrap(a,d?d:"base64")),a=a instanceof b?a:b.wrap(a),a.remaining()<1)return null;var e=a.offset,f=a.readVarint32();if(a.remaining()<f)return a.offset=e,null;try{var g=c.decode(a.slice(a.offset,a.offset+f).LE());return a.offset+=f,g}catch(h){throw a.offset+=f,h}},g.decode64=function(a){return g.decode(a,"base64")},g.decodeHex=function(a){return g.decode(a,"hex")},h.toString=function(){return c.toString()};return Object.defineProperty&&(Object.defineProperty(g,"$options",{value:c.buildOpt()}),Object.defineProperty(h,"$type",{get:function(){return c}})),g}(a,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var e,f=0,g=this.children.length;g>f;f++)if(e=this.children[f],e instanceof p)d[e.name]=e.build();else if(e instanceof j)d[e.name]=e.build();else if(e instanceof j.Field)e.build(),this._fields.push(e),this._fieldsById[e.id]=e,this._fieldsByName[e.name]=e;else if(!(e instanceof j.OneOf||e instanceof s))throw Error("Illegal reflect child of "+this.toString(!0)+": "+children[f].toString(!0));return this.clazz=d},k.encode=function(a,b,c){for(var d,e,f=null,g=0,h=this._fields.length;h>g;++g)d=this._fields[g],e=a[d.name],d.required&&null===e?null===f&&(f=d):d.encode(c?e:d.verifyValue(e),b);if(null!==f){var i=Error("Missing at least one required field for "+this.toString(!0)+": "+f);throw i.encoded=b,i}return b},k.calculate=function(a){for(var b,c,d=0,e=0,f=this._fields.length;f>e;++e){if(b=this._fields[e],c=a[b.name],b.required&&null===c)throw Error("Missing at least one required field for "+this.toString(!0)+": "+b);d+=b.calculate(c)}return d},k.decode=function(b,d,e){d="number"==typeof d?d:-1;for(var f,g,h,i,j=b.offset,k=new this.clazz;b.offset<j+d||-1===d&&b.remaining()>0;){if(f=b.readVarint32(),g=7&f,h=f>>3,g===a.WIRE_TYPES.ENDGROUP){if(h!==e)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+h+" ("+(e?e+" expected":"not a group")+")");break}if(i=this._fieldsById[h])i.repeated&&!i.options.packed?k[i.name].push(i.decode(g,b)):(k[i.name]=i.decode(g,b),i.oneof&&(null!==this[i.oneof.name]&&(this[this[i.oneof.name]]=null),k[i.oneof.name]=i.name));else switch(g){case a.WIRE_TYPES.VARINT:b.readVarint32();break;case a.WIRE_TYPES.BITS32:b.offset+=4;break;case a.WIRE_TYPES.BITS64:b.offset+=8;break;case a.WIRE_TYPES.LDELIM:var l=b.readVarint32();b.offset+=l;break;case a.WIRE_TYPES.STARTGROUP:for(;c(h,b););break;default:throw Error("Illegal wire type for unknown field "+h+" in "+this.toString(!0)+"#decode: "+g)}}for(var m=0,n=this._fields.length;n>m;++m)if(i=this._fields[m],null===k[i.name]){if(i.required){var o=Error("Missing at least one required field for "+this.toString(!0)+": "+i.name);throw o.decoded=k,o}null!==i.defaultValue&&(k[i.name]=i.defaultValue)}return k},e.Message=j;var l=function(a,b,c,d,e,g,h,i){f.call(this,a,b,e),this.className="Message.Field",this.required="required"===c,this.repeated="repeated"===c,this.type=d,this.resolvedType=null,this.id=g,this.options=h||{},this.defaultValue=null,this.oneof=i||null,this.originalName=this.name,!this.builder.options.convertFieldsToCamelCase||this instanceof j.ExtensionField||(this.name=l._toCamelCase(this.name))};l._toCamelCase=function(a){return a.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()})};var m=l.prototype=Object.create(f.prototype);m.build=function(){this.defaultValue="undefined"!=typeof this.options["default"]?this.verifyValue(this.options["default"]):null},m.verifyValue=function(c,e){e=e||!1;var f=function(a,b){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+a+" ("+b+")")}.bind(this);if(null===c)return this.required&&f(typeof c,"required"),null;var g;if(this.repeated&&!e){a.Util.isArray(c)||(c=[c]);var h=[];for(g=0;g<c.length;g++)h.push(this.verifyValue(c[g],!0));return h}switch(!this.repeated&&a.Util.isArray(c)&&f(typeof c,"no array expected"),this.type){case a.TYPES.int32:case a.TYPES.sint32:case a.TYPES.sfixed32:return("number"!=typeof c||c===c&&c%1!==0)&&f(typeof c,"not an integer"),c>4294967295?0|c:c;case a.TYPES.uint32:case a.TYPES.fixed32:return("number"!=typeof c||c===c&&c%1!==0)&&f(typeof c,"not an integer"),0>c?c>>>0:c;case a.TYPES.int64:case a.TYPES.sint64:case a.TYPES.sfixed64:if(a.Long)try{return d(c,!1)}catch(i){f(typeof c,i.message)}else f(typeof c,"requires Long.js");case a.TYPES.uint64:case a.TYPES.fixed64:if(a.Long)try{return d(c,!0)}catch(i){f(typeof c,i.message)}else f(typeof c,"requires Long.js");case a.TYPES.bool:return"boolean"!=typeof c&&f(typeof c,"not a boolean"),c;case a.TYPES["float"]:case a.TYPES["double"]:return"number"!=typeof c&&f(typeof c,"not a number"),c;case a.TYPES.string:return"string"==typeof c||c&&c instanceof String||f(typeof c,"not a string"),""+c;case a.TYPES.bytes:return b.isByteBuffer(c)?c:b.wrap(c,"base64");case a.TYPES["enum"]:var j=this.resolvedType.getChildren(p.Value);for(g=0;g<j.length;g++){if(j[g].name==c)return j[g].id;if(j[g].id==c)return j[g].id}f(c,"not a valid enum value");case a.TYPES.group:case a.TYPES.message:if(c&&"object"==typeof c||f(typeof c,"object expected"),c instanceof this.resolvedType.clazz)return c;if(c instanceof a.Builder.Message){var k={};for(var g in c)c.hasOwnProperty(g)&&(k[g]=c[g]);c=k}return new this.resolvedType.clazz(c)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+c+" (undefined type "+this.type+")")},m.encode=function(c,d){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return d;try{if(this.repeated){var e;if(this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){d.writeVarint32(this.id<<3|a.WIRE_TYPES.LDELIM),d.ensureCapacity(d.offset+=1);var f=d.offset;for(e=0;e<c.length;e++)this.encodeValue(c[e],d);var g=d.offset-f,h=b.calculateVarint32(g);if(h>1){var i=d.slice(f,d.offset);f+=h-1,d.offset=f,d.append(i)}d.writeVarint32(g,f-h)}else for(e=0;e<c.length;e++)d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c[e],d)}else d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c,d)}catch(j){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+j+")")}return d},m.encodeValue=function(c,d){if(null===c)return d;switch(this.type){case a.TYPES.int32:0>c?d.writeVarint64(c):d.writeVarint32(c);break;case a.TYPES.uint32:d.writeVarint32(c);break;case a.TYPES.sint32:d.writeVarint32ZigZag(c);break;case a.TYPES.fixed32:d.writeUint32(c);break;case a.TYPES.sfixed32:d.writeInt32(c);break;case a.TYPES.int64:case a.TYPES.uint64:d.writeVarint64(c);break;case a.TYPES.sint64:d.writeVarint64ZigZag(c);break;case a.TYPES.fixed64:d.writeUint64(c);break;case a.TYPES.sfixed64:d.writeInt64(c);break;case a.TYPES.bool:d.writeVarint32("string"==typeof c?"false"===c.toLowerCase()?0:!!c:c?1:0);break;case a.TYPES["enum"]:d.writeVarint32(c);break;case a.TYPES["float"]:d.writeFloat32(c);break;case a.TYPES["double"]:d.writeFloat64(c);break;case a.TYPES.string:d.writeVString(c);break;case a.TYPES.bytes:if(c.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+c.remaining()+" bytes remaining");var e=c.offset;d.writeVarint32(c.remaining()),d.append(c),c.offset=e;break;case a.TYPES.message:var f=(new b).LE();this.resolvedType.encode(c,f),d.writeVarint32(f.offset),d.append(f.flip());break;case a.TYPES.group:this.resolvedType.encode(c,d),d.writeVarint32(this.id<<3|a.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+c+" (unknown type)")}return d},m.calculate=function(c){if(c=this.verifyValue(c),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return 0;var d=0;try{if(this.repeated){var e,f;if(this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(d+=b.calculateVarint32(this.id<<3|a.WIRE_TYPES.LDELIM),f=0,e=0;e<c.length;e++)f+=this.calculateValue(c[e]);d+=b.calculateVarint32(f),d+=f}else for(e=0;e<c.length;e++)d+=b.calculateVarint32(this.id<<3|this.type.wireType),d+=this.calculateValue(c[e])}else d+=b.calculateVarint32(this.id<<3|this.type.wireType),d+=this.calculateValue(c)}catch(g){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+g+")")}return d},m.calculateValue=function(c){if(null===c)return 0;var d;switch(this.type){case a.TYPES.int32:return 0>c?b.calculateVarint64(c):b.calculateVarint32(c);case a.TYPES.uint32:return b.calculateVarint32(c);case a.TYPES.sint32:return b.calculateVarint32(b.zigZagEncode32(c));case a.TYPES.fixed32:case a.TYPES.sfixed32:case a.TYPES["float"]:return 4;case a.TYPES.int64:case a.TYPES.uint64:return b.calculateVarint64(c);case a.TYPES.sint64:return b.calculateVarint64(b.zigZagEncode64(c));case a.TYPES.fixed64:case a.TYPES.sfixed64:return 8;case a.TYPES.bool:return 1;case a.TYPES["enum"]:return b.calculateVarint32(c);case a.TYPES["double"]:return 8;case a.TYPES.string:return d=b.calculateUTF8Bytes(c),b.calculateVarint32(d)+d;case a.TYPES.bytes:if(c.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+c.remaining()+" bytes remaining");return b.calculateVarint32(c.remaining())+c.remaining();case a.TYPES.message:return d=this.resolvedType.calculate(c),b.calculateVarint32(d)+d;case a.TYPES.group:return d=this.resolvedType.calculate(c),d+b.calculateVarint32(this.id<<3|a.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+c+" (unknown type)")},m.decode=function(b,c,d){var e,f;if(b!=this.type.wireType&&(d||b!=a.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+b+" ("+this.type.wireType+" expected)");if(b==a.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!d){f=c.readVarint32(),f=c.offset+f;for(var g=[];c.offset<f;)g.push(this.decode(this.type.wireType,c,!0));return g}switch(this.type){case a.TYPES.int32:return 0|c.readVarint32();case a.TYPES.uint32:return c.readVarint32()>>>0;case a.TYPES.sint32:return 0|c.readVarint32ZigZag();case a.TYPES.fixed32:return c.readUint32()>>>0;case a.TYPES.sfixed32:return 0|c.readInt32();case a.TYPES.int64:return c.readVarint64();case a.TYPES.uint64:return c.readVarint64().toUnsigned();case a.TYPES.sint64:return c.readVarint64ZigZag();case a.TYPES.fixed64:return c.readUint64();case a.TYPES.sfixed64:return c.readInt64();case a.TYPES.bool:return!!c.readVarint32();case a.TYPES["enum"]:return c.readVarint32();case a.TYPES["float"]:return c.readFloat();case a.TYPES["double"]:return c.readDouble();case a.TYPES.string:return c.readVString();case a.TYPES.bytes:if(f=c.readVarint32(),c.remaining()<f)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+f+" required but got only "+c.remaining());return e=c.clone(),e.limit=e.offset+f,c.offset+=f,e;case a.TYPES.message:return f=c.readVarint32(),this.resolvedType.decode(c,f);case a.TYPES.group:return this.resolvedType.decode(c,-1,this.id)}throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+b)},e.Message.Field=l;var n=function(a,b,c,d,e,f,g){l.call(this,a,b,c,d,e,f,g),this.extension};n.prototype=Object.create(l.prototype),e.Message.ExtensionField=n;var o=function(a,b,c){f.call(this,a,b,c),this.fields=[]};e.Message.OneOf=o;var p=function(a,b,c,d){h.call(this,a,b,c,d),this.className="Enum",this.object=null},q=p.prototype=Object.create(h.prototype);q.build=function(){for(var a={},b=this.getChildren(p.Value),c=0,d=b.length;d>c;++c)a[b[c].name]=b[c].id;return Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt()}),this.object=a},e.Enum=p;var r=function(a,b,c,d){f.call(this,a,b,c),this.className="Enum.Value",this.id=d};r.prototype=Object.create(f.prototype),e.Enum.Value=r;var s=function(a,b,c,d){f.call(this,a,b,c),this.field=d};s.prototype=Object.create(f.prototype),e.Extension=s;var t=function(a,b,c,d){h.call(this,a,b,c,d),this.className="Service",this.clazz=null},u=t.prototype=Object.create(h.prototype);u.build=function(b){return this.clazz&&!b?this.clazz:this.clazz=function(a,b){var c=function(b){a.Builder.Service.call(this),this.rpcImpl=b||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},d=c.prototype=Object.create(a.Builder.Service.prototype);Object.defineProperty&&(Object.defineProperty(c,"$options",{value:b.buildOpt()}),Object.defineProperty(d,"$options",{value:c.$options}));for(var e=b.getChildren(a.Reflect.Service.RPCMethod),f=0;f<e.length;f++)!function(a){d[a.name]=function(c,d){try{if(!(c&&c instanceof a.resolvedRequestType.clazz))return void setTimeout(d.bind(this,Error("Illegal request type provided to service method "+b.name+"#"+a.name)),0);this.rpcImpl(a.fqn(),c,function(c,e){if(c)return void d(c);try{e=a.resolvedResponseType.clazz.decode(e)}catch(f){}return e&&e instanceof a.resolvedResponseType.clazz?void d(null,e):void d(Error("Illegal response type received in service method "+b.name+"#"+a.name))})}catch(e){setTimeout(d.bind(this,e),0)}},c[a.name]=function(b,d,e){new c(b)[a.name](d,e)},Object.defineProperty&&(Object.defineProperty(c[a.name],"$options",{value:a.buildOpt()}),Object.defineProperty(d[a.name],"$options",{value:c[a.name].$options}))}(e[f]);return c}(a,this)},e.Service=t;var v=function(a,b,c,d){f.call(this,a,b,c),this.className="Service.Method",this.options=d||{}},w=v.prototype=Object.create(f.prototype);w.buildOpt=i.buildOpt,e.Service.Method=v;var x=function(a,b,c,d,e,f){v.call(this,a,b,c,f),this.className="Service.RPCMethod",this.requestName=d,this.responseName=e,this.resolvedRequestType=null,this.resolvedResponseType=null};return x.prototype=Object.create(v.prototype),e.Service.RPCMethod=x,e}(c),c.Builder=function(b,c,d){var e=function(a){this.ns=new d.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=a||{}},f=e.prototype;return f.reset=function(){this.ptr=this.ns},f.define=function(a,b){if("string"!=typeof a||!c.TYPEREF.test(a))throw Error("Illegal package: "+a);var e,f=a.split(".");for(e=0;e<f.length;e++)if(!c.NAME.test(f[e]))throw Error("Illegal package: "+f[e]);for(e=0;e<f.length;e++)null===this.ptr.getChild(f[e])&&this.ptr.addChild(new d.Namespace(this,this.ptr,f[e],b)),this.ptr=this.ptr.getChild(f[e]);return this},e.isValidMessage=function(a){if("string"!=typeof a.name||!c.NAME.test(a.name))return!1;if("undefined"!=typeof a.values||"undefined"!=typeof a.rpc)return!1;var d;if("undefined"!=typeof a.fields){if(!b.Util.isArray(a.fields))return!1;var f,g=[];for(d=0;d<a.fields.length;d++){if(!e.isValidMessageField(a.fields[d]))return!1;if(f=parseInt(a.fields[d].id,10),g.indexOf(f)>=0)return!1;g.push(f)}g=null}if("undefined"!=typeof a.enums){if(!b.Util.isArray(a.enums))return!1;for(d=0;d<a.enums.length;d++)if(!e.isValidEnum(a.enums[d]))return!1}if("undefined"!=typeof a.messages){if(!b.Util.isArray(a.messages))return!1;for(d=0;d<a.messages.length;d++)if(!e.isValidMessage(a.messages[d])&&!e.isValidExtend(a.messages[d]))return!1}return"undefined"==typeof a.extensions||b.Util.isArray(a.extensions)&&2===a.extensions.length&&"number"==typeof a.extensions[0]&&"number"==typeof a.extensions[1]?!0:!1},e.isValidMessageField=function(a){if("string"!=typeof a.rule||"string"!=typeof a.name||"string"!=typeof a.type||"undefined"==typeof a.id)return!1;if(!(c.RULE.test(a.rule)&&c.NAME.test(a.name)&&c.TYPEREF.test(a.type)&&c.ID.test(""+a.id)))return!1;if("undefined"!=typeof a.options){if("object"!=typeof a.options)return!1;for(var b,d=Object.keys(a.options),e=0;e<d.length;e++)if("string"!=typeof(b=d[e])||"string"!=typeof a.options[b]&&"number"!=typeof a.options[b]&&"boolean"!=typeof a.options[b])return!1}return!0},e.isValidEnum=function(a){if("string"!=typeof a.name||!c.NAME.test(a.name))return!1;if("undefined"==typeof a.values||!b.Util.isArray(a.values)||0==a.values.length)return!1;for(var d=0;d<a.values.length;d++){if("object"!=typeof a.values[d])return!1;if("string"!=typeof a.values[d].name||"undefined"==typeof a.values[d].id)return!1;if(!c.NAME.test(a.values[d].name)||!c.NEGID.test(""+a.values[d].id))return!1}return!0},f.create=function(a){if(!a)return this;if(b.Util.isArray(a)||(a=[a]),0==a.length)return this;var c=[];for(c.push(a);c.length>0;){if(a=c.pop(),!b.Util.isArray(a))throw Error("Not a valid namespace: "+JSON.stringify(a));for(;a.length>0;){var f=a.shift();if(e.isValidMessage(f)){var g=new d.Message(this,this.ptr,f.name,f.options,f.isGroup),h={};if(f.oneofs)for(var i=Object.keys(f.oneofs),j=0,k=i.length;k>j;++j)g.addChild(h[i[j]]=new d.Message.OneOf(this,g,i[j]));if(f.fields&&f.fields.length>0)for(j=0,k=f.fields.length;k>j;++j){var l=f.fields[j];if(null!==g.getChild(l.id))throw Error("Duplicate field id in message "+g.name+": "+l.id);if(l.options)for(var m=Object.keys(l.options),n=0,o=m.length;o>n;++n){if("string"!=typeof m[n])throw Error("Illegal field option name in message "+g.name+"#"+l.name+": "+m[n]);if("string"!=typeof l.options[m[n]]&&"number"!=typeof l.options[m[n]]&&"boolean"!=typeof l.options[m[n]])throw Error("Illegal field option value in message "+g.name+"#"+l.name+"#"+m[n]+": "+l.options[m[n]])}var p=null;if("string"==typeof l.oneof&&(p=h[l.oneof],"undefined"==typeof p))throw Error("Illegal oneof in message "+g.name+"#"+l.name+": "+l.oneof);l=new d.Message.Field(this,g,l.rule,l.type,l.name,l.id,l.options,p),p&&p.fields.push(l),g.addChild(l)}var q=[];if("undefined"!=typeof f.enums&&f.enums.length>0)for(j=0;j<f.enums.length;j++)q.push(f.enums[j]);if(f.messages&&f.messages.length>0)for(j=0;j<f.messages.length;j++)q.push(f.messages[j]);if(f.extensions&&(g.extensions=f.extensions,g.extensions[0]<b.ID_MIN&&(g.extensions[0]=b.ID_MIN),g.extensions[1]>b.ID_MAX&&(g.extensions[1]=b.ID_MAX)),this.ptr.addChild(g),q.length>0){c.push(a),a=q,q=null,this.ptr=g,g=null;continue}q=null,g=null}else if(e.isValidEnum(f)){for(g=new d.Enum(this,this.ptr,f.name,f.options),j=0;j<f.values.length;j++)g.addChild(new d.Enum.Value(this,g,f.values[j].name,f.values[j].id));this.ptr.addChild(g),g=null}else if(e.isValidService(f)){g=new d.Service(this,this.ptr,f.name,f.options);for(j in f.rpc)f.rpc.hasOwnProperty(j)&&g.addChild(new d.Service.RPCMethod(this,g,j,f.rpc[j].request,f.rpc[j].response,f.rpc[j].options));this.ptr.addChild(g),g=null}else{if(!e.isValidExtend(f))throw Error("Not a valid definition: "+JSON.stringify(f));if(g=this.ptr.resolve(f.ref))for(j=0;j<f.fields.length;j++){if(null!==g.getChild(f.fields[j].id))throw Error("Duplicate extended field id in message "+g.name+": "+f.fields[j].id);if(f.fields[j].id<g.extensions[0]||f.fields[j].id>g.extensions[1])throw Error("Illegal extended field id in message "+g.name+": "+f.fields[j].id+" ("+g.extensions.join(" to ")+" expected)");var r=f.fields[j].name;this.options.convertFieldsToCamelCase&&(r=d.Message.Field._toCamelCase(f.fields[j].name)),l=new d.Message.ExtensionField(this,g,f.fields[j].rule,f.fields[j].type,this.ptr.fqn()+"."+r,f.fields[j].id,f.fields[j].options);var s=new d.Extension(this,this.ptr,f.fields[j].name,l);l.extension=s,this.ptr.addChild(s),g.addChild(l)}else if(!/\.?google\.protobuf\./.test(f.ref))throw Error("Extended message "+f.ref+" is not defined")}f=null}a=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},f["import"]=function(c,d){if("string"==typeof d){if(b.Util.IS_NODE&&(d=a("path").resolve(d)),this.files[d]===!0)return this.reset(),this;this.files[d]=!0}if(c.imports&&c.imports.length>0){var e,f="/",g=!1;"object"==typeof d?(this.importRoot=d.root,g=!0,e=this.importRoot,d=d.file,(e.indexOf("\\")>=0||d.indexOf("\\")>=0)&&(f="\\")):"string"==typeof d?this.importRoot?e=this.importRoot:d.indexOf("/")>=0?(e=d.replace(/\/[^\/]*$/,""),""===e&&(e="/")):d.indexOf("\\")>=0?(e=d.replace(/\\[^\\]*$/,""),f="\\"):e=".":e=null;for(var h=0;h<c.imports.length;h++)if("string"==typeof c.imports[h]){if(!e)throw Error("Cannot determine import root: File name is unknown");var i=c.imports[h];if(/^google\/protobuf\//.test(i))continue;if(i=e+f+i,this.files[i]===!0)continue;/\.proto$/i.test(i)&&!b.DotProto&&(i=i.replace(/\.proto$/,".json"));var j=b.Util.fetch(i);if(null===j)throw Error("Failed to import '"+i+"' in '"+d+"': File not found");/\.json$/i.test(i)?this["import"](JSON.parse(j+""),i):this["import"](new b.DotProto.Parser(j+"").parse(),i)}else d?/\.(\w+)$/.test(d)?this["import"](c.imports[h],d.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+h+"."+c})):this["import"](c.imports[h],d+"_import"+h):this["import"](c.imports[h]);g&&(this.importRoot=null)}return c.messages&&(c["package"]&&this.define(c["package"],c.options),this.create(c.messages),this.reset()),c.enums&&(c["package"]&&this.define(c["package"],c.options),this.create(c.enums),this.reset()),c.services&&(c["package"]&&this.define(c["package"],c.options),this.create(c.services),this.reset()),c["extends"]&&(c["package"]&&this.define(c["package"],c.options),this.create(c["extends"]),this.reset()),this},e.isValidService=function(a){return!("string"!=typeof a.name||!c.NAME.test(a.name)||"object"!=typeof a.rpc)},e.isValidExtend=function(a){if("string"!=typeof a.ref||!c.TYPEREF.test(a.ref))return!1;var d;if("undefined"!=typeof a.fields){if(!b.Util.isArray(a.fields))return!1;var f,g=[];for(d=0;d<a.fields.length;d++){if(!e.isValidMessageField(a.fields[d]))return!1;if(f=parseInt(a.id,10),g.indexOf(f)>=0)return!1;g.push(f)}g=null}return!0},f.resolveAll=function(){var a;if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof d.Namespace)for(var e=this.ptr.children,f=0,g=e.length;g>f;++f)this.ptr=e[f],this.resolveAll();else if(this.ptr instanceof d.Message.Field)if(c.TYPE.test(this.ptr.type))this.ptr.type=b.TYPES[this.ptr.type];else{if(!c.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(a=(this.ptr instanceof d.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!a)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=a,a instanceof d.Enum)this.ptr.type=b.TYPES["enum"];else{if(!(a instanceof d.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=a.isGroup?b.TYPES.group:b.TYPES.message}}else if(this.ptr instanceof b.Reflect.Enum.Value);else if(this.ptr instanceof b.Reflect.Service.Method){if(!(this.ptr instanceof b.Reflect.Service.RPCMethod))throw Error("Illegal service type in "+this.ptr.toString(!0));if(a=this.ptr.parent.resolve(this.ptr.requestName),!(a&&a instanceof b.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=a,a=this.ptr.parent.resolve(this.ptr.responseName),!(a&&a instanceof b.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=a}else if(!(this.ptr instanceof b.Reflect.Message.OneOf||this.ptr instanceof b.Reflect.Extension))throw Error("Illegal object in namespace: "+typeof this.ptr+":"+this.ptr);this.reset()}},f.build=function(a){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),a){for(var b=a.split("."),c=this.result,d=0;d<b.length;d++){if(!c[b[d]]){c=null;break}c=c[b[d]]}return c}return this.result},f.lookup=function(a){return a?this.ns.resolve(a):this.ns},f.toString=function(){return"Builder"},e.Message=function(){},e.Service=function(){},e}(c,c.Lang,c.Reflect),c.loadProto=function(a,b,d){return("string"==typeof b||b&&"string"==typeof b.file&&"string"==typeof b.root)&&(d=b,b=void 0),c.loadJson(new c.DotProto.Parser(a).parse(),b,d)},c.protoFromString=c.loadProto,c.loadProtoFile=function(a,b,d){if(b&&"object"==typeof b?(d=b,b=null):b&&"function"==typeof b||(b=null),b)return c.Util.fetch("string"==typeof a?a:a.root+"/"+a.file,function(e){if(null===e)return void b(Error("Failed to fetch file"));try{b(null,c.loadProto(e,d,a))}catch(f){b(f)}});var e=c.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null===e?null:c.loadProto(e,d,a)},c.protoFromFile=c.loadProtoFile,c.newBuilder=function(a){return a=a||{},"undefined"==typeof a.convertFieldsToCamelCase&&(a.convertFieldsToCamelCase=c.convertFieldsToCamelCase),"undefined"==typeof a.populateAccessors&&(a.populateAccessors=c.populateAccessors),new c.Builder(a)},c.loadJson=function(a,b,d){return("string"==typeof b||b&&"string"==typeof b.file&&"string"==typeof b.root)&&(d=b,b=null),b&&"object"==typeof b||(b=c.newBuilder()),"string"==typeof a&&(a=JSON.parse(a)),b["import"](a,d),b.resolveAll(),b},c.loadJsonFile=function(a,b,d){if(b&&"object"==typeof b?(d=b,b=null):b&&"function"==typeof b||(b=null),b)return c.Util.fetch("string"==typeof a?a:a.root+"/"+a.file,function(e){if(null===e)return void b(Error("Failed to fetch file"));try{b(null,c.loadJson(JSON.parse(e),d,a))}catch(f){b(f)}});var e=c.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null===e?null:c.loadJson(JSON.parse(e),d,a)},c}"function"==typeof a&&"object"==typeof b&&b&&"object"==typeof c&&c?b.exports=e(a("bytebuffer")):"function"==typeof define&&define.amd?define(["ByteBuffer"],e):(d.dcodeIO=d.dcodeIO||{}).ProtoBuf=e(d.dcodeIO.ByteBuffer)}(this)},{bytebuffer:123,fs:10,path:30}],122:[function(a,b){var c=a("./dist/ProtoBuf.js");b.exports=c},{"./dist/ProtoBuf.js":121}],123:[function(a,b,c){!function(d){"use strict";function e(a){function b(a){var b=0;return function(){return b<a.length?a.charCodeAt(b++):null}}function c(){var a=[],b=[];return function(){return 0===arguments.length?b.join("")+g.apply(String,a):(a.length+arguments.length>1024&&(b.push(g.apply(String,a)),a.length=0),void Array.prototype.push.apply(a,arguments))}}var d=function(a,b,c){if("undefined"==typeof a&&(a=d.DEFAULT_CAPACITY),"undefined"==typeof b&&(b=d.DEFAULT_ENDIAN),"undefined"==typeof c&&(c=d.DEFAULT_NOASSERT),!c){if(a=0|a,0>a)throw RangeError("Illegal capacity");b=!!b,c=!!c}this.buffer=0===a?f:new ArrayBuffer(a),this.view=0===a?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=a,this.littleEndian="undefined"!=typeof b?!!b:!1,this.noAssert=!!c};d.VERSION="3.5.4",d.LITTLE_ENDIAN=!0,d.BIG_ENDIAN=!1,d.DEFAULT_CAPACITY=16,d.DEFAULT_ENDIAN=d.BIG_ENDIAN,d.DEFAULT_NOASSERT=!1,d.Long=a||null;var e=d.prototype,f=new ArrayBuffer(0),g=String.fromCharCode;d.allocate=function(a,b,c){return new d(a,b,c)},d.concat=function(a,b,c,e){("boolean"==typeof b||"string"!=typeof b)&&(e=c,c=b,b=void 0);for(var f,g=0,h=0,i=a.length;i>h;++h)d.isByteBuffer(a[h])||(a[h]=d.wrap(a[h],b)),f=a[h].limit-a[h].offset,f>0&&(g+=f);if(0===g)return new d(0,c,e);var j,k=new d(g,c,e),l=new Uint8Array(k.buffer);for(h=0;i>h;)j=a[h++],f=j.limit-j.offset,0>=f||(l.set(new Uint8Array(j.buffer).subarray(j.offset,j.limit),k.offset),k.offset+=f);return k.limit=k.offset,k.offset=0,k},d.isByteBuffer=function(a){return(a&&a instanceof d)===!0},d.type=function(){return ArrayBuffer},d.wrap=function(a,b,c,f){if("string"!=typeof b&&(f=c,c=b,b=void 0),"string"==typeof a)switch("undefined"==typeof b&&(b="utf8"),b){case"base64":return d.fromBase64(a,c);case"hex":return d.fromHex(a,c);case"binary":return d.fromBinary(a,c);case"utf8":return d.fromUTF8(a,c);case"debug":return d.fromDebug(a,c);default:throw Error("Unsupported encoding: "+b)}if(null===a||"object"!=typeof a)throw TypeError("Illegal buffer");
var g;if(d.isByteBuffer(a))return g=e.clone.call(a),g.markedOffset=-1,g;if(a instanceof Uint8Array)g=new d(0,c,f),a.length>0&&(g.buffer=a.buffer,g.offset=a.byteOffset,g.limit=a.byteOffset+a.length,g.view=a.length>0?new DataView(a.buffer):null);else if(a instanceof ArrayBuffer)g=new d(0,c,f),a.byteLength>0&&(g.buffer=a,g.offset=0,g.limit=a.byteLength,g.view=a.byteLength>0?new DataView(a):null);else{if("[object Array]"!==Object.prototype.toString.call(a))throw TypeError("Illegal buffer");for(g=new d(a.length,c,f),g.limit=a.length,i=0;i<a.length;++i)g.view.setUint8(i,a[i])}return g},e.writeInt8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view.setInt8(b,a),c&&(this.offset+=1),this},e.writeByte=e.writeInt8,e.readInt8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view.getInt8(a);return b&&(this.offset+=1),c},e.readByte=e.readInt8,e.writeUint8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view.setUint8(b,a),c&&(this.offset+=1),this},e.readUint8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view.getUint8(a);return b&&(this.offset+=1),c},e.writeInt16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.view.setInt16(b,a,this.littleEndian),c&&(this.offset+=2),this},e.writeShort=e.writeInt16,e.readInt16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=this.view.getInt16(a,this.littleEndian);return b&&(this.offset+=2),c},e.readShort=e.readInt16,e.writeUint16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.view.setUint16(b,a,this.littleEndian),c&&(this.offset+=2),this},e.readUint16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=this.view.getUint16(a,this.littleEndian);return b&&(this.offset+=2),c},e.writeInt32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setInt32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.writeInt=e.writeInt32,e.readInt32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getInt32(a,this.littleEndian);return b&&(this.offset+=4),c},e.readInt=e.readInt32,e.writeUint32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setUint32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.readUint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getUint32(a,this.littleEndian);return b&&(this.offset+=4),c},a&&(e.writeInt64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},e.writeLong=e.writeInt64,e.readInt64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!1):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!1);return c&&(this.offset+=8),d},e.readLong=e.readInt64,e.writeUint64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},e.readUint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!0):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!0);return c&&(this.offset+=8),d}),e.writeFloat32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setFloat32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.writeFloat=e.writeFloat32,e.readFloat32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getFloat32(a,this.littleEndian);return b&&(this.offset+=4),c},e.readFloat=e.readFloat32,e.writeFloat64=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=8;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=8,this.view.setFloat64(b,a,this.littleEndian),c&&(this.offset+=8),this},e.writeDouble=e.writeFloat64,e.readFloat64=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+8) <= "+this.buffer.byteLength)}var c=this.view.getFloat64(a,this.littleEndian);return b&&(this.offset+=8),c},e.readDouble=e.readFloat64,d.MAX_VARINT32_BYTES=5,d.calculateVarint32=function(a){return a>>>=0,128>a?1:16384>a?2:1<<21>a?3:1<<28>a?4:5},d.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},d.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},e.writeVarint32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var e,f=d.calculateVarint32(a);b+=f;var g=this.buffer.byteLength;return b>g&&this.resize((g*=2)>b?g:b),b-=f,this.view.setUint8(b,e=128|a),a>>>=0,a>=128?(e=a>>7|128,this.view.setUint8(b+1,e),a>=16384?(e=a>>14|128,this.view.setUint8(b+2,e),a>=1<<21?(e=a>>21|128,this.view.setUint8(b+3,e),a>=1<<28?(this.view.setUint8(b+4,a>>28&15),f=5):(this.view.setUint8(b+3,127&e),f=4)):(this.view.setUint8(b+2,127&e),f=3)):(this.view.setUint8(b+1,127&e),f=2)):(this.view.setUint8(b,127&e),f=1),c?(this.offset+=f,this):f},e.writeVarint32ZigZag=function(a,b){return this.writeVarint32(d.zigZagEncode32(a),b)},e.readVarint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d,e=0,f=0;do{if(d=a+e,!this.noAssert&&d>this.limit){var g=Error("Truncated");throw g.truncated=!0,g}c=this.view.getUint8(d),5>e&&(f|=(127&c)<<7*e>>>0),++e}while(128===(128&c));return f=0|f,b?(this.offset+=e,f):{value:f,length:e}},e.readVarint32ZigZag=function(a){var b=this.readVarint32(a);return"object"==typeof b?b.value=d.zigZagDecode32(b.value):b=d.zigZagDecode32(b),b},a&&(d.MAX_VARINT64_BYTES=10,d.calculateVarint64=function(b){"number"==typeof b&&(b=a.fromNumber(b));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0,e=b.shiftRightUnsigned(56).toInt()>>>0;return 0==e?0==d?16384>c?128>c?1:2:1<<21>c?3:4:16384>d?128>d?5:6:1<<21>d?7:8:128>e?9:10},d.zigZagEncode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):b.unsigned!==!1&&(b=b.toSigned()),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):b.unsigned!==!1&&(b=b.toSigned()),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},e.writeVarint64=function(b,c){var e="undefined"==typeof c;if(e&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b,!1):b.unsigned!==!1&&(b=b.toSigned());var f=d.calculateVarint64(b),g=b.toInt()>>>0,h=b.shiftRightUnsigned(28).toInt()>>>0,i=b.shiftRightUnsigned(56).toInt()>>>0;c+=f;var j=this.buffer.byteLength;switch(c>j&&this.resize((j*=2)>c?j:c),c-=f,f){case 10:this.view.setUint8(c+9,i>>>7&1);case 9:this.view.setUint8(c+8,9!==f?128|i:127&i);case 8:this.view.setUint8(c+7,8!==f?h>>>21|128:h>>>21&127);case 7:this.view.setUint8(c+6,7!==f?h>>>14|128:h>>>14&127);case 6:this.view.setUint8(c+5,6!==f?h>>>7|128:h>>>7&127);case 5:this.view.setUint8(c+4,5!==f?128|h:127&h);case 4:this.view.setUint8(c+3,4!==f?g>>>21|128:g>>>21&127);case 3:this.view.setUint8(c+2,3!==f?g>>>14|128:g>>>14&127);case 2:this.view.setUint8(c+1,2!==f?g>>>7|128:g>>>7&127);case 1:this.view.setUint8(c,1!==f?128|g:127&g)}return e?(this.offset+=f,this):f},e.writeVarint64ZigZag=function(a,b){return this.writeVarint64(d.zigZagEncode64(a),b)},e.readVarint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+1) <= "+this.buffer.byteLength)}var d=b,e=0,f=0,g=0,h=0;if(h=this.view.getUint8(b++),e=127&h,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),f=127&h,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),g=127&h,128&h&&(h=this.view.getUint8(b++),g|=(127&h)<<7,128&h))))))))))throw Error("Buffer overrun");var i=a.fromBits(e|f<<28,f>>>4|g<<24,!1);return c?(this.offset=b,i):{value:i,length:b-d}},e.readVarint64ZigZag=function(b){var c=this.readVarint64(b);return c&&c.value instanceof a?c.value=d.zigZagDecode64(c.value):c=d.zigZagDecode64(c),c}),e.writeCString=function(a,c){var d="undefined"==typeof c;d&&(c=this.offset);var e,f=a.length;if(!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");for(e=0;f>e;++e)if(0===a.charCodeAt(e))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var g=c;f=j.calculateUTF16asUTF8(b(a))[1],c+=f+1;var h=this.buffer.byteLength;return c>h&&this.resize((h*=2)>c?h:c),c-=f+1,j.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),this.view.setUint8(c++,0),d?(this.offset=c-g,this):f},e.readCString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var d,e=a,f=-1;return j.decodeUTF8toUTF16(function(){if(0===f)return null;if(a>=this.limit)throw RangeError("Illegal range: Truncated data, "+a+" < "+this.limit);return 0===(f=this.view.getUint8(a++))?null:f}.bind(this),d=c(),!0),b?(this.offset=a,d()):{string:d(),length:a-e}},e.writeIString=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=j.calculateUTF16asUTF8(b(a),this.noAssert)[1],c+=4+e;var g=this.buffer.byteLength;if(c>g&&this.resize((g*=2)>c?g:c),c-=4+e,this.view.setUint32(c,e,this.littleEndian),c+=4,j.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==f+4+e)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+4+e));return d?(this.offset=c,this):c-f},e.readIString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var d,e=0,f=a;e=this.view.getUint32(a,this.littleEndian),a+=4;var g,h=a+e;return j.decodeUTF8toUTF16(function(){return h>a?this.view.getUint8(a++):null}.bind(this),g=c(),this.noAssert),d=g(),b?(this.offset=a,d):{string:d,length:a-f}},d.METRICS_CHARS="c",d.METRICS_BYTES="b",e.writeUTF8String=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=j.calculateUTF16asUTF8(b(a))[1],c+=e;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=e,j.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),d?(this.offset=c,this):c-f},e.writeString=e.writeUTF8String,d.calculateUTF8Chars=function(a){return j.calculateUTF16asUTF8(b(a))[0]},d.calculateUTF8Bytes=function(a){return j.calculateUTF16asUTF8(b(a))[1]},e.readUTF8String=function(a,b,e){"number"==typeof b&&(e=b,b=void 0);var f="undefined"==typeof e;if(f&&(e=this.offset),"undefined"==typeof b&&(b=d.METRICS_CHARS),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal length: "+a+" (not an integer)");if(a|=0,"number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var g,h=0,i=e;if(b===d.METRICS_CHARS){if(g=c(),j.decodeUTF8(function(){return a>h&&e<this.limit?this.view.getUint8(e++):null}.bind(this),function(a){++h,j.UTF8toUTF16(a,g)}.bind(this)),h!==a)throw RangeError("Illegal range: Truncated data, "+h+" == "+a);return f?(this.offset=e,g()):{string:g(),length:e-i}}if(b===d.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+a>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+"+a+") <= "+this.buffer.byteLength)}var k=e+a;if(j.decodeUTF8toUTF16(function(){return k>e?this.view.getUint8(e++):null}.bind(this),g=c(),this.noAssert),e!==k)throw RangeError("Illegal range: Truncated data, "+e+" == "+k);return f?(this.offset=e,g()):{string:g(),length:e-i}}throw TypeError("Unsupported metrics: "+b)},e.readString=e.readUTF8String,e.writeVString=function(a,c){var e="undefined"==typeof c;if(e&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var f,g,h=c;f=j.calculateUTF16asUTF8(b(a),this.noAssert)[1],g=d.calculateVarint32(f),c+=g+f;var i=this.buffer.byteLength;if(c>i&&this.resize((i*=2)>c?i:c),c-=g+f,c+=this.writeVarint32(f,c),j.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==h+f+g)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+f+g));return e?(this.offset=c,this):c-h},e.readVString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var d,e=this.readVarint32(a),f=a;a+=e.length,e=e.value;var g=a+e,h=c();return j.decodeUTF8toUTF16(function(){return g>a?this.view.getUint8(a++):null}.bind(this),h,this.noAssert),d=h(),b?(this.offset=a,d):{string:d,length:a-f}},e.append=function(a,b,c){("number"==typeof b||"string"!=typeof b)&&(c=b,b=void 0);var e="undefined"==typeof c;if(e&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof d||(a=d.wrap(a,b));var f=a.limit-a.offset;if(0>=f)return this;c+=f;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=f,new Uint8Array(this.buffer,c).set(new Uint8Array(a.buffer).subarray(a.offset,a.limit)),a.offset+=f,e&&(this.offset+=f),this},e.appendTo=function(a,b){return a.append(this,b),this},e.assert=function(a){return this.noAssert=!a,this},e.capacity=function(){return this.buffer.byteLength},e.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},e.clone=function(a){var b=new d(0,this.littleEndian,this.noAssert);if(a){var c=new ArrayBuffer(this.buffer.byteLength);new Uint8Array(c).set(this.buffer),b.buffer=c,b.view=new DataView(c)}else b.buffer=this.buffer,b.view=this.view;return b.offset=this.offset,b.markedOffset=this.markedOffset,b.limit=this.limit,b},e.compact=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(0===a&&b===this.buffer.byteLength)return this;var c=b-a;if(0===c)return this.buffer=f,this.view=null,this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=0,this;var d=new ArrayBuffer(c);return new Uint8Array(d).set(new Uint8Array(this.buffer).subarray(a,b)),this.buffer=d,this.view=new DataView(d),this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=c,this},e.copy=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return new d(0,this.littleEndian,this.noAssert);var c=b-a,e=new d(c,this.littleEndian,this.noAssert);return e.offset=0,e.limit=c,e.markedOffset>=0&&(e.markedOffset-=a),this.copyTo(e,0,a,b),e},e.copyTo=function(a,b,c,e){var f,g;if(!this.noAssert&&!d.isByteBuffer(a))throw TypeError("Illegal target: Not a ByteBuffer");if(b=(g="undefined"==typeof b)?a.offset:0|b,c=(f="undefined"==typeof c)?this.offset:0|c,e="undefined"==typeof e?this.limit:0|e,0>b||b>a.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+b+" <= "+a.buffer.byteLength);if(0>c||e>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+c+" <= "+this.buffer.byteLength);var h=e-c;return 0===h?a:(a.ensureCapacity(b+h),new Uint8Array(a.buffer).set(new Uint8Array(this.buffer).subarray(c,e),b),f&&(this.offset+=h),g&&(a.offset+=h),this)},e.ensureCapacity=function(a){var b=this.buffer.byteLength;return a>b?this.resize((b*=2)>a?b:a):this},e.fill=function(a,b,c){var d="undefined"==typeof b;if(d&&(b=this.offset),"string"==typeof a&&a.length>0&&(a=a.charCodeAt(0)),"undefined"==typeof b&&(b=this.offset),"undefined"==typeof c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal begin: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!==0)throw TypeError("Illegal end: Not an integer");if(c>>>=0,0>b||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(b>=c)return this;for(;c>b;)this.view.setUint8(b++,a);return d&&(this.offset=b),this},e.flip=function(){return this.limit=this.offset,this.offset=0,this},e.mark=function(a){if(a="undefined"==typeof a?this.offset:a,!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=a,this},e.order=function(a){if(!this.noAssert&&"boolean"!=typeof a)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!a,this},e.LE=function(a){return this.littleEndian="undefined"!=typeof a?!!a:!0,this},e.BE=function(a){return this.littleEndian="undefined"!=typeof a?!a:!1,this},e.prepend=function(a,b,c){("number"==typeof b||"string"!=typeof b)&&(c=b,b=void 0);var e="undefined"==typeof c;if(e&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!==0)throw TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof d||(a=d.wrap(a,b));var f=a.limit-a.offset;if(0>=f)return this;var g,h=f-c;if(h>0){var i=new ArrayBuffer(this.buffer.byteLength+h);g=new Uint8Array(i),g.set(new Uint8Array(this.buffer).subarray(c,this.buffer.byteLength),f),this.buffer=i,this.view=new DataView(i),this.offset+=h,this.markedOffset>=0&&(this.markedOffset+=h),this.limit+=h,c+=h}else g=new Uint8Array(this.buffer);return g.set(new Uint8Array(a.buffer).subarray(a.offset,a.limit),c-f),a.offset=a.limit,e&&(this.offset-=f),this},e.prependTo=function(a,b){return a.prepend(this,b),this},e.printDebug=function(a){"function"!=typeof a&&(a=console.log.bind(console)),a(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},e.remaining=function(){return this.limit-this.offset},e.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},e.resize=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal capacity: "+a+" (not an integer)");if(a|=0,0>a)throw RangeError("Illegal capacity: 0 <= "+a)}if(this.buffer.byteLength<a){var b=new ArrayBuffer(a);new Uint8Array(b).set(new Uint8Array(this.buffer)),this.buffer=b,this.view=new DataView(b)}return this},e.reverse=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}return a===b?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(a,b)),this.view=new DataView(this.buffer),this)},e.skip=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal length: "+a+" (not an integer)");a|=0}var b=this.offset+a;if(!this.noAssert&&(0>b||b>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+a+" <= "+this.buffer.byteLength);return this.offset=b,this},e.slice=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=a,c.limit=b,c},e.toBuffer=function(a){var b=this.offset,c=this.limit;if(b>c){var d=b;b=c,c=d}if(!this.noAssert){if("number"!=typeof b||b%1!==0)throw TypeError("Illegal offset: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!==0)throw TypeError("Illegal limit: Not an integer");if(c>>>=0,0>b||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(!a&&0===b&&c===this.buffer.byteLength)return this.buffer;if(b===c)return f;var e=new ArrayBuffer(c-b);return new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(b,c),0),e},e.toArrayBuffer=e.toBuffer,e.toString=function(a,b,c){if("undefined"==typeof a)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof a&&(a="utf8",b=a,c=b),a){case"utf8":return this.toUTF8(b,c);case"base64":return this.toBase64(b,c);case"hex":return this.toHex(b,c);case"binary":return this.toBinary(b,c);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+a)}};var h=function(){for(var a={},b=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],c=[],d=0,e=b.length;e>d;++d)c[b[d]]=d;return a.encode=function(a,c){for(var d,e;null!==(d=a());)c(b[d>>2&63]),e=(3&d)<<4,null!==(d=a())?(e|=d>>4&15,c(b[63&(e|d>>4&15)]),e=(15&d)<<2,null!==(d=a())?(c(b[63&(e|d>>6&3)]),c(b[63&d])):(c(b[63&e]),c(61))):(c(b[63&e]),c(61),c(61))},a.decode=function(a,b){function d(a){throw Error("Illegal character code: "+a)}for(var e,f,g;null!==(e=a());)if(f=c[e],"undefined"==typeof f&&d(e),null!==(e=a())&&(g=c[e],"undefined"==typeof g&&d(e),b(f<<2>>>0|(48&g)>>4),null!==(e=a()))){if(f=c[e],"undefined"==typeof f){if(61===e)break;d(e)}if(b((15&g)<<4>>>0|(60&f)>>2),null!==(e=a())){if(g=c[e],"undefined"==typeof g){if(61===e)break;d(e)}b((3&f)<<6>>>0|g)}}},a.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)},a}();e.toBase64=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var d;return h.encode(function(){return b>a?this.view.getUint8(a++):null}.bind(this),d=c()),d()},d.fromBase64=function(a,c,e){if(!e){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if(a.length%4!==0)throw TypeError("Illegal str: Length not a multiple of 4")
}var f=new d(a.length/4*3,c,e),g=0;return h.decode(b(a),function(a){f.view.setUint8(g++,a)}),f.limit=g,f},d.btoa=function(a){return d.fromBinary(a).toBase64()},d.atob=function(a){return d.fromBase64(a).toBinary()},e.toBinary=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return"";for(var c=[],d=[];b>a;)c.push(this.view.getUint8(a++)),c.length>=1024&&(d.push(String.fromCharCode.apply(String,c)),c=[]);return d.join("")+String.fromCharCode.apply(String,c)},d.fromBinary=function(a,b,c){if(!c&&"string"!=typeof a)throw TypeError("Illegal str: Not a string");for(var e,f=0,g=a.length,h=new d(g,b,c);g>f;){if(e=a.charCodeAt(f),!c&&e>255)throw RangeError("Illegal charCode at "+f+": 0 <= "+e+" <= 255");h.view.setUint8(f++,e)}return h.limit=g,h},e.toDebug=function(a){for(var b,c=-1,d=this.buffer.byteLength,e="",f="",g="";d>c;){if(-1!==c&&(b=this.view.getUint8(c),e+=16>b?"0"+b.toString(16).toUpperCase():b.toString(16).toUpperCase(),a&&(f+=b>32&&127>b?String.fromCharCode(b):".")),++c,a&&c>0&&c%16===0&&c!==d){for(;e.length<51;)e+=" ";g+=e+f+"\n",e=f=""}e+=c===this.offset&&c===this.limit?c===this.markedOffset?"!":"|":c===this.offset?c===this.markedOffset?"[":"<":c===this.limit?c===this.markedOffset?"]":">":c===this.markedOffset?"'":a||0!==c&&c!==d?" ":""}if(a&&" "!==e){for(;e.length<51;)e+=" ";g+=e+f+"\n"}return a?g:e},d.fromDebug=function(a,b,c){for(var e,f,g=a.length,h=new d((g+1)/3|0,b,c),i=0,j=0,k=!1,l=!1,m=!1,n=!1,o=!1;g>i;){switch(e=a.charAt(i++)){case"!":if(!c){if(l||m||n){o=!0;break}l=m=n=!0}h.offset=h.markedOffset=h.limit=j,k=!1;break;case"|":if(!c){if(l||n){o=!0;break}l=n=!0}h.offset=h.limit=j,k=!1;break;case"[":if(!c){if(l||m){o=!0;break}l=m=!0}h.offset=h.markedOffset=j,k=!1;break;case"<":if(!c){if(l){o=!0;break}l=!0}h.offset=j,k=!1;break;case"]":if(!c){if(n||m){o=!0;break}n=m=!0}h.limit=h.markedOffset=j,k=!1;break;case">":if(!c){if(n){o=!0;break}n=!0}h.limit=j,k=!1;break;case"'":if(!c){if(m){o=!0;break}m=!0}h.markedOffset=j,k=!1;break;case" ":k=!1;break;default:if(!c&&k){o=!0;break}if(f=parseInt(e+a.charAt(i++),16),!c&&(isNaN(f)||0>f||f>255))throw TypeError("Illegal str: Not a debug encoded string");h.view.setUint8(j++,f),k=!0}if(o)throw TypeError("Illegal str: Invalid symbol at "+i)}if(!c){if(!l||!n)throw TypeError("Illegal str: Missing offset or limit");if(j<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+j+" < "+g)}return h},e.toHex=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}for(var c,d=new Array(b-a);b>a;)c=this.view.getUint8(a++),16>c?d.push("0",c.toString(16)):d.push(c.toString(16));return d.join("")},d.fromHex=function(a,b,c){if(!c){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if(a.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var e,f=a.length,g=new d(f/2|0,b),h=0,i=0;f>h;h+=2){if(e=parseInt(a.substring(h,h+2),16),!c&&(!isFinite(e)||0>e||e>255))throw TypeError("Illegal str: Contains non-hex characters");g.view.setUint8(i++,e)}return g.limit=i,g};var j=function(){var a={};return a.MAX_CODEPOINT=1114111,a.encodeUTF8=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)128>c?b(127&c):2048>c?(b(c>>6&31|192),b(63&c|128)):65536>c?(b(c>>12&15|224),b(c>>6&63|128),b(63&c|128)):(b(c>>18&7|240),b(c>>12&63|128),b(c>>6&63|128),b(63&c|128)),c=null},a.decodeUTF8=function(a,b){for(var c,d,e,f,g=function(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b};null!==(c=a());)if(0===(128&c))b(c);else if(192===(224&c))null===(d=a())&&g([c,d]),b((31&c)<<6|63&d);else if(224===(240&c))(null===(d=a())||null===(e=a()))&&g([c,d,e]),b((15&c)<<12|(63&d)<<6|63&e);else{if(240!==(248&c))throw RangeError("Illegal starting byte: "+c);(null===(d=a())||null===(e=a())||null===(f=a()))&&g([c,d,e,f]),b((7&c)<<18|(63&d)<<12|(63&e)<<6|63&f)}},a.UTF16toUTF8=function(a,b){for(var c,d=null;;){if(null===(c=null!==d?d:a()))break;c>=55296&&57343>=c&&null!==(d=a())&&d>=56320&&57343>=d?(b(1024*(c-55296)+d-56320+65536),d=null):b(c)}null!==d&&b(d)},a.UTF8toUTF16=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)65535>=c?b(c):(c-=65536,b((c>>10)+55296),b(c%1024+56320)),c=null},a.encodeUTF16toUTF8=function(b,c){a.UTF16toUTF8(b,function(b){a.encodeUTF8(b,c)})},a.decodeUTF8toUTF16=function(b,c){a.decodeUTF8(b,function(b){a.UTF8toUTF16(b,c)})},a.calculateCodePoint=function(a){return 128>a?1:2048>a?2:65536>a?3:4},a.calculateUTF8=function(b){for(var c,d=0;null!==(c=b());)d+=a.calculateCodePoint(c);return d},a.calculateUTF16asUTF8=function(b){var c=0,d=0;return a.UTF16toUTF8(b,function(b){++c,d+=a.calculateCodePoint(b)}),[c,d]},a}();return e.toUTF8=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!==0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!==0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var d;try{j.decodeUTF8toUTF16(function(){return b>a?this.view.getUint8(a++):null}.bind(this),d=c())}catch(e){if(a!==b)throw RangeError("Illegal range: Truncated data, "+a+" != "+b)}return d()},d.fromUTF8=function(a,c,e){if(!e&&"string"!=typeof a)throw TypeError("Illegal str: Not a string");var f=new d(j.calculateUTF16asUTF8(b(a),!0)[1],c,e),g=0;return j.encodeUTF16toUTF8(b(a),function(a){f.view.setUint8(g++,a)}),f.limit=g,f},d}"function"==typeof a&&"object"==typeof b&&b&&"object"==typeof c&&c?b.exports=function(){var b;try{b=a("long")}catch(c){}return e(b)}():"function"==typeof define&&define.amd?define("ByteBuffer",["Long"],function(a){return e(a)}):(d.dcodeIO=d.dcodeIO||{}).ByteBuffer=e(d.dcodeIO.Long)}(this)},{"long":125}],124:[function(a,b,c){!function(d){"use strict";var e=function(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c};e.isLong=function(a){return(a&&a instanceof e)===!0};var f={},g={};e.fromInt=function(a,b){var c,d;return b?(a>>>=0,a>=0&&256>a&&(d=g[a])?d:(c=new e(a,0>(0|a)?-1:0,!0),a>=0&&256>a&&(g[a]=c),c)):(a=0|a,a>=-128&&128>a&&(d=f[a])?d:(c=new e(a,0>a?-1:0,!1),a>=-128&&128>a&&(f[a]=c),c))},e.fromNumber=function(a,b){return b=!!b,isNaN(a)||!isFinite(a)?e.ZERO:!b&&-l>=a?e.MIN_VALUE:!b&&a+1>=l?e.MAX_VALUE:b&&a>=k?e.MAX_UNSIGNED_VALUE:0>a?e.fromNumber(-a,b).negate():new e(a%j|0,a/j|0,b)},e.fromBits=function(a,b,c){return new e(a,b,c)},e.fromString=function(a,b,c){if(0===a.length)throw Error("number format error: empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return e.ZERO;if("number"==typeof b&&(c=b,b=!1),c=c||10,2>c||c>36)throw Error("radix out of range: "+c);var d;if((d=a.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+a);if(0===d)return e.fromString(a.substring(1),b,c).negate();for(var f=e.fromNumber(Math.pow(c,8)),g=e.ZERO,h=0;h<a.length;h+=8){var i=Math.min(8,a.length-h),j=parseInt(a.substring(h,h+i),c);if(8>i){var k=e.fromNumber(Math.pow(c,i));g=g.multiply(k).add(e.fromNumber(j))}else g=g.multiply(f),g=g.add(e.fromNumber(j))}return g.unsigned=b,g},e.fromValue=function(a){return"number"==typeof a?e.fromNumber(a):"string"==typeof a?e.fromString(a):e.isLong(a)?a:new e(a.low,a.high,a.unsigned)};var h=65536,i=1<<24,j=h*h,k=j*j,l=k/2,m=e.fromInt(i);e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*j+(this.low>>>0):this.high*j+(this.low>>>0)},e.prototype.toString=function(a){if(a=a||10,2>a||a>36)throw RangeError("radix out of range: "+a);if(this.isZero())return"0";var b;if(this.isNegative()){if(this.equals(e.MIN_VALUE)){var c=e.fromNumber(a),d=this.div(c);return b=d.multiply(c).subtract(this),d.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}var f=e.fromNumber(Math.pow(a,6),this.unsigned);b=this;for(var g="";;){var h=b.div(f),i=b.subtract(h.multiply(f)).toInt()>>>0,j=i.toString(a);if(b=h,b.isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(e.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high?b+33:b+1},e.prototype.isZero=function(){return 0===this.high&&0===this.low},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isOdd=function(){return 1===(1&this.low)},e.prototype.isEven=function(){return 0===(1&this.low)},e.prototype.equals=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.unsigned!==a.unsigned&&this.high>>>31===1&&a.high>>>31===1?!1:this.high===a.high&&this.low===a.low},e.prototype.notEquals=function(a){return e.isLong(a)||(a=e.fromValue(a)),!this.equals(a)},e.prototype.lessThan=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.compare(a)<0},e.prototype.lessThanOrEqual=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.compare(a)<=0},e.prototype.greaterThan=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.compare(a)>0},e.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0},e.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.subtract(a).isNegative()?-1:1},e.prototype.negate=function(){return!this.unsigned&&this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.add=function(a){e.isLong(a)||(a=e.fromValue(a));var b=this.high>>>16,c=65535&this.high,d=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,i=a.low>>>16,j=65535&a.low,k=0,l=0,m=0,n=0;return n+=f+j,m+=n>>>16,n&=65535,m+=d+i,l+=m>>>16,m&=65535,l+=c+h,k+=l>>>16,l&=65535,k+=b+g,k&=65535,e.fromBits(m<<16|n,k<<16|l,this.unsigned)},e.prototype.subtract=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.add(a.negate())},e.prototype.multiply=function(a){if(this.isZero())return e.ZERO;if(e.isLong(a)||(a=e.fromValue(a)),a.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return a.isOdd()?e.MIN_VALUE:e.ZERO;if(a.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(m)&&a.lessThan(m))return e.fromNumber(this.toNumber()*a.toNumber(),this.unsigned);var b=this.high>>>16,c=65535&this.high,d=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,i=a.low>>>16,j=65535&a.low,k=0,l=0,n=0,o=0;return o+=f*j,n+=o>>>16,o&=65535,n+=d*j,l+=n>>>16,n&=65535,n+=f*i,l+=n>>>16,n&=65535,l+=c*j,k+=l>>>16,l&=65535,l+=d*i,k+=l>>>16,l&=65535,l+=f*h,k+=l>>>16,l&=65535,k+=b*j+c*i+d*h+f*g,k&=65535,e.fromBits(n<<16|o,k<<16|l,this.unsigned)},e.prototype.div=function(a){if(e.isLong(a)||(a=e.fromValue(a)),a.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var b,c,d;if(this.equals(e.MIN_VALUE)){if(a.equals(e.ONE)||a.equals(e.NEG_ONE))return e.MIN_VALUE;if(a.equals(e.MIN_VALUE))return e.ONE;var f=this.shiftRight(1);return b=f.div(a).shiftLeft(1),b.equals(e.ZERO)?a.isNegative()?e.ONE:e.NEG_ONE:(c=this.subtract(a.multiply(b)),d=b.add(c.div(a)))}if(a.equals(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(d=e.ZERO,c=this;c.greaterThanOrEqual(a);){b=Math.max(1,Math.floor(c.toNumber()/a.toNumber()));for(var g=Math.ceil(Math.log(b)/Math.LN2),h=48>=g?1:Math.pow(2,g-48),i=e.fromNumber(b),j=i.multiply(a);j.isNegative()||j.greaterThan(c);)b-=h,i=e.fromNumber(b,this.unsigned),j=i.multiply(a);i.isZero()&&(i=e.ONE),d=d.add(i),c=c.subtract(j)}return d},e.prototype.modulo=function(a){return e.isLong(a)||(a=e.fromValue(a)),this.subtract(this.div(a).multiply(a))},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.and=function(a){return e.isLong(a)||(a=e.fromValue(a)),e.fromBits(this.low&a.low,this.high&a.high,this.unsigned)},e.prototype.or=function(a){return e.isLong(a)||(a=e.fromValue(a)),e.fromBits(this.low|a.low,this.high|a.high,this.unsigned)},e.prototype.xor=function(a){return e.isLong(a)||(a=e.fromValue(a)),e.fromBits(this.low^a.low,this.high^a.high,this.unsigned)},e.prototype.shiftLeft=function(a){return e.isLong(a)&&(a=a.toInt()),0===(a&=63)?this:32>a?e.fromBits(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):e.fromBits(0,this.low<<a-32,this.unsigned)},e.prototype.shiftRight=function(a){return e.isLong(a)&&(a=a.toInt()),0===(a&=63)?this:32>a?e.fromBits(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):e.fromBits(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shiftRightUnsigned=function(a){if(e.isLong(a)&&(a=a.toInt()),a&=63,0===a)return this;var b=this.high;if(32>a){var c=this.low;return e.fromBits(c>>>a|b<<32-a,b>>>a,this.unsigned)}return 32===a?e.fromBits(b,0,this.unsigned):e.fromBits(b>>>a-32,0,this.unsigned)},e.prototype.toSigned=function(){return this.unsigned?new e(this.low,this.high,!1):this},e.prototype.toUnsigned=function(){return this.unsigned?this:new e(this.low,this.high,!0)},"function"==typeof a&&"object"==typeof b&&b&&"object"==typeof c&&c?b.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):(d.dcodeIO=d.dcodeIO||{}).Long=e}(this)},{}],125:[function(a,b){b.exports=a("./dist/Long.js")},{"./dist/Long.js":124}],126:[function(a,b){var c=a("ndn-contrib").ndn;b.exports=function(a,b,d){var a,e={};return describe("Forwarder",function(){before(function(){a.addConnectionListener("connection/request",3)}),it("should construct",function(){b(a.nameTree.lookup),b(a.nameTree),b(a.interfaces)}),describe("Forwarder.addListener",function(){before(function(){a.listenerCallbacks=[]}),it("should accept string",function(){a.addListener("crossPlatform/test/string",function(){return"crossPlatform/test/string"}),b(a.listeners.nameTree["/crossPlatform/test/string"],"listener nameTree not there")}),it("should accept object",function(){a.addListener({prefix:"crossPlatform/test/object/blocking",blocking:!0},function(){return"crossPlatform/test/object/blocking"}),b(a.listeners.nameTree["/crossPlatform/test/object/blocking"],"listener nameTree not there")}),it("should save the callbacks",function(){b(2===a.listenerCallbacks.length)}),it("should correctly associate callback to nameSpace",function(){var c=a.listeners.lookup("crossPlatform/test/string/").nextHops[0].faceID;b(0===c);var d=a.listenerCallbacks[c].callback;b("function"==typeof d,"callback not function"),b("crossPlatform/test/string"===d());var e=a.listeners.lookup("crossPlatform/test/object/blocking").nextHops[0].faceID;b(1===e);var f=a.listenerCallbacks[e].callback;b("function"==typeof f,"callback not function"),b("crossPlatform/test/object/blocking"===f()),b(a.listenerCallbacks[e].blocking,"blocking not setting"),b(a.listenerCallbacks[e].listenerID===e,"listenerID  not accurate")}),it("should accept a second listener on duplicate namespace",function(){a.addListener("crossPlatform/test/string",function(){return"duplicate"}),b(2===a.listeners.nameTree["/crossPlatform/test/string"].fibEntry.nextHops.length)}),it("should accept a listener on a prefix of existing",function(){a.addListener({prefix:"crossPlatform",blocking:!0},function(a,b,c){return e.hasReachedEnd=!0,{blocking:!0,unblock:c}}),b(1===a.listeners.nameTree["/crossPlatform"].fibEntry.nextHops.length)}),it("should trigger only once per nonced interest",function(b){var c=new a.ndn.Name("test/duplicate/interest"),d=new a.ndn.Interest(c),e=d.wireEncode().buffer;a.addListener("test/duplicate/interest",function(){b()}).handleInterest(e,0).handleInterest(e,0).handleInterest(e,0).handleInterest(e,0)})}),describe("Forwarder.removeListeners",function(){it("should remove both listeners Entries on strict prefix",function(){a.removeListeners("crossPlatform/test/string"),b(0===a.listeners.nameTree["/crossPlatform/test/string"].fibEntry.nextHops.length)}),it("should leave prefix listener entry",function(){b(1===a.listeners.nameTree["/crossPlatform"].fibEntry.nextHops.length)}),it("should remove item from callback array",function(){b(null===a.listenerCallbacks[0].callback)}),it("should not disturb listener callback order",function(){b("crossPlatform/test/object/blocking"===a.listenerCallbacks[1].callback()),b(a.listenerCallbacks[3].callback().blocking===!0)})}),describe("Forwarder.handleInterest",function(){describe("triggers listeners correctly",function(){before(function(){a.addListener({blocking:!0,prefix:"crossPlatform/blocking/test/ordering/top"},function(a,b,c){e.firstBlockingTriggered=!0,c()}).addListener("crossPlatform/blocking/test/ordering/top",function(){e.firstNonBlockingTriggered=!0}).addListener({prefix:"crossPlatform/blocking/test/ordering/top",blocking:!0},function(a,b,c){e.secondBlockingTriggered=!0,e.unblockFirst=c}).addListener("crossPlatform/blocking/test/ordering/top",function(){e.secondNonBlockingTriggered=!0}).addListener({prefix:"crossPlatform/blocking/test/ordering",blocking:!0},function(a,b,c){e.unblockSecond=c,e.firstPrefixTriggered=!0}).addListener("crossPlatform/blocking/test",function(){console.log("WHERE???????????????????????????????????????????????????????????????????????????"),e.SecondPrefixTriggered=!0})}),it("should trigger all nonBlocking Listeners on longest prefix",function(){var d=new c.Interest(new c.Name("crossPlatform/blocking/test/ordering/top")),f=d.wireEncode().buffer;a.handleInterest(f,0),console.log("got past handleInterest"),b(e.firstNonBlockingTriggered),b(e.secondNonBlockingTriggered)}),it("should block with most recently added blocking listener on listener entry",function(){b(!e.firstBlockingTriggered),b(e.secondBlockingTriggered),b(!e.firstPrefixTriggered)}),it("should unblock",function(){console.log(e.unblockFirst.toString()),e.unblockFirst(),b(e.firstPrefixTriggered)}),it("should reblock",function(){b(!e.SecondPrefixTriggered,"second prefix should be blocked")}),it("should unblock with skipListen param",function(){e.unblockSecond(!0),b(!e.SecondPrefixTriggered,"second prefix should be skipped")})}),describe("forward interests correctly",function(){var d;before(function(){d=a.interfaces.dispatch,a.fib.addEntry("test/forwarding/long",5).addEntry("test/forwarding/long",4).addEntry("test/forwarding",3).addEntry("test/forwarding/long/er",2)}),it("should dispatch with expected faceFlag",function(){var d=new c.Interest(new c.Name("test/forwarding/long")),e=d.wireEncode().buffer;console.log(e),a.interfaces.dispatch=function(a,c){console.log("DISPATCH: "+c),b(32&c,"5th bit should be set"),b(16&c,"4th bit should be set"),b(8&c,"3rd bit should be set"),b(!(4&c),"2nd bit should NOT be set")},a.handleInterest(e,0)}),it("should not dispatch to face that data was received on",function(){var d=new c.Interest(new c.Name("test/forwarding/long")),e=d.wireEncode().buffer;a.interfaces.dispatch=function(a,c){b(32&c,"5th bit should be set"),b(!(16&c)),b(8&c),b(!(4&c))},a.handleInterest(e,4)}),after(function(){a.interfaces.dispatch=d})}),describe("return cacheHits correctly",function(){var d;before(function(){d=a.interfaces.dispatch;var b=new c.Data(new c.Name("/cache/hit/test"),new c.SignedInfo,"correct");b.signedInfo.setFreshnessPeriod(1e3),b.signedInfo.setFields(),b.sign();var e=b.wireEncode().buffer;a.cache.insert(e,b)}),it("should trigger dispatch with same faceID, and a raw data packet",function(){a.interfaces.dispatch=function(a,d){console.log("ddddddddddddd",a,d),b(4&d);var e=new c.Data;e.wireDecode(a),b("/cache/hit/test"===e.name.toUri())};var d=new c.Interest(new c.Name("cache/hit/test")),e=d.wireEncode().buffer;a.handleInterest(e,2)}),after(function(){a.interfaces.dispatch=d})})}),describe("Forwarder.handleData",function(){var d,e=new c.Interest(new c.Name("forward/test"));e.setInterestLifetimeMilliseconds(1e3);var f=e.wireEncode().buffer,g=new c.Data(new c.Name("forward/test/matching"),new c.SignedInfo,"success");g.signedInfo.setFields(),g.sign();var h=g.wireEncode().buffer;before(function(){d=a.interfaces.dispatch,a.pit.insertPitEntry(e.wireEncode().buffer,e,9)}),it("should dispatch to matching pit entries",function(){a.interfaces.dispatch=function(a,c){b(512&c)},a.handleData(h,8)}),it("should not dispatch if no pit entries (or duplicate)",function(){a.interfaces.dispatch=function(a,c){console.log(c),b(!1)},a.handleData(h,8)}),it("should cache",function(){a.interfaces.dispatch=function(a,d){b(1024&d);var e=new c.Data;e.wireDecode(a),b("/forward/test/matching"===e.name.toUri())},a.handleInterest(f,10)}),after(function(){a.interfaces.dispatch=d})});var f,g=!1;describe("Forwarder.addConnection",function(){it("should create ws connection with default port",function(b){console.log(g),a.addConnection("ws://localhost",function(a){console.log("face open at port 1338"),f=a,b()},function(){g=!0})}),it("should increment connectionCount",function(){b(1===a.connectionCount)})}),describe("Forwarder.removeConnection",function(){var c;before(function(){c=a.connectionCount,console.log("the face to close",f),a.addRegisteredPrefix("close/connection/fibtest",0),console.log(a.fib.findAllNextHops("close/connection/fibtest"))}),it("should remove connection",function(){console.log(a.fib.findAllNextHops("close/connection/fibtest")),a.removeConnection(0),console.log(a.interfaces.Faces[0].readyStatus,a.ndn.Face.CLOSED),b(a.interfaces.Faces[0].readyStatus===a.ndn.Face.CLOSED)}),it("should remove fibEntries for corresponding face",function(){b(0===a.fib.findAllNextHops("close/connection/fibtest"))}),it("should decriment connectionCount",function(){b(a.connectionCount===c-1)}),it("should call face.onclose",function(){b(g)})});var h;describe("Forwarder.createConnectionRequestSuffix",function(){this.timeout(6e4),it("should generate suffix and pass to callback",function(c){a.createConnectionRequestSuffix(function(d){console.log(d),h=d,b(d instanceof a.ndn.Name.Component),c()})}),it("should be parse back into JSON",function(){var c=new a.ndn.Data;c.wireDecode(h.getValueAsBuffer());JSON.parse(c.content.toString());b("/connectionRequest"===c.name.toUri())})});var i,j,k;describe("Forwarder.addConnectionListener",function(){var d=5;before(function(){k=a.interfaces.dispatch,console.log("dispatchSave",k),j=a.addConnection,a.addListener("/addConnectionListener",function(){e.CLNonBlock=!0}).addListener({prefix:"addConnectionListener",blocking:!0},function(a,b,c){e.CLBlock=!0,c()}),i=a.listenerCallbacks.length}),it("should add",function(){a.addConnectionListener("/addConnectionListener",2),b(a.listenerCallbacks.length===i+1)}),it("should unblock if not parseAble or fulfillable as a connection request",function(){e.CLBlock=!1,e.CLNonBlock=!1;var d=new c.Interest(new c.Name("addConnectionListener/realrequest")),f=d.wireEncode().buffer;a.handleInterest(f,0),b(e.CLBlock,"CLBlock not triggered"),b(e.CLNonBlock,"CLNonBlock not triggered")}),it("should supercede other blocking listeners when proper request arrives",function(f){e.CLBlock=!1,e.CLNonBlock=!1,a.createConnectionRequestSuffix(function(g){if(console.log("suffix:",g),a.remoteInfo.tcp){var h=a.remoteInfo.tcp.port;a.remoteInfo.tcp.port=999,a.addConnection=function(){e.addTriggered=!0,d++,f()}}else a.interfaces.dispatch=function(){console.log("dispatch triggered in "),d++,f()};var i=new c.Interest(new c.Name("addConnectionListener"));i.name.append(g.value),console.log(i.toUri());var j=i.wireEncode().buffer;a.handleInterest(j,0),b(!e.CLBlock,"CLBlock should not have been triggered"),b(!e.CLNonBlock,"CLNonBlock should not have been triggered"),a.remoteInfo.tcp&&(a.remoteInfo.tcp.port=h)})}),it("should unblock if listener maxConnections reached",function(f){a.createConnectionRequestSuffix(function(g){if(a.remoteInfo.tcp){var h=a.remoteInfo.tcp.port;a.remoteInfo.tcp.port=888;var i=!0,j=a.addConnection;a.addConnection=function(c,d,e){i?b(!1,"should not trigger addConnections after 1"):(console.log("heres/"),a.addConnection=j,j(c,d,e))}}else a.interfaces.dispatch=function(){b(!1,"should not trigger dispatch to addConnections after 1"),d++};var k=new c.Interest(new c.Name("addConnectionListener"));k.name.append(g.value);var l=k.wireEncode().buffer;a.setMaxConnections(10),a.handleInterest(l,0),console.log("forwarder.handleInterest returned"),b(e.CLBlock,"CLBLock not triggered"),b(e.CLNonBlock,"CLNonBlock not triggered"),a.remoteInfo.tcp&&(a.remoteInfo.tcp.port=h),f()})}),it("should unblock if maxConnections reached",function(d){e.CLBlock=!1,e.CLNonBlock=!1,a.createConnectionRequestSuffix(function(f){var g=new c.Interest(new c.Name("addConnectionListener"));g.name.append(f.value);var h=g.wireEncode().buffer;a.setMaxConnections(6),a.handleInterest(h,0),b(e.CLBlock,"CLBlock not triggered"),b(e.CLNonBlock,"CLNonBlock not triggered"),d()})})}),after(function(){a.interfaces.dispatch=k,d.requestConnection(a,k)})}),a}},{"ndn-contrib":130}],127:[function(a,b){var c=a("../../../dist/src/Forwarder.js");window.debug=a("debug");a("../../../dist/src/browser/adapter/adapter.js");b.exports=function(){var b,d;b=new c,d=new c({iceServers:[{url:"stun:stun.l.google.com:19302"}]});var e=function(){describe("Forwarder.requestConnection",function(){before(function(a){try{console.log("11111111111111111111"),b.addConnection("ws://localhost",function(c){console.log("2222222222222222222222"),b.addConnectionListener("connection/request",5,function(){console.log("forwarder1 connection listener just got a face :)")}).registerPrefix("connection/request",c),console.log("333333333333333333333333333333"),console.log("got ws face to testDaemon on forwarder1",c),d.addConnection("ws://localhost",function(b){console.log("got ws face to testDaemon on forwarder2",b),d.addRegisteredPrefix("connection/request",b),console.log("registeredPrefixAdded"),setTimeout(a,300)})})}catch(c){console.log(c)}}),this.timeout(15e3),it("should negotiate rtc Connection and populate fibEntry",function(a){d.requestConnection("/connection/request",function(){console.log("forwarder2.fib",d.fib.lookup("connection/request").nextHops.length),setTimeout(a,50),assert(2===d.fib.lookup("connection/request").nextHops.length)})}),it("should create messageChannel connection messageChannel port",function(a){var c=new MessageChannel;b.addConnection(c.port1,function(){a()})})})},f={requestConnection:e},g=new c({iceServers:[{url:"stun:stun.l.google.com:19302"}]});a("../../Forwarder.js")(g,assert,f)}},{"../../../dist/src/Forwarder.js":1,"../../../dist/src/browser/adapter/adapter.js":4,"../../Forwarder.js":126,debug:7}],128:[function(a){a("./forwarder.js")()},{"./forwarder.js":127}],129:[function(a,b,c){(function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function d(){return new a(null)}function e(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function f(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function g(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function h(a){return hc.charAt(a)}function i(a,b){var c=ic[a.charCodeAt(b)];return null==c?-1:c}function j(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function k(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function l(a){var b=d();return b.fromInt(a),b}function m(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.t=0,this.s=0;for(var e=b.length,f=!1,g=0;--e>=0;){var h=8==d?255&b[e]:i(b,e);0>h?"-"==b.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+d>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&b[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&a.ZERO.subTo(this,this)}function n(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function o(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,i=this.DB-g*this.DB%b;if(g-->0)for(i<this.DB&&(c=this[g]>>i)>0&&(e=!0,f=h(c));g>=0;)b>i?(c=(this[g]&(1<<i)-1)<<b-i,c|=this[--g]>>(i+=this.DB-b)):(c=this[g]>>(i-=b)&d,0>=i&&(i+=this.DB,--g)),c>0&&(e=!0),e&&(f+=h(c));return e?f:"0"}function p(){var b=d();return a.ZERO.subTo(this,b),b}function q(){return this.s<0?this.negate():this}function r(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function s(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function t(){return this.t<=0?0:this.DB*(this.t-1)+s(this[this.t-1]^this.s&this.DM)}function u(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function v(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function w(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function x(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function y(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function z(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)}function A(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)
}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function B(b,c,e){var f=b.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=c&&c.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=d());var h=d(),i=this.s,j=b.s,k=this.DB-s(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=e.t,t=r-l,u=null==c?d():c;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),a.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--t>=0;){var v=e[--r]==m?this.DM:Math.floor(e[r]*o+(e[r-1]+q)*p);if((e[r]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e[r]<--v;)e.subTo(u,e)}null!=c&&(e.drShiftTo(l,c),i!=j&&a.ZERO.subTo(c,c)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&a.ZERO.subTo(e,e)}}}function C(b){var c=d();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(a.ZERO)>0&&b.subTo(c,c),c}function D(a){this.m=a}function E(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function F(a){return a}function G(a){a.divRemTo(this.m,null,a)}function H(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function I(a,b){a.squareTo(b),this.reduce(b)}function J(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function K(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function L(b){var c=d();return b.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),b.s<0&&c.compareTo(a.ZERO)>0&&this.m.subTo(c,c),c}function M(a){var b=d();return a.copyTo(b),this.reduce(b),b}function N(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function O(a,b){a.squareTo(b),this.reduce(b)}function P(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Q(){return 0==(this.t>0?1&this[0]:this.s)}function R(b,c){if(b>4294967295||1>b)return a.ONE;var e=d(),f=d(),g=c.convert(this),h=s(b)-1;for(g.copyTo(e);--h>=0;)if(c.sqrTo(e,f),(b&1<<h)>0)c.mulTo(f,g,e);else{var i=e;e=f,f=i}return c.revert(e)}function S(a,b){var c;return c=256>a||b.isEven()?new D(b):new K(b),this.exp(a,c)}function T(){var a=d();return this.copyTo(a),a}function U(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function V(){return 0==this.t?this.s:this[0]<<24>>24}function W(){return 0==this.t?this.s:this[0]<<16>>16}function X(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function Y(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Z(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),e=l(c),f=d(),g=d(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(c+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function $(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,h=0,j=0;j<b.length;++j){var k=i(b,j);0>k?"-"==b.charAt(j)&&0==this.signum()&&(f=!0):(h=c*h+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(h,0)),f&&a.ZERO.subTo(this,this)}function _(b,c,d){if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),hb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{var e=new Array,f=7&b;e.length=(b>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function ab(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function bb(a){return 0==this.compareTo(a)}function cb(a){return this.compareTo(a)<0?this:a}function db(a){return this.compareTo(a)>0?this:a}function eb(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function fb(a,b){return a&b}function gb(a){var b=d();return this.bitwiseTo(a,fb,b),b}function hb(a,b){return a|b}function ib(a){var b=d();return this.bitwiseTo(a,hb,b),b}function jb(a,b){return a^b}function kb(a){var b=d();return this.bitwiseTo(a,jb,b),b}function lb(a,b){return a&~b}function mb(a){var b=d();return this.bitwiseTo(a,lb,b),b}function nb(){for(var a=d(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function ob(a){var b=d();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function pb(a){var b=d();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function qb(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function rb(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+qb(this[a]);return this.s<0?this.t*this.DB:-1}function sb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function tb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=sb(this[c]^b);return a}function ub(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function vb(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d}function wb(a){return this.changeBit(a,hb)}function xb(a){return this.changeBit(a,lb)}function yb(a){return this.changeBit(a,jb)}function zb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function Ab(a){var b=d();return this.addTo(a,b),b}function Bb(a){var b=d();return this.subTo(a,b),b}function Cb(a){var b=d();return this.multiplyTo(a,b),b}function Db(){var a=d();return this.squareTo(a),a}function Eb(a){var b=d();return this.divRemTo(a,b,null),b}function Fb(a){var b=d();return this.divRemTo(a,null,b),b}function Gb(a){var b=d(),c=d();return this.divRemTo(a,b,c),new Array(b,c)}function Hb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ib(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Jb(){}function Kb(a){return a}function Lb(a,b,c){a.multiplyTo(b,c)}function Mb(a,b){a.squareTo(b)}function Nb(a){return this.exp(a,new Jb)}function Ob(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Pb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Qb(b){this.r2=d(),this.q3=d(),a.ONE.dlShiftTo(2*b.t,this.r2),this.mu=this.r2.divide(b),this.m=b}function Rb(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=d();return a.copyTo(b),this.reduce(b),b}function Sb(a){return a}function Tb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Ub(a,b){a.squareTo(b),this.reduce(b)}function Vb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Wb(a,b){var c,e,f=a.bitLength(),g=l(1);if(0>=f)return g;c=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new D(b):b.isEven()?new Qb(b):new K(b);var h=new Array,i=3,j=c-1,k=(1<<c)-1;if(h[1]=e.convert(this),c>1){var m=d();for(e.sqrTo(h[1],m);k>=i;)h[i]=d(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,r=d();for(f=s(a[p])-1;p>=0;){for(f>=j?n=a[p]>>f-j&k:(n=(a[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a[p-1]>>this.DB+f-j)),i=c;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,r),e.sqrTo(r,g),i-=2;i>0?e.sqrTo(g,r):(o=g,g=r,r=o),e.mulTo(r,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,r),o=g,g=r,r=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Xb(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Yb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function Zb(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=l(1),g=l(0),h=l(0),i=l(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i}function $b(a){var b,c=this.abs();if(1==c.t&&c[0]<=jc[jc.length-1]){for(b=0;b<jc.length;++b)if(c[0]==jc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<jc.length;){for(var d=jc[b],e=b+1;e<jc.length&&kc>d;)d*=jc[e++];for(d=c.modInt(d);e>b;)if(d%jc[b++]==0)return!1}return c.millerRabin(a)}function _b(b){var c=this.subtract(a.ONE),e=c.getLowestSetBit();if(0>=e)return!1;var f=c.shiftRight(e);b=b+1>>1,b>jc.length&&(b=jc.length);for(var g=d(),h=0;b>h;++h){g.fromInt(jc[Math.floor(Math.random()*jc.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(a.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<e&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(a.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}var ac,bc=0xdeadbeefcafe,cc=15715070==(16777215&bc),dc="undefined"!=typeof navigator;dc&&cc&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=f,ac=30):dc&&cc&&"Netscape"!=navigator.appName?(a.prototype.am=e,ac=26):(a.prototype.am=g,ac=28),a.prototype.DB=ac,a.prototype.DM=(1<<ac)-1,a.prototype.DV=1<<ac;var ec=52;a.prototype.FV=Math.pow(2,ec),a.prototype.F1=ec-ac,a.prototype.F2=2*ac-ec;var fc,gc,hc="0123456789abcdefghijklmnopqrstuvwxyz",ic=new Array;for(fc="0".charCodeAt(0),gc=0;9>=gc;++gc)ic[fc++]=gc;for(fc="a".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;for(fc="A".charCodeAt(0),gc=10;36>gc;++gc)ic[fc++]=gc;D.prototype.convert=E,D.prototype.revert=F,D.prototype.reduce=G,D.prototype.mulTo=H,D.prototype.sqrTo=I,K.prototype.convert=L,K.prototype.revert=M,K.prototype.reduce=N,K.prototype.mulTo=P,K.prototype.sqrTo=O,a.prototype.copyTo=j,a.prototype.fromInt=k,a.prototype.fromString=m,a.prototype.clamp=n,a.prototype.dlShiftTo=u,a.prototype.drShiftTo=v,a.prototype.lShiftTo=w,a.prototype.rShiftTo=x,a.prototype.subTo=y,a.prototype.multiplyTo=z,a.prototype.squareTo=A,a.prototype.divRemTo=B,a.prototype.invDigit=J,a.prototype.isEven=Q,a.prototype.exp=R,a.prototype.toString=o,a.prototype.negate=p,a.prototype.abs=q,a.prototype.compareTo=r,a.prototype.bitLength=t,a.prototype.mod=C,a.prototype.modPowInt=S,a.ZERO=l(0),a.ONE=l(1),Jb.prototype.convert=Kb,Jb.prototype.revert=Kb,Jb.prototype.mulTo=Lb,Jb.prototype.sqrTo=Mb,Qb.prototype.convert=Rb,Qb.prototype.revert=Sb,Qb.prototype.reduce=Tb,Qb.prototype.mulTo=Vb,Qb.prototype.sqrTo=Ub;var jc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],kc=(1<<26)/jc[jc.length-1];a.prototype.chunkSize=X,a.prototype.toRadix=Z,a.prototype.fromRadix=$,a.prototype.fromNumber=_,a.prototype.bitwiseTo=eb,a.prototype.changeBit=vb,a.prototype.addTo=zb,a.prototype.dMultiply=Hb,a.prototype.dAddOffset=Ib,a.prototype.multiplyLowerTo=Ob,a.prototype.multiplyUpperTo=Pb,a.prototype.modInt=Yb,a.prototype.millerRabin=_b,a.prototype.clone=T,a.prototype.intValue=U,a.prototype.byteValue=V,a.prototype.shortValue=W,a.prototype.signum=Y,a.prototype.toByteArray=ab,a.prototype.equals=bb,a.prototype.min=cb,a.prototype.max=db,a.prototype.and=gb,a.prototype.or=ib,a.prototype.xor=kb,a.prototype.andNot=mb,a.prototype.not=nb,a.prototype.shiftLeft=ob,a.prototype.shiftRight=pb,a.prototype.getLowestSetBit=rb,a.prototype.bitCount=tb,a.prototype.testBit=ub,a.prototype.setBit=wb,a.prototype.clearBit=xb,a.prototype.flipBit=yb,a.prototype.add=Ab,a.prototype.subtract=Bb,a.prototype.multiply=Cb,a.prototype.divide=Eb,a.prototype.remainder=Fb,a.prototype.divideAndRemainder=Gb,a.prototype.modPow=Wb,a.prototype.modInverse=Zb,a.prototype.pow=Nb,a.prototype.gcd=Xb,a.prototype.isProbablePrime=$b,a.prototype.square=Db,"undefined"!=typeof c?c=b.exports=a:this.BigInteger=a}).call(this)},{}],130:[function(a,b,c){c.ndn=a("ndn-lib"),c.NameTree=a("./src/DataStructures/NameTree.js").installNDN(c.ndn),c.PIT=a("./src/DataStructures/PIT.js").installNDN(c.ndn),c.FIB=a("./src/DataStructures/FIB.js").installNDN(c.ndn),c.ContentStore=a("./src/DataStructures/ContentStore.js"),c.Interfaces=a("./src/DataStructures/Interfaces.js").installNDN(c.ndn),c.Transports=a("./src/Transports/node/export.js"),b.exports=c},{"./src/DataStructures/ContentStore.js":203,"./src/DataStructures/FIB.js":204,"./src/DataStructures/Interfaces.js":205,"./src/DataStructures/NameTree.js":206,"./src/DataStructures/PIT.js":208,"./src/Transports/node/export.js":211,"ndn-lib":140}],131:[function(a,b,c){arguments[4][46][0].apply(c,arguments)},{jsbn:129}],132:[function(a,b){b.exports=a(47)},{}],133:[function(a,b){b.exports=a(48)},{}],134:[function(a,b,c){arguments[4][49][0].apply(c,arguments)},{"./sha256.js":139,jsbn:129}],135:[function(a,b,c){arguments[4][50][0].apply(c,arguments)},{jsbn:129}],136:[function(a,b,c){arguments[4][51][0].apply(c,arguments)},{"./rsa.js":135,jsbn:129}],137:[function(a,b,c){arguments[4][52][0].apply(c,arguments)},{"./asn1hex-1.1.js":131,"./base64.js":132,"./rsa2.js":136}],138:[function(a,b,c){arguments[4][53][0].apply(c,arguments)},{"./rsapem-1.1.js":137,jsbn:129}],139:[function(a,b){b.exports=a(54)},{"./core.js":133}],140:[function(a,b,c){c.Face=a("./js/face.js").Face,c.NDN=a("./js/face.js").NDN,c.Closure=a("./js/closure.js").Closure,c.Name=a("./js/name.js").Name,c.ForwardingFlags=a("./js/forwarding-flags.js").ForwardingFlags,c.Interest=a("./js/interest.js").Interest,c.Exclude=a("./js/exclude.js").Exclude,c.Data=a("./js/data.js").Data,c.ContentObject=a("./js/data.js").ContentObject,c.ContentType=a("./js/meta-info.js").ContentType,c.MetaInfo=a("./js/meta-info.js").MetaInfo,c.SignedInfo=a("./js/meta-info.js").SignedInfo,c.Sha256WithRsaSignature=a("./js/sha256-with-rsa-signature.js").Sha256WithRsaSignature,c.Signature=a("./js/sha256-with-rsa-signature.js").Signature,c.Key=a("./js/key.js").Key,c.KeyLocator=a("./js/key-locator.js").KeyLocator,c.KeyName=a("./js/key-locator.js").KeyName,c.KeyLocatorType=a("./js/key-locator.js").KeyLocatorType,c.PublisherPublicKeyDigest=a("./js/publisher-public-key-digest.js").PublisherPublicKeyDigest,c.WireFormat=a("./js/encoding/wire-format.js").WireFormat,c.BinaryXmlWireFormat=a("./js/encoding/binary-xml-wire-format.js").BinaryXmlWireFormat,c.TlvWireFormat=a("./js/encoding/tlv-wire-format.js").TlvWireFormat,c.TcpTransport=a("./js/transport/tcp-transport.js").TcpTransport,c.UnixTransport=a("./js/transport/unix-transport.js").UnixTransport,c.DataUtils=a("./js/encoding/data-utils.js").DataUtils,c.EncodingUtils=a("./js/encoding/encoding-utils.js").EncodingUtils,c.ProtobufTlv=a("./js/encoding/protobuf-tlv.js").ProtobufTlv,c.Blob=a("./js/util/blob.js").Blob,c.NameEnumeration=a("./js/util/name-enumeration.js").NameEnumeration,c.MemoryContentCache=a("./js/util/memory-content-cache.js").MemoryContentCache,c.NDNTime=a("./js/util/ndn-time.js").NDNTime,c.globalKeyManager=a("./js/security/key-manager.js").globalKeyManager,c.SecurityException=a("./js/security/security-exception.js").SecurityException,c.KeyType=a("./js/security/security-types.js").KeyType,c.KeyClass=a("./js/security/security-types.js").KeyClass,c.DigestAlgorithm=a("./js/security/security-types.js").DigestAlgorithm,c.EncryptMode=a("./js/security/security-types.js").EncryptMode,c.IdentityStorage=a("./js/security/identity/identity-storage.js").IdentityStorage,c.MemoryIdentityStorage=a("./js/security/identity/memory-identity-storage.js").MemoryIdentityStorage,c.MemoryPrivateKeyStorage=a("./js/security/identity/memory-private-key-storage.js").MemoryPrivateKeyStorage,c.IdentityManager=a("./js/security/identity/identity-manager.js").IdentityManager,c.ValidationRequest=a("./js/security/policy/validation-request.js").ValidationRequest,c.PolicyManager=a("./js/security/policy/policy-manager.js").PolicyManager,c.NoVerifyPolicyManager=a("./js/security/policy/no-verify-policy-manager.js").NoVerifyPolicyManager,c.SelfVerifyPolicyManager=a("./js/security/policy/self-verify-policy-manager.js").SelfVerifyPolicyManager,c.KeyChain=a("./js/security/key-chain.js").KeyChain},{"./js/closure.js":143,"./js/data.js":145,"./js/encoding/binary-xml-wire-format.js":149,"./js/encoding/data-utils.js":150,"./js/encoding/encoding-utils.js":153,"./js/encoding/protobuf-tlv.js":154,"./js/encoding/tlv-wire-format.js":156,"./js/encoding/wire-format.js":161,"./js/exclude.js":162,"./js/face.js":164,"./js/forwarding-flags.js":166,"./js/interest.js":167,"./js/key-locator.js":168,"./js/key.js":169,"./js/meta-info.js":171,"./js/name.js":172,"./js/publisher-public-key-digest.js":174,"./js/security/identity/identity-manager.js":177,"./js/security/identity/identity-storage.js":178,"./js/security/identity/memory-identity-storage.js":179,"./js/security/identity/memory-private-key-storage.js":180,"./js/security/key-chain.js":182,"./js/security/key-manager.js":183,"./js/security/policy/no-verify-policy-manager.js":184,"./js/security/policy/policy-manager.js":185,"./js/security/policy/self-verify-policy-manager.js":186,"./js/security/policy/validation-request.js":187,"./js/security/security-exception.js":188,"./js/security/security-types.js":189,"./js/sha256-with-rsa-signature.js":190,"./js/transport/tcp-transport.js":141,"./js/transport/unix-transport.js":192,"./js/util/blob.js":194,"./js/util/memory-content-cache.js":197,"./js/util/name-enumeration.js":198,"./js/util/ndn-time.js":200}],141:[function(a,b,c){c.TcpTransport=a("./transport/web-socket-transport").WebSocketTransport},{"./transport/web-socket-transport":193}],142:[function(a,b){(function(c){var d=a("../contrib/securityLib/asn1hex-1.1.js").ASN1HEX,e=a("../contrib/securityLib/crypto-1.0.js").KJUR,f=a("../contrib/securityLib/rsasign-1.2.js").RSAKey,g=a("../contrib/securityLib/base64.js").b64tohex,h=h||{};h.Key=a("./key.js").Key;var i=h;i.createHash=function(a){if("sha256"!=a)throw new Error("createHash: unsupported algorithm.");var b={};return b.md=new e.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}),b.update=function(a){this.md.updateHex(a.toString("hex"))},b.digest=function(){return new c(this.md.digest(),"hex")},b},i.createSign=function(a){if("RSA-SHA256"!=a)throw new Error("createSign: unsupported algorithm.");var b={};return b.arr=[],b.update=function(a){this.arr.push(a)},b.sign=function(a){var b=new f;b.readPrivateKeyFromPEMString(a);var d=new e.crypto.Signature({alg:"SHA256withRSA",prov:"cryptojs/jsrsa"});d.initSign(b);for(var g=0;g<this.arr.length;++g)d.updateHex(this.arr[g].toString("hex"));return new c(d.sign(),"hex")},b},i.createVerify=function(a){if("RSA-SHA256"!=a)throw new Error("createSign: unsupported algorithm.");var b={};b.arr=[],b.update=function(a){this.arr.push(a)};var c=function(a){var b=d.getPosArrayOfChildren_AtObj(a,0);if(2!=b.length)return-1;var c=b[1];if("03"!=a.substring(c,c+2))return-1;var e=d.getStartPosOfV_AtObj(a,c);return"00"!=a.substring(e,e+2)?-1:e+2},g=function(a){var b=a.toString("hex"),e=c(b),g=d.getPosArrayOfChildren_AtObj(b,e);if(2!=g.length)return null;var h=d.getHexOfV_AtObj(b,g[0]),i=d.getHexOfV_AtObj(b,g[1]),j=new f;return j.setPublic(h,i),j};return b.verify=function(a,b){var c=new h.Key;c.fromPemString(a);var d=g(c.publicToDER()),f=new e.crypto.Signature({alg:"SHA256withRSA",prov:"cryptojs/jsrsa"});f.initVerifyByPublicKey(d);for(var i=0;i<this.arr.length;i++)f.updateHex(this.arr[i].toString("hex"));var j=b.toString("hex");return f.verify(j)},b},i.randomBytes=function(a){for(var b=new c(a),d=0;a>d;++d)b[d]=Math.floor(256*Math.random());return b},i.toByteArray=function(a){var b=g(a),c=[];return b.replace(/(..)/g,function(a){c.push(parseInt(a,16))}),c},b.exports=i}).call(this,a("buffer").Buffer)},{"../contrib/securityLib/asn1hex-1.1.js":131,"../contrib/securityLib/base64.js":132,"../contrib/securityLib/crypto-1.0.js":134,"../contrib/securityLib/rsasign-1.2.js":138,"./key.js":169,buffer:11}],143:[function(a,b,c){var d=function(){this.ndn_data=null,this.ndn_data_dirty=!1};c.Closure=d,d.RESULT_ERR=-1,d.RESULT_OK=0,d.RESULT_REEXPRESS=1,d.RESULT_INTEREST_CONSUMED=2,d.RESULT_VERIFY=3,d.RESULT_FETCHKEY=4,d.UPCALL_FINAL=0,d.UPCALL_INTEREST=1,d.UPCALL_CONSUMED_INTEREST=2,d.UPCALL_CONTENT=3,d.UPCALL_INTEREST_TIMED_OUT=4,d.UPCALL_CONTENT_UNVERIFIED=5,d.UPCALL_CONTENT_BAD=6,d.prototype.upcall=function(){return d.RESULT_OK};var e=function(a,b,c,d){this.face=a,this.ndn=a,this.interest=b,this.matchedComps=c,this.data=d,this.contentObject=d};e.prototype.toString=function(){var a="face = "+this.face;return a+="\nInterest = "+this.interest,a+="\nmatchedComps = "+this.matchedComps,a+="\nData: "+this.data},c.UpcallInfo=e},{}],144:[function(a,b,c){var d=a("./forwarding-flags.js").ForwardingFlags,e=a("./name.js").Name,f=a("./encoding/wire-format.js").WireFormat,g=function(){this.name=new e,this.faceId=null,this.localControlFeature=null,this.origin=null,this.cost=null,this.forwardingFlags=new d,this.expirationPeriod=null};c.ControlParameters=g,g.prototype.wireEncode=function(a){return a=a||f.getDefaultWireFormat(),a.encodeControlParameters(this)},g.prototype.wireDecode=function(a,b){b=b||f.getDefaultWireFormat();var c="object"==typeof a&&a instanceof Blob?a.buf():a;b.decodeControlParameters(this,c)},g.prototype.getName=function(){return this.name},g.prototype.getFaceId=function(){return this.faceId},g.prototype.getLocalControlFeature=function(){return this.localControlFeature},g.prototype.getOrigin=function(){return this.origin},g.prototype.getCost=function(){return this.cost},g.prototype.getForwardingFlags=function(){return this.forwardingFlags},g.prototype.getExpirationPeriod=function(){return this.expirationPeriod},g.prototype.setName=function(a){this.name="object"==typeof a&&a instanceof e?new e(a):new e},g.prototype.setFaceId=function(a){this.faceId=a},g.prototype.setLocalControlFeature=function(a){this.localControlFeature=a},g.prototype.setOrigin=function(a){this.origin=a},g.prototype.setCost=function(a){this.cost=a},g.prototype.setForwardingFlags=function(a){this.forwardingFlags="object"==typeof a&&a instanceof d?new d(a):new d},g.prototype.setExpirationPeriod=function(a){this.expirationPeriod=a}},{"./encoding/wire-format.js":161,"./forwarding-flags.js":166,"./name.js":172}],145:[function(a,b,c){(function(b){var d=a("./crypto.js"),e=a("./util/blob.js").Blob,f=a("./util/signed-blob.js").SignedBlob,g=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),h=a("./encoding/data-utils.js").DataUtils,i=a("./name.js").Name,j=a("./sha256-with-rsa-signature.js").Sha256WithRsaSignature,k=a("./meta-info.js").MetaInfo,l=a("./key-locator.js").KeyLocator,m=a("./security/key-manager.js").globalKeyManager,n=a("./encoding/wire-format.js").WireFormat,o=function(a,b,c){this.name="string"==typeof a?new i(a):"object"==typeof a&&a instanceof i?new i(a):new i;var d,g;"object"==typeof b&&b instanceof k?(d=b,g=c):(d=null,g=b),this.signedInfo="object"==typeof d&&d instanceof k?new k(d):new k,this.content="string"==typeof g?h.toNumbersFromString(g):"object"==typeof g&&g instanceof e?g.buf():g,this.signature=new j,this.wireEncoding=f()};c.Data=o,o.prototype.getName=function(){return this.name},o.prototype.getMetaInfo=function(){return this.signedInfo},o.prototype.getSignature=function(){return this.signature},o.prototype.getContent=function(){return new e(this.content,!1)},o.prototype.getContentAsBuffer=function(){return this.content},o.prototype.setName=function(a){return this.name="object"==typeof a&&a instanceof i?new i(a):new i,this.wireEncoding=f(),this},o.prototype.setMetaInfo=function(a){return this.signedInfo="object"==typeof a&&a instanceof k?new k(a):new k,this.wireEncoding=f(),this},o.prototype.setSignature=function(a){return this.signature="object"==typeof a&&a instanceof j?a.clone():new j,this.wireEncoding=f(),this},o.prototype.setContent=function(a){return this.content="string"==typeof a?h.toNumbersFromString(a):"object"==typeof a&&a instanceof e?a.buf():new b(a),this.wireEncoding=f(),this},o.prototype.sign=function(a){a=a||n.getDefaultWireFormat(),(null==this.getSignatureOrMetaInfoKeyLocator()||null==this.getSignatureOrMetaInfoKeyLocator().getType())&&this.getMetaInfo().setFields(),(null==this.wireEncoding||this.wireEncoding.isNull())&&(this.getSignature().setSignature(new b(128)),this.wireEncode(a));var c=d.createSign("RSA-SHA256");c.update(this.wireEncoding.signedBuf());var e=new b(h.toNumbersIfString(c.sign(m.privateKey)));this.signature.setSignature(e)},o.verifyUsesString=null,o.prototype.verify=function(a){if(null==a||null==a.publicKeyPem)throw new Error("Cannot verify Data without a public key.");if(null==o.verifyUsesString){var b=d.createHash("sha256").digest();o.verifyUsesString="string"==typeof b}(null==this.wireEncoding||this.wireEncoding.isNull())&&this.wireEncode();var c=d.createVerify("RSA-SHA256");c.update(this.wireEncoding.signedBuf());var e=o.verifyUsesString?h.toString(this.signature.getSignature().buf()):this.signature.getSignature().buf();return c.verify(a.publicKeyPem,e)},o.prototype.getElementLabel=function(){return g.Data},o.prototype.wireEncode=function(a){a=a||n.getDefaultWireFormat();var b=a.encodeData(this);return this.wireEncoding=new f(b.encoding,b.signedPortionBeginOffset,b.signedPortionEndOffset),this.wireEncoding},o.prototype.wireDecode=function(a,b){b=b||n.getDefaultWireFormat();var c="object"==typeof a&&a instanceof e?a.buf():a,d=b.decodeData(this,c);this.wireEncoding=new f(new e(a,!0),d.signedPortionBeginOffset,d.signedPortionEndOffset)},o.prototype.getSignatureOrMetaInfoKeyLocator=function(){return null!=this.signature&&null!=this.signature.getKeyLocator()&&null!=this.signature.getKeyLocator().getType()&&this.signature.getKeyLocator().getType()>=0?this.signature.getKeyLocator():null!=this.signedInfo&&null!=this.signedInfo.locator&&null!=this.signedInfo.locator.getType()&&this.signedInfo.locator.getType()>=0?(console.log("WARNING: Temporarily using the key locator found in the MetaInfo - expected it in the Signature object."),console.log("WARNING: In the future, the key locator in the Signature object will not be supported."),this.signedInfo.locator):null!=this.signature&&null!=this.signature.getKeyLocator()?this.signature.getKeyLocator():new l};var p=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat;o.prototype.from_ndnb=function(a){p.decodeData(this,a)},o.prototype.to_ndnb=function(a){p.encodeData(this,a)},o.prototype.encode=function(a){return a=a||p.get(),a.encodeData(this).buf()},o.prototype.decode=function(a,b){b=b||p.get(),b.decodeData(this,a)};var q=function(a,b,c){o.call(this,a,b,c)};q.prototype=new o,c.ContentObject=q}).call(this,a("buffer").Buffer)},{"./crypto.js":142,"./encoding/binary-xml-encoder.js":147,"./encoding/binary-xml-wire-format.js":149,"./encoding/data-utils.js":150,"./encoding/wire-format.js":161,"./key-locator.js":168,"./meta-info.js":171,"./name.js":172,"./security/key-manager.js":183,"./sha256-with-rsa-signature.js":190,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199,"./util/signed-blob.js":201,buffer:11}],146:[function(a,b,c){(function(b){var d=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("../util/ndn-time.js").NDNTime,f=a("./data-utils.js").DataUtils,g=a("./decoding-exception.js").DecodingException,h=a("../log.js").Log.LOG,i=1,j=2,k=3,l=4,m=6,n=0,o=3,p=(1<<o)-1,q=o+1,r=(1<<q)-1,s=7,t=(1<<s)-1,u=1<<s;tagToString=function(a){return a>=0&&a<NDNProtocolDTagsStrings.length?NDNProtocolDTagsStrings[a]:a==d.NDNProtocolDataUnit?d.NDNPROTOCOL_DATA_UNIT:null},stringToTag=function(a){for(var b=0;b<NDNProtocolDTagsStrings.length;++b)if(null!=NDNProtocolDTagsStrings[b]&&NDNProtocolDTagsStrings[b]==a)return b;return d.NDNPROTOCOL_DATA_UNIT==a?d.NDNProtocolDataUnit:null};var v=function(a){this.input=a,this.offset=0,this.previouslyPeekedDTagStartOffset=-1};c.BinaryXMLDecoder=v,v.prototype.readElementStartDTag=function(a){if(this.offset==this.previouslyPeekedDTagStartOffset){if(this.previouslyPeekedDTag!=a)throw new g(new Error("Did not get the expected DTAG "+a+", got "+this.previouslyPeekedDTag));this.offset=this.previouslyPeekedDTagEndOffset}else{var b=this.decodeTypeAndVal();if(null==b||b.type()!=j)throw new g(new Error("Header type is not a DTAG"));if(b.val()!=a)throw new g(new Error("Expected start element: "+a+" got: "+b.val()))}},v.prototype.readStartElement=function(a,b){var c=this.decodeTypeAndVal();if(null==c)throw new g(new Error("Expected start element: "+a+" got something not a tag."));var d=null;if(c.type()==i){var e;e="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,d=this.decodeUString(e)}else c.type()==j&&(d=c.val());if(null==d||d!=a)throw console.log("expecting "+a+" but got "+d),new g(new Error("Expected start element: "+a+" got: "+d+"("+c.val()+")"));null!=b&&readAttributes(b)},v.prototype.readAttributes=function(a){if(null!=a)try{for(var b=this.peekTypeAndVal();null!=b&&(k==b.type()||l==b.type());){var c=this.decodeTypeAndVal(),d=null;if(k==c.type()){var e;e="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,d=this.decodeUString(e)}else if(l==c.type()&&(d=tagToString(c.val()),null==d))throw new g(new Error("Unknown DATTR value"+c.val()));var f=this.decodeUString();a.push([d,f]),b=this.peekTypeAndVal()}}catch(h){throw new g(new Error("readStartElement",h))}},v.prototype.peekStartElementAsString=function(){var a=null,b=this.offset;try{var c=this.decodeTypeAndVal();if(null!=c)if(c.type()==i){var d;d="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1,a=this.decodeUString(d)}else c.type()==j&&(a=tagToString(c.val()))}catch(e){}finally{try{this.offset=b}catch(e){throw Log.logStackTrace(Log.FAC_ENCODING,Level.WARNING,e),new g(new Error("Cannot reset stream! "+e.getMessage(),e))
}}return a},v.prototype.peekDTag=function(a){if(this.offset==this.previouslyPeekedDTagStartOffset)return this.previouslyPeekedDTag==a;if(this.input[this.offset]==n)return!1;var b=this.offset,c=this.decodeTypeAndVal();return this.previouslyPeekedDTagEndOffset=this.offset,this.offset=b,null!=c&&c.type()==j?(this.previouslyPeekedDTagStartOffset=b,this.previouslyPeekedDTag=c.val(),c.val()==a):!1},v.prototype.peekStartElement=function(a){if("string"==typeof a){var b=this.peekStartElementAsString();return null!=b&&b==a?!0:!1}if("number"==typeof a){var b=this.peekStartElementAsLong();return null!=b&&b==a?!0:!1}throw new g(new Error("SHOULD BE STRING OR NUMBER"))},v.prototype.peekStartElementAsLong=function(){var a=null,b=this.offset;try{var c=this.decodeTypeAndVal();if(null!=c)if(c.type()==i){if(c.val()+1>DEBUG_MAX_LEN)throw new g(new Error("Decoding error: length "+c.val()+"1 longer than expected maximum length!"));var d;d="string"==typeof c.val()?parseInt(c.val())+1:c.val()+1;var e=this.decodeUString(d);a=stringToTag(e)}else c.type()==j&&(a=c.val())}catch(f){}finally{try{this.offset=b}catch(f){throw Log.logStackTrace(Log.FAC_ENCODING,Level.WARNING,f),new Error("Cannot reset stream! "+f.getMessage(),f)}}return a},v.prototype.readBinaryDTagElement=function(a,b){return this.readElementStartDTag(a),this.readBlob(b)},v.prototype.readBinaryElement=function(a,b,c){return this.readStartElement(a,b),this.readBlob(c)},v.prototype.readElementClose=function(){var a=this.input[this.offset++];if(a!=n)throw new g(new Error("Expected end element, got: "+a))},v.prototype.readEndElement=function(){h>4&&console.log("this.offset is "+this.offset);var a=this.input[this.offset];if(this.offset++,h>4&&console.log("XML_CLOSE IS "+n),h>4&&console.log("next is "+a),a!=n)throw console.log("Expected end element, got: "+a),new g(new Error("Expected end element, got: "+a))},v.prototype.readUString=function(){var a=this.decodeUString();return this.readElementClose(),a},v.prototype.readBlob=function(a){if(this.input[this.offset]==n&&a)return this.readElementClose(),null;var b=this.decodeBlob();return this.readElementClose(),b},v.prototype.readDateTimeDTagElement=function(a){var b=this.readBinaryDTagElement(a);b=f.toHex(b),b=parseInt(b,16);var c=b/4096*1e3,d=new e(c);if(null==d)throw new g(new Error("Cannot parse timestamp: "+f.printHexBytes(b)));return d},v.prototype.readDateTime=function(a){var b=this.readBinaryElement(a);b=f.toHex(b),b=parseInt(b,16);var c=b/4096*1e3;h>4&&console.log("DECODED DATE WITH VALUE"),h>4&&console.log(c);var d=new e(c);if(null==d)throw new g(new Error("Cannot parse timestamp: "+f.printHexBytes(b)));return d},v.prototype.decodeTypeAndVal=function(){var a=-1,b=0,c=!0;do{var d=this.input[this.offset];if(null==d)return null;if(0>d)return null;if(0==d&&0==b)return null;c=0==(d&u),c?(b<<=s,b|=d&t):(a=d&p,b<<=q,b|=d>>>o&r),this.offset++}while(c);return h>4&&console.log("TYPE is "+a+" VAL is "+b),new w(a,b)},v.prototype.peekTypeAndVal=function(){var a=null,b=this.offset;try{a=this.decodeTypeAndVal()}finally{this.offset=b}return a},v.prototype.decodeBlob=function(a){if(null==a){var c,d=this.decodeTypeAndVal();return c="string"==typeof d.val()?parseInt(d.val()):d.val(),this.decodeBlob(c)}var e=new b(this.input.slice(this.offset,this.offset+a));return this.offset+=a,e},v.prototype.decodeUString=function(a){if(null==a){var b=this.offset,c=this.decodeTypeAndVal();return h>4&&console.log("TV is "+c),h>4&&console.log(c),h>4&&console.log("Type of TV is "+typeof c),null==c||m!=c.type()?(this.offset=b,""):this.decodeUString(c.val())}var d=this.decodeBlob(a);return f.toString(d)};var w=function(a,b){this.t=a,this.v=b};w.prototype.type=function(){return this.t},w.prototype.val=function(){return this.v},v.prototype.readIntegerDTagElement=function(a){return parseInt(this.readUTF8DTagElement(a))},v.prototype.readIntegerElement=function(a){h>4&&console.log("READING INTEGER "+a),h>4&&console.log("TYPE OF "+typeof a);var b=this.readUTF8Element(a);return parseInt(b)},v.prototype.readUTF8DTagElement=function(a){return this.readElementStartDTag(a),this.readUString()},v.prototype.readUTF8Element=function(a,b){this.readStartElement(a,b);var c=this.readUString();return c},v.prototype.seek=function(a){this.offset=a}}).call(this,a("buffer").Buffer)},{"../log.js":170,"../util/ndn-protoco-id-tags.js":199,"../util/ndn-time.js":200,"./data-utils.js":150,"./decoding-exception.js":151,buffer:11}],147:[function(a,b,c){var d=a("../log.js").Log.LOG,e=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("../util/dynamic-buffer.js").DynamicBuffer,g=a("./data-utils.js").DataUtils,d=a("../log.js").Log.LOG,h=1,i=2,j=3,k=4,l=5,m=6,n=0,o=3,p=(1<<o)-1,q=o+1,r=(1<<q)-1,s=7,t=(1<<s)-1,u=1<<s,v=255,w=function(a){a||(a=16),this.ostream=new f(a),this.offset=0,this.CODEC_NAME="Binary"};c.BinaryXMLEncoder=w,w.prototype.writeUString=function(a){this.encodeUString(a,m)},w.prototype.writeBlob=function(a){d>3&&console.log(a),this.encodeBlob(a,a.length)},w.prototype.writeElementStartDTag=function(a){this.encodeTypeAndVal(i,a)},w.prototype.writeStartElement=function(a,b){var c=a;null==c?this.encodeUString(a,h):this.encodeTypeAndVal(i,c),null!=b&&this.writeAttributes(b)},w.prototype.writeElementClose=function(){this.ostream.ensureLength(this.offset+1),this.ostream.array[this.offset]=n,this.offset+=1},w.prototype.writeEndElement=function(){this.writeElementClose()},w.prototype.writeAttributes=function(a){if(null!=a)for(var b=0;b<a.length;b++){var c=a[b].k,d=a[b].v,e=stringToTag(c);null==e?this.encodeUString(c,j):this.encodeTypeAndVal(k,e),this.encodeUString(d)}},stringToTag=function(a){return a>=0&&a<NDNProtocolDTagsStrings.length?NDNProtocolDTagsStrings[a]:a==e.NDNProtocolDataUnit?e.NDNPROTOCOL_DATA_UNIT:null},tagToString=function(a){for(var b=0;b<NDNProtocolDTagsStrings.length;++b)if(null!=NDNProtocolDTagsStrings[b]&&NDNProtocolDTagsStrings[b]==a)return b;return e.NDNPROTOCOL_DATA_UNIT==a?e.NDNProtocolDataUnit:null},w.prototype.writeDTagElement=function(a,b){this.writeElementStartDTag(a),"number"==typeof b?this.writeUString(b.toString()):"string"==typeof b?this.writeUString(b):this.writeBlob(b),this.writeElementClose()},w.prototype.writeElement=function(a,b,c){this.writeStartElement(a,c),"number"==typeof b?(d>4&&console.log("GOING TO WRITE THE NUMBER .charCodeAt(0) "+b.toString().charCodeAt(0)),d>4&&console.log("GOING TO WRITE THE NUMBER "+b.toString()),d>4&&console.log("type of number is "+typeof b.toString()),this.writeUString(b.toString())):"string"==typeof b?(d>4&&console.log("GOING TO WRITE THE STRING  "+b),d>4&&console.log("type of STRING is "+typeof b),this.writeUString(b)):(d>4&&console.log("GOING TO WRITE A BLOB  "+b),this.writeBlob(b)),this.writeElementClose()};w.prototype.encodeTypeAndVal=function(a,b){if(d>4&&console.log("Encoding type "+a+" and value "+b),d>4&&console.log("OFFSET IS "+this.offset),a>m||0>a||0>b)throw new Error("Tag and value must be positive, and tag valid.");var c=this.numEncodingBytes(b);this.ostream.ensureLength(this.offset+c),this.ostream.array[this.offset+c-1]=v&(p&a|(r&b)<<o)|u,b>>>=q;for(var e=this.offset+c-2;0!=b&&e>=this.offset;)this.ostream.array[e]=v&(b&t),b>>>=s,--e;if(0!=b)throw new Error("This should not happen: miscalculated encoding");return this.offset+=c,c},w.prototype.encodeUString=function(a,b){if(null!=a&&b!=h&&(b!=j||0!=a.length)){d>3&&console.log("The string to write is "),d>3&&console.log(a);var c=g.stringToUtf8Array(a);this.encodeTypeAndVal(b,b==h||b==j?c.length-1:c.length),d>3&&console.log("THE string to write is "),d>3&&console.log(c),this.writeString(c),this.offset+=c.length}},w.prototype.encodeBlob=function(a,b){null!=a&&(d>4&&console.log("LENGTH OF XML_BLOB IS "+b),this.encodeTypeAndVal(l,b),this.writeBlobArray(a),this.offset+=b)};var x=(1<<q)-1,y=(1<<q+s)-1,z=(1<<q+2*s)-1;w.prototype.numEncodingBytes=function(a){if(x>=a)return 1;if(y>=a)return 2;if(z>=a)return 3;var b=1;for(a>>>=q;0!=a;)b++,a>>>=s;return b},w.prototype.writeDateTimeDTagElement=function(a,b){var c=Math.round(b.msec/1e3*4096).toString(16);c.length%2==1&&(c="0"+c),this.writeDTagElement(a,g.toNumbers(c))},w.prototype.writeDateTime=function(a,b){var c=Math.round(b.msec/1e3*4096).toString(16);c.length%2==1&&(c="0"+c),this.writeElement(a,g.toNumbers(c))},w.prototype.writeString=function(a){if("string"==typeof a){d>4&&console.log("GOING TO WRITE A STRING"),d>4&&console.log(a),this.ostream.ensureLength(this.offset+a.length);for(var b=0;b<a.length;b++)d>4&&console.log("input.charCodeAt(i)="+a.charCodeAt(b)),this.ostream.array[this.offset+b]=a.charCodeAt(b)}else d>4&&console.log("GOING TO WRITE A STRING IN BINARY FORM"),d>4&&console.log(a),this.writeBlobArray(a)},w.prototype.writeBlobArray=function(a){d>4&&console.log("GOING TO WRITE A BLOB"),this.ostream.copy(a,this.offset)},w.prototype.getReducedOstream=function(){return this.ostream.slice(0,this.offset)}},{"../log.js":170,"../util/dynamic-buffer.js":196,"../util/ndn-protoco-id-tags.js":199,"./data-utils.js":150}],148:[function(a,b,c){var d=a("./binary-xml-decoder.js").BinaryXMLDecoder,e=a("../util/dynamic-buffer.js").DynamicBuffer,f=0,g=1,h=2,i=3,j=4,k=5,l=6,m=0,n=7,o=1<<n,p=function(){this.gotElementEnd=!1,this.offset=0,this.level=0,this.state=p.READ_HEADER_OR_CLOSE,this.headerLength=0,this.useHeaderBuffer=!1,this.headerBuffer=new e(5),this.nBytesToRead=0};c.BinaryXMLStructureDecoder=p,p.READ_HEADER_OR_CLOSE=0,p.READ_BYTES=1,p.prototype.findElementEnd=function(a){if(this.gotElementEnd)return!0;for(var b=new d(a);;){if(this.offset>=a.length)return!1;switch(this.state){case p.READ_HEADER_OR_CLOSE:if(0==this.headerLength&&a[this.offset]==m){if(++this.offset,--this.level,0==this.level)return this.gotElementEnd=!0,!0;if(this.level<0)throw new Error("BinaryXMLStructureDecoder: Unexpected close tag at offset "+(this.offset-1));this.startHeader();break}for(var c=this.headerLength;;){if(this.offset>=a.length){this.useHeaderBuffer=!0;var e=this.headerLength-c;return this.headerBuffer.copy(a.slice(this.offset-e,e),c),!1}var n=a[this.offset++];if(++this.headerLength,n&o)break}var q;if(this.useHeaderBuffer?(e=this.headerLength-c,this.headerBuffer.copy(a.slice(this.offset-e,e),c),q=new d(this.headerBuffer.array).decodeTypeAndVal()):(b.seek(this.offset-this.headerLength),q=b.decodeTypeAndVal()),null==q)throw new Error("BinaryXMLStructureDecoder: Can't read header starting at offset "+(this.offset-this.headerLength));var r=q.t;if(r==j)this.startHeader();else if(r==h||r==f)++this.level,this.startHeader();else if(r==g||r==i)r==g&&++this.level,this.nBytesToRead=q.v+1,this.state=p.READ_BYTES;else{if(r!=k&&r!=l)throw new Error("BinaryXMLStructureDecoder: Unrecognized header type "+r);this.nBytesToRead=q.v,this.state=p.READ_BYTES}break;case p.READ_BYTES:var s=a.length-this.offset;if(s<this.nBytesToRead)return this.offset+=s,this.nBytesToRead-=s,!1;this.offset+=this.nBytesToRead,this.startHeader();break;default:throw new Error("BinaryXMLStructureDecoder: Unrecognized state "+this.state)}}},p.prototype.startHeader=function(){this.headerLength=0,this.useHeaderBuffer=!1,this.state=p.READ_HEADER_OR_CLOSE},p.prototype.seek=function(a){this.offset=a}},{"../util/dynamic-buffer.js":196,"./binary-xml-decoder.js":146}],149:[function(a,b,c){var d=a("../util/blob.js").Blob,e=a("../util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("./binary-xml-encoder.js").BinaryXMLEncoder,g=a("./binary-xml-decoder.js").BinaryXMLDecoder,h=a("./wire-format.js").WireFormat,i=a("../name.js").Name,j=a("../exclude.js").Exclude,k=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,l=a("../meta-info.js").MetaInfo,m=a("../publisher-public-key-digest.js").PublisherPublicKeyDigest,n=a("./data-utils.js").DataUtils,o=a("../key-locator.js").KeyLocatorType,p=function(){h.call(this)};c.BinaryXmlWireFormat=p,p.instance=null,p.prototype.encodeInterest=function(a){var b=new f,c=p.encodeInterest(a,b);return{encoding:new d(b.getReducedOstream(),!1),signedPortionBeginOffset:c.signedPortionBeginOffset,signedPortionEndOffset:c.signedPortionEndOffset}},p.prototype.decodeInterest=function(a,b){var c=new g(b);p.decodeInterest(a,c)},p.prototype.encodeData=function(a){var b=new f(1500),c=p.encodeData(a,b);return c.encoding=new d(b.getReducedOstream(),!1),c},p.prototype.encodeContentObject=function(a){return this.encodeData(a)},p.prototype.decodeData=function(a,b){var c=new g(b);return p.decodeData(a,c)},p.prototype.decodeContentObject=function(a,b){this.decodeData(a,b)},p.get=function(){return null===p.instance&&(p.instance=new p),p.instance},p.encodeInterest=function(a,b){b.writeElementStartDTag(e.Interest);var c=a.getName().to_ndnb(b);return null!=a.getMinSuffixComponents()&&b.writeDTagElement(e.MinSuffixComponents,a.getMinSuffixComponents()),null!=a.getMaxSuffixComponents()&&b.writeDTagElement(e.MaxSuffixComponents,a.getMaxSuffixComponents()),a.getKeyLocator().getType()==o.KEY_LOCATOR_DIGEST&&!a.getKeyLocator().getKeyData().isNull()&&a.getKeyLocator().getKeyData().size()>0?b.writeDTagElement(e.PublisherPublicKeyDigest,a.getKeyLocator().getKeyData()):null!=a.publisherPublicKeyDigest&&a.publisherPublicKeyDigest.to_ndnb(b),null!=a.getExclude()&&a.getExclude().to_ndnb(b),null!=a.getChildSelector()&&b.writeDTagElement(e.ChildSelector,a.getChildSelector()),a.DEFAULT_ANSWER_ORIGIN_KIND!=a.setAnswerOriginKind()&&null!=a.setAnswerOriginKind()&&b.writeDTagElement(e.AnswerOriginKind,a.setAnswerOriginKind()),null!=a.setScope()&&b.writeDTagElement(e.Scope,a.setScope()),null!=a.getInterestLifetimeMilliseconds()&&b.writeDTagElement(e.InterestLifetime,n.nonNegativeIntToBigEndian(a.getInterestLifetimeMilliseconds()/1e3*4096)),a.getNonce().size()>0&&b.writeDTagElement(e.Nonce,a.getNonce()),b.writeElementClose(),c},p.decodeInterest=function(a,b){b.readElementStartDTag(e.Interest),a.setName(new i),a.getName().from_ndnb(b),a.setMinSuffixComponents(b.peekDTag(e.MinSuffixComponents)?b.readIntegerDTagElement(e.MinSuffixComponents):null),a.setMaxSuffixComponents(b.peekDTag(e.MaxSuffixComponents)?b.readIntegerDTagElement(e.MaxSuffixComponents):null),a.getKeyLocator().clear(),b.peekDTag(e.PublisherPublicKeyDigest)?(a.publisherPublicKeyDigest=new m,a.publisherPublicKeyDigest.from_ndnb(b)):a.publisherPublicKeyDigest=null,null!=a.publisherPublicKeyDigest&&null!=a.publisherPublicKeyDigest.publisherPublicKeyDigest&&a.publisherPublicKeyDigest.publisherPublicKeyDigest.length>0&&(a.getKeyLocator().setType(o.KEY_LOCATOR_DIGEST),a.getKeyLocator().setKeyData(a.publisherPublicKeyDigest.publisherPublicKeyDigest)),b.peekDTag(e.Exclude)?(a.setExclude(new j),a.getExclude().from_ndnb(b)):a.setExclude(new j),a.setChildSelector(b.peekDTag(e.ChildSelector)?b.readIntegerDTagElement(e.ChildSelector):null),a.setAnswerOriginKind(b.peekDTag(e.AnswerOriginKind)?b.readIntegerDTagElement(e.AnswerOriginKind):null),a.setScope(b.peekDTag(e.Scope)?b.readIntegerDTagElement(e.Scope):null),a.setInterestLifetimeMilliseconds(b.peekDTag(e.InterestLifetime)?1e3*n.bigEndianToUnsignedInt(b.readBinaryDTagElement(e.InterestLifetime))/4096:null),a.setNonce(b.peekDTag(e.Nonce)?b.readBinaryDTagElement(e.Nonce):null),b.readElementClose()},p.encodeData=function(a,b){b.writeElementStartDTag(a.getElementLabel()),null!=a.getSignature()&&a.getSignature().to_ndnb(b);var c=b.offset;null!=a.getName()&&a.getName().to_ndnb(b),null!=a.getMetaInfo()&&a.getMetaInfo().to_ndnb(b,a.getSignatureOrMetaInfoKeyLocator()),b.writeDTagElement(e.Content,a.getContent().buf());var d=b.offset;return b.writeElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:d}},p.decodeData=function(a,b){b.readElementStartDTag(a.getElementLabel()),b.peekDTag(e.Signature)?(a.setSignature(new k),a.getSignature().from_ndnb(b)):a.setSignature(new k);var c=b.offset;a.setName(new i),a.getName().from_ndnb(b),b.peekDTag(e.SignedInfo)?(a.setMetaInfo(new l),a.getMetaInfo().from_ndnb(b),null!=a.getMetaInfo().locator&&null!=a.getSignature()&&a.getSignature().setKeyLocator(a.getMetaInfo().locator)):a.setMetaInfo(new l),a.setContent(b.readBinaryDTagElement(e.Content,!0));var d=b.offset;return b.readElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:d}}},{"../exclude.js":162,"../key-locator.js":168,"../meta-info.js":171,"../name.js":172,"../publisher-public-key-digest.js":174,"../sha256-with-rsa-signature.js":190,"../util/blob.js":194,"../util/ndn-protoco-id-tags.js":199,"./binary-xml-decoder.js":146,"./binary-xml-encoder.js":147,"./data-utils.js":150,"./wire-format.js":161}],150:[function(a,b,c){(function(a){var b=function(){};c.DataUtils=b,b.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b.stringtoBase64=function(a){var c,d,e,f,g,h="",i="",j="",k=0;do c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=a.charCodeAt(k++),e=c>>2,f=(3&c)<<4|d>>4,g=(15&d)<<2|i>>6,j=63&i,isNaN(d)?g=j=64:isNaN(i)&&(j=64),h=h+b.keyStr.charAt(e)+b.keyStr.charAt(f)+b.keyStr.charAt(g)+b.keyStr.charAt(j),c=d=i="",e=f=g=j="";while(k<a.length);return h},b.base64toString=function(a){var c,d,e,f,g,h="",i="",j="",k=0,l=/[^A-Za-z0-9\+\/\=]/g;l.exec(a)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do e=b.keyStr.indexOf(a.charAt(k++)),f=b.keyStr.indexOf(a.charAt(k++)),g=b.keyStr.indexOf(a.charAt(k++)),j=b.keyStr.indexOf(a.charAt(k++)),c=e<<2|f>>4,d=(15&f)<<4|g>>2,i=(3&g)<<6|j,h+=String.fromCharCode(c),64!=g&&(h+=String.fromCharCode(d)),64!=j&&(h+=String.fromCharCode(i)),c=d=i="",e=f=g=j="";while(k<a.length);return h},b.toHex=function(a){return a.toString("hex")},b.stringToHex=function(a){for(var b="",c=0;c<a.length;++c){var d=a.charCodeAt(c);b+=(16>d?"0":"")+d.toString(16)}return b},b.toString=function(a){return a.toString("binary")},b.toNumbers=function(b){return new a(b,"hex")},b.hexToRawString=function(a){if("string"==typeof a){var b="";return a.replace(/(..)/g,function(a){b+=String.fromCharCode(parseInt(a,16))}),b}},b.toNumbersFromString=function(b){return new a(b,"binary")},b.toNumbersIfString=function(b){return"string"==typeof b?new a(b,"binary"):b},b.stringToUtf8Array=function(b){return new a(b,"utf8")},b.concatArrays=function(b){return a.concat(b)},b.decodeUtf8=function(a){for(var b="",c=0,d=0,e=0;c<a.length;)if(d=a.charCodeAt(c),128>d)b+=String.fromCharCode(d),c++;else if(d>191&&224>d)e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2;else{e=a.charCodeAt(c+1);var f=a.charCodeAt(c+2);b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3}return b},b.arraysEqual=function(a,b){if(!a.slice)throw new Error("DataUtils.arraysEqual: a1 is not an array");if(!b.slice)throw new Error("DataUtils.arraysEqual: a2 is not an array");if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0},b.bigEndianToUnsignedInt=function(a){for(var b=0,c=0;c<a.length;++c)b<<=8,b+=a[c];return b},b.nonNegativeIntToBigEndian=function(b){if(b=Math.round(b),0>=b)return new a(0);for(var c=8,d=new a(c),e=0;0!=b;)++e,d[c-e]=255&b,b>>=8;return d.slice(c-e,c)},b.shuffle=function(a){for(var b=a.length-1;b>=1;--b){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}}}).call(this,a("buffer").Buffer)},{buffer:11}],151:[function(a,b,c){function d(a){this.message=a.message;for(var b in a)this[b]=a[b]}d.prototype=new Error,d.prototype.name="DecodingException",c.DecodingException=d},{}],152:[function(a,b,c){var d=a("./data-utils.js").DataUtils,e=a("./binary-xml-structure-decoder.js").BinaryXMLStructureDecoder,f=a("./tlv/tlv.js").Tlv,g=a("./tlv/tlv-structure-decoder.js").TlvStructureDecoder,h=a("../log.js").Log.LOG,i=function(a){this.elementListener=a,this.dataParts=[],this.binaryXmlStructureDecoder=new e,this.tlvStructureDecoder=new g,this.useTlv=null};c.ElementReader=i,i.prototype.onReceivedData=function(a){for(;;){if(0==this.dataParts.length){if(a.length<=0)return;this.useTlv=a[0]==f.Interest||a[0]==f.Data||128==a[0]?!0:!1}var b,c;if(this.useTlv?(this.tlvStructureDecoder.seek(0),b=this.tlvStructureDecoder.findElementEnd(a),c=this.tlvStructureDecoder.getOffset()):(this.binaryXmlStructureDecoder.seek(0),b=this.binaryXmlStructureDecoder.findElementEnd(a),c=this.binaryXmlStructureDecoder.offset),!b)return this.dataParts.push(a),void(h>3&&console.log("Incomplete packet received. Length "+a.length+". Wait for more input."));this.dataParts.push(a.slice(0,c));var i=d.concatArrays(this.dataParts);this.dataParts=[];try{this.elementListener.onReceivedElement(i)}catch(j){console.log("ElementReader: ignoring exception from onReceivedElement: "+j)}if(a=a.slice(c,a.length),this.binaryXmlStructureDecoder=new e,this.tlvStructureDecoder=new g,0==a.length)return}}},{"../log.js":170,"./binary-xml-structure-decoder.js":148,"./data-utils.js":150,"./tlv/tlv-structure-decoder.js":159,"./tlv/tlv.js":160}],153:[function(a,b,c){var d=a("./data-utils.js").DataUtils,e=a("./binary-xml-encoder.js").BinaryXMLEncoder,f=a("./binary-xml-decoder.js").BinaryXMLDecoder,g=(a("../key.js").Key,a("../key-locator.js").KeyLocatorType),h=a("../interest.js").Interest,i=a("../data.js").Data,j=a("../face-instance.js").FaceInstance,k=a("../forwarding-entry.js").ForwardingEntry,l=a("./wire-format.js").WireFormat,m=a("../log.js").Log.LOG,n=function(){};c.EncodingUtils=n,n.encodeToHexInterest=function(a,b){return b=b||l.getDefaultWireFormat(),d.toHex(a.wireEncode(b).buf())},n.encodeToHexData=function(a,b){return b=b||l.getDefaultWireFormat(),d.toHex(a.wireEncode(b).buf())},n.encodeToHexContentObject=function(a,b){return n.encodeToHexData(a,b)},n.encodeForwardingEntry=function(a){var b=new e;a.to_ndnb(b);var c=b.getReducedOstream();return c},n.decodeHexFaceInstance=function(a){var b=d.toNumbers(a),c=new f(b);m>3&&console.log("DECODING HEX FACE INSTANCE  \n"+b);var e=new j;return e.from_ndnb(c),e},n.decodeHexInterest=function(a,b){b=b||l.getDefaultWireFormat();var c=new h;return c.wireDecode(d.toNumbers(a),b),c},n.decodeHexData=function(a,b){b=b||l.getDefaultWireFormat();var c=new i;return c.wireDecode(d.toNumbers(a),b),c},n.decodeHexContentObject=function(a,b){return n.decodeHexData(a,b)},n.decodeHexForwardingEntry=function(a){var b=d.toNumbers(a),c=new f(b);m>3&&console.log("DECODED HEX FORWARDING ENTRY \n"+b);var e=new k;return e.from_ndnb(c),e},n.decodeSubjectPublicKeyInfo=function(a){var b=d.toHex(a).toLowerCase(),c=_x509_getPublicKeyHexArrayFromCertHex(b,_x509_getSubjectPublicKeyPosFromCertHex(b,0)),e=new RSAKey;return e.setPublic(c[0],c[1]),e},n.dataToHtml=function(a){var b="";if(-1==a)b+="NO CONTENT FOUND";else if(-2==a)b+="CONTENT NAME IS EMPTY";else{if(null!=a.getName()&&(b+="NAME: "+a.getName().toUri(),b+="<br />",b+="<br />"),a.getContent().isNull()||(b+="CONTENT(ASCII): "+d.toString(a.getContent().buf()),b+="<br />",b+="<br />"),a.getContent().isNull()||(b+="CONTENT(hex): "+a.getContent().toHex(),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().digestAlgorithm&&(b+="DigestAlgorithm (hex): "+d.toHex(a.getSignature().digestAlgorithm),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().witness&&(b+="Witness (hex): "+d.toHex(a.getSignature().witness),b+="<br />",b+="<br />"),null!=a.getSignature()&&null!=a.getSignature().getSignature()&&(b+="Signature(hex): "+a.getSignature().getSignature().toHex(),b+="<br />",b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().publisher&&null!=a.getMetaInfo().publisher.publisherPublicKeyDigest&&(b+="Publisher Public Key Digest(hex): "+d.toHex(a.getMetaInfo().publisher.publisherPublicKeyDigest),b+="<br />",b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().timestamp){var c=new Date;c.setTime(a.getMetaInfo().timestamp.msec);b+="TimeStamp: "+c,b+="<br />",b+="TimeStamp(number): "+a.getMetaInfo().timestamp.msec,b+="<br />"}null!=a.getMetaInfo()&&a.getMetaInfo().getFinalBlockID().getValue().size()>0&&(b+="FinalBlockID: "+a.getMetaInfo().getFinalBlockID().getValue().toHex(),b+="<br />"),null!=a.getMetaInfo()&&null!=a.getMetaInfo().locator&&a.getMetaInfo().locator.getType()&&(b+="keyLocator: ",b+=a.getMetaInfo().locator.getType()==g.KEY?"Key: "+d.toHex(a.getMetaInfo().locator.publicKey).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.KEY_LOCATOR_DIGEST?"KeyLocatorDigest: "+d.toHex(a.getMetaInfo().locator.getKeyData().buf()).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.CERTIFICATE?"Certificate: "+d.toHex(a.getMetaInfo().locator.certificate).toLowerCase()+"<br />":a.getMetaInfo().locator.getType()==g.KEYNAME?"KeyName: "+a.getMetaInfo().locator.keyName.contentName.to_uri()+"<br />":"[unrecognized ndn_KeyLocatorType "+a.getMetaInfo().locator.getType()+"]<br />")}return b},n.contentObjectToHtml=function(a){return n.dataToHtml(a)}},{"../data.js":145,"../face-instance.js":163,"../forwarding-entry.js":165,"../interest.js":167,"../key-locator.js":168,"../key.js":169,"../log.js":170,"./binary-xml-decoder.js":146,"./binary-xml-encoder.js":147,"./data-utils.js":150,"./wire-format.js":161}],154:[function(a,b,c){var d=a("./tlv/tlv-encoder.js").TlvEncoder,e=a("./tlv/tlv-decoder.js").TlvDecoder,f=a("../util/blob.js").Blob,g=function(){};c.ProtobufTlv=g,g._Field=null,g.establishField=function(){if(null===g._Field)try{g._Field=dcodeIO.ProtoBuf.Reflect.Message.Field}catch(b){g._Field=a("protobufjs/dist/ProtoBuf.js").Reflect.Message.Field}},g.encode=function(a,b){g.establishField(),a.encodeAB();var c=new d;return g._encodeMessageValue(a,b,c),new f(c.getOutput(),!1)},g.decode=function(b,c,d){g.establishField(),null===g._Field&&(g._Field=dcodeIO?dcodeIO.ProtoBuf.Reflect.Message.Field:a("protobufjs/dist/ProtoBuf.js").Reflect.Message.Field);var h="object"==typeof d&&d instanceof f?d.buf():d,i=new e(h);g._decodeMessageValue(b,c,i,h.length)},g._encodeMessageValue=function(a,b,c){for(var d=b.getChildren(g._Field),e=d.length-1;e>=0;--e){var h,i=d[e],j=i.id;if(i.repeated)h=a[i.name];else{if(null==a[i.name])continue;h=[a[i.name]]}for(var k=h.length-1;k>=0;--k){var l=h[k];if("message"==i.type.name){var m=c.getLength();g._encodeMessageValue(l,i.resolvedType,c),c.writeTypeAndLength(j,c.getLength()-m)}else if("uint32"==i.type.name||"uint64"==i.type.name)c.writeNonNegativeIntegerTlv(j,l);else if("enum"==i.type.name){if(0>l)throw new Error("ProtobufTlv::encode: ENUM value may not be negative");c.writeNonNegativeIntegerTlv(j,l)}else if("bytes"==i.type.name)c.writeBlobTlv(j,l.toBinary());else if("string"==i.type.name)c.writeBlobTlv(j,new f(l,!1).buf());else{if("bool"!=i.type.name)throw new Error("ProtobufTlv::encode: Unknown field type");l&&c.writeTypeAndLength(j,0)}}}},g._decodeMessageValue=function(a,b,c,d){for(var e=b.getChildren(g._Field),f=0;f<e.length;++f){var h=e[f],i=h.id;if(h.required||c.peekType(i,d))if(h.repeated)for(;c.peekType(i,d);)if("message"==h.type.name){var j=c.readNestedTlvsStart(i),k=new(h.resolvedType.build());a.add(h.name,k),g._decodeMessageValue(k,h.resolvedType,c,j),c.finishNestedTlvs(j)}else a.add(h.name,g._decodeFieldValue(h,i,c,d));else if("message"==h.type.name){var j=c.readNestedTlvsStart(i),k=new(h.resolvedType.build());a.set(h.name,k),g._decodeMessageValue(k,h.resolvedType,c,j),c.finishNestedTlvs(j)}else a.set(h.name,g._decodeFieldValue(h,i,c,d))}},g._decodeFieldValue=function(a,b,c,d){if("uint32"==a.type.name||"uint64"==a.type.name||"enum"==a.type.name)return c.readNonNegativeIntegerTlv(b);if("bytes"==a.type.name)return c.readBlobTlv(b);if("string"==a.type.name)return c.readBlobTlv(b).toString();if("bool"==a.type.name)return c.readBooleanTlv(b,d);throw new Error("ProtobufTlv.decode: Unknown field type")}},{"../util/blob.js":194,"./tlv/tlv-decoder.js":157,"./tlv/tlv-encoder.js":158,"protobufjs/dist/ProtoBuf.js":227}],155:[function(a,b,c){(function(b){var d=a("../crypto.js"),e=a("../util/blob.js").Blob,f=a("./tlv/tlv.js").Tlv,g=a("./tlv/tlv-encoder.js").TlvEncoder,h=a("./tlv/tlv-decoder.js").TlvDecoder,i=a("./wire-format.js").WireFormat,j=a("../exclude.js").Exclude,k=a("../meta-info.js").ContentType,l=a("../key-locator.js").KeyLocatorType,m=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,n=a("../forwarding-flags.js").ForwardingFlags,o=a("../publisher-public-key-digest.js").PublisherPublicKeyDigest,p=a("./decoding-exception.js").DecodingException,q=function(){i.call(this)};q.prototype=new i,q.prototype.name="Tlv0_1WireFormat",c.Tlv0_1WireFormat=q,q.instance=null,q.prototype.encodeInterest=function(a){var c=new g(256),h=c.getLength();if(c.writeOptionalNonNegativeIntegerTlv(f.InterestLifetime,a.getInterestLifetimeMilliseconds()),c.writeOptionalNonNegativeIntegerTlv(f.Scope,a.getScope()),a.getNonce().isNull()||0==a.getNonce().size())c.writeBlobTlv(f.Nonce,d.randomBytes(4));else if(a.getNonce().size()<4){var i=b(4);a.getNonce().buf().copy(i);for(var j=a.getNonce().size();4>j;++j)i[j]=d.randomBytes(1)[0];c.writeBlobTlv(f.Nonce,i)}else 4==a.getNonce().size()?c.writeBlobTlv(f.Nonce,a.getNonce().buf()):c.writeBlobTlv(f.Nonce,a.getNonce().buf().slice(0,4));q.encodeSelectors(a,c);var k=q.encodeName(a.getName(),c),l=c.getLength()-k.signedPortionBeginOffset,m=c.getLength()-k.signedPortionEndOffset;c.writeTypeAndLength(f.Interest,c.getLength()-h);var n=c.getLength()-l,o=c.getLength()-m;return{encoding:new e(c.getOutput(),!1),signedPortionBeginOffset:n,signedPortionEndOffset:o}},q.prototype.decodeInterest=function(a,b){var c=new h(b),d=c.readNestedTlvsStart(f.Interest);q.decodeName(a.getName(),c),c.peekType(f.Selectors,d)&&q.decodeSelectors(a,c);var e=c.readBlobTlv(f.Nonce);a.setScope(c.readOptionalNonNegativeIntegerTlv(f.Scope,d)),a.setInterestLifetimeMilliseconds(c.readOptionalNonNegativeIntegerTlv(f.InterestLifetime,d)),a.setNonce(e),c.finishNestedTlvs(d)},q.prototype.encodeData=function(a){var b=new g(1500),c=b.getLength();b.writeBlobTlv(f.SignatureValue,a.getSignature().getSignature().buf());var d=b.getLength();q.encodeSignatureSha256WithRsaValue(a.getSignature(),b,a.getSignatureOrMetaInfoKeyLocator()),b.writeBlobTlv(f.Content,a.getContent().buf()),q.encodeMetaInfo(a.getMetaInfo(),b),q.encodeName(a.getName(),b);var h=b.getLength();b.writeTypeAndLength(f.Data,b.getLength()-c);var i=b.getLength()-h,j=b.getLength()-d;return{encoding:new e(b.getOutput(),!1),signedPortionBeginOffset:i,signedPortionEndOffset:j}},q.prototype.decodeData=function(a,b){var c=new h(b),d=c.readNestedTlvsStart(f.Data),g=c.getOffset();q.decodeName(a.getName(),c),q.decodeMetaInfo(a.getMetaInfo(),c),a.setContent(c.readBlobTlv(f.Content)),q.decodeSignatureInfo(a,c),null!=a.getSignature()&&null!=a.getSignature().getKeyLocator()&&null!=a.getMetaInfo()&&(a.getMetaInfo().locator=a.getSignature().getKeyLocator());var i=c.getOffset();return a.getSignature().setSignature(new e(c.readBlobTlv(f.SignatureValue),!0)),c.finishNestedTlvs(d),{signedPortionBeginOffset:g,signedPortionEndOffset:i}},q.prototype.encodeControlParameters=function(a){var b=new g(256),c=b.getLength();b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_ExpirationPeriod,a.getExpirationPeriod());var d=a.getForwardingFlags().getNfdForwardingFlags();return d!=(new n).getNfdForwardingFlags()&&b.writeNonNegativeIntegerTlv(f.ControlParameters_Flags,d),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_Cost,a.getCost()),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_Origin,a.getOrigin()),b.writeOptionalNonNegativeIntegerTlv(f.ControlParameters_LocalControlFeature,a.getLocalControlFeature()),b.writeOptionalNonNegativeIntegerTlv(f.FaceID,a.getFaceId()),q.encodeName(a.getName(),b),b.writeTypeAndLength(f.ControlParameters_ControlParameters,b.getLength()-c),new e(b.getOutput(),!1)},q.prototype.encodeSignatureInfo=function(a){var b=new g(256);return q.encodeSignatureSha256WithRsaValue(a,b,a.getKeyLocator()),new e(b.getOutput(),!1)},q.SignatureHolder=function(){},q.SignatureHolder.prototype.setSignature=function(a){this.signature=a},q.SignatureHolder.prototype.getSignature=function(){return this.signature},q.prototype.decodeSignatureInfoAndValue=function(a,b){var c=new q.SignatureHolder,d=new h(a);return q.decodeSignatureInfo(c,d),d=h(b),c.getSignature().setSignature(new e(d.readBlobTlv(f.SignatureValue),!0)),c.getSignature()
},q.prototype.encodeSignatureValue=function(a){var b=new g(256);return b.writeBlobTlv(f.SignatureValue,a.getSignature().buf()),new e(b.getOutput(),!1)},q.get=function(){return null===q.instance&&(q.instance=new q),q.instance},q.encodeName=function(a,b){for(var c,d=b.getLength(),e=a.size()-1;e>=0;--e)b.writeBlobTlv(f.NameComponent,a.get(e).getValue().buf()),e==a.size()-1&&(c=b.getLength());var g=b.getLength();b.writeTypeAndLength(f.Name,b.getLength()-d);var h,i=b.getLength()-g;return h=0==a.size()?i:b.getLength()-c,{signedPortionBeginOffset:i,signedPortionEndOffset:h}},q.decodeName=function(a,b){a.clear();for(var c=b.readNestedTlvsStart(f.Name);b.getOffset()<c;)a.append(b.readBlobTlv(f.NameComponent));b.finishNestedTlvs(c)},q.encodeSelectors=function(a,b){var c=b.getLength();if(a.getMustBeFresh()&&b.writeTypeAndLength(f.MustBeFresh,0),b.writeOptionalNonNegativeIntegerTlv(f.ChildSelector,a.getChildSelector()),a.getExclude().size()>0&&q.encodeExclude(a.getExclude(),b),null!=a.getKeyLocator().getType())q.encodeKeyLocator(f.PublisherPublicKeyLocator,a.getKeyLocator(),b);else if(null!=a.publisherPublicKeyDigest){var d=b.getLength();b.writeBlobTlv(f.KeyLocatorDigest,a.publisherPublicKeyDigest.publisherPublicKeyDigest),b.writeTypeAndLength(f.PublisherPublicKeyLocator,b.getLength()-d)}b.writeOptionalNonNegativeIntegerTlv(f.MaxSuffixComponents,a.getMaxSuffixComponents()),b.writeOptionalNonNegativeIntegerTlv(f.MinSuffixComponents,a.getMinSuffixComponents()),b.getLength()!=c&&b.writeTypeAndLength(f.Selectors,b.getLength()-c)},q.decodeSelectors=function(a,b){var c=b.readNestedTlvsStart(f.Selectors);a.setMinSuffixComponents(b.readOptionalNonNegativeIntegerTlv(f.MinSuffixComponents,c)),a.setMaxSuffixComponents(b.readOptionalNonNegativeIntegerTlv(f.MaxSuffixComponents,c)),a.publisherPublicKeyDigest=null,b.peekType(f.PublisherPublicKeyLocator,c)?(q.decodeKeyLocator(f.PublisherPublicKeyLocator,a.getKeyLocator(),b),a.getKeyLocator().getType()==l.KEY_LOCATOR_DIGEST&&(a.publisherPublicKeyDigest=new o,a.publisherPublicKeyDigest.publisherPublicKeyDigest=a.getKeyLocator().getKeyData().buf())):a.getKeyLocator().clear(),b.peekType(f.Exclude,c)?q.decodeExclude(a.getExclude(),b):a.getExclude().clear(),a.setChildSelector(b.readOptionalNonNegativeIntegerTlv(f.ChildSelector,c)),a.setMustBeFresh(b.readBooleanTlv(f.MustBeFresh,c)),b.finishNestedTlvs(c)},q.encodeExclude=function(a,b){for(var c=b.getLength(),d=a.size()-1;d>=0;--d){var e=a.get(d);e==j.ANY?b.writeTypeAndLength(f.Any,0):b.writeBlobTlv(f.NameComponent,e.getValue().buf())}b.writeTypeAndLength(f.Exclude,b.getLength()-c)},q.decodeExclude=function(a,b){var c=b.readNestedTlvsStart(f.Exclude);for(a.clear();;)if(b.peekType(f.NameComponent,c))a.appendComponent(b.readBlobTlv(f.NameComponent));else{if(!b.readBooleanTlv(f.Any,c))break;a.appendAny()}b.finishNestedTlvs(c)},q.encodeKeyLocator=function(a,b,c){var d=c.getLength();if(null!=b.getType())if(b.getType()==l.KEYNAME)q.encodeName(b.getKeyName(),c);else{if(!(b.getType()==l.KEY_LOCATOR_DIGEST&&b.getKeyData().size()>0))throw new Error("Unrecognized KeyLocatorType "+b.getType());c.writeBlobTlv(f.KeyLocatorDigest,b.getKeyData().buf())}c.writeTypeAndLength(a,c.getLength()-d)},q.decodeKeyLocator=function(a,b,c){var d=c.readNestedTlvsStart(a);if(b.clear(),c.getOffset()!=d){if(c.peekType(f.Name,d))b.setType(l.KEYNAME),q.decodeName(b.getKeyName(),c);else{if(!c.peekType(f.KeyLocatorDigest,d))throw new p("decodeKeyLocator: Unrecognized key locator type");b.setType(l.KEY_LOCATOR_DIGEST),b.setKeyData(c.readBlobTlv(f.KeyLocatorDigest))}c.finishNestedTlvs(d)}},q.encodeSignatureSha256WithRsaValue=function(a,b,c){var d=b.getLength();q.encodeKeyLocator(f.KeyLocator,c,b),b.writeNonNegativeIntegerTlv(f.SignatureType,f.SignatureType_SignatureSha256WithRsa),b.writeTypeAndLength(f.SignatureInfo,b.getLength()-d)},q.decodeSignatureInfo=function(a,b){var c=b.readNestedTlvsStart(f.SignatureInfo),d=b.readNonNegativeIntegerTlv(f.SignatureType);if(d!=f.SignatureType_SignatureSha256WithRsa)throw new p("decodeSignatureInfo: unrecognized SignatureInfo type"+d);a.setSignature(new m);var e=a.getSignature();q.decodeKeyLocator(f.KeyLocator,e.getKeyLocator(),b),b.finishNestedTlvs(c)},q.encodeMetaInfo=function(a,b){var c=b.getLength(),d=a.getFinalBlockID().getValue().buf();if(null!=d&&d.length>0){var e=b.getLength();b.writeBlobTlv(f.NameComponent,d),b.writeTypeAndLength(f.FinalBlockId,b.getLength()-e)}if(b.writeOptionalNonNegativeIntegerTlv(f.FreshnessPeriod,a.getFreshnessPeriod()),a.getType()!=k.BLOB){if(a.getType()!=k.LINK&&a.getType()!=k.KEY)throw new Error("unrecognized TLV ContentType");b.writeNonNegativeIntegerTlv(f.ContentType,a.getType())}b.writeTypeAndLength(f.MetaInfo,b.getLength()-c)},q.decodeMetaInfo=function(a,b){var c=b.readNestedTlvsStart(f.MetaInfo);if(a.setType(b.readOptionalNonNegativeIntegerTlv(f.ContentType,c)),a.setFreshnessPeriod(b.readOptionalNonNegativeIntegerTlv(f.FreshnessPeriod,c)),b.peekType(f.FinalBlockId,c)){var d=b.readNestedTlvsStart(f.FinalBlockId);a.setFinalBlockID(b.readBlobTlv(f.NameComponent)),b.finishNestedTlvs(d)}else a.setFinalBlockID(null);b.finishNestedTlvs(c)}}).call(this,a("buffer").Buffer)},{"../crypto.js":142,"../exclude.js":162,"../forwarding-flags.js":166,"../key-locator.js":168,"../meta-info.js":171,"../publisher-public-key-digest.js":174,"../sha256-with-rsa-signature.js":190,"../util/blob.js":194,"./decoding-exception.js":151,"./tlv/tlv-decoder.js":157,"./tlv/tlv-encoder.js":158,"./tlv/tlv.js":160,"./wire-format.js":161,buffer:11}],156:[function(a,b,c){var d=a("./wire-format.js").WireFormat,e=a("./tlv-0_1-wire-format.js").Tlv0_1WireFormat,f=function(){e.call(this)};f.prototype=new e,f.prototype.name="TlvWireFormat",c.TlvWireFormat=f,f.instance=null,f.get=function(){return null===f.instance&&(f.instance=new f),f.instance},d.setDefaultWireFormat(f.get())},{"./tlv-0_1-wire-format.js":155,"./wire-format.js":161}],157:[function(a,b,c){var d=a("../decoding-exception.js").DecodingException,e=function(a){this.input=a,this.offset=0};c.TlvDecoder=e,e.prototype.readVarNumber=function(){var a=this.input[this.offset];return this.offset+=1,253>a?a:this.readExtendedVarNumber(a)},e.prototype.readExtendedVarNumber=function(a){var b;return 253==a?(b=(this.input[this.offset]<<8)+this.input[this.offset+1],this.offset+=2):254==a?(b=(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3],this.offset+=4):(b=(this.input[this.offset]<<56)+(this.input[this.offset+1]<<48)+(this.input[this.offset+2]<<40)+(this.input[this.offset+3]<<32)+(this.input[this.offset+4]<<24)+(this.input[this.offset+5]<<16)+(this.input[this.offset+6]<<8)+this.input[this.offset+7],this.offset+=8),b},e.prototype.readTypeAndLength=function(a){var b=this.readVarNumber();if(b!=a)throw new d("Did not get the expected TLV type");var c=this.readVarNumber();if(this.offset+c>this.input.length)throw new d("TLV length exceeds the buffer length");return c},e.prototype.readNestedTlvsStart=function(a){return this.readTypeAndLength(a)+this.offset},e.prototype.finishNestedTlvs=function(a){if(this.offset!=a){for(;this.offset<a;){this.readVarNumber();var b=this.readVarNumber();if(this.offset+=b,this.offset>this.input.length)throw new d("TLV length exceeds the buffer length")}if(this.offset!=a)throw new d("TLV length does not equal the total length of the nested TLVs")}},e.prototype.peekType=function(a,b){if(this.offset>=b)return!1;var c=this.offset,d=this.readVarNumber();return this.offset=c,d==a},e.prototype.readNonNegativeInteger=function(a){var b;if(1==a)b=this.input[this.offset];else if(2==a)b=(this.input[this.offset]<<8)+this.input[this.offset+1];else if(4==a)b=(this.input[this.offset]<<24)+(this.input[this.offset+1]<<16)+(this.input[this.offset+2]<<8)+this.input[this.offset+3];else{if(8!=a)throw new d("Invalid length for a TLV nonNegativeInteger");b=(this.input[this.offset]<<56)+(this.input[this.offset+1]<<48)+(this.input[this.offset+2]<<40)+(this.input[this.offset+3]<<32)+(this.input[this.offset+4]<<24)+(this.input[this.offset+5]<<16)+(this.input[this.offset+6]<<8)+this.input[this.offset+7]}return this.offset+=a,b},e.prototype.readNonNegativeIntegerTlv=function(a){var b=this.readTypeAndLength(a);return this.readNonNegativeInteger(b)},e.prototype.readOptionalNonNegativeIntegerTlv=function(a,b){return this.peekType(a,b)?this.readNonNegativeIntegerTlv(a):null},e.prototype.readBlobTlv=function(a){var b=this.readTypeAndLength(a),c=this.input.slice(this.offset,this.offset+b);return this.offset+=b,c},e.prototype.readOptionalBlobTlv=function(a,b){return this.peekType(a,b)?this.readBlobTlv(a):null},e.prototype.readBooleanTlv=function(a,b){if(this.peekType(a,b)){var c=this.readTypeAndLength(a);return this.offset+=c,!0}return!1},e.prototype.getOffset=function(){return this.offset},e.prototype.seek=function(a){this.offset=a}},{"../decoding-exception.js":151}],158:[function(a,b,c){var d=a("../../util/dynamic-buffer.js").DynamicBuffer,e=function(a){a=a||16,this.output=new d(a),this.length=0};c.TlvEncoder=e,e.prototype.getLength=function(){return this.length},e.prototype.writeVarNumber=function(a){if(253>a)this.length+=1,this.output.ensureLengthFromBack(this.length),this.output.array[this.output.array.length-this.length]=255&a;else if(65535>=a){this.length+=3,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=253,this.output.array[b+1]=a>>8&255,this.output.array[b+2]=255&a}else if(4294967295>=a){this.length+=5,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=254,this.output.array[b+1]=a>>24&255,this.output.array[b+2]=a>>16&255,this.output.array[b+3]=a>>8&255,this.output.array[b+4]=255&a}else{this.length+=9,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=255,this.output.array[b+1]=a>>56&255,this.output.array[b+2]=a>>48&255,this.output.array[b+3]=a>>40&255,this.output.array[b+4]=a>>32&255,this.output.array[b+5]=a>>24&255,this.output.array[b+6]=a>>16&255,this.output.array[b+7]=a>>8&255,this.output.array[b+8]=255&a}},e.prototype.writeTypeAndLength=function(a,b){this.writeVarNumber(b),this.writeVarNumber(a)},e.prototype.writeNonNegativeInteger=function(a){if(0>a)throw new Error("TLV integer value may not be negative");if(a=Math.round(a),253>a)this.length+=1,this.output.ensureLengthFromBack(this.length),this.output.array[this.output.array.length-this.length]=255&a;else if(65535>=a){this.length+=2,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=a>>8&255,this.output.array[b+1]=255&a}else if(4294967295>=a){this.length+=4,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=a>>24&255,this.output.array[b+1]=a>>16&255,this.output.array[b+2]=a>>8&255,this.output.array[b+3]=255&a}else{this.length+=8,this.output.ensureLengthFromBack(this.length);var b=this.output.array.length-this.length;this.output.array[b]=a>>56&255,this.output.array[b+1]=a>>48&255,this.output.array[b+2]=a>>40&255,this.output.array[b+3]=a>>32&255,this.output.array[b+4]=a>>24&255,this.output.array[b+5]=a>>16&255,this.output.array[b+6]=a>>8&255,this.output.array[b+7]=255&a}},e.prototype.writeNonNegativeIntegerTlv=function(a,b){var c=this.length;this.writeNonNegativeInteger(b),this.writeTypeAndLength(a,this.length-c)},e.prototype.writeOptionalNonNegativeIntegerTlv=function(a,b){null!=b&&b>=0&&this.writeNonNegativeIntegerTlv(a,b)},e.prototype.writeBlobTlv=function(a,b){return null==b?void this.writeTypeAndLength(a,0):(this.length+=b.length,this.output.copyFromBack(b,this.length),void this.writeTypeAndLength(a,b.length))},e.prototype.writeOptionalBlobTlv=function(a,b){null!=b&&b.length>0&&this.writeBlobTlv(a,b)},e.prototype.getOutput=function(){return this.output.array.slice(this.output.array.length-this.length)}},{"../../util/dynamic-buffer.js":196}],159:[function(a,b,c){(function(b){var d=a("./tlv-decoder.js").TlvDecoder,e=function f(){this.gotElementEnd=!1,this.offset=0,this.state=f.READ_TYPE,this.headerLength=0,this.useHeaderBuffer=!1,this.headerBuffer=new b(8),this.nBytesToRead=0};c.TlvStructureDecoder=e,e.READ_TYPE=0,e.READ_TYPE_BYTES=1,e.READ_LENGTH=2,e.READ_LENGTH_BYTES=3,e.READ_VALUE_BYTES=4,e.prototype.findElementEnd=function(a){if(this.gotElementEnd)return!0;for(var b=new d(a);;){if(this.offset>=a.length)return!1;if(this.state==e.READ_TYPE){var c=a[this.offset];this.offset+=1,253>c?this.state=e.READ_LENGTH:(this.nBytesToRead=253==c?2:254==c?4:8,this.state=e.READ_TYPE_BYTES)}else if(this.state==e.READ_TYPE_BYTES){var f=a.length-this.offset;if(f<this.nBytesToRead)return this.offset+=f,this.nBytesToRead-=f,!1;this.offset+=this.nBytesToRead,this.state=e.READ_LENGTH}else if(this.state==e.READ_LENGTH){var c=a[this.offset];if(this.offset+=1,253>c){if(this.nBytesToRead=c,0==this.nBytesToRead)return this.gotElementEnd=!0,!0;this.state=e.READ_VALUE_BYTES}else this.nBytesToRead=253==c?2:254==c?4:8,this.firstOctet=c,this.state=e.READ_LENGTH_BYTES}else{if(this.state!=e.READ_LENGTH_BYTES){if(this.state==e.READ_VALUE_BYTES)return f=a.length-this.offset,f<this.nBytesToRead?(this.offset+=f,this.nBytesToRead-=f,!1):(this.offset+=this.nBytesToRead,this.gotElementEnd=!0,!0);throw new Error("findElementEnd: unrecognized state")}var f=a.length-this.offset;if(!this.useHeaderBuffer&&f>=this.nBytesToRead)b.seek(this.offset),this.nBytesToRead=b.readExtendedVarNumber(this.firstOctet),this.offset=b.getOffset();else{this.useHeaderBuffer=!0;var g=this.nBytesToRead-this.headerLength;if(g>f){if(this.headerLength+f>this.headerBuffer.length)throw new Error("Cannot store more header bytes than the size of headerBuffer");return a.slice(this.offset,this.offset+f).copy(this.headerBuffer,this.headerLength),this.offset+=f,this.headerLength+=f,!1}if(this.headerLength+g>this.headerBuffer.length)throw new Error("Cannot store more header bytes than the size of headerBuffer");a.slice(this.offset,this.offset+g).copy(this.headerBuffer,this.headerLength),this.offset+=g;var h=new d(this.headerBuffer);this.nBytesToRead=h.readExtendedVarNumber(this.firstOctet)}if(0==this.nBytesToRead)return this.gotElementEnd=!0,!0;this.state=e.READ_VALUE_BYTES}}},e.prototype.getOffset=function(){return this.offset},e.prototype.seek=function(a){this.offset=a}}).call(this,a("buffer").Buffer)},{"./tlv-decoder.js":157,buffer:11}],160:[function(a,b,c){var d=function(){};c.Tlv=d,d.Interest=5,d.Data=6,d.Name=7,d.NameComponent=8,d.Selectors=9,d.Nonce=10,d.Scope=11,d.InterestLifetime=12,d.MinSuffixComponents=13,d.MaxSuffixComponents=14,d.PublisherPublicKeyLocator=15,d.Exclude=16,d.ChildSelector=17,d.MustBeFresh=18,d.Any=19,d.MetaInfo=20,d.Content=21,d.SignatureInfo=22,d.SignatureValue=23,d.ContentType=24,d.FreshnessPeriod=25,d.FinalBlockId=26,d.SignatureType=27,d.KeyLocator=28,d.KeyLocatorDigest=29,d.FaceInstance=128,d.ForwardingEntry=129,d.StatusResponse=130,d.Action=131,d.FaceID=132,d.IPProto=133,d.Host=134,d.Port=135,d.MulticastInterface=136,d.MulticastTTL=137,d.ForwardingFlags=138,d.StatusCode=139,d.StatusText=140,d.SignatureType_DigestSha256=0,d.SignatureType_SignatureSha256WithRsa=1,d.ContentType_Default=0,d.ContentType_Link=1,d.ContentType_Key=2,d.NfdCommand_ControlResponse=101,d.NfdCommand_StatusCode=102,d.NfdCommand_StatusText=103,d.ControlParameters_ControlParameters=104,d.ControlParameters_FaceId=105,d.ControlParameters_Uri=114,d.ControlParameters_LocalControlFeature=110,d.ControlParameters_Origin=111,d.ControlParameters_Cost=106,d.ControlParameters_Flags=108,d.ControlParameters_Strategy=107,d.ControlParameters_ExpirationPeriod=109},{}],161:[function(a,b,c){var d=function(){};c.WireFormat=d,d.prototype.encodeInterest=function(){throw new Error("encodeInterest is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeInterest=function(){throw new Error("decodeInterest is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeData=function(){throw new Error("encodeData is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeData=function(){throw new Error("decodeData is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeControlParameters=function(){throw new Error("encodeControlParameters is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeControlParameters=function(){throw new Error("decodeControlParameters is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeSignatureInfo=function(){throw new Error("encodeSignatureInfo is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.decodeSignatureInfoAndValue=function(){throw new Error("decodeSignatureInfoAndValue is unimplemented in the base WireFormat class.  You should use a derived class.")},d.prototype.encodeSignatureValue=function(){throw new Error("encodeSignatureValue is unimplemented in the base WireFormat class.  You should use a derived class.")},d.setDefaultWireFormat=function(a){d.defaultWireFormat=a},d.getDefaultWireFormat=function(){return d.defaultWireFormat};a("./tlv-wire-format.js").TlvWireFormat},{"./tlv-wire-format.js":156}],162:[function(a,b,c){var d=a("./name.js").Name,e=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./encoding/data-utils.js").DataUtils),g=a("./util/blob.js").Blob,h=function i(a){if(this.values=[],"object"==typeof a&&a instanceof i)this.values=a.values.slice(0);else if(a){this.changeCount=0;for(var b=0;b<a.length;++b)a[b]==i.ANY?this.appendAny():this.appendComponent(a[b])}this.changeCount=0};c.Exclude=h,h.ANY="*",h.prototype.size=function(){return this.values.length},h.prototype.get=function(a){return this.values[a]},h.prototype.appendAny=function(){return this.values.push(h.ANY),++this.changeCount,this},h.prototype.appendComponent=function(a){return this.values.push(new d.Component(a)),++this.changeCount,this},h.prototype.clear=function(){++this.changeCount,this.values=[]},h.prototype.from_ndnb=function(a){for(a.readElementStartDTag(e.Exclude);;)if(a.peekDTag(e.Component))this.appendComponent(a.readBinaryDTagElement(e.Component));else if(a.peekDTag(e.Any))a.readElementStartDTag(e.Any),a.readElementClose(),this.appendAny();else{if(!a.peekDTag(e.Bloom))break;a.readBinaryDTagElement(e.Bloom),this.appendAny()}a.readElementClose()},h.prototype.to_ndnb=function(a){if(null!=this.values&&0!=this.values.length){a.writeElementStartDTag(e.Exclude);for(var b=0;b<this.values.length;++b)this.values[b]==h.ANY?(a.writeElementStartDTag(e.Any),a.writeElementClose()):a.writeDTagElement(e.Component,this.values[b].getValue().buf());a.writeElementClose()}},h.prototype.toUri=function(){if(null==this.values||0==this.values.length)return"";for(var a="",b=0;b<this.values.length;++b)b>0&&(a+=","),a+=this.values[b]==h.ANY?"*":d.toEscapedString(this.values[b].getValue().buf());return a},h.prototype.matches=function(a){"object"==typeof a&&a instanceof d.Component?a=a.getValue().buf():"object"==typeof a&&a instanceof g&&(a=a.buf());for(var b=0;b<this.values.length;++b)if(this.values[b]==h.ANY){var c=null;b>0&&(c=this.values[b-1]);var e,i=null;for(e=b+1;e<this.values.length;++e)if(this.values[e]!=h.ANY){i=this.values[e];break}if(null!=i){if(null!=c){if(h.compareComponents(a,c)>0&&h.compareComponents(a,i)<0)return!0}else if(h.compareComponents(a,i)<0)return!0;b=e-1}else{if(null==c)return!0;if(h.compareComponents(a,c)>0)return!0}}else if(f.arraysEqual(a,this.values[b].getValue().buf()))return!0;return!1},h.compareComponents=function(a,b){return"object"==typeof a&&a instanceof d.Component&&(a=a.getValue().buf()),"object"==typeof b&&b instanceof d.Component&&(b=b.getValue().buf()),d.Component.compareBuffers(a,b)},h.prototype.getChangeCount=function(){return this.changeCount}},{"./encoding/binary-xml-decoder.js":146,"./encoding/binary-xml-encoder.js":147,"./encoding/data-utils.js":150,"./name.js":172,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199}],163:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,f=function(a,b,c,d,e,f,g,h,i){this.action=a,this.publisherPublicKeyDigest=b,this.faceID=c,this.ipProto=d,this.host=e,this.Port=f,this.multicastInterface=g,this.multicastTTL=h,this.freshnessSeconds=i};c.FaceInstance=f,f.NetworkProtocol={TCP:6,UDP:17},f.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(d.Action)&&(this.action=a.readUTF8DTagElement(d.Action)),a.peekDTag(d.PublisherPublicKeyDigest)&&(this.publisherPublicKeyDigest=new e,this.publisherPublicKeyDigest.from_ndnb(a)),a.peekDTag(d.FaceID)&&(this.faceID=a.readIntegerDTagElement(d.FaceID)),a.peekDTag(d.IPProto)){var b=a.readIntegerDTagElement(d.IPProto);if(this.ipProto=null,f.NetworkProtocol.TCP==b)this.ipProto=f.NetworkProtocol.TCP;else{if(f.NetworkProtocol.UDP!=b)throw new Error("FaceInstance.decoder.  Invalid NDNProtocolDTags.IPProto field: "+b);this.ipProto=f.NetworkProtocol.UDP}}a.peekDTag(d.Host)&&(this.host=a.readUTF8DTagElement(d.Host)),a.peekDTag(d.Port)&&(this.Port=a.readIntegerDTagElement(d.Port)),a.peekDTag(d.MulticastInterface)&&(this.multicastInterface=a.readUTF8DTagElement(d.MulticastInterface)),a.peekDTag(d.MulticastTTL)&&(this.multicastTTL=a.readIntegerDTagElement(d.MulticastTTL)),a.peekDTag(d.FreshnessSeconds)&&(this.freshnessSeconds=a.readIntegerDTagElement(d.FreshnessSeconds)),a.readElementClose()},f.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),null!=this.action&&0!=this.action.length&&a.writeDTagElement(d.Action,this.action),null!=this.publisherPublicKeyDigest&&this.publisherPublicKeyDigest.to_ndnb(a),null!=this.faceID&&a.writeDTagElement(d.FaceID,this.faceID),null!=this.ipProto&&a.writeDTagElement(d.IPProto,this.ipProto),null!=this.host&&0!=this.host.length&&a.writeDTagElement(d.Host,this.host),null!=this.Port&&a.writeDTagElement(d.Port,this.Port),null!=this.multicastInterface&&0!=this.multicastInterface.length&&a.writeDTagElement(d.MulticastInterface,this.multicastInterface),null!=this.multicastTTL&&a.writeDTagElement(d.MulticastTTL,this.multicastTTL),null!=this.freshnessSeconds&&a.writeDTagElement(d.FreshnessSeconds,this.freshnessSeconds),a.writeElementClose()},f.prototype.getElementLabel=function(){return d.FaceInstance}},{"./publisher-public-key-digest.js":174,"./util/ndn-protoco-id-tags.js":199}],164:[function(a,b,c){(function(b){function d(a){for(var b=-1,c=0;c<E.registeredPrefixTable.length;c++)D>3&&console.log("Registered prefix "+c+": checking if "+E.registeredPrefixTable[c].prefix+" matches "+a),E.registeredPrefixTable[c].prefix.match(a)&&(0>b||E.registeredPrefixTable[c].prefix.size()>E.registeredPrefixTable[b].prefix.size())&&(b=c);return b>=0?E.registeredPrefixTable[b]:null}var e=(a("crypto"),a("./encoding/data-utils.js").DataUtils),f=a("./name.js").Name,g=a("./interest.js").Interest,h=a("./data.js").Data,i=a("./meta-info.js").MetaInfo,j=a("./forwarding-entry.js").ForwardingEntry,k=a("./control-parameters.js").ControlParameters,l=a("./encoding/tlv-wire-format.js").TlvWireFormat,m=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat,n=a("./encoding/tlv/tlv.js").Tlv,o=a("./encoding/tlv/tlv-decoder.js").TlvDecoder,p=a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,q=a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,r=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,s=a("./key.js").Key,t=a("./key-locator.js").KeyLocatorType,u=a("./security/key-manager.js").globalKeyManager,v=a("./forwarding-flags.js").ForwardingFlags,w=a("./closure.js").Closure,x=a("./closure.js").UpcallInfo,y=a("./transport/transport.js").Transport,z=a("./transport/tcp-transport.js").TcpTransport,A=a("./transport/unix-transport.js").UnixTransport,B=a("./util/command-interest-generator.js").CommandInterestGenerator,C=a("fs"),D=a("./log.js").Log.LOG,E=function J(a,b){if(!J.supported)throw new Error("The necessary JavaScript support is not available on this platform.");var c;if("object"==typeof a&&a instanceof y){if(this.getConnectionInfo=null,this.transport=a,this.connectionInfo=b||null,c={},null==this.connectionInfo&&this.transport&&this.transport.__proto__&&"UnixTransport"==this.transport.__proto__.name){var d=J.getUnixSocketFilePathForLocalhost();null!=d?this.connectionInfo=new A.ConnectionInfo(d):console.log("Face constructor: Cannot determine the default Unix socket file path for UnixTransport"),console.log("Using "+this.connectionInfo.toString())}}else{c=a||{};var e=c.getTransport||function(){return new z};if(this.transport=e(),this.getConnectionInfo=c.getConnectionInfo||this.transport.defaultGetConnectionInfo,this.connectionInfo=c.connectionInfo||null,null==this.connectionInfo){var g=void 0!==c.host?c.host:null;if(this.transport&&this.transport.__proto__&&"UnixTransport"==this.transport.__proto__.name){if(null!=g)this.connectionInfo=new A.ConnectionInfo(g);else if(null==this.getConnectionInfo){var d=J.getUnixSocketFilePathForLocalhost();null!=d?this.connectionInfo=new A.ConnectionInfo(d):console.log("Face constructor: Cannot determine the default Unix socket file path for UnixTransport")}}else null!=g&&(this.connectionInfo="undefined"!=typeof WebSocketTransport?new WebSocketTransport.ConnectionInfo(g,c.port||9696):new z.ConnectionInfo(g,c.port||6363))}}null==this.connectionInfo?(this.host=null,this.host=null):(this.host=this.connectionInfo.host,this.host=this.connectionInfo.port),this.readyStatus=J.UNOPEN,this.verify=void 0!==c.verify?c.verify:!1,this.onopen=c.onopen||function(){D>3&&console.log("Face connection established.")},this.onclose=c.onclose||function(){D>3&&console.log("Face connection closed.")},this.ndndid=null,this.onConnectedCallbacks=[],this.commandKeyChain=null,this.commandCertificateName=new f,this.commandInterestGenerator=new B};c.Face=E,E.UNOPEN=0,E.OPEN_REQUESTED=1,E.OPENED=2,E.CLOSED=3,E.getUnixSocketFilePathForLocalhost=function(){var a="/var/run/nfd.sock";return C.existsSync(a)?a:(a="/tmp/.ndnd.sock",C.existsSync(a)?a:"")},E.getSupported=function(){try{{new b(1).slice(0,1)}}catch(a){return console.log("NDN not available: Buffer not supported. "+a),!1}return!0},E.supported=E.getSupported(),E.ndndIdFetcher=new f("/%C1.M.S.localhost/%C1.M.SRV/ndnd/KEY"),E.prototype.createRoute=function(a,b){this.connectionInfo=a instanceof y.ConnectionInfo?a:new z.ConnectionInfo(a,b),this.host=this.connectionInfo.host,this.host=this.connectionInfo.port},E.KeyStore=new Array;var F=function(a,b,c){this.keyName=a,this.rsaKey=b,this.timeStamp=c};E.addKeyEntry=function(a){var b=E.getKeyByName(a.keyName);null==b?E.KeyStore.push(a):b=a},E.getKeyByName=function(a){for(var b=null,c=0;c<E.KeyStore.length;c++)E.KeyStore[c].keyName.contentName.match(a.contentName)&&(null==b||E.KeyStore[c].keyName.contentName.size()>b.keyName.contentName.size())&&(b=E.KeyStore[c]);return b},E.prototype.close=function(){this.readyStatus==E.OPENED&&(this.readyStatus=E.CLOSED,this.transport.close())},E.PITTable=new Array,E.PITTableRemoveRequests=new Array;var G=function(a,b,c){this.pendingInterestId=a,this.interest=b,this.closure=c,this.timerID=-1};G.lastPendingInterestId=0,G.getNextPendingInterestId=function(){return++G.lastPendingInterestId,G.lastPendingInterestId},E.extractEntriesForExpressedInterest=function(a){for(var b=[],c=E.PITTable.length-1;c>=0;--c){var d=E.PITTable[c];d.interest.matchesName(a)&&(clearTimeout(d.timerID),b.push(d),E.PITTable.splice(c,1))}return b},E.registeredPrefixTable=new Array,E.registeredPrefixRemoveRequests=new Array;var H=function(a,b,c){this.registeredPrefixId=a,this.prefix=b,this.closure=c};H.lastRegisteredPrefixId=0,H.getNextRegisteredPrefixId=function(){return++H.lastRegisteredPrefixId,H.lastRegisteredPrefixId},E.makeShuffledHostGetConnectionInfo=function(a,b,c){return a=a.slice(0,a.length),e.shuffle(a),function(){return 0==a.length?null:c(a.splice(0,1)[0],b)}},E.prototype.expressInterest=function(a,b,c,d){if(b&&b.upcall&&"function"==typeof b.upcall){if(f=new g(a),c){var e=c;f.setMinSuffixComponents(e.getMinSuffixComponents()),f.setMaxSuffixComponents(e.getMaxSuffixComponents()),f.publisherPublicKeyDigest=e.publisherPublicKeyDigest,f.setExclude(e.getExclude()),f.setChildSelector(e.getChildSelector()),f.getAnswerOriginKind(e.getAnswerOriginKind()),f.setScope(e.getScope()),f.setInterestLifetimeMilliseconds(e.getInterestLifetimeMilliseconds())}else f.setInterestLifetimeMilliseconds(4e3);return this.expressInterestWithClosure(f,b)}var f,h,i;if("object"==typeof a&&a instanceof g)f=new g(a),h=b,i=c?c:function(){};else if(f=new g(a),b&&"object"==typeof b&&b instanceof g){var e=b;f.setMinSuffixComponents(e.getMinSuffixComponents()),f.setMaxSuffixComponents(e.getMaxSuffixComponents()),f.publisherPublicKeyDigest=e.publisherPublicKeyDigest,f.setExclude(e.getExclude()),f.setChildSelector(e.getChildSelector()),f.getAnswerOriginKind(e.getAnswerOriginKind()),f.setScope(e.getScope()),f.setInterestLifetimeMilliseconds(e.getInterestLifetimeMilliseconds()),h=c,i=d?d:function(){}}else f.setInterestLifetimeMilliseconds(4e3),h=b,i=c?c:function(){};return this.expressInterestWithClosure(f,new E.CallbackClosure(h,i))},E.CallbackClosure=function(a,b,c,d,e){w.call(this),this.onData=a,this.onTimeout=b,this.onInterest=c,this.prefix=d,this.transport=e},E.CallbackClosure.prototype.upcall=function(a,b){return a==w.UPCALL_CONTENT||a==w.UPCALL_CONTENT_UNVERIFIED?this.onData(b.interest,b.data):a==w.UPCALL_INTEREST_TIMED_OUT?this.onTimeout(b.interest):a==w.UPCALL_INTEREST&&this.onInterest(this.prefix,b.interest,this.transport),w.RESULT_OK},E.prototype.expressInterestWithClosure=function(a,b){var c=G.getNextPendingInterestId();if(null==this.connectionInfo)if(null==this.getConnectionInfo)console.log("ERROR: connectionInfo is NOT SET");else{var d=this;this.connectAndExecute(function(){d.reconnectAndExpressInterest(c,a,b)})}else this.reconnectAndExpressInterest(c,a,b);return c},E.prototype.reconnectAndExpressInterest=function(a,b,c){var d=this;if(this.connectionInfo.equals(this.transport.connectionInfo)&&this.readyStatus!==E.UNOPEN)if(this.readyStatus===E.OPEN_REQUESTED)this.onConnectedCallbacks.push(function(){d.expressInterestHelper(a,b,c)});else{if(this.readyStatus!==E.OPENED)throw new Error("reconnectAndExpressInterest: unexpected connection is not opened");this.expressInterestHelper(a,b,c)}else this.readyStatus=E.OPEN_REQUESTED,this.onConnectedCallbacks.push(function(){d.expressInterestHelper(a,b,c)}),this.transport.connect(this.connectionInfo,this,function(){for(d.readyStatus=E.OPENED;d.onConnectedCallbacks.length>0;)try{d.onConnectedCallbacks.shift()()}catch(a){console.log("Face.reconnectAndExpressInterest: ignoring exception from onConnectedCallbacks: "+a)}d.onopen&&d.onopen()},function(){d.closeByTransport()})},E.prototype.expressInterestHelper=function(a,b,c){var d=b.wireEncode(),e=this;if(null!=c){var f=-1;if(null!=f&&(f=E.PITTableRemoveRequests.indexOf(a)),f>=0)E.PITTableRemoveRequests.splice(f,1);else{var g=new G(a,b,c);E.PITTable.push(g),c.pitEntry=g;var h=b.getInterestLifetimeMilliseconds()||4e3,i=function(){D>1&&console.log("Interest time out: "+b.getName().toUri());var a=E.PITTable.indexOf(g);a>=0&&E.PITTable.splice(a,1),c.upcall(w.UPCALL_INTEREST_TIMED_OUT,new x(e,b,0,null))==w.RESULT_REEXPRESS&&(D>1&&console.log("Re-express interest: "+b.getName().toUri()),g.timerID=setTimeout(i,h),E.PITTable.push(g),e.transport.send(d.buf()))};g.timerID=setTimeout(i,h)}}this.transport.send(d.buf())},E.prototype.removePendingInterest=function(a){if(null!=a){for(var b=0,c=E.PITTable.length-1;c>=0;--c){var d=E.PITTable[c];d.pendingInterestId==a&&(clearTimeout(d.timerID),E.PITTable.splice(c,1),++b)}0==b&&E.PITTableRemoveRequests.indexOf(a)<0&&E.PITTableRemoveRequests.push(a)
}},E.prototype.setCommandSigningInfo=function(a,b){this.commandKeyChain=a,this.commandCertificateName=new f(b)},E.prototype.setCommandCertificateName=function(a){this.commandCertificateName=new f(a)},E.prototype.makeCommandInterest=function(a,b){b=b||WireFormat.getDefaultWireFormat(),this.nodeMakeCommandInterest(a,this.commandKeyChain,this.commandCertificateName,b)},E.prototype.nodeMakeCommandInterest=function(a,b,c,d){this.commandInterestGenerator.generate(a,b,c,d)},E.prototype.registerPrefix=function(a,b,c,d){if(b&&b.upcall&&"function"==typeof b.upcall){if(c){var e;return"number"==typeof e?(e=new v,e.setForwardingEntryFlags(c)):e=c,this.registerPrefixWithClosure(a,b,e)}return this.registerPrefixWithClosure(a,b,new v)}var f=b,g=c?c:function(){},e=d?d:new v;return this.registerPrefixWithClosure(a,new E.CallbackClosure(null,null,f,a,this.transport),e,g)},E.prototype.registerPrefixWithClosure=function(a,b,c,d){var e=H.getNextRegisteredPrefixId(),f=this,h=function(){if(null!=f.ndndid||null==f.commandKeyChain)if(null==f.ndndid){var h=new g(E.ndndIdFetcher);h.setInterestLifetimeMilliseconds(4e3),D>3&&console.log("Expressing interest for ndndid from ndnd."),f.reconnectAndExpressInterest(null,h,new E.FetchNdndidClosure(f,e,a,b,c,d))}else f.registerPrefixHelper(e,a,b,c,d);else f.nfdRegisterPrefix(e,a,b,c,d,f.commandKeyChain,f.commandCertificateName)};return null==this.connectionInfo?null==this.getConnectionInfo?console.log("ERROR: connectionInfo is NOT SET"):this.connectAndExecute(h):h(),e},E.FetchNdndidClosure=function(a,b,c,d,e,f){w.call(this),this.face=a,this.registeredPrefixId=b,this.prefix=c,this.callerClosure=d,this.flags=e,this.onRegisterFailed=f},E.FetchNdndidClosure.prototype.upcall=function(c,d){if(c==w.UPCALL_INTEREST_TIMED_OUT)return console.log("Timeout while requesting the ndndid.  Cannot registerPrefix for "+this.prefix.toUri()+" ."),this.onRegisterFailed&&this.onRegisterFailed(this.prefix),w.RESULT_OK;if(c!=w.UPCALL_CONTENT&&c!=w.UPCALL_CONTENT_UNVERIFIED)return w.RESULT_ERR;D>3&&console.log("Got ndndid from ndnd.");var f=a("crypto").createHash("sha256");return f.update(d.data.getContent().buf()),this.face.ndndid=new b(e.toNumbersIfString(f.digest())),D>3&&console.log(this.face.ndndid),this.face.registerPrefixHelper(this.registeredPrefixId,this.prefix,this.callerClosure,this.flags,this.onRegisterFailed),w.RESULT_OK},E.RegisterResponseClosure=function(a,b,c,d,e,f,g){w.call(this),this.face=a,this.prefix=b,this.callerClosure=c,this.onRegisterFailed=d,this.flags=e,this.wireFormat=f,this.isNfdCommand=g},E.RegisterResponseClosure.prototype.upcall=function(a,b){if(a==w.UPCALL_INTEREST_TIMED_OUT){if(this.isNfdCommand)if(null==this.face.ndndid){var c=new g(E.ndndIdFetcher);c.setInterestLifetimeMilliseconds(4e3),this.face.reconnectAndExpressInterest(null,c,new E.FetchNdndidClosure(this.face,0,this.prefix,this.closure,this.flags,this.onRegisterFailed))}else this.face.registerPrefixHelper(0,this.prefix,this.closure,this.flags,this.onRegisterFailed);else this.onRegisterFailed&&this.onRegisterFailed(this.prefix);return w.RESULT_OK}if(a!=w.UPCALL_CONTENT&&a!=w.UPCALL_CONTENT_UNVERIFIED)return w.RESULT_ERR;if(this.isNfdCommand){var d;try{var e=new o(b.data.getContent().buf());e.readNestedTlvsStart(n.NfdCommand_ControlResponse),d=e.readNonNegativeIntegerTlv(n.NfdCommand_StatusCode)}catch(h){return this.onRegisterFailed&&this.onRegisterFailed(this.prefix),w.RESULT_OK}200!=d&&this.onRegisterFailed&&this.onRegisterFailed(this.prefix)}else{var i=new f("/ndnx/.../selfreg");if(b.data.getName().size()<4||!b.data.getName().get(0).equals(i.get(0))||!b.data.getName().get(2).equals(i.get(2)))return this.onRegisterFailed(this.prefix),w.RESULT_OK}return w.RESULT_OK},E.prototype.registerPrefixHelper=function(a,b,c,d,e){var k=-1;if(null!=k&&(k=E.registeredPrefixRemoveRequests.indexOf(a)),k>=0)return void E.registeredPrefixRemoveRequests.splice(k,1);var l=new j("selfreg",b,null,null,d.getForwardingEntryFlags(),null),n=new q;l.to_ndnb(n);var o=n.getReducedOstream(),p=new i;p.setFields(),p.locator.setType(t.KEY),p.locator.setKeyData(u.getKey().publicToDER());var r=new h(new f,p,o);r.sign(m.get());var s=r.wireEncode(m.get()),v=this.ndndid,w=new f(["ndnx",v,"selfreg",s]),x=new g(w);x.setInterestLifetimeMilliseconds(4e3),x.setScope(1),D>3&&console.log("Send Interest registration packet."),0!=a&&E.registeredPrefixTable.push(new H(a,b,c)),this.reconnectAndExpressInterest(null,x,new E.RegisterResponseClosure(this,b,c,e,d,m.get(),!1))},E.prototype.nfdRegisterPrefix=function(a,b,c,d,e,h,i){var j=-1;if(null!=j&&(j=E.registeredPrefixRemoveRequests.indexOf(a)),j>=0)return void E.registeredPrefixRemoveRequests.splice(j,1);if(null==h)throw new Error("registerPrefix: The command KeyChain has not been set. You must call setCommandSigningInfo.");if(0==i.size())throw new Error("registerPrefix: The command certificate name has not been set. You must call setCommandSigningInfo.");var m=new k;m.setName(b);var n=new g(new f("/localhost/nfd/rib/register"));n.getName().append(m.wireEncode(l.get())),this.nodeMakeCommandInterest(n,h,i,l.get()),n.setInterestLifetimeMilliseconds(2e3),0!=a&&E.registeredPrefixTable.push(new H(a,b,c)),this.reconnectAndExpressInterest(null,n,new E.RegisterResponseClosure(this,b,c,e,d,l.get(),!0))},E.prototype.removeRegisteredPrefix=function(a){for(var b=0,c=E.registeredPrefixTable.length-1;c>=0;--c){var d=E.registeredPrefixTable[c];d.registeredPrefixId==a&&(E.registeredPrefixTable.splice(c,1),++b)}0==b&&E.registeredPrefixRemoveRequests.indexOf(a)<0&&E.registeredPrefixRemoveRequests.push(a)},E.prototype.onReceivedElement=function(a){D>3&&console.log("Complete element received. Length "+a.length+". Start decoding.");var b=null,c=null;if(a[0]==n.Interest||a[0]==n.Data){var e=new o(a);e.peekType(n.Interest,a.length)?(b=new g,b.wireDecode(a,l.get())):e.peekType(n.Data,a.length)&&(c=new h,c.wireDecode(a,l.get()))}else{var e=new p(a);e.peekDTag(r.Interest)?(b=new g,b.wireDecode(a,m.get())):e.peekDTag(r.Data)&&(c=new h,c.wireDecode(a,m.get()))}if(null!==b){D>3&&console.log("Interest packet received.");var f=d(b.getName());if(null!=f){D>3&&console.log("Found registered prefix for "+b.getName().toUri());var i=new x(this,b,0,null),j=f.closure.upcall(w.UPCALL_INTEREST,i);j==w.RESULT_INTEREST_CONSUMED&&null!=i.data&&this.transport.send(i.data.wireEncode().buf())}}else if(null!==c){D>3&&console.log("Data packet received.");for(var k=E.extractEntriesForExpressedInterest(c.getName()),q=0;q<k.length;++q){var u=k[q],v=u.closure;if(0!=this.verify){var y=function(a,b,c){this.data=a,this.closure=b,this.keyName=c,w.call(this)},z=this;if(y.prototype.upcall=function(a,b){if(a==w.UPCALL_INTEREST_TIMED_OUT)console.log("In KeyFetchClosure.upcall: interest time out."),console.log(this.keyName.contentName.toUri());else if(a==w.UPCALL_CONTENT){var d=new s;d.readDerPublicKey(b.data.getContent().buf());var e=c.verify(d),f=1==e?w.UPCALL_CONTENT:w.UPCALL_CONTENT_BAD;this.closure.upcall(f,new x(z,null,0,this.data));var g=new F(C.keyName,d,(new Date).getTime());E.addKeyEntry(g)}else a==w.UPCALL_CONTENT_BAD&&console.log("In KeyFetchClosure.upcall: signature verification failed")},c.getMetaInfo()&&c.getMetaInfo().locator&&c.getSignature()){D>3&&console.log("Key verification...");var A=c.getSignature().getSignature().toHex(),B=null;null!=c.getSignature().witness&&v.upcall(w.UPCALL_CONTENT_BAD,new x(this,u.interest,0,c));var C=c.getMetaInfo().locator;if(C.getType()==t.KEYNAME)if(D>3&&console.log("KeyLocator contains KEYNAME"),C.keyName.contentName.match(c.getName())){D>3&&console.log("Content is key itself");var G=new s;G.readDerPublicKey(c.getContent().buf());var H=c.verify(G),I=1==H?w.UPCALL_CONTENT:w.UPCALL_CONTENT_BAD;v.upcall(I,new x(this,u.interest,0,c))}else{var J=E.getKeyByName(C.keyName);if(J){D>3&&console.log("Local key cache hit");var G=J.rsaKey,H=c.verify(G),I=1==H?w.UPCALL_CONTENT:w.UPCALL_CONTENT_BAD;v.upcall(I,new x(this,u.interest,0,c))}else{D>3&&console.log("Fetch key according to keylocator");var K=new y(c,v,C.keyName,A,B);this.expressInterest(C.keyName.contentName.getPrefix(4),K)}}else if(C.getType()==t.KEY){D>3&&console.log("Keylocator contains KEY");var G=new s;G.readDerPublicKey(C.publicKey);var H=c.verify(G),I=1==H?w.UPCALL_CONTENT:w.UPCALL_CONTENT_BAD;v.upcall(w.UPCALL_CONTENT,new x(this,u.interest,0,c))}else{var L=C.certificate;console.log("KeyLocator contains CERT"),console.log(L)}}}else v.upcall(w.UPCALL_CONTENT_UNVERIFIED,new x(this,u.interest,0,c))}}},E.prototype.connectAndExecute=function(a){var b=this.getConnectionInfo();if(null==b)return console.log("ERROR: No more connectionInfo from getConnectionInfo"),this.connectionInfo=null,this.host=null,void(this.host=null);if(b.equals(this.connectionInfo))return void console.log("ERROR: The host returned by getConnectionInfo is not alive: "+this.connectionInfo.toString());this.connectionInfo=b,D>0&&console.log("connectAndExecute: trying host from getConnectionInfo: "+this.connectionInfo.toString()),this.host=this.connectionInfo.host,this.host=this.connectionInfo.port;var c=new g(new f("/"));c.setInterestLifetimeMilliseconds(4e3);var d=this,e=setTimeout(function(){D>0&&console.log("connectAndExecute: timeout waiting for host "+d.host),d.connectAndExecute(a)},3e3);this.reconnectAndExpressInterest(null,c,new E.ConnectClosure(this,a,e))},E.prototype.closeByTransport=function(){this.readyStatus=E.CLOSED,this.onclose()},E.ConnectClosure=function(a,b,c){w.call(this),this.face=a,this.onConnected=b,this.timerID=c},E.ConnectClosure.prototype.upcall=function(a){return a!=w.UPCALL_CONTENT&&a!=w.UPCALL_CONTENT_UNVERIFIED?w.RESULT_ERR:(clearTimeout(this.timerID),D>0&&console.log("connectAndExecute: connected to host "+this.face.host),this.onConnected(),w.RESULT_OK)};var I=function(a){E.call(this,a)};I.prototype=new E({getTransport:function(){},getConnectionInfo:function(){}}),c.NDN=I,I.supported=E.supported,I.UNOPEN=E.UNOPEN,I.OPEN_REQUESTED=E.OPEN_REQUESTED,I.OPENED=E.OPENED,I.CLOSED=E.CLOSED}).call(this,a("buffer").Buffer)},{"./closure.js":143,"./control-parameters.js":144,"./data.js":145,"./encoding/binary-xml-decoder.js":146,"./encoding/binary-xml-encoder.js":147,"./encoding/binary-xml-wire-format.js":149,"./encoding/data-utils.js":150,"./encoding/tlv-wire-format.js":156,"./encoding/tlv/tlv-decoder.js":157,"./encoding/tlv/tlv.js":160,"./forwarding-entry.js":165,"./forwarding-flags.js":166,"./interest.js":167,"./key-locator.js":168,"./key.js":169,"./log.js":170,"./meta-info.js":171,"./name.js":172,"./security/key-manager.js":183,"./transport/tcp-transport.js":141,"./transport/transport.js":191,"./transport/unix-transport.js":192,"./util/command-interest-generator.js":195,"./util/ndn-protoco-id-tags.js":199,buffer:11,crypto:18,fs:10}],165:[function(a,b,c){var d=(a("./forwarding-flags.js").ForwardingFlags,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),e=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,f=a("./name.js").Name,g=function(a,b,c,d,e,f){this.action=a,this.prefixName=b,this.ndndID=c,this.faceID=d,this.flags=e,this.lifetime=f};c.ForwardingEntry=g,g.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),a.peekDTag(d.Action)&&(this.action=a.readUTF8DTagElement(d.Action)),a.peekDTag(d.Name)&&(this.prefixName=new f,this.prefixName.from_ndnb(a)),a.peekDTag(d.PublisherPublicKeyDigest)&&(this.NdndId=new e,this.NdndId.from_ndnb(a)),a.peekDTag(d.FaceID)&&(this.faceID=a.readIntegerDTagElement(d.FaceID)),a.peekDTag(d.ForwardingFlags)&&(this.flags=a.readIntegerDTagElement(d.ForwardingFlags)),a.peekDTag(d.FreshnessSeconds)&&(this.lifetime=a.readIntegerDTagElement(d.FreshnessSeconds)),a.readElementClose()},g.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),null!=this.action&&0!=this.action.length&&a.writeDTagElement(d.Action,this.action),null!=this.prefixName&&this.prefixName.to_ndnb(a),null!=this.NdndId&&this.NdndId.to_ndnb(a),null!=this.faceID&&a.writeDTagElement(d.FaceID,this.faceID),null!=this.flags&&a.writeDTagElement(d.ForwardingFlags,this.flags),null!=this.lifetime&&a.writeDTagElement(d.FreshnessSeconds,this.lifetime),a.writeElementClose()},g.prototype.getElementLabel=function(){return d.ForwardingEntry}},{"./forwarding-flags.js":166,"./name.js":172,"./publisher-public-key-digest.js":174,"./util/ndn-protoco-id-tags.js":199}],166:[function(a,b,c){var d=function(){this.active=!0,this.childInherit=!0,this.advertise=!1,this.last=!1,this.capture=!1,this.local=!1,this.tap=!1,this.captureOk=!1};c.ForwardingFlags=d,d.ForwardingEntryFlags_ACTIVE=1,d.ForwardingEntryFlags_CHILD_INHERIT=2,d.ForwardingEntryFlags_ADVERTISE=4,d.ForwardingEntryFlags_LAST=8,d.ForwardingEntryFlags_CAPTURE=16,d.ForwardingEntryFlags_LOCAL=32,d.ForwardingEntryFlags_TAP=64,d.ForwardingEntryFlags_CAPTURE_OK=128,d.NfdForwardingFlags_CHILD_INHERIT=1,d.NfdForwardingFlags_CAPTURE=2,d.prototype.getForwardingEntryFlags=function(){var a=0;return this.active&&(a|=d.ForwardingEntryFlags_ACTIVE),this.childInherit&&(a|=d.ForwardingEntryFlags_CHILD_INHERIT),this.advertise&&(a|=d.ForwardingEntryFlags_ADVERTISE),this.last&&(a|=d.ForwardingEntryFlags_LAST),this.capture&&(a|=d.ForwardingEntryFlags_CAPTURE),this.local&&(a|=d.ForwardingEntryFlags_LOCAL),this.tap&&(a|=d.ForwardingEntryFlags_TAP),this.captureOk&&(a|=d.ForwardingEntryFlags_CAPTURE_OK),a},d.prototype.setForwardingEntryFlags=function(a){this.active=0!=(a&d.ForwardingEntryFlags_ACTIVE),this.childInherit=0!=(a&d.ForwardingEntryFlags_CHILD_INHERIT),this.advertise=0!=(a&d.ForwardingEntryFlags_ADVERTISE),this.last=0!=(a&d.ForwardingEntryFlags_LAST),this.capture=0!=(a&d.ForwardingEntryFlags_CAPTURE),this.local=0!=(a&d.ForwardingEntryFlags_LOCAL),this.tap=0!=(a&d.ForwardingEntryFlags_TAP),this.captureOk=0!=(a&d.ForwardingEntryFlags_CAPTURE_OK)},d.prototype.getNfdForwardingFlags=function(){var a=0;return this.childInherit&&(a|=d.NfdForwardingFlags_CHILD_INHERIT),this.capture&&(a|=d.NfdForwardingFlags_CAPTURE),a},d.prototype.setNfdForwardingFlags=function(a){this.childInherit=0!=(a&d.NfdForwardingFlags_CHILD_INHERIT),this.capture=0!=(a&d.NfdForwardingFlags_CAPTURE)},d.prototype.getActive=function(){return this.active},d.prototype.getChildInherit=function(){return this.childInherit},d.prototype.getAdvertise=function(){return this.advertise},d.prototype.getLast=function(){return this.last},d.prototype.getCapture=function(){return this.capture},d.prototype.getLocal=function(){return this.local},d.prototype.getTap=function(){return this.tap},d.prototype.getCaptureOk=function(){return this.captureOk},d.prototype.setActive=function(a){this.active=a},d.prototype.setChildInherit=function(a){this.childInherit=a},d.prototype.setAdvertise=function(a){this.advertise=a},d.prototype.setLast=function(a){this.last=a},d.prototype.setCapture=function(a){this.capture=a},d.prototype.setLocal=function(a){this.local=a},d.prototype.setTap=function(a){this.tap=a},d.prototype.setCaptureOk=function(a){this.captureOk=a}},{}],167:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./name.js").Name,f=a("./exclude.js").Exclude,g=(a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,a("./key-locator.js").KeyLocator),h=a("./encoding/wire-format.js").WireFormat,i=function k(a,c,d,h,i,j,l,m,n,o){if("object"==typeof a&&a instanceof k){var p=a;p.name&&(this.name=new e(p.name)),this.maxSuffixComponents=p.maxSuffixComponents,this.minSuffixComponents=p.minSuffixComponents,this.publisherPublicKeyDigest=p.publisherPublicKeyDigest,this.keyLocator=new g(p.keyLocator),this.exclude=new f(p.exclude),this.childSelector=p.childSelector,this.answerOriginKind=p.answerOriginKind,this.scope=p.scope,this.interestLifetime=p.interestLifetime,p.nonce&&(this.nonce=new b(p.nonce))}else this.name="object"==typeof a&&a instanceof e?new e(a):new e,this.maxSuffixComponents=d,this.minSuffixComponents=c,this.publisherPublicKeyDigest=h,this.keyLocator=new g,this.exclude="object"==typeof i&&i instanceof f?new f(i):new f,this.childSelector=j,this.answerOriginKind=l,this.scope=m,this.interestLifetime=n,o&&(this.nonce=new b(o))};c.Interest=i,i.RECURSIVE_POSTFIX="*",i.CHILD_SELECTOR_LEFT=0,i.CHILD_SELECTOR_RIGHT=1,i.ANSWER_NO_CONTENT_STORE=0,i.ANSWER_CONTENT_STORE=1,i.ANSWER_GENERATED=2,i.ANSWER_STALE=4,i.MARK_STALE=16,i.DEFAULT_ANSWER_ORIGIN_KIND=i.ANSWER_CONTENT_STORE|i.ANSWER_GENERATED,i.prototype.matchesName=function(a){return this.name.match(a)&&(null==this.minSuffixComponents||a.size()+1-this.name.size()>=this.minSuffixComponents)&&(null==this.maxSuffixComponents||a.size()+1-this.name.size()<=this.maxSuffixComponents)?null!=this.exclude&&a.size()>this.name.size()&&this.exclude.matches(a.get(this.name.size()))?!1:!0:!1},i.prototype.matches_name=function(a){return this.matchesName(a)},i.prototype.clone=function(){return new i(this.name,this.minSuffixComponents,this.maxSuffixComponents,this.publisherPublicKeyDigest,this.exclude,this.childSelector,this.answerOriginKind,this.scope,this.interestLifetime,this.nonce)},i.prototype.getName=function(){return this.name},i.prototype.getMinSuffixComponents=function(){return this.minSuffixComponents},i.prototype.getMaxSuffixComponents=function(){return this.maxSuffixComponents},i.prototype.getKeyLocator=function(){return this.keyLocator},i.prototype.getExclude=function(){return this.exclude},i.prototype.getChildSelector=function(){return this.childSelector},i.prototype.getAnswerOriginKind=function(){return this.answerOriginKind},i.prototype.getMustBeFresh=function(){return null==this.answerOriginKind||this.answerOriginKind<0?!0:0==(this.answerOriginKind&i.ANSWER_STALE)},i.prototype.getNonce=function(){return new d(this.nonce,!1)},i.prototype.getNonceAsBuffer=function(){return this.nonce},i.prototype.getScope=function(){return this.scope},i.prototype.getInterestLifetimeMilliseconds=function(){return this.interestLifetime},i.prototype.setName=function(a){this.nonce=null,this.name="object"==typeof a&&a instanceof e?new e(a):new e},i.prototype.setMinSuffixComponents=function(a){this.nonce=null,this.minSuffixComponents=a},i.prototype.setMaxSuffixComponents=function(a){this.nonce=null,this.maxSuffixComponents=a},i.prototype.setExclude=function(a){this.nonce=null,this.exclude="object"==typeof a&&a instanceof f?new f(a):new f},i.prototype.setChildSelector=function(a){this.nonce=null,this.childSelector=a},i.prototype.setAnswerOriginKind=function(a){this.nonce=null,this.answerOriginKind=a},i.prototype.setMustBeFresh=function(a){this.nonce=null,null==this.answerOriginKind||this.answerOriginKind<0?a||(this.answerOriginKind=i.ANSWER_STALE):a?this.answerOriginKind&=~i.ANSWER_STALE:this.answerOriginKind|=i.ANSWER_STALE},i.prototype.setScope=function(a){this.nonce=null,this.scope=a},i.prototype.setInterestLifetimeMilliseconds=function(a){this.nonce=null,this.interestLifetime=a},i.prototype.setNonce=function(a){this.nonce=a?"object"==typeof a&&a instanceof d?a.buf():new b(a):null},i.prototype.toUri=function(){var a="";null!=this.minSuffixComponents&&(a+="&ndn.MinSuffixComponents="+this.minSuffixComponents),null!=this.maxSuffixComponents&&(a+="&ndn.MaxSuffixComponents="+this.maxSuffixComponents),null!=this.childSelector&&(a+="&ndn.ChildSelector="+this.childSelector),null!=this.answerOriginKind&&(a+="&ndn.AnswerOriginKind="+this.answerOriginKind),null!=this.scope&&(a+="&ndn.Scope="+this.scope),null!=this.interestLifetime&&(a+="&ndn.InterestLifetime="+this.interestLifetime),null!=this.publisherPublicKeyDigest&&(a+="&ndn.PublisherPublicKeyDigest="+e.toEscapedString(this.publisherPublicKeyDigest.publisherPublicKeyDigest)),null!=this.nonce&&(a+="&ndn.Nonce="+e.toEscapedString(this.nonce)),null!=this.exclude&&this.exclude.size()>0&&(a+="&ndn.Exclude="+this.exclude.toUri());var b=this.name.toUri();return""!=a&&(b+="?"+a.substr(1)),b},i.prototype.wireEncode=function(a){a=a||h.getDefaultWireFormat();var b=a.encodeInterest(this);return b.encoding},i.prototype.wireDecode=function(a,b){b=b||h.getDefaultWireFormat();var c="object"==typeof a&&a instanceof d?a.buf():a;b.decodeInterest(this,c)};var j=a("./encoding/binary-xml-wire-format.js").BinaryXmlWireFormat;i.prototype.from_ndnb=function(a){j.decodeInterest(this,a)},i.prototype.to_ndnb=function(a){j.encodeInterest(this,a)},i.prototype.encode=function(){return this.wireEncode(j.get()).buf()},i.prototype.decode=function(a){this.wireDecode(a,j.get())}}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-wire-format.js":149,"./encoding/wire-format.js":161,"./exclude.js":162,"./key-locator.js":168,"./name.js":172,"./publisher-public-key-digest.js":174,"./util/blob.js":194,buffer:11}],168:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./name.js").Name,f=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,g=a("./publisher-id.js").PublisherID,h=a("./log.js").Log.LOG,i={KEYNAME:1,KEY_LOCATOR_DIGEST:2,KEY:3,CERTIFICATE:4};c.KeyLocatorType=i;var j=function l(a,c){"object"==typeof a&&a instanceof l?(this.type=a.type,this.keyName=new k,null!=a.keyName&&(this.keyName.contentName=null==a.keyName.contentName?null:new e(a.keyName.contentName),this.keyName.publisherID=a.keyName.publisherID),this.keyData=null==a.keyData?null:new b(a.keyData),this.publicKey=null==a.publicKey?null:new b(a.publicKey),this.certificate=null==a.certificate?null:new b(a.certificate)):(this.type=c,this.keyName=new k,c==i.KEYNAME?this.keyName=a:c==i.KEY_LOCATOR_DIGEST?this.keyData=new b(a):c==i.KEY?(this.keyData=new b(a),this.publicKey=this.keyData):c==i.CERTIFICATE&&(this.keyData=new b(a),this.certificate=this.keyData))};c.KeyLocator=j,j.prototype.getType=function(){return this.type},j.prototype.getKeyName=function(){return null==this.keyName&&(this.keyName=new k),null==this.keyName.contentName&&(this.keyName.contentName=new e),this.keyName.contentName},j.prototype.getKeyData=function(){return new d(this.getKeyDataAsBuffer(),!1)},j.prototype.getKeyDataAsBuffer=function(){return this.type==i.KEY?this.publicKey:this.type==i.CERTIFICATE?this.certificate:this.keyData},j.prototype.setType=function(a){this.type=a},j.prototype.setKeyName=function(a){null==this.keyName&&(this.keyName=new k),this.keyName.contentName="object"==typeof a&&a instanceof e?new e(a):new e},j.prototype.setKeyData=function(a){var c=a;null!=c&&(c=new b("object"==typeof c&&c instanceof d?c.buf():c)),this.keyData=c,this.publicKey=c,this.certificate=c},j.prototype.clear=function(){this.type=null,this.keyName=null,this.keyData=null,this.publicKey=null,this.certificate=null},j.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(f.Key)){try{var b=a.readBinaryDTagElement(f.Key);this.publicKey=b,this.type=i.KEY,h>4&&console.log("PUBLIC KEY FOUND: "+this.publicKey)}catch(c){throw new Error("Cannot parse key: ",c)}if(null==this.publicKey)throw new Error("Cannot parse key: ")}else if(a.peekDTag(f.Certificate)){try{var d=a.readBinaryDTagElement(f.Certificate);this.certificate=d,this.type=i.CERTIFICATE,h>4&&console.log("CERTIFICATE FOUND: "+this.certificate)}catch(c){throw new Error("Cannot decode certificate: "+c)}if(null==this.certificate)throw new Error("Cannot parse certificate! ")}else this.type=i.KEYNAME,this.keyName=new k,this.keyName.from_ndnb(a);a.readElementClose()},j.prototype.to_ndnb=function(a){if(h>4&&console.log("type is is "+this.type),this.type!=i.KEY_LOCATOR_DIGEST){if(a.writeElementStartDTag(this.getElementLabel()),this.type==i.KEY)h>5&&console.log("About to encode a public key"+this.publicKey),a.writeDTagElement(f.Key,this.publicKey);else if(this.type==i.CERTIFICATE)try{a.writeDTagElement(f.Certificate,this.certificate)}catch(b){throw new Error("CertificateEncodingException attempting to write key locator: "+b)}else this.type==i.KEYNAME&&this.keyName.to_ndnb(a);a.writeElementClose()}},j.prototype.getElementLabel=function(){return f.KeyLocator};var k=function(){this.contentName=new e,this.publisherID=this.publisherID};c.KeyName=k,k.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),this.contentName=new e,this.contentName.from_ndnb(a),h>4&&console.log("KEY NAME FOUND: "),g.peek(a)&&(this.publisherID=new g,this.publisherID.from_ndnb(a)),a.readElementClose()},k.prototype.to_ndnb=function(a){a.writeElementStartDTag(this.getElementLabel()),this.contentName.to_ndnb(a),null!=this.publisherID&&this.publisherID.to_ndnb(a),a.writeElementClose()},k.prototype.getElementLabel=function(){return f.KeyName}}).call(this,a("buffer").Buffer)},{"./log.js":170,"./name.js":172,"./publisher-id.js":173,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199,buffer:11}],169:[function(a,b,c){(function(b){var d=a("./encoding/data-utils.js").DataUtils,e=a("./log.js").Log.LOG,f=function(){this.publicKeyDer=null,this.publicKeyDigest=null,this.publicKeyPem=null,this.privateKeyPem=null};c.Key=f,f.prototype.publicToDER=function(){return this.publicKeyDer},f.prototype.privateToDER=function(){var a=this.privateKeyPem.split("\n");priKey="";for(var c=1;c<a.length-1;c++)priKey+=a[c];return new b(priKey,"base64")},f.prototype.publicToPEM=function(){return this.publicKeyPem},f.prototype.privateToPEM=function(){return this.privateKeyPem},f.prototype.getKeyID=function(){return this.publicKeyDigest},c.Key=f,f.prototype.readDerPublicKey=function(c){e>4&&console.log("Encode DER public key:\n"+c.toString("hex")),this.publicKeyDer=c;var f=a("crypto").createHash("sha256");f.update(this.publicKeyDer),this.publicKeyDigest=new b(d.toNumbersIfString(f.digest()));for(var g=c.toString("base64"),h="-----BEGIN PUBLIC KEY-----\n",i=0;i<g.length;i+=64)h+=g.substr(i,64)+"\n";h+="-----END PUBLIC KEY-----",this.publicKeyPem=h,e>4&&console.log("Convert public key to PEM format:\n"+this.publicKeyPem)},f.prototype.fromPemString=function(c,f){if(null==c&&null==f)throw new Error("Cannot create Key object if both public and private PEM string is empty.");if(null!=c){this.publicKeyPem=c,e>4&&console.log("Key.publicKeyPem: \n"+this.publicKeyPem);var g=c.split("\n");c="";for(var h=1;h<g.length-1;h++)c+=g[h];this.publicKeyDer=new b(c,"base64"),e>4&&console.log("Key.publicKeyDer: \n"+this.publicKeyDer.toString("hex"));var i=a("crypto").createHash("sha256");i.update(this.publicKeyDer),this.publicKeyDigest=new b(d.toNumbersIfString(i.digest())),e>4&&console.log("Key.publicKeyDigest: \n"+this.publicKeyDigest.toString("hex"))}null!=f&&(this.privateKeyPem=f,e>4&&console.log("Key.privateKeyPem: \n"+this.privateKeyPem))},f.prototype.fromPem=f.prototype.fromPemString,f.createFromPEM=function(a){var b=new f;return b.fromPemString(a.pub,a.pri),b}}).call(this,a("buffer").Buffer)},{"./encoding/data-utils.js":150,"./log.js":170,buffer:11,crypto:18}],170:[function(a,b,c){var d=function(){};c.Log=d,d.LOG=0},{}],171:[function(a,b,c){(function(b){var d=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/blob.js").Blob),e=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("./key-locator.js").KeyLocator,g=a("./key-locator.js").KeyLocatorType,h=a("./name.js").Name,i=a("./publisher-public-key-digest.js").PublisherPublicKeyDigest,j=a("./util/ndn-time.js").NDNTime,k=a("./security/key-manager.js").globalKeyManager,l=a("./log.js").Log.LOG,m={BLOB:0,DATA:0,LINK:1,KEY:2,ENCR:3,GONE:4,NACK:5};c.ContentType=m;var n=function p(a,b,c,d,e,g,h){if("object"==typeof a&&a instanceof p){var i=a;this.publisher=i.publisher,this.timestamp=i.timestamp,this.type=i.type,this.locator=null==i.locator?new f:new f(i.locator),this.freshnessSeconds=i.freshnessSeconds,this.finalBlockID=i.finalBlockID}else this.publisher=a,this.timestamp=b,this.type=null==c||0>c?m.BLOB:c,this.locator=null==d?new f:new f(d),this.freshnessSeconds=e,this.finalBlockID=g,h||this.setFields();this.changeCount=0};c.MetaInfo=n,n.prototype.getType=function(){return this.type},n.prototype.getFreshnessPeriod=function(){return null==this.freshnessSeconds||this.freshnessSeconds<0?null:1e3*this.freshnessSeconds},n.prototype.getFinalBlockID=function(){return new h.Component(new d(this.finalBlockID,!0))},n.prototype.getFinalBlockIDAsBuffer=function(){return this.finalBlockID},n.prototype.setType=function(a){this.type=null==a||0>a?m.BLOB:a,++this.changeCount},n.prototype.setFreshnessPeriod=function(a){this.freshnessSeconds=null==a||0>a?null:a/1e3,++this.changeCount},n.prototype.setFinalBlockID=function(a){this.finalBlockID=null==a?null:"object"==typeof a&&a instanceof d?a.buf():"object"==typeof a&&a instanceof h.Component?a.getValue().buf():new b(a),++this.changeCount},n.prototype.setFields=function(){var a=k.getKey();this.publisher=new i(a.getKeyID());var b=new Date,c=b.getTime();this.timestamp=new j(c),l>4&&console.log("TIME msec is"),l>4&&console.log(this.timestamp.msec),this.type=m.BLOB,l>4&&console.log("PUBLIC KEY TO WRITE TO DATA PACKET IS "),l>4&&console.log(a.publicToDER().toString("hex")),this.locator=new f(a.getKeyID(),g.KEY_LOCATOR_DIGEST),++this.changeCount},n.prototype.from_ndnb=function(a){if(a.readElementStartDTag(this.getElementLabel()),a.peekDTag(e.PublisherPublicKeyDigest)&&(l>4&&console.log("DECODING PUBLISHER KEY"),this.publisher=new i,this.publisher.from_ndnb(a)),a.peekDTag(e.Timestamp)&&(l>4&&console.log("DECODING TIMESTAMP"),this.timestamp=a.readDateTimeDTagElement(e.Timestamp)),a.peekDTag(e.Type)){var b=a.readBinaryDTagElement(e.Type);if(l>4&&console.log("Binary Type of of Signed Info is "+b),this.type=b,null==this.type)throw new Error("Cannot parse signedInfo type: bytes.")}else this.type=m.DATA;a.peekDTag(e.FreshnessSeconds)&&(this.freshnessSeconds=a.readIntegerDTagElement(e.FreshnessSeconds),l>4&&console.log("FRESHNESS IN SECONDS IS "+this.freshnessSeconds)),a.peekDTag(e.FinalBlockID)&&(l>4&&console.log("DECODING FINAL BLOCKID"),this.finalBlockID=a.readBinaryDTagElement(e.FinalBlockID)),a.peekDTag(e.KeyLocator)&&(l>4&&console.log("DECODING KEY LOCATOR"),this.locator=new f,this.locator.from_ndnb(a)),a.readElementClose(),++this.changeCount},n.prototype.to_ndnb=function(a,b){if(!this.validate())throw new Error("Cannot encode : field values missing.");a.writeElementStartDTag(this.getElementLabel()),null!=this.publisher?(l>3&&console.log("ENCODING PUBLISHER KEY"+this.publisher.publisherPublicKeyDigest),this.publisher.to_ndnb(a)):null!=b&&b.getType()==g.KEY_LOCATOR_DIGEST&&!b.getKeyData().isNull()&&b.getKeyData().size()>0&&a.writeDTagElement(e.PublisherPublicKeyDigest,b.getKeyData().buf()),null!=this.timestamp&&a.writeDateTimeDTagElement(e.Timestamp,this.timestamp),null!=this.type&&0!=this.type&&a.writeDTagElement(e.type,this.type),null!=this.freshnessSeconds&&a.writeDTagElement(e.FreshnessSeconds,this.freshnessSeconds),null!=this.finalBlockID&&a.writeDTagElement(e.FinalBlockID,this.finalBlockID),null!=b&&b.to_ndnb(a),a.writeElementClose()},n.prototype.valueToType=function(){return null},n.prototype.getElementLabel=function(){return e.SignedInfo},n.prototype.validate=function(){return null==this.timestamp?!1:!0},n.prototype.getChangeCount=function(){return this.changeCount};var o=function(a,b,c,d,e,f){n.call(this,a,b,c,d,e,f)};o.prototype=new n(null,null,null,null,null,null,!0),c.SignedInfo=o}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":146,"./encoding/binary-xml-encoder.js":147,"./key-locator.js":168,"./log.js":170,"./name.js":172,"./publisher-public-key-digest.js":174,"./security/key-manager.js":183,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199,"./util/ndn-time.js":200,buffer:11}],172:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=a("./encoding/data-utils.js").DataUtils,f=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),g=a("./log.js").Log.LOG,h=function i(a){if("string"==typeof a)g>3&&console.log("Content Name String "+a),this.components=i.createNameArray(a);else if("object"==typeof a)if(this.components=[],a instanceof i)this.append(a);else for(var b=0;b<a.length;++b)this.append(a[b]);else null==a?this.components=[]:g>1&&console.log("NO CONTENT NAME GIVEN");this.changeCount=0
};c.Name=h,h.Component=function(a){if("string"==typeof a)this.value=e.stringToUtf8Array(a);else if("object"==typeof a&&a instanceof h.Component)this.value=new b(a.value);else if("object"==typeof a&&a instanceof d)this.value=new b(a.isNull()?0:a.buf());else if(b.isBuffer(a))this.value=new b(a);else if("object"==typeof a&&"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)this.value=new b(new ArrayBuffer(a.byteLength)),this.value.set(new b(a));else if("object"==typeof a)this.value=new b(a);else{if(a)throw new Error("Name.Component constructor: Invalid type");this.value=new b(0)}},h.Component.prototype.getValue=function(){return new d(this.value,!1)},h.Component.prototype.getValueAsBuffer=function(){return this.value},h.Component.prototype.toEscapedString=function(){return h.toEscapedString(this.value)},h.Component.prototype.toNumber=function(){return e.bigEndianToUnsignedInt(this.value)},h.Component.prototype.toNumberWithMarker=function(a){if(0==this.value.length||this.value[0]!=a)throw new Error("Name component does not begin with the expected marker");return e.bigEndianToUnsignedInt(this.value.slice(1))},h.Component.prototype.toSegment=function(){return this.toNumberWithMarker(0)},h.Component.prototype.toVersion=function(){return this.toNumberWithMarker(253)},h.Component.fromNumberWithMarker=function(a,c){var d=e.nonNegativeIntToBigEndian(a),f=new b(d.length+1);return f[0]=c,d.copy(f,1),new h.Component(f)},h.Component.prototype.equals=function(a){return e.arraysEqual(this.value,a.value)},h.Component.prototype.compare=function(a){return h.Component.compareBuffers(this.value,a.value)},h.Component.compareBuffers=function(a,b){if(a.length<b.length)return-1;if(a.length>b.length)return 1;for(var c=0;c<a.length;++c){if(a[c]<b[c])return-1;if(a[c]>b[c])return 1}return 0},h.prototype.getName=function(){return this.toUri()},h.createNameArray=function(a){if(a=a.trim(),a.length<=0)return[];var b=a.indexOf(":");if(b>=0){var c=a.indexOf("/");(0>c||c>b)&&(a=a.substr(b+1,a.length-b-1).trim())}if("/"==a[0])if(a.length>=2&&"/"==a[1]){var d=a.indexOf("/",2);if(0>d)return[];a=a.substr(d+1,a.length-d-1).trim()}else a=a.substr(1,a.length-1).trim();for(var e=a.split("/"),f=0;f<e.length;++f){var g=h.fromEscapedString(e[f]);g.isNull()?(e.splice(f,1),--f):e[f]=new h.Component(g)}return e},h.prototype.set=function(a){this.components=h.createNameArray(a),++this.changeCount},h.prototype.from_ndnb=function(a){for(a.readElementStartDTag(this.getElementLabel()),this.components=[];a.peekDTag(f.Component);)this.append(a.readBinaryDTagElement(f.Component));a.readElementClose(),++this.changeCount},h.prototype.to_ndnb=function(a){if(null==this.components)throw new Error("CANNOT ENCODE EMPTY CONTENT NAME");a.writeElementStartDTag(this.getElementLabel());var b,c=a.offset,d=this.size();if(0==d)b=c;else for(var e=0;d>e;e++)e==d-1&&(b=a.offset),a.writeDTagElement(f.Component,this.components[e].getValue().buf());return a.writeElementClose(),{signedPortionBeginOffset:c,signedPortionEndOffset:b}},h.prototype.getElementLabel=function(){return f.Name},h.prototype.append=function(a){if("object"==typeof a&&a instanceof h){var b;b=a==this?this.components.slice(0,this.components.length):a.components;for(var c=0;c<b.length;++c)this.components.push(new h.Component(b[c]))}else this.components.push(new h.Component(a));return++this.changeCount,this},h.prototype.add=function(a){return this.append(a)},h.prototype.clear=function(){this.components=[],++this.changeCount},h.prototype.toUri=function(){if(0==this.size())return"/";for(var a="",b=0;b<this.size();++b)a+="/"+h.toEscapedString(this.components[b].getValue().buf());return a},h.prototype.to_uri=function(){return this.toUri()},h.prototype.appendSegment=function(a){return this.append(h.Component.fromNumberWithMarker(a,0))},h.prototype.appendVersion=function(){return this.append(h.Component.fromNumberWithMarker(segment,253))},h.prototype.addSegment=function(a){return this.appendSegment(a)},h.prototype.getSubName=function(a,b){void 0==b&&(b=this.components.length-a);for(var c=new h,d=a+b,e=a;d>e&&e<this.components.length;++e)c.components.push(this.components[e]);return c},h.prototype.getPrefix=function(a){return 0>a?this.getSubName(0,this.components.length+a):this.getSubName(0,a)},h.prototype.cut=function(a){return new h(this.components.slice(0,this.components.length-a))},h.prototype.size=function(){return this.components.length},h.prototype.get=function(a){if(a>=0){if(a>=this.components.length)throw new Error("Name.get: Index is out of bounds");return new h.Component(this.components[a])}if(a<-this.components.length)throw new Error("Name.get: Index is out of bounds");return new h.Component(this.components[this.components.length- -a])},h.prototype.getComponentCount=function(){return this.components.length},h.prototype.getComponent=function(a){return new b(this.components[a].getValue().buf())},h.prototype.indexOfFileName=function(){for(var a=this.size()-1;a>=0;--a){var b=this.components[a].getValue().buf();if(!(b.length<=0||0==b[0]||192==b[0]||193==b[0]||b[0]>=245&&b[0]<=255))return a}return-1},h.prototype.compare=function(a){for(var b=0;b<this.size()&&b<a.size();++b){var c=this.components[b].compare(a.components[b]);if(0!=c)return c}return this.size()<a.size()?-1:this.size()>a.size()?1:0},h.prototype.equals=function(a){if(this.components.length!=a.components.length)return!1;for(var b=this.components.length-1;b>=0;--b)if(!this.components[b].equals(a.components[b]))return!1;return!0},h.prototype.equalsName=function(a){return this.equals(a)},h.prototype.getContentDigestValue=function(){for(var a=this.size()-1;a>=0;--a){var b=h.getComponentContentDigestValue(this.components[a]);if(null!=b)return b}return null},h.getComponentContentDigestValue=function(a){"object"==typeof a&&a instanceof h.Component&&(a=a.getValue().buf());var b=h.ContentDigestPrefix.length+32+h.ContentDigestSuffix.length;return a.length==b&&e.arraysEqual(a.slice(0,h.ContentDigestPrefix.length),h.ContentDigestPrefix)&&e.arraysEqual(a.slice(a.length-h.ContentDigestSuffix.length,a.length),h.ContentDigestSuffix)?a.slice(h.ContentDigestPrefix.length,h.ContentDigestPrefix.length+32):null},h.ContentDigestPrefix=new b([193,46,77,46,71,193,1,170,2,133]),h.ContentDigestSuffix=new b([0]),h.toEscapedString=function(a){"object"==typeof a&&a instanceof h.Component?a=a.getValue().buf():"object"==typeof a&&a instanceof d&&(a=a.buf());for(var b="",c=!1,e=0;e<a.length;++e)if(46!=a[e]){c=!0;break}if(c)for(var e=0;e<a.length;++e){var f=a[e];b+=f>=48&&57>=f||f>=65&&90>=f||f>=97&&122>=f||43==f||45==f||46==f||95==f?String.fromCharCode(f):"%"+(16>f?"0":"")+f.toString(16).toUpperCase()}else{b="...";for(var e=0;e<a.length;++e)b+="."}return b},h.fromEscapedString=function(a){var b=unescape(a.trim());return null==b.match(/[^.]/)?b.length<=2?new d:new d(e.toNumbersFromString(b.substr(3,b.length-3)),!1):new d(e.toNumbersFromString(b),!1)},h.fromEscapedStringAsBuffer=function(a){return h.fromEscapedString(a).buf()},h.prototype.match=function(a){var b=this.components,c=a.components;if(b.length>c.length)return!1;for(var d=0;d<b.length;++d)if(!b[d].equals(c[d]))return!1;return!0},h.prototype.getChangeCount=function(){return this.changeCount}}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":146,"./encoding/binary-xml-encoder.js":147,"./encoding/data-utils.js":150,"./log.js":170,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199,buffer:11}],173:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=(a("./util/ndn-protoco-id-tags.js").NDNProtocolDTagsStrings,a("./encoding/decoding-exception.js").DecodingException),f=function(a){this.KEY=d.PublisherPublicKeyDigest,this.CERTIFICATE=d.PublisherCertificateDigest,this.ISSUER_KEY=d.PublisherIssuerKeyDigest,this.ISSUER_CERTIFICATE=d.PublisherIssuerCertificateDigest,this.Tag=a},g=function(){this.PUBLISHER_ID_DIGEST_ALGORITHM="SHA-256",this.PUBLISHER_ID_LEN=32,this.publisherID=null,this.publisherType=null,this.changeCount=0};c.PublisherID=g,g.prototype.from_ndnb=function(a){var b=g.peekAndGetNextDTag(a);if(this.publisherType=new f(b),0>b)throw new Error("Invalid publisher ID, got unexpected type");if(this.publisherID=a.readBinaryDTagElement(b),null==this.publisherID)throw new e(new Error("Cannot parse publisher ID of type : "+b+"."));++this.changeCount},g.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode "+this.getClass().getName()+": field values missing.");a.writeDTagElement(this.getElementLabel(),this.publisherID)},g.peekAndGetNextDTag=function(a){return a.peekDTag(d.PublisherPublicKeyDigest)?d.PublisherPublicKeyDigest:a.peekDTag(d.PublisherCertificateDigest)?d.PublisherCertificateDigest:a.peekDTag(d.PublisherIssuerKeyDigest)?d.PublisherIssuerKeyDigest:a.peekDTag(d.PublisherIssuerCertificateDigest)?d.PublisherIssuerCertificateDigest:-1},g.peek=function(a){return g.peekAndGetNextDTag(a)>=0},g.prototype.getElementLabel=function(){return this.publisherType.Tag},g.prototype.validate=function(){return null!=id()&&null!=type()},g.prototype.getChangeCount=function(){return this.changeCount}},{"./encoding/decoding-exception.js":151,"./util/ndn-protoco-id-tags.js":199}],174:[function(a,b,c){var d=a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags,e=a("./log.js").Log.LOG,f=function(a){this.PUBLISHER_ID_LEN=64,this.publisherPublicKeyDigest=a,this.changeCount=0};c.PublisherPublicKeyDigest=f,f.prototype.from_ndnb=function(a){if(this.publisherPublicKeyDigest=a.readBinaryDTagElement(this.getElementLabel()),e>4&&console.log("Publisher public key digest is "+this.publisherPublicKeyDigest),null==this.publisherPublicKeyDigest)throw new Error("Cannot parse publisher key digest.");this.publisherPublicKeyDigest.length!=this.PUBLISHER_ID_LEN&&e>0&&console.log("LENGTH OF PUBLISHER ID IS WRONG! Expected "+this.PUBLISHER_ID_LEN+", got "+this.publisherPublicKeyDigest.length),++this.changeCount},f.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode : field values missing.");e>3&&console.log("PUBLISHER KEY DIGEST IS"+this.publisherPublicKeyDigest),a.writeDTagElement(this.getElementLabel(),this.publisherPublicKeyDigest)},f.prototype.getElementLabel=function(){return d.PublisherPublicKeyDigest},f.prototype.validate=function(){return null!=this.publisherPublicKeyDigest},f.prototype.getChangeCount=function(){return this.changeCount}},{"./log.js":170,"./util/ndn-protoco-id-tags.js":199}],175:[function(a,b,c){var d=function(){};c.IdentityCertificate=d,d.certificateNameToPublicKeyName=function(a){for(var b=a.size()-1,c="ID-CERT";b>=0&&a.get(b).toEscapedString()!=c;)b-=1;for(var d=a.getSubName(0,b),e="KEY",b=0;b<d.size()&&d.get(b).toEscapedString()!=e;++b);return d.getSubName(0,b).append(d.getSubName(b+1,d.size()-b-1))}},{}],176:[function(a,b,c){var d=a("../security-exception.js").SecurityException,e=a("../security-types.js").KeyType,f=function(a,b){this.keyType=a,this.keyDer=b};c.PublicKey=f,f.prototype.toDer=function(){throw new Error("PublicKey.toDer is not implemented")},f.fromDer=function(a,b){if(a!=e.RSA)throw new d(new Error("PublicKey::fromDer: Unrecognized keyType"));return new f(a,b)},f.prototype.getDigest=function(){throw new Error("PublicKey.getDigest is not implemented")},f.prototype.getKeyType=function(){return this.keyType},f.prototype.getKeyDer=function(){return this.keyDer}},{"../security-exception.js":188,"../security-types.js":189}],177:[function(a,b,c){(function(b){var d=a("../../name.js").Name,e=a("../../data.js").Data,f=a("../../sha256-with-rsa-signature.js").Sha256WithRsaSignature,g=a("../../key-locator.js").KeyLocatorType,h=a("../../encoding/wire-format.js").WireFormat,i=a("../security-exception.js").SecurityException,j=function(a,b){this.identityStorage=a,this.privateKeyStorage=b};c.IdentityManager=j,j.prototype.createIdentity=function(){throw new Error("IdentityManager.createIdentity is not implemented")},j.prototype.getDefaultIdentity=function(){return this.identityStorage.getDefaultIdentity()},j.prototype.generateRSAKeyPair=function(){throw new Error("IdentityManager.generateRSAKeyPair is not implemented")},j.prototype.setDefaultKeyForIdentity=function(a,b){null==b&&(b=new d),this.identityStorage.setDefaultKeyNameForIdentity(a,b)},j.prototype.getDefaultKeyNameForIdentity=function(a){return this.identityStorage.getDefaultKeyNameForIdentity(a)},j.prototype.generateRSAKeyPairAsDefault=function(){throw new Error("IdentityManager.generateRSAKeyPairAsDefault is not implemented")},j.prototype.getPublicKey=function(a){return PublicKey.fromDer(this.identityStorage.getKeyType(a),this.identityStorage.getKey(a))},j.prototype.addCertificate=function(a){this.identityStorage.addCertificate(a)},j.prototype.setDefaultCertificateForKey=function(a){var b=a.getPublicKeyName();if(!this.identityStorage.doesKeyExist(b))throw new i(new Error("No corresponding Key record for certificate!"));this.identityStorage.setDefaultCertificateNameForKey(b,a.getName())},j.prototype.addCertificateAsIdentityDefault=function(a){this.identityStorage.addCertificate(a);var b=a.getPublicKeyName();this.setDefaultKeyForIdentity(b),this.setDefaultCertificateForKey(a)},j.prototype.addCertificateAsDefault=function(a){this.identityStorage.addCertificate(a),this.setDefaultCertificateForKey(a)},j.prototype.getCertificate=function(a){return new IdentityCertificate(this.identityStorage.getCertificate(a,!1))},j.prototype.getAnyCertificate=function(a){return new IdentityCertificate(this.identityStorage.getCertificate(a,!0))},j.prototype.getDefaultCertificateNameForIdentity=function(a){return this.identityStorage.getDefaultCertificateNameForIdentity(a)},j.prototype.getDefaultCertificateName=function(){return this.identityStorage.getDefaultCertificateNameForIdentity(this.getDefaultIdentity())},j.prototype.signByCertificate=function(a,c,d){if(d=d||h.getDefaultWireFormat(),!(a instanceof e)){var i=j.certificateNameToPublicKeyName(c),k=new f;return k.getKeyLocator().setType(g.KEYNAME),k.getKeyLocator().setKeyName(c.getPrefix(-1)),k.setSignature(this.privateKeyStorage.sign(a,i)),k}var l=a,i=j.certificateNameToPublicKeyName(c);l.setSignature(new f);var k=l.getSignature();k.getKeyLocator().setType(g.KEYNAME),k.getKeyLocator().setKeyName(c.getPrefix(-1)),k.setSignature(new b(1));var m=l.wireEncode(d);k.setSignature(this.privateKeyStorage.sign(m.signedBuf(),i)),l.wireEncode(d)},j.prototype.selfSign=function(){throw new Error("IdentityManager.selfSign is not implemented")},j.certificateNameToPublicKeyName=function(a){for(var b=a.size()-1,c="ID-CERT";b>=0&&a.get(b).toEscapedString()!=c;)--b;var d=a.getSubName(0,b),e="KEY";for(b=0;b<d.size()&&d.get(b).toEscapedString()!=e;)++b;return d.getSubName(0,b).append(d.getSubName(b+1,d.size()-b-1))}}).call(this,a("buffer").Buffer)},{"../../data.js":145,"../../encoding/wire-format.js":161,"../../key-locator.js":168,"../../name.js":172,"../../sha256-with-rsa-signature.js":190,"../security-exception.js":188,buffer:11}],178:[function(a,b,c){var d=a("../../name.js").Name,e=a("../security-exception.js").SecurityException,f=function(){};c.IdentityStorage=f,f.prototype.doesIdentityExist=function(){throw new Error("IdentityStorage.doesIdentityExist is not implemented")},f.prototype.addIdentity=function(){throw new Error("IdentityStorage.addIdentity is not implemented")},f.prototype.revokeIdentity=function(){throw new Error("IdentityStorage.revokeIdentity is not implemented")},f.prototype.getNewKeyName=function(a,b){var c,f=(new Date).getTime(),g=""+Math.floor(f/1e3);c=b?"KSK-"+g:"DSK-"+g;var h=new d(a).append(c);if(this.doesKeyExist(h))throw new e(new Error("Key name already exists"));return h},f.prototype.doesKeyExist=function(){throw new Error("IdentityStorage.doesKeyExist is not implemented")},f.prototype.addKey=function(){throw new Error("IdentityStorage.addKey is not implemented")},f.prototype.getKey=function(){throw new Error("IdentityStorage.getKey is not implemented")},f.prototype.getKeyType=function(){throw new Error("IdentityStorage.getKeyType is not implemented")},f.prototype.activateKey=function(){throw new Error("IdentityStorage.activateKey is not implemented")},f.prototype.deactivateKey=function(){throw new Error("IdentityStorage.deactivateKey is not implemented")},f.prototype.doesCertificateExist=function(){throw new Error("IdentityStorage.doesCertificateExist is not implemented")},f.prototype.addCertificate=function(){throw new Error("IdentityStorage.addCertificate is not implemented")},f.prototype.getCertificate=function(){throw new Error("IdentityStorage.getCertificate is not implemented")},f.prototype.getDefaultIdentity=function(){throw new Error("IdentityStorage.getDefaultIdentity is not implemented")},f.prototype.getDefaultKeyNameForIdentity=function(){throw new Error("IdentityStorage.getDefaultKeyNameForIdentity is not implemented")},f.prototype.getDefaultCertificateNameForIdentity=function(a){var b=this.getDefaultKeyNameForIdentity(a);return this.getDefaultCertificateNameForKey(b)},f.prototype.getDefaultCertificateNameForKey=function(){throw new Error("IdentityStorage.getDefaultCertificateNameForKey is not implemented")},f.prototype.setDefaultIdentity=function(){throw new Error("IdentityStorage.setDefaultIdentity is not implemented")},f.prototype.setDefaultKeyNameForIdentity=function(){throw new Error("IdentityStorage.setDefaultKeyNameForIdentity is not implemented")},f.prototype.setDefaultCertificateNameForKey=function(){throw new Error("IdentityStorage.setDefaultCertificateNameForKey is not implemented")}},{"../../name.js":172,"../security-exception.js":188}],179:[function(a,b,c){var d=a("../../data.js").Data,e=a("../../name.js").Name,f=a("../../util/blob.js").Blob,g=(a("../security-types.js").KeyType,a("../../encoding/data-utils.js").DataUtils),h=a("../security-exception.js").SecurityException,i=a("./identity-storage.js").IdentityStorage,j=function(){i.call(this),this.identityStore=[],this.defaultIdentity="",this.keyStore={},this.certificateStore={}};j.prototype=new i,j.prototype.name="MemoryIdentityStorage",c.MemoryIdentityStorage=j,j.prototype.doesIdentityExist=function(a){return void 0!==this.identityStore[a.toUri()]},j.prototype.addIdentity=function(a){var b=a.toUri();if(this.identityStore.indexOf(b)>=0)throw new h(new Error("Identity already exists: "+b));this.identityStore.push(b)},j.prototype.revokeIdentity=function(){throw new Error("MemoryIdentityStorage.revokeIdentity is not implemented")},j.prototype.doesKeyExist=function(a){return void 0!==this.keyStore[a.toUri()]},j.prototype.addKey=function(a,b,c){var d=a.getSubName(0,a.size()-1);if(this.doesIdentityExist(d)||this.addIdentity(d),this.doesKeyExist(a))throw new h(new Error("A key with the same name already exists!"));this.keyStore[a.toUri()]={keyType:b,keyDer:new f(c)}},j.prototype.getKey=function(a){var b=a.toUri(),c=this.keyStore[b];return void 0===c?new f:c.keyDer},j.prototype.getKeyType=function(a){var b=a.toUri(),c=this.keyStore[b];if(void 0===c)throw new h(new Error("Cannot get public key type because the keyName doesn't exist"));return c.keyType},j.prototype.activateKey=function(){throw new Error("MemoryIdentityStorage.activateKey is not implemented")},j.prototype.deactivateKey=function(){throw new Error("MemoryIdentityStorage.deactivateKey is not implemented")},j.prototype.doesCertificateExist=function(a){return void 0!==this.certificateStore[a.toUri()]},j.prototype.addCertificate=function(a){var b=a.getName(),c=a.getPublicKeyName();if(!this.doesKeyExist(c))throw new h(new Error("No corresponding Key record for certificate! "+c.toUri()+" "+b.toUri()));if(this.doesCertificateExist(b))throw new h(new Error("Certificate has already been installed!"));var d=getKey(c);if(d.isNull()||!g.arraysEqual(d.buf(),a.getPublicKeyInfo().getKeyDer().buf()))throw new h(new Error("The certificate does not match the public key!"));this.certificateStore[b.toUri()]=a.wireEncode()},j.prototype.getCertificate=function(a){var b=a.toUri();if(void 0===this.certificateStore[b])return null;var c=new d;return c.wireDecode(this.certificateStore[b]),c},j.prototype.getDefaultIdentity=function(){if(0===this.defaultIdentity.length)throw new h(new Error("MemoryIdentityStorage.getDefaultIdentity: The default identity is not defined"));return new e(this.defaultIdentity)},j.prototype.getDefaultKeyNameForIdentity=function(){throw new Error("MemoryIdentityStorage.getDefaultKeyNameForIdentity is not implemented")},j.prototype.getDefaultCertificateNameForKey=function(){throw new Error("MemoryIdentityStorage.getDefaultCertificateNameForKey is not implemented")},j.prototype.setDefaultIdentity=function(a){var b=a.toUri();this.defaultIdentity=void 0!==this.identityStore[b]?b:""},j.prototype.setDefaultKeyNameForIdentity=function(){throw new Error("MemoryIdentityStorage.setDefaultKeyNameForIdentity is not implemented")},j.prototype.setDefaultCertificateNameForKey=function(){throw new Error("MemoryIdentityStorage.setDefaultCertificateNameForKey is not implemented")}},{"../../data.js":145,"../../encoding/data-utils.js":150,"../../name.js":172,"../../util/blob.js":194,"../security-exception.js":188,"../security-types.js":189,"./identity-storage.js":178}],180:[function(a,b,c){(function(b){var d=a("../../util/blob.js").Blob,e=a("../security-exception.js").SecurityException,f=a("../certificate/public-key.js").PublicKey,g=a("../security-types.js").KeyClass,h=a("../security-types.js").DigestAlgorithm,i=a("../../encoding/data-utils.js").DataUtils,j=a("./private-key-storage.js").PrivateKeyStorage,k=function(){j.call(this),this.publicKeyStore={},this.privateKeyStore={}};k.prototype=new j,k.prototype.name="MemoryPrivateKeyStorage",c.MemoryPrivateKeyStorage=k,k.prototype.setPublicKeyForKeyName=function(a,b,c){this.publicKeyStore[a.toUri()]=f.fromDer(b,new d(c,!0))},k.prototype.setPrivateKeyForKeyName=function(a,b,c){for(var d=c.toString("base64"),e="-----BEGIN RSA PRIVATE KEY-----\n",f=0;f<d.length;f+=64)e+=d.substr(f,64)+"\n";e+="-----END RSA PRIVATE KEY-----",this.privateKeyStore[a.toUri()]={keyType:b,privateKey:e}},k.prototype.setKeyPairForKeyName=function(a,b,c,d){this.setPublicKeyForKeyName(a,b,c),this.setPrivateKeyForKeyName(a,b,d)},k.prototype.getPublicKey=function(a){var b=a.toUri(),c=this.publicKeyStore[b];if(void 0===c)throw new e(new Error("MemoryPrivateKeyStorage: Cannot find public key "+a.toUri()));return c},k.prototype.sign=function(c,f,g){if(null==g&&(g=h.SHA256),g!=h.SHA256)return new d;var j=f.toUri(),k=this.privateKeyStore[j];if(void 0===k)throw new e(new Error("MemoryPrivateKeyStorage: Cannot find private key "+j));var l=a("crypto").createSign("RSA-SHA256");l.update(c);var m=new b(i.toNumbersIfString(l.sign(k.privateKey)));return new d(m,!1)},k.prototype.doesKeyExist=function(a,b){var c=a.toUri();return b==g.PUBLIC?void 0!==this.publicKeyStore[c]:b==g.PRIVATE?void 0!==this.privateKeyStore[c]:!1}}).call(this,a("buffer").Buffer)},{"../../encoding/data-utils.js":150,"../../util/blob.js":194,"../certificate/public-key.js":176,"../security-exception.js":188,"../security-types.js":189,"./private-key-storage.js":181,buffer:11,crypto:18}],181:[function(a,b,c){var d=function(){};c.PrivateKeyStorage=d,d.prototype.generateKeyPair=function(){throw new Error("PrivateKeyStorage.generateKeyPair is not implemented")},d.prototype.getPublicKey=function(){throw new Error("PrivateKeyStorage.getPublicKey is not implemented")},d.prototype.sign=function(){throw new Error("PrivateKeyStorage.sign is not implemented")},d.prototype.decrypt=function(){throw new Error("PrivateKeyStorage.decrypt is not implemented")},d.prototype.encrypt=function(){throw new Error("PrivateKeyStorage.encrypt is not implemented")},d.prototype.generateKey=function(){throw new Error("PrivateKeyStorage.generateKey is not implemented")},d.prototype.doesKeyExist=function(){throw new Error("PrivateKeyStorage.doesKeyExist is not implemented")}},{}],182:[function(a,b,c){var d=a("../name.js").Name,e=a("../interest.js").Interest,f=a("../data.js").Data,g=a("../key-locator.js").KeyLocatorType,h=a("../sha256-with-rsa-signature.js").Sha256WithRsaSignature,i=a("../encoding/wire-format.js").WireFormat,j=a("../encoding/tlv/tlv.js").Tlv,k=a("../encoding/tlv/tlv-encoder.js").TlvEncoder,l=a("./security-exception.js").SecurityException,m=function(a,b){this.identityManager=a,this.policyManager=b,this.encryptionManager=null,this.face=null,this.maxSteps=100};c.KeyChain=m,m.prototype.createIdentity=function(a){return this.identityManager.createIdentity(a)},m.prototype.getDefaultIdentity=function(){return this.identityManager.getDefaultIdentity()},m.prototype.getDefaultCertificateName=function(){return this.identityManager.getDefaultCertificateName()},m.prototype.generateRSAKeyPair=function(a,b,c){return this.identityManager.generateRSAKeyPair(a,b,c)},m.prototype.setDefaultKeyForIdentity=function(a,b){return null==b&&(b=new d),this.identityManager.setDefaultKeyForIdentity(a,b)},m.prototype.generateRSAKeyPairAsDefault=function(a,b,c){return this.identityManager.generateRSAKeyPairAsDefault(a,b,c)},m.prototype.createSigningRequest=function(a){return this.identityManager.getPublicKey(a).getKeyDer()},m.prototype.installIdentityCertificate=function(a){this.identityManager.addCertificate(a)},m.prototype.setDefaultCertificateForKey=function(a){this.identityManager.setDefaultCertificateForKey(a)},m.prototype.getCertificate=function(a){return this.identityManager.getCertificate(a)},m.prototype.getAnyCertificate=function(a){return this.identityManager.getAnyCertificate(a)},m.prototype.getIdentityCertificate=function(a){return this.identityManager.getCertificate(a)},m.prototype.getAnyIdentityCertificate=function(a){return this.identityManager.getAnyCertificate(a)},m.prototype.revokeKey=function(){},m.prototype.revokeCertificate=function(){},m.prototype.getIdentityManager=function(){return this.identityManager},m.prototype.getPolicyManager=function(){return this.policyManager},m.prototype.sign=function(a,b,c){if(a instanceof e)this.signInterest(a,b,c);else{if(!(a instanceof f))return this.identityManager.signByCertificate(a,b);this.identityManager.signByCertificate(a,b,c)}},m.prototype.signInterest=function(a,b,c){c=c||i.getDefaultWireFormat();var e=new h;e.getKeyLocator().setType(g.KEYNAME),e.getKeyLocator().setKeyName(b.getPrefix(-1)),a.getName().append(c.encodeSignatureInfo(e)),a.getName().append(new d.Component);var f=a.wireEncode(c),l=this.sign(f.buf(),b),m=new k(256);m.writeBlobTlv(j.SignatureValue,l.getSignature().buf()),a.setName(a.getName().getPrefix(-1).append(c.encodeSignatureValue(l)))},m.prototype.signByIdentity=function(a,b,c){if(null==b&&(b=new d),!(a instanceof f)){var e=this.identityManager.getDefaultCertificateNameForIdentity(b);if(0==e.size())throw new l(new Error("No qualified certificate name found!"));return this.identityManager.signByCertificate(array,e)}var e;if(0==b.size()){var g=this.policyManager.inferSigningIdentity(data.getName());e=0==g.size()?this.identityManager.getDefaultCertificateName():this.identityManager.getDefaultCertificateNameForIdentity(g)}else e=this.identityManager.getDefaultCertificateNameForIdentity(b);if(0==e.size())throw new l(new Error("No qualified certificate name found!"));if(!this.policyManager.checkSigningPolicy(data.getName(),e))throw new l(new Error("Signing Cert name does not comply with signing policy"));this.identityManager.signByCertificate(data,e,c)},m.prototype.verifyData=function(a,b,c,d){if(this.policyManager.requireVerify(a)){var e=this.policyManager.checkVerificationPolicy(a,d,b,c);if(null!=e){var f=this;this.face.expressInterest(e.interest,function(a,b){f.onCertificateData(a,b,e)},function(b){f.onCertificateInterestTimeout(b,e.retry,c,a,e)})}}else this.policyManager.skipVerifyAndTrust(a)?b(a):c(a)},m.prototype.verifyInterest=function(){throw new Error("KeyChain.verifyInterest is not implemented")},m.prototype.generateSymmetricKey=function(a,b){this.encryptionManager.createSymmetricKey(a,b)},m.prototype.encrypt=function(a,b,c,d){return this.encryptionManager.encrypt(a,b,c,d)},m.prototype.decrypt=function(a,b,c,d){return this.encryptionManager.decrypt(a,b,c,d)},m.prototype.setFace=function(a){this.face=a},m.prototype.onCertificateData=function(a,b,c){this.verifyData(b,c.onVerified,c.onVerifyFailed,c.stepCount)},m.prototype.onCertificateInterestTimeout=function(a,b,c,d,e){if(b>0){var f=this;this.face.expressInterest(a,function(a,b){f.onCertificateData(a,b,e)},function(a){f.onCertificateInterestTimeout(a,b-1,c,d,e)})}else c(d)}},{"../data.js":145,"../encoding/tlv/tlv-encoder.js":158,"../encoding/tlv/tlv.js":160,"../encoding/wire-format.js":161,"../interest.js":167,"../key-locator.js":168,"../name.js":172,"../sha256-with-rsa-signature.js":190,"./security-exception.js":188}],183:[function(a,b,c){var d=a("../key.js").Key,e=function(){this.publicKey="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuAmnWYKE7E8G+hyy4TiT\nU7t91KyIGvglEeT6HWEkW4LKzXLO22a1jVS9+yP96I6vp7N5vpS1t7oXtgWuzkO+\nO85u6gfbvwp+67zJe2I89eHO4dmNnP4fx/j7WcCUCyzZfbyW67h5IoouoBIdQge2\nXdvh9rFdex9UUhyjEZv5676zlcqlhz8xGBrJmQHsqpD9ijY1XhKBvoSIoQ0ZKkpm\nwVk8QYM9PbjUqzSQBj4aYXS+BPV6aRudVvyDt2DBXp2FNP0CGrosCXKnSl4Yv8BY\np0k0RmFZDuJuntLb/XIvPEfMX5li7g3zHzAlIJIVSwT+FRkd3H5cECFSIZFUYIuS\nQQIDAQAB\n-----END PUBLIC KEY-----",this.privateKey="-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAuAmnWYKE7E8G+hyy4TiTU7t91KyIGvglEeT6HWEkW4LKzXLO\n22a1jVS9+yP96I6vp7N5vpS1t7oXtgWuzkO+O85u6gfbvwp+67zJe2I89eHO4dmN\nnP4fx/j7WcCUCyzZfbyW67h5IoouoBIdQge2Xdvh9rFdex9UUhyjEZv5676zlcql\nhz8xGBrJmQHsqpD9ijY1XhKBvoSIoQ0ZKkpmwVk8QYM9PbjUqzSQBj4aYXS+BPV6\naRudVvyDt2DBXp2FNP0CGrosCXKnSl4Yv8BYp0k0RmFZDuJuntLb/XIvPEfMX5li\n7g3zHzAlIJIVSwT+FRkd3H5cECFSIZFUYIuSQQIDAQABAoIBAQCKBftzfxavn6lM\n5T8m+GZN0vzRBsBg8Z/jpsYKSLOayiHNKYCIPaSFpXuCIYEo6/JDJLB2xVLvwupL\ngkGSwm2mrvCyJkihI38Cz6iQF6I+iia9bYrupgwxzsK7klm1c+J9kXXivYxj4hyL\nwmoc/mnARMtYV7cTQvDbUEzgRQmPykWKBv6Y0SL1WprfiRfKIMwSqQk91ffj6whK\nxBLAuUdseVBmo/ivLPq0a+wDrcvaJAxSB4eIwCHzAugkRA/NoK0vG3mra0lK5jvQ\nrcNIuffxNAnresDVDTnYRc42etjePLAhlpeK/4sjYE/wPdeP8yzLHUg/hsSpAPIj\nLXJNZqUBAoGBANxPmUQNf1lGHo/nLY3dVMD3+kYNnTUD8XwS81qdg8/dNyF8t+7D\nOdJ1j7Itb+zGA1XXAGfTm6JoUG+eKKR2OSuyZcxygpOgzxAFanXKhTWZsKbG70xN\nmX0sOAEhtTGsgFTEGEv977MwIlFa6n2bsp3Luj/AGmvNsOYvBDPXOklxAoGBANXZ\nyXAaE7M5JALusLuEFxLGvWVz6TRdQ//c+FWvKrnh+nFlTlAPpDvlaPJJca8ViNev\nxJ2UhGtbENXAqgwTYpnAi/yQD4dATViIveK6Pn4t12mpPAlkMbbMTR8jtp5l1oHc\nhcwe8QuEOKuTX5+STpNGlWs+tsMb12mhCpc3eO3RAoGAMxjDE2WOA8afkACuMBkF\nbzwUb+r4azNe7sf2aS3fRHaqMroabuYYoxdhHJItQ10pqN8U2P/bOO+4uCqWgo5o\n9BmMQr7MSjEh1TVsW6V8/9GFhyjcl3XoA4Ad/SU0QTEhEofomrdqwMSJMRVFDZzu\n8Gov6FlFx3sNbFW7Q8rHWgECgYEAq/TVz3iIgsLdvCXmosHSM9zvCpcr3FlqhmFO\npseVmaamVWxajnIlY6xSuRBpg5nTUWwas4Nq/1BYtyiXE+K6lFuJtOq6Mc145EoA\nNkIAYkHGR0Y36m1QtGaPVQzImZHV7NJAHCR9Ov90+jIk4BErca1+FKB3IWhPzLYb\n6ABJEyECgYEAthhzWSxPkqyiLl+2vnhdR3EEkvDX6MV6hGu4tDAf2A1Y0GSApyEa\nSAA31hlxu5EgneLD7Ns2HMpIfQMydB5lcwKQc9g/tVI1eRzuk6Myi+2JmPEM2BLy\niX8yI+xnZlKDiZleQitCS4RQGz5HbXT70aYQIGxuvkQ/uf68jdrL6o8=\n-----END RSA PRIVATE KEY-----",this.key=null};e.prototype.getKey=function(){return null===this.key&&(this.key=new d,this.key.fromPemString(this.publicKey,this.privateKey)),this.key};var f=f||new e;c.globalKeyManager=f},{"../key.js":169}],184:[function(a,b,c){var d=a("../../name.js").Name,e=a("./policy-manager.js").PolicyManager,f=function(){e.call(this)};f.prototype=new e,f.prototype.name="NoVerifyPolicyManager",c.NoVerifyPolicyManager=f,f.prototype.skipVerifyAndTrust=function(){return!0},f.prototype.requireVerify=function(){return!1},f.prototype.checkVerificationPolicy=function(a,b,c){return c(a),null},f.prototype.checkSigningPolicy=function(){return!0},f.prototype.inferSigningIdentity=function(){return new d}},{"../../name.js":172,"./policy-manager.js":185}],185:[function(a,b,c){var d=function(){};c.PolicyManager=d,d.prototype.skipVerifyAndTrust=function(){throw new Error("PolicyManager.skipVerifyAndTrust is not implemented")},d.prototype.requireVerify=function(){throw new Error("PolicyManager.requireVerify is not implemented")},d.prototype.checkVerificationPolicy=function(){throw new Error("PolicyManager.checkVerificationPolicy is not implemented")
},d.prototype.checkSigningPolicy=function(){throw new Error("PolicyManager.checkSigningPolicy is not implemented")},d.prototype.inferSigningIdentity=function(){throw new Error("PolicyManager.inferSigningIdentity is not implemented")}},{}],186:[function(a,b,c){var d=a("../../name.js").Name,e=a("../../data.js").Data,f=a("../../encoding/data-utils.js").DataUtils,g=a("../certificate/identity-certificate.js").IdentityCertificate,h=a("../../key-locator.js").KeyLocatorType,i=a("../security-exception.js").SecurityException,j=a("../../encoding/wire-format.js").WireFormat,k=a("./policy-manager.js").PolicyManager,l=function(a){k.call(this),this.identityStorage=a};l.prototype=new k,l.prototype.name="SelfVerifyPolicyManager",c.SelfVerifyPolicyManager=l,l.prototype.skipVerifyAndTrust=function(){return!1},l.prototype.requireVerify=function(){return!0},l.prototype.checkVerificationPolicy=function(a,b,c,d,f){if(f=f||j.getDefaultWireFormat(),a instanceof e){var g=a;this.verify(g.getSignature(),g.wireEncode())?c(g):d(g)}else{if(!(a instanceof Interest))throw new i(new Error("checkVerificationPolicy: unrecognized type for dataOrInterest"));var h=a,k=f.decodeSignatureInfoAndValue(h.getName().get(-2).getValue().buf(),h.getName().get(-1).getValue().buf());this.verify(k,h.wireEncode())?c(h):d(h)}return null},l.prototype.checkSigningPolicy=function(){return!0},l.prototype.inferSigningIdentity=function(){return new d},l.prototype.verify=function(a,b){var c=a;if(c.getKeyLocator().getType()==h.KEY)return l.verifySha256WithRsaSignature(c,b,c.getKeyLocator().getKeyData());if(c.getKeyLocator().getType()==h.KEYNAME&&null!=this.identityStorage){var d=this.identityStorage.getKey(g.certificateNameToPublicKeyName(c.getKeyLocator().getKeyName()));return d.isNull()?!1:l.verifySha256WithRsaSignature(c,b,d)}return!1},l.verifyUsesString=null,l.verifySha256WithRsaSignature=function(b,c,d){if(null===l.verifyUsesString){var g=a("crypto").createHash("sha256").digest();l.verifyUsesString="string"==typeof g}for(var h=d.buf().toString("base64"),i="-----BEGIN PUBLIC KEY-----\n",j=0;j<h.length;j+=64)i+=h.substr(j,64)+"\n";i+="-----END PUBLIC KEY-----";var k=a("crypto").createVerify("RSA-SHA256");k.update(c.signedBuf());var m=e.verifyUsesString?f.toString(b.getSignature().buf()):b.getSignature().buf();return k.verify(i,m)}},{"../../data.js":145,"../../encoding/data-utils.js":150,"../../encoding/wire-format.js":161,"../../key-locator.js":168,"../../name.js":172,"../certificate/identity-certificate.js":175,"../security-exception.js":188,"./policy-manager.js":185,crypto:18}],187:[function(a,b,c){var d=function(a,b,c,d,e){this.interest=a,this.onVerified=b,this.onVerifyFailed=c,this.retry=d,this.stepCount=e};c.ValidationRequest=d},{}],188:[function(a,b,c){function d(a){this.message=a.message;for(var b in a)this[b]=a[b]}d.prototype=new Error,d.prototype.name="SecurityException",c.SecurityException=d},{}],189:[function(a,b,c){var d=function(){};c.KeyType=d,d.RSA=0,d.AES=1,d.EC=2;var e=function(){};c.KeyClass=e,e.PUBLIC=1,e.PRIVATE=2,e.SYMMETRIC=3;var f=function(){};c.DigestAlgorithm=f,f.SHA256=1;var g=function(){};c.EncryptMode=g,g.DEFAULT=1,g.CFB_AES=2},{}],190:[function(a,b,c){(function(b){var d=a("./util/blob.js").Blob,e=(a("./encoding/binary-xml-encoder.js").BinaryXMLEncoder,a("./encoding/binary-xml-decoder.js").BinaryXMLDecoder,a("./util/ndn-protoco-id-tags.js").NDNProtocolDTags),f=a("./key-locator.js").KeyLocator,g=a("./log.js").Log.LOG,h=function j(a){"object"==typeof a&&a instanceof j?(this.keyLocator=new f(a.keyLocator),this.signature=a.signature,this.witness=a.witness,this.digestAlgorithm=a.digestAlgorithm):(this.keyLocator=new f,this.signature=null,this.witness=null,this.digestAlgorithm=null)};c.Sha256WithRsaSignature=h,h.prototype.clone=function(){return new h(this)},h.prototype.getKeyLocator=function(){return this.keyLocator},h.prototype.getSignature=function(){return new d(this.signature,!1)},h.prototype.getSignatureAsBuffer=function(){return this.signature},h.prototype.setKeyLocator=function(a){this.keyLocator="object"==typeof a&&a instanceof f?new f(a):new f},h.prototype.setSignature=function(a){this.signature=null==a?null:new b("object"==typeof a&&a instanceof d?a.buf():a)},h.prototype.from_ndnb=function(a){a.readElementStartDTag(this.getElementLabel()),g>4&&console.log("STARTED DECODING SIGNATURE"),a.peekDTag(e.DigestAlgorithm)&&(g>4&&console.log("DIGIEST ALGORITHM FOUND"),this.digestAlgorithm=a.readUTF8DTagElement(e.DigestAlgorithm)),a.peekDTag(e.Witness)&&(g>4&&console.log("WITNESS FOUND"),this.witness=a.readBinaryDTagElement(e.Witness)),g>4&&console.log("SIGNATURE FOUND"),this.signature=a.readBinaryDTagElement(e.SignatureBits),a.readElementClose()},h.prototype.to_ndnb=function(a){if(!this.validate())throw new Error("Cannot encode: field values missing.");a.writeElementStartDTag(this.getElementLabel()),null==this.digestAlgorithm||this.digestAlgorithm.equals(NDNDigestHelper.DEFAULT_DIGEST_ALGORITHM)||a.writeDTagElement(e.DigestAlgorithm,OIDLookup.getDigestOID(this.DigestAlgorithm)),null!=this.witness&&a.writeDTagElement(e.Witness,this.witness),a.writeDTagElement(e.SignatureBits,this.signature),a.writeElementClose()},h.prototype.getElementLabel=function(){return e.Signature},h.prototype.validate=function(){return this.getSignature().size()>0};var i=function(a,b,c){"object"==typeof a&&a instanceof h?h.call(this,a):(h.call(this),null!=a&&(this.witness=a),null!=b&&(this.signature=b),null!=c&&(this.digestAlgorithm=c))};i.prototype=new h,c.Signature=i}).call(this,a("buffer").Buffer)},{"./encoding/binary-xml-decoder.js":146,"./encoding/binary-xml-encoder.js":147,"./key-locator.js":168,"./log.js":170,"./util/blob.js":194,"./util/ndn-protoco-id-tags.js":199,buffer:11}],191:[function(a,b,c){var d=function(){};c.Transport=d,d.ConnectionInfo=function(){}},{}],192:[function(a,b,c){(function(b){var d=a("../encoding/element-reader.js").ElementReader,e=a("../log.js").Log.LOG,f=a("./transport.js").Transport,g=function(){f.call(this),this.socket=null,this.sock_ready=!1,this.elementReader=null,this.connectionInfo=null,this.defaultGetConnectionInfo=null};g.prototype=new f,g.prototype.name="UnixTransport",c.UnixTransport=g,g.ConnectionInfo=function(a){f.ConnectionInfo.call(this),this.filePath=a},g.ConnectionInfo.prototype=new f.ConnectionInfo,g.ConnectionInfo.prototype.name="UnixTransport.ConnectionInfo",g.ConnectionInfo.prototype.equals=function(a){return null==a||void 0==a.filePath?!1:this.filePath==a.filePath},g.ConnectionInfo.prototype.toString=function(){return"{ filePath: "+this.filePath+" }"},g.prototype.connect=function(c,f,g,h){null!=this.socket&&delete this.socket,this.elementReader=new d(f);var i=a("net");this.socket=new i.createConnection(c.filePath);var j=this;this.socket.on("data",function(a){if("object"==typeof a){var c=new b(a);try{j.elementReader.onReceivedData(c)}catch(d){return void console.log("NDN.UnixTransport.ondata exception: "+d)}}}),this.socket.on("connect",function(){e>3&&console.log("socket.onopen: Unix socket connection opened."),j.sock_ready=!0,g()}),this.socket.on("error",function(){e>3&&console.log("socket.onerror: Unix socket error")}),this.socket.on("close",function(){e>3&&console.log("socket.onclose: Unix socket connection closed."),j.socket=null,h()}),this.connectionInfo=c},g.prototype.send=function(a){this.sock_ready?this.socket.write(a):console.log("Unix socket connection is not established.")},g.prototype.close=function(){this.socket.end(),e>3&&console.log("Unix socket connection closed.")}}).call(this,a("buffer").Buffer)},{"../encoding/element-reader.js":152,"../log.js":170,"./transport.js":191,buffer:11,net:10}],193:[function(a,b,c){(function(b){var d=a("../encoding/element-reader.js").ElementReader,e=a("../log.js").Log.LOG,f=a("./transport.js").Transport,g=function h(){if(f.call(this),!WebSocket)throw new Error("WebSocket support is not available on this platform.");this.ws=null,this.connectionInfo=null,this.elementReader=null,this.defaultGetConnectionInfo=Face.makeShuffledHostGetConnectionInfo(["A.ws.ndn.ucla.edu","B.ws.ndn.ucla.edu","C.ws.ndn.ucla.edu","D.ws.ndn.ucla.edu","E.ws.ndn.ucla.edu","F.ws.ndn.ucla.edu","G.ws.ndn.ucla.edu","H.ws.ndn.ucla.edu","I.ws.ndn.ucla.edu","J.ws.ndn.ucla.edu","K.ws.ndn.ucla.edu","L.ws.ndn.ucla.edu","M.ws.ndn.ucla.edu","N.ws.ndn.ucla.edu"],9696,function(a,b){return new h.ConnectionInfo(a,b)})};g.prototype=new f,g.prototype.name="WebSocketTransport",c.WebSocketTransport=g,g.ConnectionInfo=function(a,b){f.ConnectionInfo.call(this),b=void 0!==b?b:9696,this.host=a,this.port=b},g.ConnectionInfo.prototype=new f.ConnectionInfo,g.ConnectionInfo.prototype.name="WebSocketTransport.ConnectionInfo",g.ConnectionInfo.prototype.equals=function(a){return null==a||void 0==a.host||void 0==a.port?!1:this.host==a.host&&this.port==a.port},g.ConnectionInfo.prototype.toString=function(){return"{ host: "+this.host+", port: "+this.port+" }"},g.prototype.connect=function(a,c,f,g){this.close(),this.ws=new WebSocket("ws://"+a.host+":"+a.port),e>0&&console.log("ws connection created."),this.connectionInfo=a,this.ws.binaryType="arraybuffer",this.elementReader=new d(c);var h=this;this.ws.onmessage=function(a){var c=a.data;if(null==c||void 0==c||""==c)console.log("INVALID ANSWER");else if(c instanceof ArrayBuffer){var d=new b(c);e>3&&console.log("BINARY RESPONSE IS "+d.toString("hex"));try{h.elementReader.onReceivedData(d)}catch(f){return void console.log("NDN.ws.onmessage exception: "+f)}}},this.ws.onopen=function(a){e>3&&console.log(a),e>3&&console.log("ws.onopen: WebSocket connection opened."),e>3&&console.log("ws.onopen: ReadyState: "+this.readyState),f()},this.ws.onerror=function(a){console.log("ws.onerror: ReadyState: "+this.readyState),console.log(a),console.log("ws.onerror: WebSocket error: "+a.data)},this.ws.onclose=function(){console.log("ws.onclose: WebSocket connection closed."),h.ws=null,g()}},g.prototype.connectByFace=function(a,b){this.connect(a.connectionInfo,a,b,function(){a.closeByTransport()})},g.prototype.send=function(a){if(null!=this.ws){var b=new Uint8Array(a.length);b.set(a),this.ws.send(b.buffer),e>3&&console.log("ws.send() returned.")}else console.log("WebSocket connection is not established.")},g.prototype.close=function(){null!=this.ws&&delete this.ws}}).call(this,a("buffer").Buffer)},{"../encoding/element-reader.js":152,"../log.js":170,"./transport.js":191,buffer:11}],194:[function(a,b,c){(function(a){var b=function d(b,c){null==c&&(c=!0),this.buffer=null==b?null:"object"==typeof b&&b instanceof d?b.buffer:"string"==typeof b?new a(b,"utf8"):c?new a(b):a.isBuffer(b)?b:new a(b),this.length=null!=this.buffer?this.buffer.length:0};c.Blob=b,b.prototype.size=function(){return null!=this.buffer?this.buffer.length:0},b.prototype.buf=function(){return this.buffer},b.prototype.isNull=function(){return null==this.buffer},b.prototype.toHex=function(){return null==this.buffer?"":this.buffer.toString("hex")},b.prototype.equals=function(a){if(this.isNull())return a.isNull();if(a.isNull())return!1;if(this.buffer.length!=a.buffer.length)return!1;for(var b=0;b<this.buffer.length;++b)if(this.buffer[b]!=a.buffer[b])return!1;return!0}}).call(this,a("buffer").Buffer)},{buffer:11}],195:[function(a,b,c){var d=a("../encoding/wire-format.js").WireFormat,e=a("../encoding/tlv/tlv-encoder.js").TlvEncoder,f=a("./blob.js").Blob,g=function(){this.lastTimestamp=Math.round((new Date).getTime())};c.CommandInterestGenerator=g,g.prototype.generate=function(b,c,g,h){h=h||d.getDefaultWireFormat();for(var i=Math.round((new Date).getTime());i<=this.lastTimestamp;)i+=1;var j=new e(8);j.writeNonNegativeInteger(i),b.getName().append(new f(j.getOutput(),!1)),b.getName().append(new f(a("crypto").randomBytes(8),!1)),c.sign(b,g,h),(null==b.getInterestLifetimeMilliseconds()||b.getInterestLifetimeMilliseconds()<0)&&b.setInterestLifetimeMilliseconds(1e3),this.lastTimestamp=i}},{"../encoding/tlv/tlv-encoder.js":158,"../encoding/wire-format.js":161,"./blob.js":194,crypto:18}],196:[function(a,b,c){(function(a){var b=function(b){b||(b=16),this.array=new a(b)};c.DynamicBuffer=b,b.prototype.ensureLength=function(b){if(!(this.array.length>=b)){var c=2*this.array.length;b>c&&(c=b);var d=new a(c);this.array.copy(d),this.array=d}},b.prototype.copy=function(b,c){this.ensureLength(b.length+c),a.isBuffer(b)?b.copy(this.array,c):new a(b).copy(this.array,c)},b.prototype.ensureLengthFromBack=function(b){if(!(this.array.length>=b)){var c=2*this.array.length;b>c&&(c=b);var d=new a(c);this.array.copy(d,d.length-this.array.length),this.array=d}},b.prototype.copyFromBack=function(b,c){this.ensureLengthFromBack(c),a.isBuffer(b)?b.copy(this.array,this.array.length-c):new a(b).copy(this.array,this.array.length-c)},b.prototype.slice=function(a,b){return this.array.slice(a,b)}}).call(this,a("buffer").Buffer)},{buffer:11}],197:[function(a,b,c){var d=a("../name.js").Name,e=function(a,b){b=b||1e3,this.face=a,this.cleanupIntervalMilliseconds=b,this.nextCleanupTime=(new Date).getTime()+b,this.onDataNotFoundForPrefix={},this.noStaleTimeCache=[],this.staleTimeCache=[],this.emptyComponent=new d.Component};c.MemoryContentCache=e,e.prototype.registerPrefix=function(a,b,c,d,e){c&&(this.onDataNotFoundForPrefix[a.toUri()]=c);var f=this;this.face.registerPrefix(a,function(a,b,c){f.onInterest(a,b,c)},b,d,e)},e.prototype.add=function(a){if(this.doCleanup(),null!=a.getMetaInfo().getFreshnessPeriod()&&a.getMetaInfo().getFreshnessPeriod()>=0){for(var b=new e.StaleTimeContent(a),c=this.staleTimeCache.length-1;c>=0&&!(this.staleTimeCache[c].staleTimeMilliseconds<=b.staleTimeMilliseconds);)--c;this.staleTimeCache.splice(c+1,0,b)}else this.noStaleTimeCache.push(new e.Content(a))},e.prototype.onInterest=function(a,b,c){this.doCleanup();for(var d=0,e=null,f=this.staleTimeCache.length+this.noStaleTimeCache.length,g=0;f>g;++g){var h;if(h=g<this.staleTimeCache.length?this.staleTimeCache[g]:this.noStaleTimeCache[g-this.staleTimeCache.length],b.matchesName(h.getName())){if(b.getChildSelector()<0)return void c.send(h.getDataEncoding());var i;i=h.getName().size()>b.getName().size()?h.getName().get(b.getName().size()):this.emptyComponent;var j=!1;null===e?j=!0:0==b.getChildSelector()?i.compare(d)<0&&(j=!0):i.compare(d)>0&&(j=!0),j&&(d=i,e=h.getDataEncoding())}}if(null!==e)c.send(e);else{var k=this.onDataNotFoundForPrefix[a.toUri()];k&&k(a,b,c)}},e.prototype.doCleanup=function(){var a=(new Date).getTime();if(a>=this.nextCleanupTime){for(;this.staleTimeCache.length>0&&this.staleTimeCache[0].isStale(a);)this.staleTimeCache.shift();this.nextCleanupTime=a+this.cleanupIntervalMilliseconds}},e.Content=function(a){a&&(this.name=new d(a.getName()),this.dataEncoding=a.wireEncode().buf())},e.Content.prototype.getName=function(){return this.name},e.Content.prototype.getDataEncoding=function(){return this.dataEncoding},e.StaleTimeContent=function(a){e.Content.call(this,a),this.staleTimeMilliseconds=(new Date).getTime()+a.getMetaInfo().getFreshnessPeriod()},e.StaleTimeContent.prototype=new e.Content,e.StaleTimeContent.prototype.name="StaleTimeContent",e.StaleTimeContent.prototype.isStale=function(a){return this.staleTimeMilliseconds<=a}},{"../name.js":172}],198:[function(a,b,c){(function(b){var d=(a("../encoding/data-utils.js").DataUtils,a("../encoding/binary-xml-decoder.js").BinaryXMLDecoder),e=a("./ndn-protoco-id-tags.js").NDNProtocolDTags,f=a("../name.js").Name,g=function(a,b){this.face=a,this.onComponents=b,this.contentParts=[];var c=this;this.onData=function(a,b){c.processData(b)},this.onTimeout=function(){c.processTimeout()}};c.NameEnumeration=g,g.getComponents=function(a,b,c){var d=new f(b);d.add([193,46,69,46,98,101]);var e=new g(a,c);a.expressInterest(d,e.onData,e.onTimeout)},g.prototype.processData=function(a){try{if(g.endsWithSegmentNumber(a.getName())){var c=a.getName().get(-1).toSegment(),d=this.contentParts.length;if(c!=d)this.face.expressInterest(a.getName().getPrefix(-1).addSegment(d),this.onData,this.onTimeout);else{if(this.contentParts.push(a.getContent().buf()),null!=a.getMetaInfo()&&a.getMetaInfo().getFinalBlockID().getValue().size()>0){var e=a.getMetaInfo().getFinalBlockID().toSegment();if(c==e)return void this.onComponents(g.parseComponents(b.concat(this.contentParts)))}this.face.expressInterest(a.getName().getPrefix(-1).addSegment(d+1),this.onData,this.onTimeout)}}else this.onComponents(null)}catch(f){console.log("NameEnumeration: ignoring exception: "+f)}},g.prototype.processTimeout=function(){try{this.onComponents(null)}catch(a){console.log("NameEnumeration: ignoring exception: "+a)}},g.parseComponents=function(a){var c=[],f=new d(a);for(f.readElementStartDTag(e.Collection);f.peekDTag(e.Link);)f.readElementStartDTag(e.Link),f.readElementStartDTag(e.Name),c.push(new b(f.readBinaryDTagElement(e.Component))),f.readElementClose(),f.readElementClose();return f.readElementClose(),c},g.endsWithSegmentNumber=function(a){return a.size()>=1&&a.get(-1).getValue().size()>=1&&0==a.get(-1).getValue().buf()[0]}}).call(this,a("buffer").Buffer)},{"../encoding/binary-xml-decoder.js":146,"../encoding/data-utils.js":150,"../name.js":172,"./ndn-protoco-id-tags.js":199,buffer:11}],199:[function(a,b,c){var d={Any:13,Name:14,Component:15,Certificate:16,Collection:17,CompleteName:18,Content:19,SignedInfo:20,ContentDigest:21,ContentHash:22,Count:24,Header:25,Interest:26,Key:27,KeyLocator:28,KeyName:29,Length:30,Link:31,LinkAuthenticator:32,NameComponentCount:33,RootDigest:36,Signature:37,Start:38,Timestamp:39,Type:40,Nonce:41,Scope:42,Exclude:43,Bloom:44,BloomSeed:45,AnswerOriginKind:47,InterestLifetime:48,Witness:53,SignatureBits:54,DigestAlgorithm:55,BlockSize:56,FreshnessSeconds:58,FinalBlockID:59,PublisherPublicKeyDigest:60,PublisherCertificateDigest:61,PublisherIssuerKeyDigest:62,PublisherIssuerCertificateDigest:63,Data:64,WrappedKey:65,WrappingKeyIdentifier:66,WrapAlgorithm:67,KeyAlgorithm:68,Label:69,EncryptedKey:70,EncryptedNonceKey:71,WrappingKeyName:72,Action:73,FaceID:74,IPProto:75,Host:76,Port:77,MulticastInterface:78,ForwardingFlags:79,FaceInstance:80,ForwardingEntry:81,MulticastTTL:82,MinSuffixComponents:83,MaxSuffixComponents:84,ChildSelector:85,RepositoryInfo:86,Version:87,RepositoryVersion:88,GlobalPrefix:89,LocalName:90,Policy:91,Namespace:92,GlobalPrefixName:93,PolicyVersion:94,KeyValueSet:95,KeyValuePair:96,IntegerValue:97,DecimalValue:98,StringValue:99,BinaryValue:100,NameValue:101,Entry:102,ACL:103,ParameterizedName:104,Prefix:105,Suffix:106,Root:107,ProfileName:108,Parameters:109,InfoString:110,StatusResponse:112,StatusCode:113,StatusText:114,SyncNode:115,SyncNodeKind:116,SyncNodeElement:117,SyncVersion:118,SyncNodeElements:119,SyncContentHash:120,SyncLeafCount:121,SyncTreeDepth:122,SyncByteCount:123,ConfigSlice:124,ConfigSliceList:125,ConfigSliceOp:126,NDNProtocolDataUnit:17702112,NDNPROTOCOL_DATA_UNIT:"NDNProtocolDataUnit"};c.NDNProtocolDTags=d;var e=[null,null,null,null,null,null,null,null,null,null,null,null,null,"Any","Name","Component","Certificate","Collection","CompleteName","Content","SignedInfo","ContentDigest","ContentHash",null,"Count","Header","Interest","Key","KeyLocator","KeyName","Length","Link","LinkAuthenticator","NameComponentCount",null,null,"RootDigest","Signature","Start","Timestamp","Type","Nonce","Scope","Exclude","Bloom","BloomSeed",null,"AnswerOriginKind","InterestLifetime",null,null,null,null,"Witness","SignatureBits","DigestAlgorithm","BlockSize",null,"FreshnessSeconds","FinalBlockID","PublisherPublicKeyDigest","PublisherCertificateDigest","PublisherIssuerKeyDigest","PublisherIssuerCertificateDigest","Data","WrappedKey","WrappingKeyIdentifier","WrapAlgorithm","KeyAlgorithm","Label","EncryptedKey","EncryptedNonceKey","WrappingKeyName","Action","FaceID","IPProto","Host","Port","MulticastInterface","ForwardingFlags","FaceInstance","ForwardingEntry","MulticastTTL","MinSuffixComponents","MaxSuffixComponents","ChildSelector","RepositoryInfo","Version","RepositoryVersion","GlobalPrefix","LocalName","Policy","Namespace","GlobalPrefixName","PolicyVersion","KeyValueSet","KeyValuePair","IntegerValue","DecimalValue","StringValue","BinaryValue","NameValue","Entry","ACL","ParameterizedName","Prefix","Suffix","Root","ProfileName","Parameters","InfoString",null,"StatusResponse","StatusCode","StatusText","SyncNode","SyncNodeKind","SyncNodeElement","SyncVersion","SyncNodeElements","SyncContentHash","SyncLeafCount","SyncTreeDepth","SyncByteCount","ConfigSlice","ConfigSliceList","ConfigSliceOp"];c.NDNProtocolDTagsStrings=e},{}],200:[function(a,b,c){var d=a("../log.js").Log.LOG,e=function(a){this.NANOS_MAX=999877929,"number"==typeof a?this.msec=a:d>1&&console.log("UNRECOGNIZED TYPE FOR TIME")};c.NDNTime=e,e.prototype.getJavascriptDate=function(){var a=new Date;return a.setTime(this.msec),a}},{"../log.js":170}],201:[function(a,b,c){var d=a("./blob.js").Blob,e=function f(a,b,c){d.call(this,a),null==this.buffer?(this.signedPortionBeginOffset=0,this.signedPortionEndOffset=0):"object"==typeof a&&a instanceof f?(this.signedPortionBeginOffset=null==b?a.signedPortionBeginOffset:b,this.signedPortionEndOffset=null==c?a.signedPortionEndOffset:c):(this.signedPortionBeginOffset=b||0,this.signedPortionEndOffset=c||0),this.signedBuffer=null==this.buffer?null:this.buffer.slice(this.signedPortionBeginOffset,this.signedPortionEndOffset)};e.prototype=new d,e.prototype.name="SignedBlob",c.SignedBlob=e,e.prototype.signedSize=function(){return null!=this.signedBuffer?this.signedBuffer.length:0},e.prototype.signedBuf=function(){return null!=this.signedBuffer?this.signedBuffer:null},e.prototype.getSignedPortionBeginOffset=function(){return this.signedPortionBeginOffset},e.prototype.getSignedPortionEndOffset=function(){return this.signedPortionEndOffset}},{"./blob.js":194}],202:[function(a,b){function c(a,b){var c;return c=b?new e(a,b):new e(a)}var d=function(){return this}(),e=d.WebSocket||d.MozWebSocket;b.exports=e?c:null,e&&(c.prototype=e.prototype)},{}],203:[function(a,b){function c(a,b){if(!a)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function d(a,b){var c=b.getMetaInfo().getFreshnessPeriod();return this.name=b.name,this.element=a,this.freshnessPeriod=c,this.uri=b.name.toUri(),this.publisherPublicKeyDigest=b.signedInfo.publisher.publisherPublicKeyDigest,this}var e=!1;d.type="csEntry",d.prototype.getElement=function(a){return(a=a||function(a){return a})(this.element)},d.prototype.stale=function(a){return delete a.csEntry,this};var f=function(a,b){return this.nameTree=a,this.EntryClass=b||d,this};f.prototype.check=function(a,b,d,f,g,h){function i(c){return e&&console.log("toChild",g),f++,g.push(0),n?l.check(a,b,c.children[c.children.length-1],f,g,h++):l.check(a,b,c.children[0],f,g,h++)}function j(c){return e&&console.log("toSibling from ",c.prefix.toUri(),g,c),g[g.length-1]++,n?(e&&console.log(c.prefix.toUri(),g,c.parent.children[c.parent.children.length+~g[g.length-1]].prefix.toUri()),l.check(a,b,c.parent.children[c.parent.children.length+~g[g.length-1]],f,g,h++)):(e&&console.log(c.prefix.toUri(),g,c.parent.children[g[g.length-1]].prefix.toUri()),l.check(a,b,c.parent.children[g[g.length-1]],f,g,h++))}function k(a,c){if(e&&console.log("toAncestorSibling from ",a.prefix.toUri(),g),f--,g.pop(),c++>1e4)return b(null);var d=a.parent&&a.parent.parent&&a.parent.parent.children.length>g[g.length-1]+1;return d?j(a.parent):g.length>0?k(a.parent,c++):b(null)}if(b=b||function(a){return a},d=d||this.nameTree.lookup(a.name),h=h||1,h++,h++>2*Object.keys(this.nameTree).length)return console.log("stack over"),b(null);var l=this;if(d[this.EntryClass.type]&&a.matchesName(d[this.EntryClass.type].name)&&c(a.publisherPublicKeyDigest,d[this.EntryClass.type].publisherPublicKeyDigest))return d[this.EntryClass.type].getElement(b);f=f||0,g=g||[];var m=a.getMaxSuffixComponents(),n=(a.getMinSuffixComponents(),a.getChildSelector()),o=m&&f===m,p=d.children.length>0,q=function(a){return e&&console.log(g.length,a.parent.children.length,g[g.length-1]),!!g.length&&!!a.parent&&a.parent.children.length>g[g.length-1]+1};return e&&console.log(d.prefix.toUri(),a.name.toUri(),g,q(d)),1===g.length&&a.exclude.matches(d.prefix.get(-1))?q(d)?j(d):b(null):!d.prefix.size()||!o&&p?i(d):q(d)?j(d):g.length>1?k(d):b(null)},f.prototype.insert=function(a,b){var c=this.EntryClass,d=b.getMetaInfo().getFreshnessPeriod(),e=this.nameTree.lookup(b.name),f=new c(a,b);return e[c.type]=f,e[c.type].nameTreeNode=e,setTimeout(function(){e[c.type]&&e[c.type].stale(e)},d||20),this},b.exports=f},{}],204:[function(a,b){function c(a,b){return this.prefix="string"==typeof a?new e.Name(a):a,this.nextHops=function(){function a(){if(b&&b.length>0){var d=b[0].faceID?b.shift():{faceID:b.shift()},e=f(c,d,"faceID");return 0>e&&c.splice(~e,0,d),a()}return c}var c=[];return a()}(),this}function d(a){return this.nameTree=a,this}var e,f=a("./../Utility/binarySearch.js");c.type="FibEntry",c.prototype.getNextHops=function(a){if(void 0!==a){var b={faceID:a},c=f(this.nextHops,b,"faceID");return c>=0?this.nextHops.slice(0,c).concat(this.nextHops.slice(c+1)):this.nextHops}return this.nextHops},c.prototype.removeNextHop=function(a){var b=f(this.nextHops,a,"faceID");return 0>b?this:(this.nextHops.splice(b,1),this)},c.prototype.addNextHop=function(a){var b=f(this.nextHops,a,"faceID");return 0>b?(this.nextHops.splice(~b,0,a),this):(this.nextHops.splice(b,1,a),this)},d.installNDN=function(a){return e=a,this},d.prototype.lookup=function(a){a="string"==typeof a?new e.Name(a):a;var b=this.nameTree.lookup(a),c=b.fibEntry;return c?c:b.fibEntry=new d.FibEntry({prefix:a,nextHops:[]})},d.prototype.findAllFibEntries=function(a){var b=this.nameTree.findAllMatches(a,function(a){return a.fibEntry&&a.fibEntry.nextHops.length>0?!0:!1}),c={hasNext:b.hasNext,next:function(){var a=b.next();return this.hasNext=b.hasNext?!0:!1,a.fibEntry}};return c},d.prototype.findAllNextHops=function(a,b){a="string"==typeof a?new e.Name(a):a;for(var c=0,d=this.findAllFibEntries(a);d.hasNext;)for(var f=d.next(),g=f.getNextHops(b),h=0;h<g.length;h++)c|=1<<g[h].faceID;return c},d.prototype.addEntry=function(a,b){var d=new c(a,b),e=this.nameTree.lookup(d.prefix);if(e.fibEntry){for(var g=0;g<d.nextHops.length;g++){var h=f(e.fibEntry.nextHops,d.nextHops[g],"faceID");0>h&&e.fibEntry.nextHops.splice(~h,0,d.nextHops[g])}return this}return e.fibEntry=d,this},d.Entry=c,b.exports=d},{"./../Utility/binarySearch.js":212}],205:[function(a,b){var c,d,c=a("ndn-lib"),e=a("ndn-lib/js/encoding/tlv/tlv-decoder.js").TlvDecoder,f=a("ndn-lib/js/encoding/tlv/tlv.js").Tlv,g=function(a){return this.subject=a,this.transports={},d=c.Face,this};g.installNDN=function(a){return c=a,this},g.prototype.transports={},g.prototype.Faces=[],g.prototype.installTransport=function(a){return this.transports[a.prototype.name]=a,a.Listener&&a.Listener(this.newFace),this},g.prototype.newFace=function(a,b,d,g){var h=this;if(this.transports[a]){var i=new this.transports[a](b),j=new c.Face(i,i.connectionInfo);return this.Faces.push(j),j.faceID=this.Faces.length-1,j.transport.connect(j.connectionInfo,j,function(){j.onReceivedElement=function(a){var b=new e(a);b.peekType(f.Interest,a.length)?h.subject.handleInterest(a,this.faceID):b.peekType(f.Data,a.length)&&h.subject.handleData(a,this.faceID)},j.send=function(a){this.transport.send(a)},d&&d()},function(){g&&g()}),j.faceID}return-1},g.prototype.dispatch=function(a,b,c){if(b)for(var d=0;d<b.toString(2).length;d++)b&1<<d&&(this.Faces[d]&&this.Faces[d].send(a),c&&c(d));return this},b.exports=g},{"ndn-lib":140,"ndn-lib/js/encoding/tlv/tlv-decoder.js":157,"ndn-lib/js/encoding/tlv/tlv.js":160}],206:[function(a,b){var c,d=a("./NameTreeNode.js"),e=(a("./../Utility/binarySearch.js"),a("./../Utility/debug.js").NameTree,function(){return this.addNode("/"),this});e.Node=d,e.installNDN=function(a){return e.Node.installNDN(a),c=a,this},e.prototype.addNode=function(a){"string"==typeof a&&(a=new c.Name(a));var b=this[a.toUri()];if(b)return b;for(b=this[a.toUri()]=new e.Node(a);a.size()>0;){var d=a.getPrefix(-1);this[d.toUri()]||(this[d.toUri()]=new e.Node(d)),this[a.toUri()].parent=this[d.toUri()],this[d.toUri()].addChild(this[a.toUri()]),a=d}return b},e.prototype.removeNode=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||a;var d=this[a.toUri()];if(d){var e=d.children.shift();return void 0!==e?this.removeNode(e.prefix,b):(delete this[d.prefix.toUri()],b.equals(a)?(d.parent.removeChild(d),this):this.removeNode(a.getPrefix(-1),b))}return this},e.prototype.lookup=function(a){"string"==typeof a&&(a=new c.Name(a));var b=this[a.toUri()];return b?b:this.addNode(a)},e.prototype.findLongestPrefixMatch=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||function(){return!0};var d=this[a.toUri()];return d&&b(d)?d:a.size()>0?this.findLongestPrefixMatch(a.getPrefix(-1),b):null},e.prototype.findAllMatches=function(a,b){"string"==typeof a&&(a=new c.Name(a)),b=b||function(){return!0};var d,e=this,f=e[a.toUri()],g={next:function(){return this.hasNext?(a=f.prefix,d=f,f=d&&d.parent&&b(d.parent)?d.parent:a.size()>0?e.findLongestPrefixMatch(a.getPrefix(-1),b):null,this.hasNext=f?!0:!1,d):null}};return f&&b(f)?(g.hasNext=!0,g):a.size()>0?this.findAllMatches(a.getPrefix(-1),b):null},b.exports=e},{"./../Utility/binarySearch.js":212,"./../Utility/debug.js":213,"./NameTreeNode.js":207}],207:[function(a,b){var c,d=a("./../Utility/binarySearch.js"),e=a("./../Utility/debug.js"),f=function(a){return this.prefix="string"==typeof a?new c.Name(a):a||null,this.parent=null,this.children=[],this.fibEntry=null,this.pitEntries=[],this.measurements=null,this.strategy=null,this};f.installNDN=function(a){return c=a,this},f.prototype.addChild=function(a){var b=this,g=d(this.children,a.prefix.get(-1),"prefix");return a=a.prefix?a:new f(new c.Name(b.prefix).append(a)),0>g&&(e.NameTree&&console.log("adding child "+a.prefix.toUri()+" to "+b.prefix.toUri()+" at index "+~g),this.children.splice(~g,0,a)),this},f.prototype.removeChild=function(a){a="string"==typeof a?{prefix:new c.Name(a)}:a;var b=d(this.children,a.prefix.get(-1),"prefix");return 0>b?this:(this.children.splice(b,1),this)},b.exports=f},{"./../Utility/binarySearch.js":212,"./../Utility/debug.js":213}],208:[function(a,b){function c(a,b){if(!a)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function d(a,b,c){return"object"!=typeof b&&(c=b,b=new e.Interest,b.wireDecode(a)),b.nonce||b.wireDecode(a),this.nonce=b.nonce,this.uri=b.name.toUri(),this.interest=b,this.element=a,"function"==typeof c?this.callback=c:this.faceID=c,this}var e,f=a("./../Utility/binarySearch.js");d.prototype.matches=function(a){return this.interest.matchesName(a.name)&&c(this.interest.publisherPublicKeyDigest,a.signedInfo.publisher.publisherPublicKeyDigest)?!0:!1},d.prototype.consume=function(){if(this.nameTreeNode){var a=f(this.nameTreeNode.pitEntries,this,"nonce");if(a>=0){var b=this.nameTreeNode.pitEntries.splice(~a,1)[0];b.callback&&b.callback(null,b.interest)}}return this};var g=function(a){return this.nameTree=a,this};g.installNDN=function(a){return e=a,this},g.Entry=d,g.prototype.useNameTree=function(a){return this.nameTree=a,this},g.prototype.insertPitEntry=function(a,b,c){var d=new g.Entry(a,b,c);setTimeout(function(){d.consume()},d.interest.getInterestLifetimeMilliseconds()||10);var e=this.nameTree.lookup(d.interest.name),h=f(e.pitEntries,d,"nonce");return 0>h&&(d.nameTreeNode=e,e.pitEntries.splice(~h,0,d)),this},g.prototype.lookup=function(a,b,c,d){b=b||a.name,c=c||[],d=d||0;for(var e=this.nameTree.lookup(b).pitEntries,f=0;f<e.length;f++)e[f].matches(a)&&(c.push(e[f]),d|=1<<e[f].faceID);return b.size()>0?this.lookup(a,b.getPrefix(-1),c,d):{pitEntries:c,faces:d}},b.exports=g},{"./../Utility/binarySearch.js":212}],209:[function(a,b){(function(c){var d=a("ndn-lib/js/encoding/element-reader.js").ElementReader,e=a("ndn-lib/js/transport/transport.js").Transport,f=a("net"),g=function(a){var b=this;return Object.keys(a).length<=2?f.connect(a.port||7474,a.host||"localhost",function(c){b.socket=c,b.connectedHost=a.host||"localhost",b.connectedPort=a.port||7474,b.sock_ready=!0}):(this.socket=a,this.connectedHost=null,this.connectedPort=null),this
};g.prototype.name="TCPServerTransport",g.prototype=new e,g.prototype.name="messageChannelTransport",g.ConnectionInfo=function(a){e.ConnectionInfo.call(this),this.socket=a},g.ConnectionInfo.prototype=new e.ConnectionInfo,g.ConnectionInfo.prototype.name="TCPServerTransport.ConnectionInfo",g.ConnectionInfo.prototype.getSocket=function(){return this.socket},g.defineListener=function(a){a=a||7474,this.Listener=function(b){this.server=f.createServer(function(a){a.on("end",function(){console.log("server disconnected")}),b("tcpServer",a)}),this.server.listen(a,function(){})}},g.prototype.connect=function(a,b,e){this.elementReader=new d(b);var f=this;this.socket.on("data",function(a){if(console.log("got data on server tcp"),"object"==typeof a){var b=new c(a);try{f.elementReader.onReceivedData(b)}catch(d){return void console.log("NDN.TcpTransport.ondata exception: "+d)}}}),this.socket.on("error",function(){console.log("socket.onerror: TCP socket error")}),this.socket.on("close",function(){console.log("socket.onclose: TCP connection closed."),f.socket=null,face.closeByTransport()}),this.socket.on("connection",function(){console.log("new connection"),e()}),this.connectedHost=111,this.connectedPort=111},g.prototype.send=function(a){this.sock_ready?(console.log("writing data to socket"),this.socket.write(a)):console.log("TCP connection is not established.")},g.prototype.close=function(){this.socket.end(),console.log("TCP connection closed.")},b.exports=g}).call(this,a("buffer").Buffer)},{buffer:11,"ndn-lib/js/encoding/element-reader.js":152,"ndn-lib/js/transport/transport.js":191,net:10}],210:[function(a,b){(function(c){var d=a("ndn-lib/js/encoding/element-reader.js").ElementReader,e=a("ndn-lib/js/transport/transport.js").Transport,f=a("ws").Server,g=function(a){return e.call(this),this.ws=a,this};g.prototype.name="WebSocketServerTransport",g.prototype=new e,g.prototype.name="messageChannelTransport",g.ConnectionInfo=function(a){e.ConnectionInfo.call(this),this.socket=a},g.ConnectionInfo.prototype=new e.ConnectionInfo,g.ConnectionInfo.prototype.name="WebSocketServerTransport.ConnectionInfo",g.ConnectionInfo.prototype.getSocket=function(){return this.socket},g.defineListener=function(a){a=a||7575,this.Listener=function(b){this.server=new f({port:a}),this.server.on("connection",function(a){b("wsServer",a)})}},g.prototype.connect=function(a,b,e){this.elementReader=new d(b);var f=this;this.ws.on("message",function(a){if("object"==typeof a){var b=new c(a);try{f.elementReader.onReceivedData(b)}catch(d){return void console.log("NDN.TcpTransport.ondata exception: "+d)}}}),this.ws.on("error",function(){console.log("socket.onerror: TCP socket error")}),this.ws.on("close",function(){console.log("socket.onclose: TCP connection closed."),f.wst=null,b.closeByTransport()}),this.connectedHost=111,this.connectedPort=111,e()},g.prototype.send=function(a){try{this.ws.send(a,{binary:!0})}catch(b){console.log("WS connection is not established.",b)}},g.prototype.close=function(){try{this.ws.end()}catch(a){}console.log("WS connection closed.")},b.exports=g}).call(this,a("buffer").Buffer)},{buffer:11,"ndn-lib/js/encoding/element-reader.js":152,"ndn-lib/js/transport/transport.js":191,ws:202}],211:[function(a,b,c){c.TCPServer=a("./TCPServer.js"),c.WebSocketServer=a("./WebSocketServer.js"),b.exports=c},{"./TCPServer.js":209,"./WebSocketServer.js":210}],212:[function(a,b){function c(a,b,d){if(d>=0||(d=-1),d>=0||a.length==b.length){if(d++,b[d]>a[d])return 1;if(b[d]<a[d])return-1;if(a[d]==b[d])return d<a.length-1?c(a,b,d):0}else{if(b.length>a.length)return 1;if(b.length<a.length)return-1}}var d=(a("./debug.js").binaryIndexOf,function(a,b,d){"use strict";if(0==a.length)return-1;var e,f,g,h,i=0,j=a.length-1;for(b="prefix"==d?b.getValue().buffer:"nonce"==d?b.nonce:"faceID"==d?b.faceID:b;j>=i;)if(g=e=(i+j)/2|0,f="prefix"==d?a[e].prefix.get(-1).getValue().buffer:"nonce"==d?a[e].nonce:"faceID"==d?a[e].faceID:a[e],h="number"!=typeof b?c(b,f):function(){return b>f?-1:f>b?1:0}(),1==h)j=e-1;else{if(-1!=h)return e;i=e+1}return~(j+1)});b.exports=d},{"./debug.js":213}],213:[function(a,b){b.exports={NameTree:!1,binaryIndexOf:!0}},{}],214:[function(a,b){b.exports=a(61)},{"../log.js":222,"../util/ndn-protoco-id-tags.js":225,"../util/ndn-time.js":226,"./data-utils.js":216,"./decoding-exception.js":217,buffer:11}],215:[function(a,b){b.exports=a(63)},{"../util/dynamic-buffer.js":224,"./binary-xml-decoder.js":214}],216:[function(a,b){b.exports=a(65)},{buffer:11}],217:[function(a,b){b.exports=a(66)},{}],218:[function(a,b){b.exports=a(67)},{"../log.js":222,"./binary-xml-structure-decoder.js":215,"./data-utils.js":216,"./tlv/tlv-structure-decoder.js":220,"./tlv/tlv.js":221}],219:[function(a,b){b.exports=a(72)},{"../decoding-exception.js":217}],220:[function(a,b){b.exports=a(74)},{"./tlv-decoder.js":219,buffer:11}],221:[function(a,b){b.exports=a(75)},{}],222:[function(a,b){b.exports=a(85)},{}],223:[function(a,b){b.exports=a(109)},{}],224:[function(a,b){b.exports=a(114)},{buffer:11}],225:[function(a,b){b.exports=a(117)},{}],226:[function(a,b){b.exports=a(118)},{"../log.js":222}],227:[function(a,b){!function(c){"use strict";function d(b){var c={};return c.VERSION="3.5.4",c.WIRE_TYPES={},c.WIRE_TYPES.VARINT=0,c.WIRE_TYPES.BITS64=1,c.WIRE_TYPES.LDELIM=2,c.WIRE_TYPES.STARTGROUP=3,c.WIRE_TYPES.ENDGROUP=4,c.WIRE_TYPES.BITS32=5,c.PACKABLE_WIRE_TYPES=[c.WIRE_TYPES.VARINT,c.WIRE_TYPES.BITS64,c.WIRE_TYPES.BITS32],c.TYPES={int32:{name:"int32",wireType:c.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:c.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:c.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:c.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:c.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:c.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:c.WIRE_TYPES.VARINT},"double":{name:"double",wireType:c.WIRE_TYPES.BITS64},string:{name:"string",wireType:c.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:c.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:c.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:c.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:c.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:c.WIRE_TYPES.BITS64},"float":{name:"float",wireType:c.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:c.WIRE_TYPES.VARINT},message:{name:"message",wireType:c.WIRE_TYPES.LDELIM},group:{name:"group",wireType:c.WIRE_TYPES.STARTGROUP}},c.ID_MIN=1,c.ID_MAX=536870911,c.ByteBuffer=b,c.Long=b.Long||null,c.convertFieldsToCamelCase=!1,c.populateAccessors=!0,c.Util=function(){Object.create||(Object.create=function(a){function b(){}if(arguments.length>1)throw Error("Object.create polyfill only accepts the first parameter.");return b.prototype=a,new b});var b={};b.IS_NODE=!1;try{b.IS_NODE="function"==typeof a&&"function"==typeof a("fs").readFileSync&&"function"==typeof a("path").resolve}catch(c){}return b.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=null,c=0;c<a.length;c++){try{b=a[c]()}catch(d){continue}break}if(!b)throw Error("XMLHttpRequest is not supported");return b},b.fetch=function(c,d){if(d&&"function"!=typeof d&&(d=null),b.IS_NODE)if(d)a("fs").readFile(c,function(a,b){d(a?null:""+b)});else try{return a("fs").readFileSync(c)}catch(e){return null}else{var f=b.XHR();if(f.open("GET",c,d?!0:!1),f.setRequestHeader("Accept","text/plain"),"function"==typeof f.overrideMimeType&&f.overrideMimeType("text/plain"),!d)return f.send(null),200==f.status||0==f.status&&"string"==typeof f.responseText?f.responseText:null;if(f.onreadystatechange=function(){4==f.readyState&&d(200==f.status||0==f.status&&"string"==typeof f.responseText?f.responseText:null)},4==f.readyState)return;f.send(null)}},b.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},b}(),c.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i},c.DotProto=function(a,b){var c={},d=function(a){this.source=""+a,this.index=0,this.line=1,this.stack=[],this.readingString=!1,this.stringEndsWith=b.STRINGCLOSE};d.prototype._readString=function(){b.STRING.lastIndex=this.index-1;var a;if(null!==(a=b.STRING.exec(this.source))){var c=a[1];return this.index=b.STRING.lastIndex,this.stack.push(this.stringEndsWith),c}throw Error("Illegal string value at line "+this.line+", index "+this.index)},d.prototype.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var a,c;do{for(a=!1;b.WHITESPACE.test(c=this.source.charAt(this.index));)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,this.line++,a=!0}else{if("*"!==this.source.charAt(this.index))throw Error("Invalid comment at line "+this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");for(c="";c+(c=this.source.charAt(this.index))!=="*/";)if(this.index++,"\n"===c&&this.line++,this.index===this.source.length)return null;this.index++,a=!0}}while(a);if(this.index===this.source.length)return null;var d=this.index;b.DELIM.lastIndex=0;var e=b.DELIM.test(this.source.charAt(d));if(e)++d;else for(++d;d<this.source.length&&!b.DELIM.test(this.source.charAt(d));)d++;var f=this.source.substring(this.index,this.index=d);return f===b.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE):f===b.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=b.STRINGCLOSE_SQ),f},d.prototype.peek=function(){if(0===this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]},d.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"},c.Tokenizer=d;var e=function(a){this.tn=new d(a)};return e.prototype.parse=function(){for(var a,b={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},c=!0;a=this.tn.next();)switch(a){case"package":if(!c||null!==b["package"])throw Error("Illegal package at line "+this.tn.line);b["package"]=this._parsePackage(a);break;case"import":if(!c)throw Error("Illegal import at line "+this.tn.line);b.imports.push(this._parseImport(a));break;case"message":this._parseMessage(b,null,a),c=!1;break;case"enum":this._parseEnum(b,a),c=!1;break;case"option":if(!c)throw Error("Illegal option at line "+this.tn.line);this._parseOption(b,a);break;case"service":this._parseService(b,a);break;case"extend":this._parseExtend(b,a);break;case"syntax":this._parseIgnoredStatement(b,a);break;default:throw Error("Illegal token at line "+this.tn.line+": "+a)}return delete b.name,b},e.prototype._parseNumber=function(a){var c=1;if("-"==a.charAt(0)&&(c=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))return c*parseInt(a,10);if(b.NUMBER_HEX.test(a))return c*parseInt(a.substring(2),16);if(b.NUMBER_OCT.test(a))return c*parseInt(a.substring(1),8);if(b.NUMBER_FLT.test(a))return c*parseFloat(a);throw Error("Illegal number at line "+this.tn.line+": "+(0>c?"-":"")+a)},e.prototype._parseString=function(a){var c,d="";do{if(c=this.tn.next(),d+=this.tn.next(),c=this.tn.next(),c!==this.tn.stringEndsWith)throw Error("Illegal end of string in "+a+" at line "+this.tn.line+": "+c+" ('"+this.tn.stringEndsWith+"' expected)");c=this.tn.peek()}while(c===b.STRINGOPEN||c===b.STRINGOPEN_SQ);return d},e.prototype._parseId=function(a,c){var d=-1,e=1;if("-"==a.charAt(0)&&(e=-1,a=a.substring(1)),b.NUMBER_DEC.test(a))d=parseInt(a);else if(b.NUMBER_HEX.test(a))d=parseInt(a.substring(2),16);else{if(!b.NUMBER_OCT.test(a))throw Error("Illegal ID at line "+this.tn.line+": "+(0>e?"-":"")+a);d=parseInt(a.substring(1),8)}if(d=e*d|0,!c&&0>d)throw Error("Illegal ID at line "+this.tn.line+": "+(0>e?"-":"")+a);return d},e.prototype._parsePackage=function(a){if(a=this.tn.next(),!b.TYPEREF.test(a))throw Error("Illegal package at line "+this.tn.line+": "+a);var c=a;if(a=this.tn.next(),a!=b.END)throw Error("Illegal end of package at line "+this.tn.line+": "+a+" ('"+b.END+"' expected)");return c},e.prototype._parseImport=function(a){if(a=this.tn.peek(),"public"===a&&(this.tn.next(),a=this.tn.peek()),a!==b.STRINGOPEN&&a!==b.STRINGOPEN_SQ)throw Error("Illegal import at line "+this.tn.line+": "+a+" ('"+b.STRINGOPEN+"' or '"+b.STRINGOPEN_SQ+"' expected)");var c=this._parseString("root");if(a=this.tn.next(),a!==b.END)throw Error("Illegal import at line "+this.tn.line+": "+a+" ('"+b.END+"' expected)");return c},e.prototype._parseOption=function(a,c){c=this.tn.next();var d=!1;if(c==b.COPTOPEN&&(d=!0,c=this.tn.next()),!b.TYPEREF.test(c)&&!/google\.protobuf\./.test(c))throw Error("Illegal option in message "+a.name+" at line "+this.tn.line+": "+c);var e=c;if(c=this.tn.next(),d){if(c!==b.COPTCLOSE)throw Error("Illegal option in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");e="("+e+")",c=this.tn.next(),b.FQTYPEREF.test(c)&&(e+=c,c=this.tn.next())}if(c!==b.EQUAL)throw Error("Illegal option operator in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");var f;if(c=this.tn.peek(),c===b.STRINGOPEN||c===b.STRINGOPEN_SQ)f=this._parseString("message "+a.name+", option "+e);else if(this.tn.next(),b.NUMBER.test(c))f=this._parseNumber(c,!0);else if(b.BOOL.test(c))f="true"===c;else{if(!b.TYPEREF.test(c))throw Error("Illegal option value in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c);f=c}if(c=this.tn.next(),c!==b.END)throw Error("Illegal end of option in message "+a.name+", option "+e+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)");a.options[e]=f},e.prototype._parseIgnoredStatement=function(a,c){for(var d;;){if(d=this.tn.next(),null===d)throw Error("Unexpected EOF in "+a.name+", "+c+" (ignored) at line "+this.tn.line);if(d===b.END)break}},e.prototype._parseService=function(a,c){if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal service name at line "+this.tn.line+": "+c);var d=c,e={name:d,rpc:{},options:{}};if(c=this.tn.next(),c!==b.OPEN)throw Error("Illegal OPEN after service "+d+" at line "+this.tn.line+": "+c+" ('"+b.OPEN+"' expected)");do if(c=this.tn.next(),"option"===c)this._parseOption(e,c);else if("rpc"===c)this._parseServiceRPC(e,c);else if(c!==b.CLOSE)throw Error("Illegal type for service "+d+" at line "+this.tn.line+": "+c);while(c!==b.CLOSE);a.services.push(e)},e.prototype._parseServiceRPC=function(a,c){var d=c;if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal RPC method name in service "+a.name+" at line "+this.tn.line+": "+c);var e=c,f={request:null,response:null,options:{}};if(c=this.tn.next(),c!==b.COPTOPEN)throw Error("Illegal start of request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTOPEN+"' expected)");if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c);if(f.request=c,c=this.tn.next(),c!=b.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");if(c=this.tn.next(),"returns"!==c.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('returns' expected)");if(c=this.tn.next(),c!=b.COPTOPEN)throw Error("Illegal start of response type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTOPEN+"' expected)");if(c=this.tn.next(),f.response=c,c=this.tn.next(),c!==b.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.COPTCLOSE+"' expected)");if(c=this.tn.next(),c===b.OPEN){do if(c=this.tn.next(),"option"===c)this._parseOption(f,c);else if(c!==b.CLOSE)throw Error("Illegal start of option in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('option' expected)");while(c!==b.CLOSE);this.tn.peek()===b.END&&this.tn.next()}else if(c!==b.END)throw Error("Illegal method delimiter in RPC service "+a.name+"#"+e+" at line "+this.tn.line+": "+c+" ('"+b.END+"' or '"+b.OPEN+"' expected)");"undefined"==typeof a[d]&&(a[d]={}),a[d][e]=f},e.prototype._parseMessage=function(a,c,d){var e={},f="group"===d;if(d=this.tn.next(),!b.NAME.test(d))throw Error("Illegal "+(f?"group":"message")+" name"+(a?" in message "+a.name:"")+" at line "+this.tn.line+": "+d);if(e.name=d,f){if(d=this.tn.next(),d!==b.EQUAL)throw Error("Illegal id assignment after group "+e.name+" at line "+this.tn.line+": "+d+" ('"+b.EQUAL+"' expected)");d=this.tn.next();try{c.id=this._parseId(d)}catch(g){throw Error("Illegal field id value for group "+e.name+"#"+c.name+" at line "+this.tn.line+": "+d)}e.isGroup=!0}if(e.fields=[],e.enums=[],e.messages=[],e.options={},d=this.tn.next(),d===b.OPTOPEN&&c&&(this._parseFieldOptions(e,c,d),d=this.tn.next()),d!==b.OPEN)throw Error("Illegal OPEN after "+(f?"group":"message")+" "+e.name+" at line "+this.tn.line+": "+d+" ('"+b.OPEN+"' expected)");for(;;){if(d=this.tn.next(),d===b.CLOSE){d=this.tn.peek(),d===b.END&&this.tn.next();break}if(b.RULE.test(d))this._parseMessageField(e,d);else if("enum"===d)this._parseEnum(e,d);else if("message"===d)this._parseMessage(e,null,d);else if("option"===d)this._parseOption(e,d);else if("extensions"===d)e.extensions=this._parseExtensions(e,d);else{if("extend"!==d)throw Error("Illegal token in message "+e.name+" at line "+this.tn.line+": "+d+" (type or '"+b.CLOSE+"' expected)");this._parseExtend(e,d)}}return a.messages.push(e),e},e.prototype._parseMessageField=function(a,c){var d={},e=null;if(d.rule=c,d.options={},c=this.tn.next(),"group"===c){if(e=this._parseMessage(a,d,c),!/^[A-Z]/.test(e.name))throw Error("Group names must start with a capital letter");d.type=e.name,d.name=e.name.toLowerCase(),c=this.tn.peek(),c===b.END&&this.tn.next()}else{if(!b.TYPE.test(c)&&!b.TYPEREF.test(c))throw Error("Illegal field type in message "+a.name+" at line "+this.tn.line+": "+c);if(d.type=c,c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal field name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal field id assignment in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c)}catch(f){throw Error("Illegal field id value in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c)}if(c=this.tn.next(),c===b.OPTOPEN&&(this._parseFieldOptions(a,d,c),c=this.tn.next()),c!==b.END)throw Error("Illegal field delimiter in message "+a.name+"#"+d.name+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)")}a.fields.push(d)},e.prototype._parseFieldOptions=function(a,c,d){for(var e=!0;;){if(d=this.tn.next(),d===b.OPTCLOSE)break;if(d===b.OPTEND){if(e)throw Error("Illegal start of message field options in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);d=this.tn.next()}this._parseFieldOption(a,c,d),e=!1}},e.prototype._parseFieldOption=function(a,c,d){var e=!1;if(d===b.COPTOPEN&&(d=this.tn.next(),e=!0),!b.TYPEREF.test(d))throw Error("Illegal field option in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d);var f=d;if(d=this.tn.next(),e){if(d!==b.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d+" (')' expected)");f="("+f+")",d=this.tn.next(),b.FQTYPEREF.test(d)&&(f+=d,d=this.tn.next())}if(d!==b.EQUAL)throw Error("Illegal field option operation in message "+a.name+"#"+c.name+" at line "+this.tn.line+": "+d+" ('=' expected)");var g;if(d=this.tn.peek(),d===b.STRINGOPEN||d===b.STRINGOPEN_SQ)g=this._parseString("message "+a.name+"#"+c.name);else if(b.NUMBER.test(d,!0))g=this._parseNumber(this.tn.next(),!0);else if(b.BOOL.test(d))g="true"===this.tn.next().toLowerCase();else{if(!b.TYPEREF.test(d))throw Error("Illegal field option value in message "+a.name+"#"+c.name+", option "+f+" at line "+this.tn.line+": "+d);g=this.tn.next()}c.options[f]=g},e.prototype._parseEnum=function(a,c){var d={};if(c=this.tn.next(),!b.NAME.test(c))throw Error("Illegal enum name in message "+a.name+" at line "+this.tn.line+": "+c);if(d.name=c,c=this.tn.next(),c!==b.OPEN)throw Error("Illegal OPEN after enum "+d.name+" at line "+this.tn.line+": "+c);for(d.values=[],d.options={};;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c===b.END&&this.tn.next();break}if("option"==c)this._parseOption(d,c);else{if(!b.NAME.test(c))throw Error("Illegal enum value name in enum "+d.name+" at line "+this.tn.line+": "+c);this._parseEnumValue(d,c)}}a.enums.push(d)},e.prototype._parseEnumValue=function(a,c){var d={};if(d.name=c,c=this.tn.next(),c!==b.EQUAL)throw Error("Illegal enum value operator in enum "+a.name+" at line "+this.tn.line+": "+c+" ('"+b.EQUAL+"' expected)");c=this.tn.next();try{d.id=this._parseId(c,!0)}catch(e){throw Error("Illegal enum value id in enum "+a.name+" at line "+this.tn.line+": "+c)}if(a.values.push(d),c=this.tn.next(),c===b.OPTOPEN){var f={options:{}};this._parseFieldOptions(a,f,c),c=this.tn.next()}if(c!==b.END)throw Error("Illegal enum value delimiter in enum "+a.name+" at line "+this.tn.line+": "+c+" ('"+b.END+"' expected)")},e.prototype._parseExtensions=function(c,d){var e=[];if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),"to"!==d)throw Error("Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+" ('to' expected)");if(d=this.tn.next(),e.push("min"===d?a.ID_MIN:"max"===d?a.ID_MAX:this._parseNumber(d)),d=this.tn.next(),d!==b.END)throw Error("Illegal extension delimiter in message "+c.name+" at line "+this.tn.line+": "+d+" ('"+b.END+"' expected)");return e},e.prototype._parseExtend=function(a,c){if(c=this.tn.next(),!b.TYPEREF.test(c))throw Error("Illegal extended message name at line "+this.tn.line+": "+c);var d={};if(d.ref=c,d.fields=[],c=this.tn.next(),c!==b.OPEN)throw Error("Illegal OPEN in extend "+d.name+" at line "+this.tn.line+": "+c+" ('"+b.OPEN+"' expected)");for(;;){if(c=this.tn.next(),c===b.CLOSE){c=this.tn.peek(),c==b.END&&this.tn.next();break}if(!b.RULE.test(c))throw Error("Illegal token in extend "+d.name+" at line "+this.tn.line+": "+c+" (rule or '"+b.CLOSE+"' expected)");this._parseMessageField(d,c)}return a.messages.push(d),d},e.prototype.toString=function(){return"Parser"},c.Parser=e,c}(c,c.Lang),c.Reflect=function(a){function c(b,d){var e=d.readVarint32(),f=7&e,g=e>>3;switch(f){case a.WIRE_TYPES.VARINT:do e=d.readUint8();while(128===(128&e));break;case a.WIRE_TYPES.BITS64:d.offset+=8;break;case a.WIRE_TYPES.LDELIM:e=d.readVarint32(),d.offset+=e;break;case a.WIRE_TYPES.STARTGROUP:c(g,d);break;case a.WIRE_TYPES.ENDGROUP:if(g===b)return!1;throw Error("Illegal GROUPEND after unknown group: "+g+" ("+b+" expected)");case a.WIRE_TYPES.BITS32:d.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+b+": "+f)}return!0}function d(b,c){if(b&&"number"==typeof b.low&&"number"==typeof b.high&&"boolean"==typeof b.unsigned&&b.low===b.low&&b.high===b.high)return new a.Long(b.low,b.high,"undefined"==typeof c?b.unsigned:c);if("string"==typeof b)return a.Long.fromString(b,c||!1,10);if("number"==typeof b)return a.Long.fromNumber(b,c||!1);throw Error("not convertible to Long")}var e={},f=function(a,b){this.parent=a,this.name=b,this.className};f.prototype.fqn=function(){for(var a=this.name,b=this;;){if(b=b.parent,null==b)break;a=b.name+"."+a}return a},f.prototype.toString=function(a){return(a?this.className+" ":"")+this.fqn()},f.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},e.T=f;var g=function(a,b,c){f.call(this,a,b),this.className="Namespace",this.children=[],this.options=c||{}};g.prototype=Object.create(f.prototype),g.prototype.getChildren=function(a){if(a=a||null,null==a)return this.children.slice();for(var b=[],c=0,d=this.children.length;d>c;++c)this.children[c]instanceof a&&b.push(this.children[c]);return b},g.prototype.addChild=function(a){var b;if(b=this.getChild(a.name))if(b instanceof h.Field&&b.name!==b.originalName&&null===this.getChild(b.originalName))b.name=b.originalName;else{if(!(a instanceof h.Field&&a.name!==a.originalName&&null===this.getChild(a.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+a.name);a.name=a.originalName}this.children.push(a)},g.prototype.getChild=function(a){for(var b="number"==typeof a?"id":"name",c=0,d=this.children.length;d>c;++c)if(this.children[c][b]===a)return this.children[c];return null},g.prototype.resolve=function(a,b){var c=a.split("."),d=this,f=0;if(""===c[f]){for(;null!==d.parent;)d=d.parent;f++}var g;do{do{if(g=d.getChild(c[f]),!g||!(g instanceof e.T)||b&&g instanceof e.Message.Field){d=null;break}d=g,f++}while(f<c.length);if(null!=d)break;if(null!==this.parent)return this.parent.resolve(a,b)}while(null!=d);return d},g.prototype.build=function(){for(var a,b={},c=this.getChildren(),d=0,e=c.length;e>d;++d)a=c[d],a instanceof g&&(b[a.name]=a.build());return Object.defineProperty&&Object.defineProperty(b,"$options",{value:this.buildOpt()}),b},g.prototype.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0,d=b.length;d>c;++c){var e=b[c],f=this.options[b[c]];a[e]=f}return a},g.prototype.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?this.options[a]:null},e.Namespace=g;var h=function(b,c,d,e){g.call(this,b,c,d),this.className="Message",this.extensions=[a.ID_MIN,a.ID_MAX],this.clazz=null,this.isGroup=!!e};h.prototype=Object.create(g.prototype),h.prototype.build=function(c){if(this.clazz&&!c)return this.clazz;for(var d,e=function(a,c){function d(a,c){var e={};for(var f in a)a.hasOwnProperty(f)&&(null===a[f]||"object"!=typeof a[f]?e[f]=a[f]:a[f]instanceof b?c&&(e[f]=a.toBuffer()):e[f]=d(a[f],c));return e}var e=c.getChildren(a.Reflect.Message.Field),f=function(d){a.Builder.Message.call(this);for(var f,g=0,h=e.length;h>g;++g)this[(f=e[g]).name]=f.repeated?[]:null,f.required&&null!==f.defaultValue&&(this[f.name]=f.defaultValue);if(arguments.length>0)if(1!==arguments.length||"object"!=typeof d||"function"==typeof d.encode||a.Util.isArray(d)||d instanceof b||d instanceof ArrayBuffer||a.Long&&d instanceof a.Long)for(g=0,h=arguments.length;h>g;++g)this.$set(e[g].name,arguments[g]);else{var i=Object.keys(d);for(g=0,h=i.length;h>g;++g)this.$set(i[g],d[i[g]])}Object.defineProperty&&Object.defineProperty(this,"$type",{get:function(){return c}})};f.prototype=Object.create(a.Builder.Message.prototype),f.prototype.add=function(b,d,e){var f=c.getChild(b);if(!f)throw Error(this+"#"+b+" is undefined");if(!(f instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+b+" is not a repeated field");null===this[f.name]&&(this[f.name]=[]),this[f.name].push(e?d:f.verifyValue(d,!0))},f.prototype.$add=f.prototype.add,f.prototype.set=function(b,d,e){if(b&&"object"==typeof b){for(var f in b)b.hasOwnProperty(f)&&this.$set(f,b[f],e);return this}if(e)return this[b]=d,this;var g=c.getChild(b);if(!g)throw Error(this+"#"+b+" is not a field: undefined");if(!(g instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+g.toString(!0));return this[g.name]=g.verifyValue(d),this},f.prototype.$set=f.prototype.set,f.prototype.get=function(b,d){if(d)return this[b];var e=c.getChild(b);if(!(e&&e instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: undefined");if(!(e instanceof a.Reflect.Message.Field))throw Error(this+"#"+b+" is not a field: "+e.toString(!0));return this[e.name]},f.prototype.$get=f.prototype.get;for(var g=0;g<e.length;g++){var h=e[g];h instanceof a.Reflect.Message.ExtensionField||a.populateAccessors&&function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")});b=b.substring(0,1).toUpperCase()+b.substring(1);var d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a});null===c.getChild("set"+b)&&(f.prototype["set"+b]=function(b){this.$set(a.name,b)}),null===c.getChild("set_"+d)&&(f.prototype["set_"+d]=function(b){this.$set(a.name,b)}),null===c.getChild("get"+b)&&(f.prototype["get"+b]=function(){return this.$get(a.name)}),null===c.getChild("get_"+d)&&(f.prototype["get_"+d]=function(){return this.$get(a.name)})}(h)}f.prototype.encode=function(a,d){"boolean"==typeof a&&(d=a,a=void 0);var e=!1;a||(a=new b,e=!0);var f=a.littleEndian;try{return c.encode(this,a.LE(),d),(e?a.flip():a).LE(f)}catch(g){throw a.LE(f),g}},f.prototype.calculate=function(){return c.calculate(this)},f.prototype.encodeDelimited=function(a){var d=!1;a||(a=new b,d=!0);var e=(new b).LE();return c.encode(this,e).flip(),a.writeVarint32(e.remaining()),a.append(e),d?a.flip():a},f.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toArrayBuffer()),a}},f.prototype.toArrayBuffer=f.prototype.encodeAB,f.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a}},f.prototype.toBuffer=f.prototype.encodeNB,f.prototype.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a}},f.prototype.toBase64=f.prototype.encode64,f.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toHex()),a}},f.prototype.toHex=f.prototype.encodeHex,f.prototype.toRaw=function(a){return d(this,!!a)},f.decode=function(a,d){"string"==typeof a&&(a=b.wrap(a,d?d:"base64")),a=a instanceof b?a:b.wrap(a);var e=a.littleEndian;try{var f=c.decode(a.LE());return a.LE(e),f}catch(g){throw a.LE(e),g}},f.decodeDelimited=function(a,d){if("string"==typeof a&&(a=b.wrap(a,d?d:"base64")),a=a instanceof b?a:b.wrap(a),a.remaining()<1)return null;var e=a.offset,f=a.readVarint32();if(a.remaining()<f)return a.offset=e,null;try{var g=c.decode(a.slice(a.offset,a.offset+f).LE());return a.offset+=f,g}catch(h){throw a.offset+=f,h}},f.decode64=function(a){return f.decode(a,"base64")},f.decodeHex=function(a){return f.decode(a,"hex")},f.prototype.toString=function(){return c.toString()};return Object.defineProperty&&Object.defineProperty(f,"$options",{value:c.buildOpt()}),f}(a,this),f=this.getChildren(),g=0,i=f.length;i>g;g++)if(d=f[g],d instanceof k)e[d.name]=d.build();else if(d instanceof h)e[d.name]=d.build();else if(d instanceof h.Field)d.build();else if(!(d instanceof m))throw Error("Illegal reflect child of "+this.toString(!0)+": "+f[g].toString(!0));return this.clazz=e},h.prototype.encode=function(a,b,c){for(var d,e,f=null,g=0,i=this.children.length;i>g;++g)d=this.children[g],d instanceof h.Field&&(e=a[d.name],d.required&&null===e?null===f&&(f=d):d.encode(c?e:d.verifyValue(e),b));if(null!==f){var j=Error("Missing at least one required field for "+this.toString(!0)+": "+f);throw j.encoded=b,j}return b},h.prototype.calculate=function(a){for(var b,c=this.getChildren(h.Field),d=0,e=0;e<c.length;e++){if(b=a.$get(c[e].name),c[e].required&&null===b)throw Error("Missing at least one required field for "+this.toString(!0)+": "+c[e]);
d+=c[e].calculate(b)}return d},h.prototype.decode=function(b,d,e){d="number"==typeof d?d:-1;for(var f,g,i,j=b.offset,k=new this.clazz,l={},m=0,n=this.children.length;n>m;++m){var o=this.children[m];o instanceof h.Field&&(l[o.id]=o)}for(;b.offset<j+d||-1===d&&b.remaining()>0;){if(f=b.readVarint32(),g=7&f,i=f>>3,g===a.WIRE_TYPES.ENDGROUP){if(i!==e)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+i+" ("+(e?e+" expected":"not a group")+")");break}if(o=l[i])o.repeated&&!o.options.packed?k[o.name].push(o.decode(g,b)):k[o.name]=o.decode(g,b);else switch(g){case a.WIRE_TYPES.VARINT:b.readVarint32();break;case a.WIRE_TYPES.BITS32:b.offset+=4;break;case a.WIRE_TYPES.BITS64:b.offset+=8;break;case a.WIRE_TYPES.LDELIM:var p=b.readVarint32();b.offset+=p;break;case a.WIRE_TYPES.STARTGROUP:for(;c(i,b););break;default:throw Error("Illegal wire type for unknown field "+i+" in "+this.toString(!0)+"#decode: "+g)}}for(m=0,n=this.children.length;n>m;++m)if(o=this.children[m],o instanceof h.Field&&null===k[o.name]){if(o.required){var q=Error("Missing at least one required field for "+this.toString(!0)+": "+o.name);throw q.decoded=k,q}null!==o.defaultValue&&(k[o.name]=o.defaultValue)}return k},e.Message=h;var i=function(b,c,d,e,g,i){f.call(this,b,e),this.className="Message.Field",this.required="required"===c,this.repeated="repeated"===c,this.type=d,this.resolvedType=null,this.id=g,this.options=i||{},this.defaultValue=null,this.originalName=this.name,!a.convertFieldsToCamelCase||this instanceof h.ExtensionField||(this.name=this.name.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()}))};i.prototype=Object.create(f.prototype),i.prototype.build=function(){this.defaultValue="undefined"!=typeof this.options["default"]?this.verifyValue(this.options["default"]):null},i.prototype.verifyValue=function(c,e){e=e||!1;var f=function(a,b){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+a+" ("+b+")")}.bind(this);if(null===c)return this.required&&f(typeof c,"required"),null;var g;if(this.repeated&&!e){a.Util.isArray(c)||(c=[c]);var h=[];for(g=0;g<c.length;g++)h.push(this.verifyValue(c[g],!0));return h}switch(!this.repeated&&a.Util.isArray(c)&&f(typeof c,"no array expected"),this.type){case a.TYPES.int32:case a.TYPES.sint32:case a.TYPES.sfixed32:return("number"!=typeof c||c===c&&c%1!==0)&&f(typeof c,"not an integer"),c>4294967295?0|c:c;case a.TYPES.uint32:case a.TYPES.fixed32:return("number"!=typeof c||c===c&&c%1!==0)&&f(typeof c,"not an integer"),0>c?c>>>0:c;case a.TYPES.int64:case a.TYPES.sint64:case a.TYPES.sfixed64:if(a.Long)try{return d(c,!1)}catch(i){f(typeof c,i.message)}else f(typeof c,"requires Long.js");case a.TYPES.uint64:case a.TYPES.fixed64:if(a.Long)try{return d(c,!0)}catch(i){f(typeof c,i.message)}else f(typeof c,"requires Long.js");case a.TYPES.bool:return"boolean"!=typeof c&&f(typeof c,"not a boolean"),c;case a.TYPES["float"]:case a.TYPES["double"]:return"number"!=typeof c&&f(typeof c,"not a number"),c;case a.TYPES.string:return"string"==typeof c||c&&c instanceof String||f(typeof c,"not a string"),""+c;case a.TYPES.bytes:return c&&c instanceof b?c:b.wrap(c);case a.TYPES["enum"]:var j=this.resolvedType.getChildren(k.Value);for(g=0;g<j.length;g++){if(j[g].name==c)return j[g].id;if(j[g].id==c)return j[g].id}f(c,"not a valid enum value");case a.TYPES.group:case a.TYPES.message:if(c&&"object"==typeof c||f(typeof c,"object expected"),c instanceof this.resolvedType.clazz)return c;if(c instanceof a.Builder.Message){var l={};for(var g in c)c.hasOwnProperty(g)&&(l[g]=c[g]);c=l}return new this.resolvedType.clazz(c)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+c+" (undefined type "+this.type+")")},i.prototype.encode=function(c,d){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return d;try{if(this.repeated){var e;if(this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){d.writeVarint32(this.id<<3|a.WIRE_TYPES.LDELIM),d.ensureCapacity(d.offset+=1);var f=d.offset;for(e=0;e<c.length;e++)this.encodeValue(c[e],d);var g=d.offset-f,h=b.calculateVarint32(g);if(h>1){var i=d.slice(f,d.offset);f+=h-1,d.offset=f,d.append(i)}d.writeVarint32(g,f-h)}else for(e=0;e<c.length;e++)d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c[e],d)}else d.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(c,d)}catch(j){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+j+")")}return d},i.prototype.encodeValue=function(c,d){if(null===c)return d;switch(this.type){case a.TYPES.int32:0>c?d.writeVarint64(c):d.writeVarint32(c);break;case a.TYPES.uint32:d.writeVarint32(c);break;case a.TYPES.sint32:d.writeVarint32ZigZag(c);break;case a.TYPES.fixed32:d.writeUint32(c);break;case a.TYPES.sfixed32:d.writeInt32(c);break;case a.TYPES.int64:case a.TYPES.uint64:d.writeVarint64(c);break;case a.TYPES.sint64:d.writeVarint64ZigZag(c);break;case a.TYPES.fixed64:d.writeUint64(c);break;case a.TYPES.sfixed64:d.writeInt64(c);break;case a.TYPES.bool:d.writeVarint32("string"==typeof c?"false"===c.toLowerCase()?0:!!c:c?1:0);break;case a.TYPES["enum"]:d.writeVarint32(c);break;case a.TYPES["float"]:d.writeFloat32(c);break;case a.TYPES["double"]:d.writeFloat64(c);break;case a.TYPES.string:d.writeVString(c);break;case a.TYPES.bytes:if(c.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+c.remaining()+" bytes remaining");var e=c.offset;d.writeVarint32(c.remaining()),d.append(c),c.offset=e;break;case a.TYPES.message:var f=(new b).LE();this.resolvedType.encode(c,f),d.writeVarint32(f.offset),d.append(f.flip());break;case a.TYPES.group:this.resolvedType.encode(c,d),d.writeVarint32(this.id<<3|a.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+c+" (unknown type)")}return d},i.prototype.calculate=function(c){if(c=this.verifyValue(c),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return 0;var d=0;try{if(this.repeated){var e,f;if(this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(d+=b.calculateVarint32(this.id<<3|a.WIRE_TYPES.LDELIM),f=0,e=0;e<c.length;e++)f+=this.calculateValue(c[e]);d+=b.calculateVarint32(f),d+=f}else for(e=0;e<c.length;e++)d+=b.calculateVarint32(this.id<<3|this.type.wireType),d+=this.calculateValue(c[e])}else d+=b.calculateVarint32(this.id<<3|this.type.wireType),d+=this.calculateValue(c)}catch(g){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+g+")")}return d},i.prototype.calculateValue=function(c){if(null===c)return 0;var d;switch(this.type){case a.TYPES.int32:return 0>c?b.calculateVarint64(c):b.calculateVarint32(c);case a.TYPES.uint32:return b.calculateVarint32(c);case a.TYPES.sint32:return b.calculateVarint32(b.zigZagEncode32(c));case a.TYPES.fixed32:case a.TYPES.sfixed32:case a.TYPES["float"]:return 4;case a.TYPES.int64:case a.TYPES.uint64:return b.calculateVarint64(c);case a.TYPES.sint64:return b.calculateVarint64(b.zigZagEncode64(c));case a.TYPES.fixed64:case a.TYPES.sfixed64:return 8;case a.TYPES.bool:return 1;case a.TYPES["enum"]:return b.calculateVarint32(c);case a.TYPES["double"]:return 8;case a.TYPES.string:return d=b.calculateUTF8Bytes(c),b.calculateVarint32(d)+d;case a.TYPES.bytes:if(c.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+c.remaining()+" bytes remaining");return b.calculateVarint32(c.remaining())+c.remaining();case a.TYPES.message:return d=this.resolvedType.calculate(c),b.calculateVarint32(d)+d;case a.TYPES.group:return d=this.resolvedType.calculate(c),d+b.calculateVarint32(this.id<<3|a.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+c+" (unknown type)")},i.prototype.decode=function(b,c,d){var e,f;if(b!=this.type.wireType&&(d||b!=a.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+b+" ("+this.type.wireType+" expected)");if(b==a.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&a.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!d){f=c.readVarint32(),f=c.offset+f;for(var g=[];c.offset<f;)g.push(this.decode(this.type.wireType,c,!0));return g}switch(this.type){case a.TYPES.int32:return 0|c.readVarint32();case a.TYPES.uint32:return c.readVarint32()>>>0;case a.TYPES.sint32:return 0|c.readVarint32ZigZag();case a.TYPES.fixed32:return c.readUint32()>>>0;case a.TYPES.sfixed32:return 0|c.readInt32();case a.TYPES.int64:return c.readVarint64();case a.TYPES.uint64:return c.readVarint64().toUnsigned();case a.TYPES.sint64:return c.readVarint64ZigZag();case a.TYPES.fixed64:return c.readUint64();case a.TYPES.sfixed64:return c.readInt64();case a.TYPES.bool:return!!c.readVarint32();case a.TYPES["enum"]:return c.readVarint32();case a.TYPES["float"]:return c.readFloat();case a.TYPES["double"]:return c.readDouble();case a.TYPES.string:return c.readVString();case a.TYPES.bytes:if(f=c.readVarint32(),c.remaining()<f)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+f+" required but got only "+c.remaining());return e=c.clone(),e.limit=e.offset+f,c.offset+=f,e;case a.TYPES.message:return f=c.readVarint32(),this.resolvedType.decode(c,f);case a.TYPES.group:return this.resolvedType.decode(c,-1,this.id)}throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+b)},e.Message.Field=i;var j=function(a,b,c,d,e,f){i.call(this,a,b,c,d,e,f),this.extension};j.prototype=Object.create(i.prototype),e.Message.ExtensionField=j;var k=function(a,b,c){g.call(this,a,b,c),this.className="Enum",this.object=null};k.prototype=Object.create(g.prototype),k.prototype.build=function(){for(var a={},b=this.getChildren(k.Value),c=0,d=b.length;d>c;++c)a[b[c].name]=b[c].id;return Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt()}),this.object=a},e.Enum=k;var l=function(a,b,c){f.call(this,a,b),this.className="Enum.Value",this.id=c};l.prototype=Object.create(f.prototype),e.Enum.Value=l;var m=function(a,b,c){f.call(this,a,b),this.field=c};m.prototype=Object.create(f.prototype),e.Extension=m;var n=function(a,b,c){g.call(this,a,b,c),this.className="Service",this.clazz=null};n.prototype=Object.create(g.prototype),n.prototype.build=function(b){return this.clazz&&!b?this.clazz:this.clazz=function(a,b){var c=function(b){a.Builder.Service.call(this),this.rpcImpl=b||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};c.prototype=Object.create(a.Builder.Service.prototype),Object.defineProperty&&(Object.defineProperty(c,"$options",{value:b.buildOpt()}),Object.defineProperty(c.prototype,"$options",{value:c.$options}));for(var d=b.getChildren(a.Reflect.Service.RPCMethod),e=0;e<d.length;e++)!function(a){c.prototype[a.name]=function(c,d){try{if(!(c&&c instanceof a.resolvedRequestType.clazz))return void setTimeout(d.bind(this,Error("Illegal request type provided to service method "+b.name+"#"+a.name)),0);this.rpcImpl(a.fqn(),c,function(c,e){if(c)return void d(c);try{e=a.resolvedResponseType.clazz.decode(e)}catch(f){}return e&&e instanceof a.resolvedResponseType.clazz?void d(null,e):void d(Error("Illegal response type received in service method "+b.name+"#"+a.name))})}catch(e){setTimeout(d.bind(this,e),0)}},c[a.name]=function(b,d,e){new c(b)[a.name](d,e)},Object.defineProperty&&(Object.defineProperty(c[a.name],"$options",{value:a.buildOpt()}),Object.defineProperty(c.prototype[a.name],"$options",{value:c[a.name].$options}))}(d[e]);return c}(a,this)},e.Service=n;var o=function(a,b,c){f.call(this,a,b),this.className="Service.Method",this.options=c||{}};o.prototype=Object.create(f.prototype),o.prototype.buildOpt=g.prototype.buildOpt,e.Service.Method=o;var p=function(a,b,c,d,e){o.call(this,a,b,e),this.className="Service.RPCMethod",this.requestName=c,this.responseName=d,this.resolvedRequestType=null,this.resolvedResponseType=null};return p.prototype=Object.create(o.prototype),e.Service.RPCMethod=p,e}(c),c.Builder=function(b,c,d){var e=function(){this.ns=new d.Namespace(null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null};return e.prototype.reset=function(){this.ptr=this.ns},e.prototype.define=function(a,b){if("string"!=typeof a||!c.TYPEREF.test(a))throw Error("Illegal package: "+a);var e,f=a.split(".");for(e=0;e<f.length;e++)if(!c.NAME.test(f[e]))throw Error("Illegal package: "+f[e]);for(e=0;e<f.length;e++)null===this.ptr.getChild(f[e])&&this.ptr.addChild(new d.Namespace(this.ptr,f[e],b)),this.ptr=this.ptr.getChild(f[e]);return this},e.isValidMessage=function(a){if("string"!=typeof a.name||!c.NAME.test(a.name))return!1;if("undefined"!=typeof a.values||"undefined"!=typeof a.rpc)return!1;var d;if("undefined"!=typeof a.fields){if(!b.Util.isArray(a.fields))return!1;var f,g=[];for(d=0;d<a.fields.length;d++){if(!e.isValidMessageField(a.fields[d]))return!1;if(f=parseInt(a.fields[d].id,10),g.indexOf(f)>=0)return!1;g.push(f)}g=null}if("undefined"!=typeof a.enums){if(!b.Util.isArray(a.enums))return!1;for(d=0;d<a.enums.length;d++)if(!e.isValidEnum(a.enums[d]))return!1}if("undefined"!=typeof a.messages){if(!b.Util.isArray(a.messages))return!1;for(d=0;d<a.messages.length;d++)if(!e.isValidMessage(a.messages[d])&&!e.isValidExtend(a.messages[d]))return!1}return"undefined"==typeof a.extensions||b.Util.isArray(a.extensions)&&2===a.extensions.length&&"number"==typeof a.extensions[0]&&"number"==typeof a.extensions[1]?!0:!1},e.isValidMessageField=function(a){if("string"!=typeof a.rule||"string"!=typeof a.name||"string"!=typeof a.type||"undefined"==typeof a.id)return!1;if(!(c.RULE.test(a.rule)&&c.NAME.test(a.name)&&c.TYPEREF.test(a.type)&&c.ID.test(""+a.id)))return!1;if("undefined"!=typeof a.options){if("object"!=typeof a.options)return!1;for(var b,d=Object.keys(a.options),e=0;e<d.length;e++)if("string"!=typeof(b=d[e])||"string"!=typeof a.options[b]&&"number"!=typeof a.options[b]&&"boolean"!=typeof a.options[b])return!1}return!0},e.isValidEnum=function(a){if("string"!=typeof a.name||!c.NAME.test(a.name))return!1;if("undefined"==typeof a.values||!b.Util.isArray(a.values)||0==a.values.length)return!1;for(var d=0;d<a.values.length;d++){if("object"!=typeof a.values[d])return!1;if("string"!=typeof a.values[d].name||"undefined"==typeof a.values[d].id)return!1;if(!c.NAME.test(a.values[d].name)||!c.NEGID.test(""+a.values[d].id))return!1}return!0},e.prototype.create=function(a){if(!a)return this;if(b.Util.isArray(a)||(a=[a]),0==a.length)return this;var c,f,g,h,i,j=[];for(j.push(a);j.length>0;){if(a=j.pop(),!b.Util.isArray(a))throw Error("Not a valid namespace: "+JSON.stringify(a));for(;a.length>0;){if(c=a.shift(),e.isValidMessage(c)){if(f=new d.Message(this.ptr,c.name,c.options,c.isGroup),c.fields&&c.fields.length>0)for(h=0;h<c.fields.length;h++){if(null!==f.getChild(c.fields[h].id))throw Error("Duplicate field id in message "+f.name+": "+c.fields[h].id);if(c.fields[h].options){for(g=Object.keys(c.fields[h].options),i=0;i<g.length;i++){if("string"!=typeof g[i])throw Error("Illegal field option name in message "+f.name+"#"+c.fields[h].name+": "+g[i]);if("string"!=typeof c.fields[h].options[g[i]]&&"number"!=typeof c.fields[h].options[g[i]]&&"boolean"!=typeof c.fields[h].options[g[i]])throw Error("Illegal field option value in message "+f.name+"#"+c.fields[h].name+"#"+g[i]+": "+c.fields[h].options[g[i]])}g=null}f.addChild(new d.Message.Field(f,c.fields[h].rule,c.fields[h].type,c.fields[h].name,c.fields[h].id,c.fields[h].options))}if(g=[],"undefined"!=typeof c.enums&&c.enums.length>0)for(h=0;h<c.enums.length;h++)g.push(c.enums[h]);if(c.messages&&c.messages.length>0)for(h=0;h<c.messages.length;h++)g.push(c.messages[h]);if(c.extensions&&(f.extensions=c.extensions,f.extensions[0]<b.ID_MIN&&(f.extensions[0]=b.ID_MIN),f.extensions[1]>b.ID_MAX&&(f.extensions[1]=b.ID_MAX)),this.ptr.addChild(f),g.length>0){j.push(a),a=g,g=null,this.ptr=f,f=null;continue}g=null,f=null}else if(e.isValidEnum(c)){for(f=new d.Enum(this.ptr,c.name,c.options),h=0;h<c.values.length;h++)f.addChild(new d.Enum.Value(f,c.values[h].name,c.values[h].id));this.ptr.addChild(f),f=null}else if(e.isValidService(c)){f=new d.Service(this.ptr,c.name,c.options);for(h in c.rpc)c.rpc.hasOwnProperty(h)&&f.addChild(new d.Service.RPCMethod(f,h,c.rpc[h].request,c.rpc[h].response,c.rpc[h].options));this.ptr.addChild(f),f=null}else{if(!e.isValidExtend(c))throw Error("Not a valid definition: "+JSON.stringify(c));if(f=this.ptr.resolve(c.ref))for(h=0;h<c.fields.length;h++){if(null!==f.getChild(c.fields[h].id))throw Error("Duplicate extended field id in message "+f.name+": "+c.fields[h].id);if(c.fields[h].id<f.extensions[0]||c.fields[h].id>f.extensions[1])throw Error("Illegal extended field id in message "+f.name+": "+c.fields[h].id+" ("+f.extensions.join(" to ")+" expected)");var k=new d.Message.ExtensionField(f,c.fields[h].rule,c.fields[h].type,this.ptr.fqn()+"."+c.fields[h].name,c.fields[h].id,c.fields[h].options),l=new d.Extension(this.ptr,c.fields[h].name,k);k.extension=l,this.ptr.addChild(l),f.addChild(k)}else if(!/\.?google\.protobuf\./.test(c.ref))throw Error("Extended message "+c.ref+" is not defined")}c=null}a=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},e.prototype["import"]=function(c,d){if("string"==typeof d){if(b.Util.IS_NODE&&(d=a("path").resolve(d)),this.files[d]===!0)return this.reset(),this;this.files[d]=!0}if(c.imports&&c.imports.length>0){var e,f="/",g=!1;"object"==typeof d?(this.importRoot=d.root,g=!0,e=this.importRoot,d=d.file,(e.indexOf("\\")>=0||d.indexOf("\\")>=0)&&(f="\\")):"string"==typeof d?this.importRoot?e=this.importRoot:d.indexOf("/")>=0?(e=d.replace(/\/[^\/]*$/,""),""===e&&(e="/")):d.indexOf("\\")>=0?(e=d.replace(/\\[^\\]*$/,""),f="\\"):e=".":e=null;for(var h=0;h<c.imports.length;h++)if("string"==typeof c.imports[h]){if(!e)throw Error("Cannot determine import root: File name is unknown");var i=c.imports[h];if(/^google\/protobuf\//.test(i))continue;if(i=e+f+i,this.files[i]===!0)continue;/\.proto$/i.test(i)&&!b.DotProto&&(i=i.replace(/\.proto$/,".json"));var j=b.Util.fetch(i);if(null===j)throw Error("Failed to import '"+i+"' in '"+d+"': File not found");/\.json$/i.test(i)?this["import"](JSON.parse(j+""),i):this["import"](new b.DotProto.Parser(j+"").parse(),i)}else d?/\.(\w+)$/.test(d)?this["import"](c.imports[h],d.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+h+"."+c})):this["import"](c.imports[h],d+"_import"+h):this["import"](c.imports[h]);g&&(this.importRoot=null)}return c.messages&&(c["package"]&&this.define(c["package"],c.options),this.create(c.messages),this.reset()),c.enums&&(c["package"]&&this.define(c["package"],c.options),this.create(c.enums),this.reset()),c.services&&(c["package"]&&this.define(c["package"],c.options),this.create(c.services),this.reset()),c["extends"]&&(c["package"]&&this.define(c["package"],c.options),this.create(c["extends"]),this.reset()),this},e.isValidService=function(a){return!("string"!=typeof a.name||!c.NAME.test(a.name)||"object"!=typeof a.rpc)},e.isValidExtend=function(a){if("string"!=typeof a.ref||!c.TYPEREF.test(a.ref))return!1;var d;if("undefined"!=typeof a.fields){if(!b.Util.isArray(a.fields))return!1;var f,g=[];for(d=0;d<a.fields.length;d++){if(!e.isValidMessageField(a.fields[d]))return!1;if(f=parseInt(a.id,10),g.indexOf(f)>=0)return!1;g.push(f)}g=null}return!0},e.prototype.resolveAll=function(){var a;if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof d.Namespace)for(var e=this.ptr.getChildren(),f=0;f<e.length;f++)this.ptr=e[f],this.resolveAll();else if(this.ptr instanceof d.Message.Field)if(c.TYPE.test(this.ptr.type))this.ptr.type=b.TYPES[this.ptr.type];else{if(!c.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(a=(this.ptr instanceof d.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!a)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=a,a instanceof d.Enum)this.ptr.type=b.TYPES["enum"];else{if(!(a instanceof d.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=a.isGroup?b.TYPES.group:b.TYPES.message}}else if(this.ptr instanceof b.Reflect.Enum.Value);else if(this.ptr instanceof b.Reflect.Service.Method){if(!(this.ptr instanceof b.Reflect.Service.RPCMethod))throw Error("Illegal service type in "+this.ptr.toString(!0));if(a=this.ptr.parent.resolve(this.ptr.requestName),!(a&&a instanceof b.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=a,a=this.ptr.parent.resolve(this.ptr.responseName),!(a&&a instanceof b.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=a}else if(!(this.ptr instanceof b.Reflect.Extension))throw Error("Illegal object in namespace: "+typeof this.ptr+":"+this.ptr);this.reset()}},e.prototype.build=function(a){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),a){for(var b=a.split("."),c=this.result,d=0;d<b.length;d++){if(!c[b[d]]){c=null;break}c=c[b[d]]}return c}return this.result},e.prototype.lookup=function(a){return a?this.ns.resolve(a):this.ns},e.prototype.toString=function(){return"Builder"},e.Message=function(){},e.Service=function(){},e}(c,c.Lang,c.Reflect),c.loadProto=function(a,b,d){return("string"==typeof b||b&&"string"==typeof b.file&&"string"==typeof b.root)&&(d=b,b=null),c.loadJson(new c.DotProto.Parser(a).parse(),b,d)},c.protoFromString=c.loadProto,c.loadProtoFile=function(a,b,d){if(b&&"object"==typeof b?(d=b,b=null):b&&"function"==typeof b||(b=null),b)return c.Util.fetch("string"==typeof a?a:a.root+"/"+a.file,function(e){if(null===e)return void b(Error("Failed to fetch file"));try{b(null,c.loadProto(e,d,a))}catch(f){b(f)}});var e=c.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null===e?null:c.loadProto(e,d,a)},c.protoFromFile=c.loadProtoFile,c.newBuilder=function(a,b){var d=new c.Builder;return"undefined"!=typeof a&&null!==a&&d.define(a,b),d},c.loadJson=function(a,b,d){return("string"==typeof b||b&&"string"==typeof b.file&&"string"==typeof b.root)&&(d=b,b=null),b&&"object"==typeof b||(b=c.newBuilder()),"string"==typeof a&&(a=JSON.parse(a)),b["import"](a,d),b.resolveAll(),b.build(),b},c.loadJsonFile=function(a,b,d){if(b&&"object"==typeof b?(d=b,b=null):b&&"function"==typeof b||(b=null),b)return c.Util.fetch("string"==typeof a?a:a.root+"/"+a.file,function(e){if(null===e)return void b(Error("Failed to fetch file"));try{b(null,c.loadJson(JSON.parse(e),d,a))}catch(f){b(f)}});var e=c.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null===e?null:c.loadJson(JSON.parse(e),d,a)},c}"undefined"!=typeof b&&b.exports?b.exports=d(a("bytebuffer")):"function"==typeof define&&define.amd?define(["ByteBuffer"],d):(c.dcodeIO=c.dcodeIO||{}).ProtoBuf=d(c.dcodeIO.ByteBuffer)}(this)},{bytebuffer:228,fs:10,path:30}],228:[function(a,b){!function(c){function d(a){function b(a,d,e){if("undefined"==typeof a&&(a=b.DEFAULT_CAPACITY),"undefined"==typeof d&&(d=b.DEFAULT_ENDIAN),"undefined"==typeof e&&(e=b.DEFAULT_NOASSERT),!e){if(a|=0,0>a)throw new RangeError("Illegal capacity: 0 <= "+a);if("boolean"!=typeof d)throw new TypeError("Illegal littleEndian: Not a boolean");if("boolean"!=typeof e)throw new TypeError("Illegal noAssert: Not a boolean")}this.buffer=0===a?c:new ArrayBuffer(a),this.view=0===a?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=a,this.littleEndian="undefined"!=typeof d?!!d:!1,this.noAssert=!!e}b.VERSION="3.2.2",b.LITTLE_ENDIAN=!0,b.BIG_ENDIAN=!1,b.DEFAULT_CAPACITY=16,b.DEFAULT_ENDIAN=b.BIG_ENDIAN,b.DEFAULT_NOASSERT=!1,b.Long=a||null;var c=new ArrayBuffer(0);b.allocate=function(a,c,d){return new b(a,c,d)},b.concat=function(a,c,d,e){("boolean"==typeof c||"string"!=typeof c)&&(e=d,d=c,c=void 0);for(var f,g=0,h=0,i=a.length;i>h;++h)b.isByteBuffer(a[h])||(a[h]=b.wrap(a[h],c)),f=a[h].limit-a[h].offset,f>0&&(g+=f);if(0===g)return new b(0,d,e);for(c=new b(g,d,e),e=new Uint8Array(c.buffer),h=0;i>h;)d=a[h++],f=d.limit-d.offset,0>=f||(e.set(new Uint8Array(d.buffer).subarray(d.offset,d.limit),c.offset),c.offset+=f);return c.limit=c.offset,c.offset=0,c},b.isByteBuffer=function(a){return a&&a instanceof b},b.type=function(){return ArrayBuffer},b.wrap=function(a,c,d,e){if("string"!=typeof c&&(e=d,d=c,c=void 0),"string"==typeof a)switch("undefined"==typeof c&&(c="utf8"),c){case"base64":return b.fromBase64(a,d);case"hex":return b.fromHex(a,d);case"binary":return b.fromBinary(a,d);case"utf8":return b.fromUTF8(a,d);case"debug":return b.fromDebug(a,d);default:throw new TypeError("Unsupported encoding: "+c)}if(null===a||"object"!=typeof a)throw new TypeError("Illegal buffer: null or non-object");if(b.isByteBuffer(a))return c=b.prototype.clone.call(a),c.markedOffset=-1,c;if(a instanceof Uint8Array)c=new b(0,d,e),0<a.length&&(c.buffer=a.buffer,c.offset=a.byteOffset,c.limit=a.byteOffset+a.length,c.view=0<a.length?new DataView(a.buffer):null);else if(a instanceof ArrayBuffer)c=new b(0,d,e),0<a.byteLength&&(c.buffer=a,c.offset=0,c.limit=a.byteLength,c.view=0<a.byteLength?new DataView(a):null);else{if("[object Array]"!==Object.prototype.toString.call(a))throw new TypeError("Illegal buffer");for(c=new b(a.length,d,e),c.limit=a.length,i=0;i<a.length;++i)c.view.setUint8(i,a[i])}return c},b.prototype.writeInt8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt8(b-1,a),c&&(this.offset+=1),this},b.prototype.writeByte=b.prototype.writeInt8,b.prototype.readInt8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}return a=this.view.getInt8(a),b&&(this.offset+=1),a},b.prototype.readByte=b.prototype.readInt8,b.prototype.writeUint8=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint8(b-1,a),c&&(this.offset+=1),this},b.prototype.readUint8=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}return a=this.view.getUint8(a),b&&(this.offset+=1),a},b.prototype.writeInt16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt16(b-2,a,this.littleEndian),c&&(this.offset+=2),this},b.prototype.writeShort=b.prototype.writeInt16,b.prototype.readInt16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}return a=this.view.getInt16(a,this.littleEndian),b&&(this.offset+=2),a},b.prototype.readShort=b.prototype.readInt16,b.prototype.writeUint16=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint16(b-2,a,this.littleEndian),c&&(this.offset+=2),this},b.prototype.readUint16=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}return a=this.view.getUint16(a,this.littleEndian),b&&(this.offset+=2),a},b.prototype.writeInt32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setInt32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.writeInt=b.prototype.writeInt32,b.prototype.readInt32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getInt32(a,this.littleEndian),b&&(this.offset+=4),a},b.prototype.readInt=b.prototype.readInt32,b.prototype.writeUint32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setUint32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.readUint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getUint32(a,this.littleEndian),b&&(this.offset+=4),a},a&&(b.prototype.writeInt64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw new TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)
}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},b.prototype.writeLong=b.prototype.writeInt64,b.prototype.readInt64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}return b=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!1):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!1),c&&(this.offset+=8),b},b.prototype.readLong=b.prototype.readInt64,b.prototype.writeUint64=function(b,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if(!(b&&b instanceof a))throw new TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b&&(b=a.fromNumber(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},b.prototype.readUint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}return b=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!0):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!0),c&&(this.offset+=8),b}),b.prototype.writeFloat32=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw new TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setFloat32(b-4,a,this.littleEndian),c&&(this.offset+=4),this},b.prototype.writeFloat=b.prototype.writeFloat32,b.prototype.readFloat32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}return a=this.view.getFloat32(a,this.littleEndian),b&&(this.offset+=4),a},b.prototype.readFloat=b.prototype.readFloat32,b.prototype.writeFloat64=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw new TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=8;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),this.view.setFloat64(b-8,a,this.littleEndian),c&&(this.offset+=8),this},b.prototype.writeDouble=b.prototype.writeFloat64,b.prototype.readFloat64=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+8) <= "+this.buffer.byteLength)}return a=this.view.getFloat64(a,this.littleEndian),b&&(this.offset+=8),a},b.prototype.readDouble=b.prototype.readFloat64,b.MAX_VARINT32_BYTES=5,b.calculateVarint32=function(a){return a>>>=0,128>a?1:16384>a?2:2097152>a?3:268435456>a?4:5},b.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},b.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},b.prototype.writeVarint32=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e=b.calculateVarint32(a);c+=e;var f=this.buffer.byteLength;return c>f&&this.resize((f*=2)>c?f:c),c-=e,this.view.setUint8(c,e=128|a),a>>>=0,a>=128?(e=a>>7|128,this.view.setUint8(c+1,e),a>=16384?(e=a>>14|128,this.view.setUint8(c+2,e),a>=2097152?(e=a>>21|128,this.view.setUint8(c+3,e),a>=268435456?(this.view.setUint8(c+4,a>>28&15),e=5):(this.view.setUint8(c+3,127&e),e=4)):(this.view.setUint8(c+2,127&e),e=3)):(this.view.setUint8(c+1,127&e),e=2)):(this.view.setUint8(c,127&e),e=1),d?(this.offset+=e,this):e},b.prototype.writeVarint32ZigZag=function(a,c){return this.writeVarint32(b.zigZagEncode32(a),c)},b.prototype.readVarint32=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=0,e=0;do c=this.view.getUint8(a+d),5>d&&(e|=(127&c)<<7*d>>>0),++d;while(128===(128&c));return e|=0,b?(this.offset+=d,e):{value:e,length:d}},b.prototype.readVarint32ZigZag=function(a){return a=this.readVarint32(a),"object"==typeof a?a.value=b.zigZagDecode32(a.value):a=b.zigZagDecode32(a),a},a&&(b.MAX_VARINT64_BYTES=10,b.calculateVarint64=function(b){"number"==typeof b&&(b=a.fromNumber(b));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0;return b=b.shiftRightUnsigned(56).toInt()>>>0,0==b?0==d?16384>c?128>c?1:2:2097152>c?3:4:16384>d?128>d?5:6:2097152>d?7:8:128>b?9:10},b.zigZagEncode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},b.zigZagDecode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},b.prototype.writeVarint64=function(c,d){var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"==typeof c)c=a.fromNumber(c);else if(!(c&&c instanceof a))throw new TypeError("Illegal value: "+c+" (not an integer or Long)");if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}"number"==typeof c?c=a.fromNumber(c,!1):!1!==c.unsigned&&(c=c.toSigned());var f=b.calculateVarint64(c),g=c.toInt()>>>0,h=c.shiftRightUnsigned(28).toInt()>>>0,i=c.shiftRightUnsigned(56).toInt()>>>0;d+=f;var j=this.buffer.byteLength;switch(d>j&&this.resize((j*=2)>d?j:d),d-=f,f){case 10:this.view.setUint8(d+9,i>>>7&1);case 9:this.view.setUint8(d+8,9!==f?128|i:127&i);case 8:this.view.setUint8(d+7,8!==f?h>>>21|128:h>>>21&127);case 7:this.view.setUint8(d+6,7!==f?h>>>14|128:h>>>14&127);case 6:this.view.setUint8(d+5,6!==f?h>>>7|128:h>>>7&127);case 5:this.view.setUint8(d+4,5!==f?128|h:127&h);case 4:this.view.setUint8(d+3,4!==f?g>>>21|128:g>>>21&127);case 3:this.view.setUint8(d+2,3!==f?g>>>14|128:g>>>14&127);case 2:this.view.setUint8(d+1,2!==f?g>>>7|128:g>>>7&127);case 1:this.view.setUint8(d,1!==f?128|g:127&g)}return e?(this.offset+=f,this):f},b.prototype.writeVarint64ZigZag=function(a,c){return this.writeVarint64(b.zigZagEncode64(a),c)},b.prototype.readVarint64=function(b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+1) <= "+this.buffer.byteLength)}var d=b,e=0,f=0,g=0,h=0,h=this.view.getUint8(b++),e=127&h;if(128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),f=127&h,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),g=127&h,128&h&&(h=this.view.getUint8(b++),g|=(127&h)<<7,128&h))))))))))throw Error("Data must be corrupt: Buffer overrun");return e=a.fromBits(e|f<<28,f>>>4|g<<24,!1),c?(this.offset=b,e):{value:e,length:b-d}},b.prototype.readVarint64ZigZag=function(c){return(c=this.readVarint64(c))&&c.value instanceof a?c.value=b.zigZagDecode64(c.value):c=b.zigZagDecode64(c),c}),b.prototype.writeCString=function(a,b){var c="undefined"==typeof b;c&&(b=this.offset);var d,f=a.length;if(!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");for(d=0;f>d;++d)if(0===a.charCodeAt(d))throw new RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}d=b,f=e.b(e.a(a))[1],b+=f+1;var g=this.buffer.byteLength;return b>g&&this.resize((g*=2)>b?g:b),b-=f+1,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),this.view.setUint8(b++,0),c?(this.offset=b-d,this):f},b.prototype.readCString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=a,f=-1;return e.d(function(){if(0===f)return null;if(a>=this.limit)throw RangeError("Illegal range: Truncated data, "+a+" < "+this.limit);return 0===(f=this.view.getUint8(a++))?null:f}.bind(this),c=e.c(),!0),b?(this.offset=a,c()):{string:c(),length:a-d}},b.prototype.writeIString=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,f=b;d=e.b(e.a(a),this.noAssert)[1],b+=4+d;var g=this.buffer.byteLength;if(b>g&&this.resize((g*=2)>b?g:b),b-=4+d,this.view.setUint32(b,d,this.littleEndian),b+=4,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),b!==f+4+d)throw new RangeError("Illegal range: Truncated data, "+b+" == "+(b+4+d));return c?(this.offset=b,this):b-f},b.prototype.readIString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=0,d=a,c=this.view.getUint32(a,this.littleEndian);a+=4;var f=a+c;return e.d(function(){return f>a?this.view.getUint8(a++):null}.bind(this),c=e.c(),this.noAssert),c=c(),b?(this.offset=a,c):{string:c,length:a-d}},b.METRICS_CHARS="c",b.METRICS_BYTES="b",b.prototype.writeUTF8String=function(a,b){var c="undefined"==typeof b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: "+b+" (not an integer)");if(b>>>=0,0>b||b+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,f=b;d=e.b(e.a(a))[1],b+=d;var g=this.buffer.byteLength;return b>g&&this.resize((g*=2)>b?g:b),b-=d,e.e(e.a(a),function(a){this.view.setUint8(b++,a)}.bind(this)),c?(this.offset=b,this):b-f},b.prototype.writeString=b.prototype.writeUTF8String,b.calculateUTF8Chars=function(a){return e.b(e.a(a))[0]},b.calculateUTF8Bytes=function(a){return e.b(e.a(a))[1]},b.prototype.readUTF8String=function(a,c,d){"number"==typeof c&&(d=c,c=void 0);var f="undefined"==typeof d;if(f&&(d=this.offset),"undefined"==typeof c&&(c=b.METRICS_CHARS),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal length: "+a+" (not an integer)");if(a|=0,"number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}var g,h=0,i=d;if(c===b.METRICS_CHARS){if(g=e.c(),e.i(function(){return a>h&&d<this.limit?this.view.getUint8(d++):null}.bind(this),function(a){++h,e.g(a,g)}.bind(this)),h!==a)throw new RangeError("Illegal range: Truncated data, "+h+" == "+a);return f?(this.offset=d,g()):{string:g(),length:d-i}}if(c===b.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+a>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+"+a+") <= "+this.buffer.byteLength)}var j=d+a;if(e.d(function(){return j>d?this.view.getUint8(d++):null}.bind(this),g=e.c(),this.noAssert),d!==j)throw new RangeError("Illegal range: Truncated data, "+d+" == "+j);return f?(this.offset=d,g()):{string:g(),length:d-i}}throw new TypeError("Unsupported metrics: "+c)},b.prototype.readString=b.prototype.readUTF8String,b.prototype.writeVString=function(a,c){var d="undefined"==typeof c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if("number"!=typeof c||0!==c%1)throw new TypeError("Illegal offset: "+c+" (not an integer)");if(c>>>=0,0>c||c+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var f,g,h=c;f=e.b(e.a(a),this.noAssert)[1],g=b.calculateVarint32(f),c+=g+f;var i=this.buffer.byteLength;if(c>i&&this.resize((i*=2)>c?i:c),c-=g+f,c+=this.writeVarint32(f,c),e.e(e.a(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==h+f+g)throw new RangeError("Illegal range: Truncated data, "+c+" == "+(c+f+g));return d?(this.offset=c,this):c-h},b.prototype.readVString=function(a){var b="undefined"==typeof a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.readVarint32(a),d=a;a+=c.length;var c=c.value,f=a+c,c=e.c();return e.d(function(){return f>a?this.view.getUint8(a++):null}.bind(this),c,this.noAssert),c=c(),b?(this.offset=a,c):{string:c,length:a-d}},b.prototype.append=function(a,c,d){("number"==typeof c||"string"!=typeof c)&&(d=c,c=void 0);var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}if(a instanceof b||(a=b.wrap(a,c)),c=a.limit-a.offset,0>=c)return this;d+=c;var f=this.buffer.byteLength;return d>f&&this.resize((f*=2)>d?f:d),new Uint8Array(this.buffer,d-c).set(new Uint8Array(a.buffer).subarray(a.offset,a.limit)),a.offset+=c,e&&(this.offset+=c),this},b.prototype.appendTo=function(a,b){return a.append(this,b),this},b.prototype.assert=function(a){return this.noAssert=!a,this},b.prototype.capacity=function(){return this.buffer.byteLength},b.prototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},b.prototype.clone=function(a){var c=new b(0,this.littleEndian,this.noAssert);return a?(a=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(a).set(this.buffer),c.buffer=a,c.view=new DataView(a)):(c.buffer=this.buffer,c.view=this.view),c.offset=this.offset,c.markedOffset=this.markedOffset,c.limit=this.limit,c},b.prototype.compact=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(0===a&&b===this.buffer.byteLength)return this;var d=b-a;if(0===d)return this.buffer=c,this.view=null,0<=this.markedOffset&&(this.markedOffset-=a),this.limit=this.offset=0,this;var e=new ArrayBuffer(d);return new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(a,b)),this.buffer=e,this.view=new DataView(e),0<=this.markedOffset&&(this.markedOffset-=a),this.offset=0,this.limit=d,this},b.prototype.copy=function(a,c){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal end: Not an integer");if(c>>>=0,0>a||a>c||c>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+c+" <= "+this.buffer.byteLength)}if(a===c)return new b(0,this.littleEndian,this.noAssert);var d=c-a,e=new b(d,this.littleEndian,this.noAssert);return e.offset=0,e.limit=d,0<=e.markedOffset&&(e.markedOffset-=a),this.copyTo(e,0,a,c),e},b.prototype.copyTo=function(a,c,d,e){var f,g;if(!this.noAssert&&!b.isByteBuffer(a))throw new TypeError("Illegal target: Not a ByteBuffer");if(c=(g="undefined"==typeof c)?a.offset:0|c,d=(f="undefined"==typeof d)?this.offset:0|d,e="undefined"==typeof e?this.limit:0|e,0>c||c>a.buffer.byteLength)throw new RangeError("Illegal target range: 0 <= "+c+" <= "+a.buffer.byteLength);if(0>d||e>this.buffer.byteLength)throw new RangeError("Illegal source range: 0 <= "+d+" <= "+this.buffer.byteLength);var h=e-d;return 0===h?a:(a.ensureCapacity(c+h),new Uint8Array(a.buffer).set(new Uint8Array(this.buffer).subarray(d,e),c),f&&(this.offset+=h),g&&(a.offset+=h),this)},b.prototype.ensureCapacity=function(a){var b=this.buffer.byteLength;return a>b?this.resize((b*=2)>a?b:a):this},b.prototype.fill=function(a,b,c){var d="undefined"==typeof b;if(d&&(b=this.offset),"string"==typeof a&&0<a.length&&(a=a.charCodeAt(0)),"undefined"==typeof b&&(b=this.offset),"undefined"==typeof c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal begin: Not an integer");if(b>>>=0,"number"!=typeof c||0!==c%1)throw new TypeError("Illegal end: Not an integer");if(c>>>=0,0>b||b>c||c>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(b>=c)return this;for(;c>b;)this.view.setUint8(b++,a);return d&&(this.offset=b),this},b.prototype.flip=function(){return this.limit=this.offset,this.offset=0,this},b.prototype.mark=function(a){if(a="undefined"==typeof a?this.offset:a,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal offset: "+a+" (not an integer)");if(a>>>=0,0>a||a+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=a,this},b.prototype.order=function(a){if(!this.noAssert&&"boolean"!=typeof a)throw new TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!a,this},b.prototype.LE=function(a){return this.littleEndian="undefined"!=typeof a?!!a:!0,this},b.prototype.BE=function(a){return this.littleEndian="undefined"!=typeof a?!a:!1,this},b.prototype.prepend=function(a,c,d){("number"==typeof c||"string"!=typeof c)&&(d=c,c=void 0);var e="undefined"==typeof d;if(e&&(d=this.offset),!this.noAssert){if("number"!=typeof d||0!==d%1)throw new TypeError("Illegal offset: "+d+" (not an integer)");if(d>>>=0,0>d||d+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}if(a instanceof b||(a=b.wrap(a,c)),c=a.limit-a.offset,0>=c)return this;var f,g=c-d;if(g>0){var h=new ArrayBuffer(this.buffer.byteLength+g);f=new Uint8Array(h),f.set(new Uint8Array(this.buffer).subarray(d,this.buffer.byteLength),c),this.buffer=h,this.view=new DataView(h),this.offset+=g,0<=this.markedOffset&&(this.markedOffset+=g),this.limit+=g,d+=g}else f=new Uint8Array(this.buffer);return f.set(new Uint8Array(a.buffer).subarray(a.offset,a.limit),d-c),a.offset=a.limit,e&&(this.offset-=c),this},b.prototype.prependTo=function(a,b){return a.prepend(this,b),this},b.prototype.printDebug=function(a){"function"!=typeof a&&(a=console.log.bind(console)),a(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},b.prototype.remaining=function(){return this.limit-this.offset},b.prototype.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},b.prototype.resize=function(a){if(!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal capacity: "+a+" (not an integer)");if(a|=0,0>a)throw new RangeError("Illegal capacity: 0 <= "+a)}return this.buffer.byteLength<a&&(a=new ArrayBuffer(a),new Uint8Array(a).set(new Uint8Array(this.buffer)),this.buffer=a,this.view=new DataView(a)),this},b.prototype.reverse=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}return a===b?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(a,b)),this.view=new DataView(this.buffer),this)},b.prototype.skip=function(a){if(!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal length: "+a+" (not an integer)");a|=0}var b=this.offset+a;if(!this.noAssert&&(0>b||b>this.buffer.byteLength))throw new RangeError("Illegal length: 0 <= "+this.offset+" + "+a+" <= "+this.buffer.byteLength);return this.offset=b,this},b.prototype.slice=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=a,c.limit=b,c},b.prototype.toBuffer=function(a){var b=this.offset,d=this.limit;if(b>d)var e=b,b=d,d=e;if(!this.noAssert){if("number"!=typeof b||0!==b%1)throw new TypeError("Illegal offset: Not an integer");if(b>>>=0,"number"!=typeof d||0!==d%1)throw new TypeError("Illegal limit: Not an integer");if(d>>>=0,0>b||b>d||d>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+b+" <= "+d+" <= "+this.buffer.byteLength)}return a||0!==b||d!==this.buffer.byteLength?b===d?c:(a=new ArrayBuffer(d-b),new Uint8Array(a).set(new Uint8Array(this.buffer).subarray(b,d),0),a):this.buffer},b.prototype.toArrayBuffer=b.prototype.toBuffer,b.prototype.toString=function(a){if("undefined"==typeof a)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(a){case"utf8":return this.toUTF8();case"base64":return this.toBase64();case"hex":return this.toHex();case"binary":return this.toBinary();case"debug":return this.toDebug();case"columns":return this.m();default:throw Error("Unsupported encoding: "+a)}};var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=d+"";b.prototype.toBase64=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return"";for(var c,e,f,g,h,i,j="";b>a;)c=this.view.getUint8(a++),e=(g=b>a)?this.view.getUint8(a++):0,f=(h=b>a)?this.view.getUint8(a++):0,i=c>>2,c=(3&c)<<4|e>>4,e=(15&e)<<2|f>>6,f&=63,h||(f=64,g||(e=64)),j+=d.charAt(i)+d.charAt(c)+d.charAt(e)+d.charAt(f);return j},b.fromBase64=function(a,c,e){if(!e){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if(0!==a.length%4)throw new TypeError("Illegal str: Length not a multiple of 4")}var f,g=a.length,h=0;for(f=a.length-1;f>=0&&"="===a.charAt(f);--f)h++;if(h>2)throw new TypeError("Illegal str: Suffix is too large");if(0===g)return new b(0,c,e);var i,j,k,l=new b(g/4*3-h,c,e);for(c=f=0;g>f;){if(h=d.indexOf(a.charAt(f++)),i=g>f?d.indexOf(a.charAt(f++)):0,j=g>f?d.indexOf(a.charAt(f++)):0,k=g>f?d.indexOf(a.charAt(f++)):0,!e&&(0>h||0>i||0>j||0>k))throw new TypeError("Illegal str: Contains non-base64 characters");l.view.setUint8(c++,h<<2|i>>4),64!==j&&(l.view.setUint8(c++,i<<4&240|j>>2,c),64!==k&&l.view.setUint8(c++,j<<6&192|k))}return l.limit=c,l},b.btoa=function(a){return b.fromBinary(a).toBase64()},b.atob=function(a){return b.fromBase64(a).toBinary()},b.prototype.toBinary=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return"";for(var c=[];b>a;)c.push(this.view.getUint8(a++));return String.fromCharCode.apply(String,c)},b.fromBinary=function(a,c,d){if(!d&&"string"!=typeof a)throw new TypeError("Illegal str: Not a string");for(var e=0,f=a.length,g=new b(f,c,d);f>e;){if(c=a.charCodeAt(e),!d&&c>255)throw new TypeError("Illegal charCode at "+e+": 0 <= "+c+" <= 255");g.view.setUint8(e++,c)}return g.limit=f,g},b.prototype.toDebug=function(a){for(var b,c=-1,d=this.buffer.byteLength,e="",f="",g="";d>c;){if(-1!==c&&(b=this.view.getUint8(c),e=16>b?e+("0"+b.toString(16).toUpperCase()):e+b.toString(16).toUpperCase(),a&&(f+=b>32&&127>b?String.fromCharCode(b):".")),++c,a&&c>0&&0===c%16&&c!==d){for(;51>e.length;)e+=" ";g+=e+f+"\n",e=f=""}e=c===this.offset&&c===this.limit?e+(c===this.markedOffset?"!":"|"):c===this.offset?e+(c===this.markedOffset?"[":"<"):c===this.limit?e+(c===this.markedOffset?"]":">"):e+(c===this.markedOffset?"'":a||0!==c&&c!==d?" ":"")}if(a&&" "!==e){for(;51>e.length;)e+=" ";g+=e+f+"\n"}return a?g:e},b.fromDebug=function(a,c,d){var e=a.length;c=new b((e+1)/3|0,c,d);for(var f,g=0,h=0,i=!1,j=!1,k=!1,l=!1,m=!1;e>g;){switch(f=a.charAt(g++)){case"!":if(!d){if(j||k||l){m=!0;break}j=k=l=!0}c.offset=c.markedOffset=c.limit=h,i=!1;break;case"|":if(!d){if(j||l){m=!0;break}j=l=!0}c.offset=c.limit=h,i=!1;break;case"[":if(!d){if(j||k){m=!0;break}j=k=!0}c.offset=c.markedOffset=h,i=!1;break;case"<":if(!d){if(j){m=!0;break}j=!0}c.offset=h,i=!1;break;case"]":if(!d){if(l||k){m=!0;break}l=k=!0}c.limit=c.markedOffset=h,i=!1;break;case">":if(!d){if(l){m=!0;break}l=!0}c.limit=h,i=!1;break;case"'":if(!d){if(k){m=!0;break}k=!0}c.markedOffset=h,i=!1;break;case" ":i=!1;break;default:if(!d&&i){m=!0;break}if(f=parseInt(f+a.charAt(g++),16),!d&&(isNaN(f)||0>f||f>255))throw new TypeError("Illegal str: Not a debug encoded string");c.view.setUint8(h++,f),i=!0}if(m)throw new TypeError("Illegal str: Invalid symbol at "+g)}if(!d){if(!j||!l)throw new TypeError("Illegal str: Missing offset or limit");if(h<c.buffer.byteLength)throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) "+h+" < "+e)}return c},b.prototype.toHex=function(a,b){if(a="undefined"==typeof a?this.offset:a,b="undefined"==typeof b?this.limit:b,!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}for(var c,d=Array(b-a);b>a;)c=this.view.getUint8(a++),16>c?d.push("0",c.toString(16)):d.push(c.toString(16));return d.join("")},b.fromHex=function(a,c,d){if(!d){if("string"!=typeof a)throw new TypeError("Illegal str: Not a string");if(0!==a.length%2)throw new TypeError("Illegal str: Length not a multiple of 2")}var e=a.length;c=new b(e/2|0,c);for(var f,g=0,h=0;e>g;g+=2){if(f=parseInt(a.substring(g,g+2),16),!d&&(!isFinite(f)||0>f||f>255))throw new TypeError("Illegal str: Contains non-hex characters");c.view.setUint8(h++,f)}return c.limit=h,c};var e=function(){var a={k:1114111,j:function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)128>c?b(127&c):(2048>c?b(c>>6&31|192):(65536>c?b(c>>12&15|224):(b(c>>18&7|240),b(c>>12&63|128)),b(c>>6&63|128)),b(63&c|128)),c=null},i:function(a,b){function c(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b}for(var d,e,f,g;null!==(d=a());)if(0===(128&d))b(d);else if(192===(224&d))null===(e=a())&&c([d,e]),b((31&d)<<6|63&e);else if(224===(240&d))null!==(e=a())&&null!==(f=a())||c([d,e,f]),b((15&d)<<12|(63&e)<<6|63&f);else{if(240!==(248&d))throw RangeError("Illegal starting byte: "+d);null!==(e=a())&&null!==(f=a())&&null!==(g=a())||c([d,e,f,g]),b((7&d)<<18|(63&e)<<12|(63&f)<<6|63&g)}},f:function(a,b){for(var c,d=null;null!==(c=null!==d?d:a());)c>=55296&&57343>=c&&null!==(d=a())&&d>=56320&&57343>=d?(b(1024*(c-55296)+d-56320+65536),d=null):b(c);null!==d&&b(d)},g:function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)65535>=c?b(c):(c-=65536,b((c>>10)+55296),b(c%1024+56320)),c=null},e:function(b,c){a.f(b,function(b){a.j(b,c)})},d:function(b,c){a.i(b,function(b){a.g(b,c)})},h:function(a){return 128>a?1:2048>a?2:65536>a?3:4},l:function(b){for(var c,d=0;null!==(c=b());)d+=a.h(c);return d},b:function(b){var c=0,d=0;return a.f(b,function(b){++c,d+=a.h(b)}),[c,d]}};return a}(),f=String.fromCharCode;return e.a=function(a){var b=0;return function(){return b<a.length?a.charCodeAt(b++):null}},e.c=function(){var a=[],b=[];return function(){return 0===arguments.length?b.join("")+f.apply(String,a):(1024<a.length+arguments.length&&(b.push(f.apply(String,a)),a.length=0),void Array.prototype.push.apply(a,arguments))}},b.prototype.toUTF8=function(a,b){if("undefined"==typeof a&&(a=this.offset),"undefined"==typeof b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||0!==a%1)throw new TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||0!==b%1)throw new TypeError("Illegal end: Not an integer");if(b>>>=0,0>a||a>b||b>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c,d=this;try{e.d(function(){return b>a?d.view.getUint8(a++):null},c=e.c())}catch(f){if(a!==b)throw new RangeError("Illegal range: Truncated data, "+a+" != "+b)}return c()},b.fromUTF8=function(a,c,d){if(!d&&"string"!=typeof a)throw new TypeError("Illegal str: Not a string");var f=new b(e.b(e.a(a),!0)[1],c,d),g=0;
return e.e(e.a(a),function(a){f.view.setUint8(g++,a)}),f.limit=g,f},b}"undefined"!=typeof b&&b.exports?b.exports=d(a("long")):"function"==typeof define&&define.amd?define("ByteBuffer",["Long"],function(a){return d(a)}):(c.dcodeIO=c.dcodeIO||{}).ByteBuffer=d(c.dcodeIO.Long)}(this)},{"long":230}],229:[function(a,b){!function(a){"use strict";var c=function(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c};c.isLong=function(a){return(a&&a instanceof c)===!0};var d={},e={};c.fromInt=function(a,b){var f,g;return b?(a>>>=0,a>=0&&256>a&&(g=e[a])?g:(f=new c(a,0>(0|a)?-1:0,!0),a>=0&&256>a&&(e[a]=f),f)):(a=0|a,a>=-128&&128>a&&(g=d[a])?g:(f=new c(a,0>a?-1:0,!1),a>=-128&&128>a&&(d[a]=f),f))},c.fromNumber=function(a,b){return b=!!b,isNaN(a)||!isFinite(a)?c.ZERO:!b&&-i>=a?c.MIN_VALUE:!b&&a+1>=i?c.MAX_VALUE:b&&a>=h?c.MAX_UNSIGNED_VALUE:0>a?c.fromNumber(-a,b).negate():new c(a%g|0,a/g|0,b)},c.fromBits=function(a,b,d){return new c(a,b,d)},c.fromString=function(a,b,d){if(0===a.length)throw Error("number format error: empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return c.ZERO;if("number"==typeof b&&(d=b,b=!1),d=d||10,2>d||d>36)throw Error("radix out of range: "+d);var e;if((e=a.indexOf("-"))>0)throw Error('number format error: interior "-" character: '+a);if(0===e)return c.fromString(a.substring(1),b,d).negate();for(var f=c.fromNumber(Math.pow(d,8)),g=c.ZERO,h=0;h<a.length;h+=8){var i=Math.min(8,a.length-h),j=parseInt(a.substring(h,h+i),d);if(8>i){var k=c.fromNumber(Math.pow(d,i));g=g.multiply(k).add(c.fromNumber(j))}else g=g.multiply(f),g=g.add(c.fromNumber(j))}return g.unsigned=b,g},c.fromValue=function(a){return"number"==typeof a?c.fromNumber(a):"string"==typeof a?c.fromString(a):c.isLong(a)?a:new c(a.low,a.high,a.unsigned)};var f=65536,g=f*f,h=g*g,i=h/2,j=c.fromInt(1<<24);c.ZERO=c.fromInt(0),c.UZERO=c.fromInt(0,!0),c.ONE=c.fromInt(1),c.UONE=c.fromInt(1,!0),c.NEG_ONE=c.fromInt(-1),c.MAX_VALUE=c.fromBits(-1,2147483647,!1),c.MAX_UNSIGNED_VALUE=c.fromBits(-1,-1,!0),c.MIN_VALUE=c.fromBits(0,-2147483648,!1),c.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},c.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},c.prototype.toString=function(a){if(a=a||10,2>a||a>36)throw RangeError("radix out of range: "+a);if(this.isZero())return"0";var b;if(this.isNegative()){if(this.equals(c.MIN_VALUE)){var d=c.fromNumber(a),e=this.div(d);return b=e.multiply(d).subtract(this),e.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}var f=c.fromNumber(Math.pow(a,6),this.unsigned);b=this;for(var g="";;){var h=b.div(f),i=b.subtract(h.multiply(f)).toInt()>>>0,j=i.toString(a);if(b=h,b.isZero())return j+g;for(;j.length<6;)j="0"+j;g=""+j+g}},c.prototype.getHighBits=function(){return this.high},c.prototype.getHighBitsUnsigned=function(){return this.high>>>0},c.prototype.getLowBits=function(){return this.low},c.prototype.getLowBitsUnsigned=function(){return this.low>>>0},c.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(c.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high?b+33:b+1},c.prototype.isZero=function(){return 0===this.high&&0===this.low},c.prototype.isNegative=function(){return!this.unsigned&&this.high<0},c.prototype.isPositive=function(){return this.unsigned||this.high>=0},c.prototype.isOdd=function(){return 1===(1&this.low)},c.prototype.isEven=function(){return 0===(1&this.low)},c.prototype.equals=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.unsigned!==a.unsigned&&this.high>>>31!==a.high>>>31?!1:this.high===a.high&&this.low===a.low},c.prototype.notEquals=function(a){return c.isLong(a)||(a=c.fromValue(a)),!this.equals(a)},c.prototype.lessThan=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.compare(a)<0},c.prototype.lessThanOrEqual=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.compare(a)<=0},c.prototype.greaterThan=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.compare(a)>0},c.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0},c.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.subtract(a).isNegative()?-1:1},c.prototype.negate=function(){return!this.unsigned&&this.equals(c.MIN_VALUE)?c.MIN_VALUE:this.not().add(c.ONE)},c.prototype.add=function(a){c.isLong(a)||(a=c.fromValue(a));var b=this.high>>>16,d=65535&this.high,e=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,i=a.low>>>16,j=65535&a.low,k=0,l=0,m=0,n=0;return n+=f+j,m+=n>>>16,n&=65535,m+=e+i,l+=m>>>16,m&=65535,l+=d+h,k+=l>>>16,l&=65535,k+=b+g,k&=65535,c.fromBits(m<<16|n,k<<16|l,this.unsigned)},c.prototype.subtract=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.add(a.negate())},c.prototype.multiply=function(a){if(this.isZero())return c.ZERO;if(c.isLong(a)||(a=c.fromValue(a)),a.isZero())return c.ZERO;if(this.equals(c.MIN_VALUE))return a.isOdd()?c.MIN_VALUE:c.ZERO;if(a.equals(c.MIN_VALUE))return this.isOdd()?c.MIN_VALUE:c.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(j)&&a.lessThan(j))return c.fromNumber(this.toNumber()*a.toNumber(),this.unsigned);var b=this.high>>>16,d=65535&this.high,e=this.low>>>16,f=65535&this.low,g=a.high>>>16,h=65535&a.high,i=a.low>>>16,k=65535&a.low,l=0,m=0,n=0,o=0;return o+=f*k,n+=o>>>16,o&=65535,n+=e*k,m+=n>>>16,n&=65535,n+=f*i,m+=n>>>16,n&=65535,m+=d*k,l+=m>>>16,m&=65535,m+=e*i,l+=m>>>16,m&=65535,m+=f*h,l+=m>>>16,m&=65535,l+=b*k+d*i+e*h+f*g,l&=65535,c.fromBits(n<<16|o,l<<16|m,this.unsigned)},c.prototype.div=function(a){if(c.isLong(a)||(a=c.fromValue(a)),a.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?c.UZERO:c.ZERO;var b,d,e;if(this.equals(c.MIN_VALUE)){if(a.equals(c.ONE)||a.equals(c.NEG_ONE))return c.MIN_VALUE;if(a.equals(c.MIN_VALUE))return c.ONE;var f=this.shiftRight(1);return b=f.div(a).shiftLeft(1),b.equals(c.ZERO)?a.isNegative()?c.ONE:c.NEG_ONE:(d=this.subtract(a.multiply(b)),e=b.add(d.div(a)))}if(a.equals(c.MIN_VALUE))return this.unsigned?c.UZERO:c.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();for(e=c.ZERO,d=this;d.greaterThanOrEqual(a);){b=Math.max(1,Math.floor(d.toNumber()/a.toNumber()));for(var g=Math.ceil(Math.log(b)/Math.LN2),h=48>=g?1:Math.pow(2,g-48),i=c.fromNumber(b),j=i.multiply(a);j.isNegative()||j.greaterThan(d);)b-=h,i=c.fromNumber(b,this.unsigned),j=i.multiply(a);i.isZero()&&(i=c.ONE),e=e.add(i),d=d.subtract(j)}return e},c.prototype.modulo=function(a){return c.isLong(a)||(a=c.fromValue(a)),this.subtract(this.div(a).multiply(a))},c.prototype.not=function(){return c.fromBits(~this.low,~this.high,this.unsigned)},c.prototype.and=function(a){return c.isLong(a)||(a=c.fromValue(a)),c.fromBits(this.low&a.low,this.high&a.high,this.unsigned)},c.prototype.or=function(a){return c.isLong(a)||(a=c.fromValue(a)),c.fromBits(this.low|a.low,this.high|a.high,this.unsigned)},c.prototype.xor=function(a){return c.isLong(a)||(a=c.fromValue(a)),c.fromBits(this.low^a.low,this.high^a.high,this.unsigned)},c.prototype.shiftLeft=function(a){return c.isLong(a)&&(a=a.toInt()),0===(a&=63)?this:32>a?c.fromBits(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):c.fromBits(0,this.low<<a-32,this.unsigned)},c.prototype.shiftRight=function(a){return c.isLong(a)&&(a=a.toInt()),0===(a&=63)?this:32>a?c.fromBits(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):c.fromBits(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},c.prototype.shiftRightUnsigned=function(a){if(c.isLong(a)&&(a=a.toInt()),a&=63,0===a)return this;var b=this.high;if(32>a){var d=this.low;return c.fromBits(d>>>a|b<<32-a,b>>>a,this.unsigned)}return 32===a?c.fromBits(b,0,this.unsigned):c.fromBits(b>>>a-32,0,this.unsigned)},c.prototype.toSigned=function(){return this.unsigned?new c(this.low,this.high,!1):this},c.prototype.toUnsigned=function(){return this.unsigned?this:new c(this.low,this.high,!0)},"undefined"!=typeof b&&b.exports?b.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):(a.dcodeIO=a.dcodeIO||{}).Long=c}(this)},{}],230:[function(a,b,c){arguments[4][125][0].apply(c,arguments)},{"./dist/Long.js":229}]},{},[128]);